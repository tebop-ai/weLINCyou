function yO(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var Gc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function DT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function X5(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var xO={exports:{}},E0={},vO={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fm=Symbol.for("react.element"),Y5=Symbol.for("react.portal"),Q5=Symbol.for("react.fragment"),J5=Symbol.for("react.strict_mode"),Z5=Symbol.for("react.profiler"),eG=Symbol.for("react.provider"),tG=Symbol.for("react.context"),nG=Symbol.for("react.forward_ref"),sG=Symbol.for("react.suspense"),rG=Symbol.for("react.memo"),iG=Symbol.for("react.lazy"),E$=Symbol.iterator;function oG(t){return t===null||typeof t!="object"?null:(t=E$&&t[E$]||t["@@iterator"],typeof t=="function"?t:null)}var bO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wO=Object.assign,IO={};function Dd(t,e,n){this.props=t,this.context=e,this.refs=IO,this.updater=n||bO}Dd.prototype.isReactComponent={};Dd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Dd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kO(){}kO.prototype=Dd.prototype;function PT(t,e,n){this.props=t,this.context=e,this.refs=IO,this.updater=n||bO}var OT=PT.prototype=new kO;OT.constructor=PT;wO(OT,Dd.prototype);OT.isPureReactComponent=!0;var C$=Array.isArray,SO=Object.prototype.hasOwnProperty,FT={current:null},TO={key:!0,ref:!0,__self:!0,__source:!0};function NO(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)SO.call(e,s)&&!TO.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:fm,type:t,key:i,ref:o,props:r,_owner:FT.current}}function aG(t,e){return{$$typeof:fm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function LT(t){return typeof t=="object"&&t!==null&&t.$$typeof===fm}function lG(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var $$=/\/+/g;function H1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?lG(""+t.key):e.toString(36)}function Cx(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case fm:case Y5:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+H1(o,0):s,C$(r)?(n="",t!=null&&(n=t.replace($$,"$&/")+"/"),Cx(r,e,n,"",function(c){return c})):r!=null&&(LT(r)&&(r=aG(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace($$,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",C$(t))for(var a=0;a<t.length;a++){i=t[a];var l=s+H1(i,a);o+=Cx(i,e,n,l,r)}else if(l=oG(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=s+H1(i,a++),o+=Cx(i,e,n,l,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ly(t,e,n){if(t==null)return t;var s=[],r=0;return Cx(t,s,"","",function(i){return e.call(n,i,r++)}),s}function cG(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ws={current:null},$x={transition:null},uG={ReactCurrentDispatcher:Ws,ReactCurrentBatchConfig:$x,ReactCurrentOwner:FT};function _O(){throw Error("act(...) is not supported in production builds of React.")}st.Children={map:Ly,forEach:function(t,e,n){Ly(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ly(t,function(){e++}),e},toArray:function(t){return Ly(t,function(e){return e})||[]},only:function(t){if(!LT(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};st.Component=Dd;st.Fragment=Q5;st.Profiler=Z5;st.PureComponent=PT;st.StrictMode=J5;st.Suspense=sG;st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uG;st.act=_O;st.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=wO({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=FT.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)SO.call(e,l)&&!TO.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:fm,type:t.type,key:r,ref:i,props:s,_owner:o}};st.createContext=function(t){return t={$$typeof:tG,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:eG,_context:t},t.Consumer=t};st.createElement=NO;st.createFactory=function(t){var e=NO.bind(null,t);return e.type=t,e};st.createRef=function(){return{current:null}};st.forwardRef=function(t){return{$$typeof:nG,render:t}};st.isValidElement=LT;st.lazy=function(t){return{$$typeof:iG,_payload:{_status:-1,_result:t},_init:cG}};st.memo=function(t,e){return{$$typeof:rG,type:t,compare:e===void 0?null:e}};st.startTransition=function(t){var e=$x.transition;$x.transition={};try{t()}finally{$x.transition=e}};st.unstable_act=_O;st.useCallback=function(t,e){return Ws.current.useCallback(t,e)};st.useContext=function(t){return Ws.current.useContext(t)};st.useDebugValue=function(){};st.useDeferredValue=function(t){return Ws.current.useDeferredValue(t)};st.useEffect=function(t,e){return Ws.current.useEffect(t,e)};st.useId=function(){return Ws.current.useId()};st.useImperativeHandle=function(t,e,n){return Ws.current.useImperativeHandle(t,e,n)};st.useInsertionEffect=function(t,e){return Ws.current.useInsertionEffect(t,e)};st.useLayoutEffect=function(t,e){return Ws.current.useLayoutEffect(t,e)};st.useMemo=function(t,e){return Ws.current.useMemo(t,e)};st.useReducer=function(t,e,n){return Ws.current.useReducer(t,e,n)};st.useRef=function(t){return Ws.current.useRef(t)};st.useState=function(t){return Ws.current.useState(t)};st.useSyncExternalStore=function(t,e,n){return Ws.current.useSyncExternalStore(t,e,n)};st.useTransition=function(){return Ws.current.useTransition()};st.version="18.3.1";vO.exports=st;var M=vO.exports;const bt=DT(M),nd=yO({__proto__:null,default:bt},[M]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dG=M,hG=Symbol.for("react.element"),pG=Symbol.for("react.fragment"),fG=Object.prototype.hasOwnProperty,mG=dG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gG={key:!0,ref:!0,__self:!0,__source:!0};function EO(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)fG.call(e,s)&&!gG.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:hG,type:t,key:i,ref:o,props:r,_owner:mG.current}}E0.Fragment=pG;E0.jsx=EO;E0.jsxs=EO;xO.exports=E0;var b=xO.exports,sk={},CO={exports:{}},$r={},$O={exports:{}},AO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,H){var Z=B.length;B.push(H);e:for(;0<Z;){var se=Z-1>>>1,re=B[se];if(0<r(re,H))B[se]=H,B[Z]=re,Z=se;else break e}}function n(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var H=B[0],Z=B.pop();if(Z!==H){B[0]=Z;e:for(var se=0,re=B.length,ie=re>>>1;se<ie;){var de=2*(se+1)-1,ce=B[de],pe=de+1,we=B[pe];if(0>r(ce,Z))pe<re&&0>r(we,ce)?(B[se]=we,B[pe]=Z,se=pe):(B[se]=ce,B[de]=Z,se=de);else if(pe<re&&0>r(we,Z))B[se]=we,B[pe]=Z,se=pe;else break e}}return H}function r(B,H){var Z=B.sortIndex-H.sortIndex;return Z!==0?Z:B.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,p=!1,f=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(B){for(var H=n(c);H!==null;){if(H.callback===null)s(c);else if(H.startTime<=B)s(c),H.sortIndex=H.expirationTime,e(l,H);else break;H=n(c)}}function I(B){if(g=!1,w(B),!f)if(n(l)!==null)f=!0,Q(N);else{var H=n(c);H!==null&&te(I,H.startTime-B)}}function N(B,H){f=!1,g&&(g=!1,x(S),S=-1),p=!0;var Z=h;try{for(w(H),d=n(l);d!==null&&(!(d.expirationTime>H)||B&&!P());){var se=d.callback;if(typeof se=="function"){d.callback=null,h=d.priorityLevel;var re=se(d.expirationTime<=H);H=t.unstable_now(),typeof re=="function"?d.callback=re:d===n(l)&&s(l),w(H)}else s(l);d=n(l)}if(d!==null)var ie=!0;else{var de=n(c);de!==null&&te(I,de.startTime-H),ie=!1}return ie}finally{d=null,h=Z,p=!1}}var A=!1,T=null,S=-1,E=5,$=-1;function P(){return!(t.unstable_now()-$<E)}function F(){if(T!==null){var B=t.unstable_now();$=B;var H=!0;try{H=T(!0,B)}finally{H?R():(A=!1,T=null)}}else A=!1}var R;if(typeof v=="function")R=function(){v(F)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,q=G.port2;G.port1.onmessage=F,R=function(){q.postMessage(null)}}else R=function(){y(F,0)};function Q(B){T=B,A||(A=!0,R())}function te(B,H){S=y(function(){B(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,Q(N))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(B){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var Z=h;h=H;try{return B()}finally{h=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,H){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Z=h;h=B;try{return H()}finally{h=Z}},t.unstable_scheduleCallback=function(B,H,Z){var se=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?se+Z:se):Z=se,B){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Z+re,B={id:u++,callback:H,priorityLevel:B,startTime:Z,expirationTime:re,sortIndex:-1},Z>se?(B.sortIndex=Z,e(c,B),n(l)===null&&B===n(c)&&(g?(x(S),S=-1):g=!0,te(I,Z-se))):(B.sortIndex=re,e(l,B),f||p||(f=!0,Q(N))),B},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(B){var H=h;return function(){var Z=h;h=H;try{return B.apply(this,arguments)}finally{h=Z}}}})(AO);$O.exports=AO;var yG=$O.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xG=M,_r=yG;function he(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RO=new Set,xf={};function Hc(t,e){sd(t,e),sd(t+"Capture",e)}function sd(t,e){for(xf[t]=e,t=0;t<e.length;t++)RO.add(e[t])}var Fo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rk=Object.prototype.hasOwnProperty,vG=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A$={},R$={};function bG(t){return rk.call(R$,t)?!0:rk.call(A$,t)?!1:vG.test(t)?R$[t]=!0:(A$[t]=!0,!1)}function wG(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function IG(t,e,n,s){if(e===null||typeof e>"u"||wG(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Gs(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var as={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){as[t]=new Gs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];as[e]=new Gs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){as[t]=new Gs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){as[t]=new Gs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){as[t]=new Gs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){as[t]=new Gs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){as[t]=new Gs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){as[t]=new Gs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){as[t]=new Gs(t,5,!1,t.toLowerCase(),null,!1,!1)});var MT=/[\-:]([a-z])/g;function VT(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(MT,VT);as[e]=new Gs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(MT,VT);as[e]=new Gs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(MT,VT);as[e]=new Gs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){as[t]=new Gs(t,1,!1,t.toLowerCase(),null,!1,!1)});as.xlinkHref=new Gs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){as[t]=new Gs(t,1,!1,t.toLowerCase(),null,!0,!0)});function zT(t,e,n,s){var r=as.hasOwnProperty(e)?as[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(IG(e,n,r,s)&&(n=null),s||r===null?bG(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Qo=xG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,My=Symbol.for("react.element"),_u=Symbol.for("react.portal"),Eu=Symbol.for("react.fragment"),jT=Symbol.for("react.strict_mode"),ik=Symbol.for("react.profiler"),DO=Symbol.for("react.provider"),PO=Symbol.for("react.context"),BT=Symbol.for("react.forward_ref"),ok=Symbol.for("react.suspense"),ak=Symbol.for("react.suspense_list"),UT=Symbol.for("react.memo"),xa=Symbol.for("react.lazy"),OO=Symbol.for("react.offscreen"),D$=Symbol.iterator;function yp(t){return t===null||typeof t!="object"?null:(t=D$&&t[D$]||t["@@iterator"],typeof t=="function"?t:null)}var Jt=Object.assign,q1;function Fp(t){if(q1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);q1=e&&e[1]||""}return`
`+q1+t}var K1=!1;function X1(t,e){if(!t||K1)return"";K1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,a=i.length-1;1<=o&&0<=a&&r[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==i[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{K1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fp(t):""}function kG(t){switch(t.tag){case 5:return Fp(t.type);case 16:return Fp("Lazy");case 13:return Fp("Suspense");case 19:return Fp("SuspenseList");case 0:case 2:case 15:return t=X1(t.type,!1),t;case 11:return t=X1(t.type.render,!1),t;case 1:return t=X1(t.type,!0),t;default:return""}}function lk(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Eu:return"Fragment";case _u:return"Portal";case ik:return"Profiler";case jT:return"StrictMode";case ok:return"Suspense";case ak:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case PO:return(t.displayName||"Context")+".Consumer";case DO:return(t._context.displayName||"Context")+".Provider";case BT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case UT:return e=t.displayName||null,e!==null?e:lk(t.type)||"Memo";case xa:e=t._payload,t=t._init;try{return lk(t(e))}catch{}}return null}function SG(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lk(e);case 8:return e===jT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ya(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function FO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function TG(t){var e=FO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vy(t){t._valueTracker||(t._valueTracker=TG(t))}function LO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=FO(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function tv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ck(t,e){var n=e.checked;return Jt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function P$(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Ya(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function MO(t,e){e=e.checked,e!=null&&zT(t,"checked",e,!1)}function uk(t,e){MO(t,e);var n=Ya(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?dk(t,e.type,n):e.hasOwnProperty("defaultValue")&&dk(t,e.type,Ya(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function O$(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function dk(t,e,n){(e!=="number"||tv(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Lp=Array.isArray;function zu(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Ya(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function hk(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(he(91));return Jt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function F$(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(he(92));if(Lp(n)){if(1<n.length)throw Error(he(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ya(n)}}function VO(t,e){var n=Ya(e.value),s=Ya(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function L$(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pk(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var zy,jO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(zy=zy||document.createElement("div"),zy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=zy.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ef={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NG=["Webkit","ms","Moz","O"];Object.keys(ef).forEach(function(t){NG.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ef[e]=ef[t]})});function BO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ef.hasOwnProperty(t)&&ef[t]?(""+e).trim():e+"px"}function UO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=BO(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var _G=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fk(t,e){if(e){if(_G[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(he(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(he(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(he(61))}if(e.style!=null&&typeof e.style!="object")throw Error(he(62))}}function mk(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gk=null;function WT(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var yk=null,ju=null,Bu=null;function M$(t){if(t=ym(t)){if(typeof yk!="function")throw Error(he(280));var e=t.stateNode;e&&(e=D0(e),yk(t.stateNode,t.type,e))}}function WO(t){ju?Bu?Bu.push(t):Bu=[t]:ju=t}function GO(){if(ju){var t=ju,e=Bu;if(Bu=ju=null,M$(t),e)for(t=0;t<e.length;t++)M$(e[t])}}function HO(t,e){return t(e)}function qO(){}var Y1=!1;function KO(t,e,n){if(Y1)return t(e,n);Y1=!0;try{return HO(t,e,n)}finally{Y1=!1,(ju!==null||Bu!==null)&&(qO(),GO())}}function bf(t,e){var n=t.stateNode;if(n===null)return null;var s=D0(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(he(231,e,typeof n));return n}var xk=!1;if(Fo)try{var xp={};Object.defineProperty(xp,"passive",{get:function(){xk=!0}}),window.addEventListener("test",xp,xp),window.removeEventListener("test",xp,xp)}catch{xk=!1}function EG(t,e,n,s,r,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var tf=!1,nv=null,sv=!1,vk=null,CG={onError:function(t){tf=!0,nv=t}};function $G(t,e,n,s,r,i,o,a,l){tf=!1,nv=null,EG.apply(CG,arguments)}function AG(t,e,n,s,r,i,o,a,l){if($G.apply(this,arguments),tf){if(tf){var c=nv;tf=!1,nv=null}else throw Error(he(198));sv||(sv=!0,vk=c)}}function qc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function XO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function V$(t){if(qc(t)!==t)throw Error(he(188))}function RG(t){var e=t.alternate;if(!e){if(e=qc(t),e===null)throw Error(he(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return V$(r),t;if(i===s)return V$(r),e;i=i.sibling}throw Error(he(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,s=i;break}if(a===s){o=!0,s=r,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,s=r;break}if(a===s){o=!0,s=i,n=r;break}a=a.sibling}if(!o)throw Error(he(189))}}if(n.alternate!==s)throw Error(he(190))}if(n.tag!==3)throw Error(he(188));return n.stateNode.current===n?t:e}function YO(t){return t=RG(t),t!==null?QO(t):null}function QO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=QO(t);if(e!==null)return e;t=t.sibling}return null}var JO=_r.unstable_scheduleCallback,z$=_r.unstable_cancelCallback,DG=_r.unstable_shouldYield,PG=_r.unstable_requestPaint,fn=_r.unstable_now,OG=_r.unstable_getCurrentPriorityLevel,GT=_r.unstable_ImmediatePriority,ZO=_r.unstable_UserBlockingPriority,rv=_r.unstable_NormalPriority,FG=_r.unstable_LowPriority,eF=_r.unstable_IdlePriority,C0=null,Ui=null;function LG(t){if(Ui&&typeof Ui.onCommitFiberRoot=="function")try{Ui.onCommitFiberRoot(C0,t,void 0,(t.current.flags&128)===128)}catch{}}var mi=Math.clz32?Math.clz32:zG,MG=Math.log,VG=Math.LN2;function zG(t){return t>>>=0,t===0?32:31-(MG(t)/VG|0)|0}var jy=64,By=4194304;function Mp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function iv(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?s=Mp(a):(i&=o,i!==0&&(s=Mp(i)))}else o=n&~r,o!==0?s=Mp(o):i!==0&&(s=Mp(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-mi(e),r=1<<n,s|=t[n],e&=~r;return s}function jG(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function BG(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-mi(i),a=1<<o,l=r[o];l===-1?(!(a&n)||a&s)&&(r[o]=jG(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function bk(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function tF(){var t=jy;return jy<<=1,!(jy&4194240)&&(jy=64),t}function Q1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function mm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mi(e),t[e]=n}function UG(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-mi(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function HT(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-mi(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var It=0;function nF(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var sF,qT,rF,iF,oF,wk=!1,Uy=[],Oa=null,Fa=null,La=null,wf=new Map,If=new Map,wa=[],WG="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function j$(t,e){switch(t){case"focusin":case"focusout":Oa=null;break;case"dragenter":case"dragleave":Fa=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":wf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":If.delete(e.pointerId)}}function vp(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=ym(e),e!==null&&qT(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function GG(t,e,n,s,r){switch(e){case"focusin":return Oa=vp(Oa,t,e,n,s,r),!0;case"dragenter":return Fa=vp(Fa,t,e,n,s,r),!0;case"mouseover":return La=vp(La,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return wf.set(i,vp(wf.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,If.set(i,vp(If.get(i)||null,t,e,n,s,r)),!0}return!1}function aF(t){var e=Jl(t.target);if(e!==null){var n=qc(e);if(n!==null){if(e=n.tag,e===13){if(e=XO(n),e!==null){t.blockedOn=e,oF(t.priority,function(){rF(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ax(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ik(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);gk=s,n.target.dispatchEvent(s),gk=null}else return e=ym(n),e!==null&&qT(e),t.blockedOn=n,!1;e.shift()}return!0}function B$(t,e,n){Ax(t)&&n.delete(e)}function HG(){wk=!1,Oa!==null&&Ax(Oa)&&(Oa=null),Fa!==null&&Ax(Fa)&&(Fa=null),La!==null&&Ax(La)&&(La=null),wf.forEach(B$),If.forEach(B$)}function bp(t,e){t.blockedOn===e&&(t.blockedOn=null,wk||(wk=!0,_r.unstable_scheduleCallback(_r.unstable_NormalPriority,HG)))}function kf(t){function e(r){return bp(r,t)}if(0<Uy.length){bp(Uy[0],t);for(var n=1;n<Uy.length;n++){var s=Uy[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Oa!==null&&bp(Oa,t),Fa!==null&&bp(Fa,t),La!==null&&bp(La,t),wf.forEach(e),If.forEach(e),n=0;n<wa.length;n++)s=wa[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<wa.length&&(n=wa[0],n.blockedOn===null);)aF(n),n.blockedOn===null&&wa.shift()}var Uu=Qo.ReactCurrentBatchConfig,ov=!0;function qG(t,e,n,s){var r=It,i=Uu.transition;Uu.transition=null;try{It=1,KT(t,e,n,s)}finally{It=r,Uu.transition=i}}function KG(t,e,n,s){var r=It,i=Uu.transition;Uu.transition=null;try{It=4,KT(t,e,n,s)}finally{It=r,Uu.transition=i}}function KT(t,e,n,s){if(ov){var r=Ik(t,e,n,s);if(r===null)aI(t,e,s,av,n),j$(t,s);else if(GG(r,t,e,n,s))s.stopPropagation();else if(j$(t,s),e&4&&-1<WG.indexOf(t)){for(;r!==null;){var i=ym(r);if(i!==null&&sF(i),i=Ik(t,e,n,s),i===null&&aI(t,e,s,av,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else aI(t,e,s,null,n)}}var av=null;function Ik(t,e,n,s){if(av=null,t=WT(s),t=Jl(t),t!==null)if(e=qc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=XO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return av=t,null}function lF(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OG()){case GT:return 1;case ZO:return 4;case rv:case FG:return 16;case eF:return 536870912;default:return 16}default:return 16}}var Ea=null,XT=null,Rx=null;function cF(){if(Rx)return Rx;var t,e=XT,n=e.length,s,r="value"in Ea?Ea.value:Ea.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return Rx=r.slice(t,1<s?1-s:void 0)}function Dx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Wy(){return!0}function U$(){return!1}function Ar(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Wy:U$,this.isPropagationStopped=U$,this}return Jt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wy)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wy)},persist:function(){},isPersistent:Wy}),e}var Pd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},YT=Ar(Pd),gm=Jt({},Pd,{view:0,detail:0}),XG=Ar(gm),J1,Z1,wp,$0=Jt({},gm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:QT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wp&&(wp&&t.type==="mousemove"?(J1=t.screenX-wp.screenX,Z1=t.screenY-wp.screenY):Z1=J1=0,wp=t),J1)},movementY:function(t){return"movementY"in t?t.movementY:Z1}}),W$=Ar($0),YG=Jt({},$0,{dataTransfer:0}),QG=Ar(YG),JG=Jt({},gm,{relatedTarget:0}),eI=Ar(JG),ZG=Jt({},Pd,{animationName:0,elapsedTime:0,pseudoElement:0}),e9=Ar(ZG),t9=Jt({},Pd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),n9=Ar(t9),s9=Jt({},Pd,{data:0}),G$=Ar(s9),r9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function a9(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=o9[t])?!!e[t]:!1}function QT(){return a9}var l9=Jt({},gm,{key:function(t){if(t.key){var e=r9[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?i9[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:QT,charCode:function(t){return t.type==="keypress"?Dx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),c9=Ar(l9),u9=Jt({},$0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H$=Ar(u9),d9=Jt({},gm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:QT}),h9=Ar(d9),p9=Jt({},Pd,{propertyName:0,elapsedTime:0,pseudoElement:0}),f9=Ar(p9),m9=Jt({},$0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),g9=Ar(m9),y9=[9,13,27,32],JT=Fo&&"CompositionEvent"in window,nf=null;Fo&&"documentMode"in document&&(nf=document.documentMode);var x9=Fo&&"TextEvent"in window&&!nf,uF=Fo&&(!JT||nf&&8<nf&&11>=nf),q$=" ",K$=!1;function dF(t,e){switch(t){case"keyup":return y9.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hF(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Cu=!1;function v9(t,e){switch(t){case"compositionend":return hF(e);case"keypress":return e.which!==32?null:(K$=!0,q$);case"textInput":return t=e.data,t===q$&&K$?null:t;default:return null}}function b9(t,e){if(Cu)return t==="compositionend"||!JT&&dF(t,e)?(t=cF(),Rx=XT=Ea=null,Cu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uF&&e.locale!=="ko"?null:e.data;default:return null}}var w9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X$(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!w9[t.type]:e==="textarea"}function pF(t,e,n,s){WO(s),e=lv(e,"onChange"),0<e.length&&(n=new YT("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var sf=null,Sf=null;function I9(t){SF(t,0)}function A0(t){var e=Ru(t);if(LO(e))return t}function k9(t,e){if(t==="change")return e}var fF=!1;if(Fo){var tI;if(Fo){var nI="oninput"in document;if(!nI){var Y$=document.createElement("div");Y$.setAttribute("oninput","return;"),nI=typeof Y$.oninput=="function"}tI=nI}else tI=!1;fF=tI&&(!document.documentMode||9<document.documentMode)}function Q$(){sf&&(sf.detachEvent("onpropertychange",mF),Sf=sf=null)}function mF(t){if(t.propertyName==="value"&&A0(Sf)){var e=[];pF(e,Sf,t,WT(t)),KO(I9,e)}}function S9(t,e,n){t==="focusin"?(Q$(),sf=e,Sf=n,sf.attachEvent("onpropertychange",mF)):t==="focusout"&&Q$()}function T9(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return A0(Sf)}function N9(t,e){if(t==="click")return A0(e)}function _9(t,e){if(t==="input"||t==="change")return A0(e)}function E9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ii=typeof Object.is=="function"?Object.is:E9;function Tf(t,e){if(Ii(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!rk.call(e,r)||!Ii(t[r],e[r]))return!1}return!0}function J$(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Z$(t,e){var n=J$(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=J$(n)}}function gF(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?gF(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function yF(){for(var t=window,e=tv();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=tv(t.document)}return e}function ZT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function C9(t){var e=yF(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&gF(n.ownerDocument.documentElement,n)){if(s!==null&&ZT(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=Z$(n,i);var o=Z$(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var $9=Fo&&"documentMode"in document&&11>=document.documentMode,$u=null,kk=null,rf=null,Sk=!1;function eA(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Sk||$u==null||$u!==tv(s)||(s=$u,"selectionStart"in s&&ZT(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),rf&&Tf(rf,s)||(rf=s,s=lv(kk,"onSelect"),0<s.length&&(e=new YT("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=$u)))}function Gy(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Au={animationend:Gy("Animation","AnimationEnd"),animationiteration:Gy("Animation","AnimationIteration"),animationstart:Gy("Animation","AnimationStart"),transitionend:Gy("Transition","TransitionEnd")},sI={},xF={};Fo&&(xF=document.createElement("div").style,"AnimationEvent"in window||(delete Au.animationend.animation,delete Au.animationiteration.animation,delete Au.animationstart.animation),"TransitionEvent"in window||delete Au.transitionend.transition);function R0(t){if(sI[t])return sI[t];if(!Au[t])return t;var e=Au[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in xF)return sI[t]=e[n];return t}var vF=R0("animationend"),bF=R0("animationiteration"),wF=R0("animationstart"),IF=R0("transitionend"),kF=new Map,tA="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gl(t,e){kF.set(t,e),Hc(e,[t])}for(var rI=0;rI<tA.length;rI++){var iI=tA[rI],A9=iI.toLowerCase(),R9=iI[0].toUpperCase()+iI.slice(1);gl(A9,"on"+R9)}gl(vF,"onAnimationEnd");gl(bF,"onAnimationIteration");gl(wF,"onAnimationStart");gl("dblclick","onDoubleClick");gl("focusin","onFocus");gl("focusout","onBlur");gl(IF,"onTransitionEnd");sd("onMouseEnter",["mouseout","mouseover"]);sd("onMouseLeave",["mouseout","mouseover"]);sd("onPointerEnter",["pointerout","pointerover"]);sd("onPointerLeave",["pointerout","pointerover"]);Hc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D9=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vp));function nA(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,AG(s,e,void 0,t),t.currentTarget=null}function SF(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&r.isPropagationStopped())break e;nA(r,a,c),i=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&r.isPropagationStopped())break e;nA(r,a,c),i=l}}}if(sv)throw t=vk,sv=!1,vk=null,t}function Lt(t,e){var n=e[Ck];n===void 0&&(n=e[Ck]=new Set);var s=t+"__bubble";n.has(s)||(TF(e,t,2,!1),n.add(s))}function oI(t,e,n){var s=0;e&&(s|=4),TF(n,t,s,e)}var Hy="_reactListening"+Math.random().toString(36).slice(2);function Nf(t){if(!t[Hy]){t[Hy]=!0,RO.forEach(function(n){n!=="selectionchange"&&(D9.has(n)||oI(n,!1,t),oI(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hy]||(e[Hy]=!0,oI("selectionchange",!1,e))}}function TF(t,e,n,s){switch(lF(e)){case 1:var r=qG;break;case 4:r=KG;break;default:r=KT}n=r.bind(null,e,n,t),r=void 0,!xk||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function aI(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Jl(a),o===null)return;if(l=o.tag,l===5||l===6){s=i=o;continue e}a=a.parentNode}}s=s.return}KO(function(){var c=i,u=WT(n),d=[];e:{var h=kF.get(t);if(h!==void 0){var p=YT,f=t;switch(t){case"keypress":if(Dx(n)===0)break e;case"keydown":case"keyup":p=c9;break;case"focusin":f="focus",p=eI;break;case"focusout":f="blur",p=eI;break;case"beforeblur":case"afterblur":p=eI;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=W$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=QG;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=h9;break;case vF:case bF:case wF:p=e9;break;case IF:p=f9;break;case"scroll":p=XG;break;case"wheel":p=g9;break;case"copy":case"cut":case"paste":p=n9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=H$}var g=(e&4)!==0,y=!g&&t==="scroll",x=g?h!==null?h+"Capture":null:h;g=[];for(var v=c,w;v!==null;){w=v;var I=w.stateNode;if(w.tag===5&&I!==null&&(w=I,x!==null&&(I=bf(v,x),I!=null&&g.push(_f(v,I,w)))),y)break;v=v.return}0<g.length&&(h=new p(h,f,null,n,u),d.push({event:h,listeners:g}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==gk&&(f=n.relatedTarget||n.fromElement)&&(Jl(f)||f[Lo]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(f=n.relatedTarget||n.toElement,p=c,f=f?Jl(f):null,f!==null&&(y=qc(f),f!==y||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=c),p!==f)){if(g=W$,I="onMouseLeave",x="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=H$,I="onPointerLeave",x="onPointerEnter",v="pointer"),y=p==null?h:Ru(p),w=f==null?h:Ru(f),h=new g(I,v+"leave",p,n,u),h.target=y,h.relatedTarget=w,I=null,Jl(u)===c&&(g=new g(x,v+"enter",f,n,u),g.target=w,g.relatedTarget=y,I=g),y=I,p&&f)t:{for(g=p,x=f,v=0,w=g;w;w=xu(w))v++;for(w=0,I=x;I;I=xu(I))w++;for(;0<v-w;)g=xu(g),v--;for(;0<w-v;)x=xu(x),w--;for(;v--;){if(g===x||x!==null&&g===x.alternate)break t;g=xu(g),x=xu(x)}g=null}else g=null;p!==null&&sA(d,h,p,g,!1),f!==null&&y!==null&&sA(d,y,f,g,!0)}}e:{if(h=c?Ru(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var N=k9;else if(X$(h))if(fF)N=_9;else{N=T9;var A=S9}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=N9);if(N&&(N=N(t,c))){pF(d,N,n,u);break e}A&&A(t,h,c),t==="focusout"&&(A=h._wrapperState)&&A.controlled&&h.type==="number"&&dk(h,"number",h.value)}switch(A=c?Ru(c):window,t){case"focusin":(X$(A)||A.contentEditable==="true")&&($u=A,kk=c,rf=null);break;case"focusout":rf=kk=$u=null;break;case"mousedown":Sk=!0;break;case"contextmenu":case"mouseup":case"dragend":Sk=!1,eA(d,n,u);break;case"selectionchange":if($9)break;case"keydown":case"keyup":eA(d,n,u)}var T;if(JT)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Cu?dF(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(uF&&n.locale!=="ko"&&(Cu||S!=="onCompositionStart"?S==="onCompositionEnd"&&Cu&&(T=cF()):(Ea=u,XT="value"in Ea?Ea.value:Ea.textContent,Cu=!0)),A=lv(c,S),0<A.length&&(S=new G$(S,t,null,n,u),d.push({event:S,listeners:A}),T?S.data=T:(T=hF(n),T!==null&&(S.data=T)))),(T=x9?v9(t,n):b9(t,n))&&(c=lv(c,"onBeforeInput"),0<c.length&&(u=new G$("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=T))}SF(d,e)})}function _f(t,e,n){return{instance:t,listener:e,currentTarget:n}}function lv(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=bf(t,n),i!=null&&s.unshift(_f(t,i,r)),i=bf(t,e),i!=null&&s.push(_f(t,i,r))),t=t.return}return s}function xu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function sA(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=bf(n,i),l!=null&&o.unshift(_f(n,l,a))):r||(l=bf(n,i),l!=null&&o.push(_f(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var P9=/\r\n?/g,O9=/\u0000|\uFFFD/g;function rA(t){return(typeof t=="string"?t:""+t).replace(P9,`
`).replace(O9,"")}function qy(t,e,n){if(e=rA(e),rA(t)!==e&&n)throw Error(he(425))}function cv(){}var Tk=null,Nk=null;function _k(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ek=typeof setTimeout=="function"?setTimeout:void 0,F9=typeof clearTimeout=="function"?clearTimeout:void 0,iA=typeof Promise=="function"?Promise:void 0,L9=typeof queueMicrotask=="function"?queueMicrotask:typeof iA<"u"?function(t){return iA.resolve(null).then(t).catch(M9)}:Ek;function M9(t){setTimeout(function(){throw t})}function lI(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),kf(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);kf(e)}function Ma(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function oA(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Od=Math.random().toString(36).slice(2),Vi="__reactFiber$"+Od,Ef="__reactProps$"+Od,Lo="__reactContainer$"+Od,Ck="__reactEvents$"+Od,V9="__reactListeners$"+Od,z9="__reactHandles$"+Od;function Jl(t){var e=t[Vi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Lo]||n[Vi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=oA(t);t!==null;){if(n=t[Vi])return n;t=oA(t)}return e}t=n,n=t.parentNode}return null}function ym(t){return t=t[Vi]||t[Lo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ru(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(he(33))}function D0(t){return t[Ef]||null}var $k=[],Du=-1;function yl(t){return{current:t}}function Vt(t){0>Du||(t.current=$k[Du],$k[Du]=null,Du--)}function Dt(t,e){Du++,$k[Du]=t.current,t.current=e}var Qa={},Ts=yl(Qa),nr=yl(!1),xc=Qa;function rd(t,e){var n=t.type.contextTypes;if(!n)return Qa;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function sr(t){return t=t.childContextTypes,t!=null}function uv(){Vt(nr),Vt(Ts)}function aA(t,e,n){if(Ts.current!==Qa)throw Error(he(168));Dt(Ts,e),Dt(nr,n)}function NF(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(he(108,SG(t)||"Unknown",r));return Jt({},n,s)}function dv(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Qa,xc=Ts.current,Dt(Ts,t),Dt(nr,nr.current),!0}function lA(t,e,n){var s=t.stateNode;if(!s)throw Error(he(169));n?(t=NF(t,e,xc),s.__reactInternalMemoizedMergedChildContext=t,Vt(nr),Vt(Ts),Dt(Ts,t)):Vt(nr),Dt(nr,n)}var bo=null,P0=!1,cI=!1;function _F(t){bo===null?bo=[t]:bo.push(t)}function j9(t){P0=!0,_F(t)}function xl(){if(!cI&&bo!==null){cI=!0;var t=0,e=It;try{var n=bo;for(It=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}bo=null,P0=!1}catch(r){throw bo!==null&&(bo=bo.slice(t+1)),JO(GT,xl),r}finally{It=e,cI=!1}}return null}var Pu=[],Ou=0,hv=null,pv=0,Lr=[],Mr=0,vc=null,_o=1,Eo="";function zl(t,e){Pu[Ou++]=pv,Pu[Ou++]=hv,hv=t,pv=e}function EF(t,e,n){Lr[Mr++]=_o,Lr[Mr++]=Eo,Lr[Mr++]=vc,vc=t;var s=_o;t=Eo;var r=32-mi(s)-1;s&=~(1<<r),n+=1;var i=32-mi(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,_o=1<<32-mi(e)+r|n<<r|s,Eo=i+t}else _o=1<<i|n<<r|s,Eo=t}function eN(t){t.return!==null&&(zl(t,1),EF(t,1,0))}function tN(t){for(;t===hv;)hv=Pu[--Ou],Pu[Ou]=null,pv=Pu[--Ou],Pu[Ou]=null;for(;t===vc;)vc=Lr[--Mr],Lr[Mr]=null,Eo=Lr[--Mr],Lr[Mr]=null,_o=Lr[--Mr],Lr[Mr]=null}var Sr=null,vr=null,Ut=!1,hi=null;function CF(t,e){var n=Vr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function cA(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Sr=t,vr=Ma(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Sr=t,vr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vc!==null?{id:_o,overflow:Eo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Sr=t,vr=null,!0):!1;default:return!1}}function Ak(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rk(t){if(Ut){var e=vr;if(e){var n=e;if(!cA(t,e)){if(Ak(t))throw Error(he(418));e=Ma(n.nextSibling);var s=Sr;e&&cA(t,e)?CF(s,n):(t.flags=t.flags&-4097|2,Ut=!1,Sr=t)}}else{if(Ak(t))throw Error(he(418));t.flags=t.flags&-4097|2,Ut=!1,Sr=t}}}function uA(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Sr=t}function Ky(t){if(t!==Sr)return!1;if(!Ut)return uA(t),Ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_k(t.type,t.memoizedProps)),e&&(e=vr)){if(Ak(t))throw $F(),Error(he(418));for(;e;)CF(t,e),e=Ma(e.nextSibling)}if(uA(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(he(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){vr=Ma(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}vr=null}}else vr=Sr?Ma(t.stateNode.nextSibling):null;return!0}function $F(){for(var t=vr;t;)t=Ma(t.nextSibling)}function id(){vr=Sr=null,Ut=!1}function nN(t){hi===null?hi=[t]:hi.push(t)}var B9=Qo.ReactCurrentBatchConfig;function Ip(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(he(309));var s=n.stateNode}if(!s)throw Error(he(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=r.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(he(284));if(!n._owner)throw Error(he(290,t))}return t}function Xy(t,e){throw t=Object.prototype.toString.call(e),Error(he(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function dA(t){var e=t._init;return e(t._payload)}function AF(t){function e(x,v){if(t){var w=x.deletions;w===null?(x.deletions=[v],x.flags|=16):w.push(v)}}function n(x,v){if(!t)return null;for(;v!==null;)e(x,v),v=v.sibling;return null}function s(x,v){for(x=new Map;v!==null;)v.key!==null?x.set(v.key,v):x.set(v.index,v),v=v.sibling;return x}function r(x,v){return x=Ba(x,v),x.index=0,x.sibling=null,x}function i(x,v,w){return x.index=w,t?(w=x.alternate,w!==null?(w=w.index,w<v?(x.flags|=2,v):w):(x.flags|=2,v)):(x.flags|=1048576,v)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,v,w,I){return v===null||v.tag!==6?(v=gI(w,x.mode,I),v.return=x,v):(v=r(v,w),v.return=x,v)}function l(x,v,w,I){var N=w.type;return N===Eu?u(x,v,w.props.children,I,w.key):v!==null&&(v.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===xa&&dA(N)===v.type)?(I=r(v,w.props),I.ref=Ip(x,v,w),I.return=x,I):(I=zx(w.type,w.key,w.props,null,x.mode,I),I.ref=Ip(x,v,w),I.return=x,I)}function c(x,v,w,I){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=yI(w,x.mode,I),v.return=x,v):(v=r(v,w.children||[]),v.return=x,v)}function u(x,v,w,I,N){return v===null||v.tag!==7?(v=cc(w,x.mode,I,N),v.return=x,v):(v=r(v,w),v.return=x,v)}function d(x,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=gI(""+v,x.mode,w),v.return=x,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case My:return w=zx(v.type,v.key,v.props,null,x.mode,w),w.ref=Ip(x,null,v),w.return=x,w;case _u:return v=yI(v,x.mode,w),v.return=x,v;case xa:var I=v._init;return d(x,I(v._payload),w)}if(Lp(v)||yp(v))return v=cc(v,x.mode,w,null),v.return=x,v;Xy(x,v)}return null}function h(x,v,w,I){var N=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return N!==null?null:a(x,v,""+w,I);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case My:return w.key===N?l(x,v,w,I):null;case _u:return w.key===N?c(x,v,w,I):null;case xa:return N=w._init,h(x,v,N(w._payload),I)}if(Lp(w)||yp(w))return N!==null?null:u(x,v,w,I,null);Xy(x,w)}return null}function p(x,v,w,I,N){if(typeof I=="string"&&I!==""||typeof I=="number")return x=x.get(w)||null,a(v,x,""+I,N);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case My:return x=x.get(I.key===null?w:I.key)||null,l(v,x,I,N);case _u:return x=x.get(I.key===null?w:I.key)||null,c(v,x,I,N);case xa:var A=I._init;return p(x,v,w,A(I._payload),N)}if(Lp(I)||yp(I))return x=x.get(w)||null,u(v,x,I,N,null);Xy(v,I)}return null}function f(x,v,w,I){for(var N=null,A=null,T=v,S=v=0,E=null;T!==null&&S<w.length;S++){T.index>S?(E=T,T=null):E=T.sibling;var $=h(x,T,w[S],I);if($===null){T===null&&(T=E);break}t&&T&&$.alternate===null&&e(x,T),v=i($,v,S),A===null?N=$:A.sibling=$,A=$,T=E}if(S===w.length)return n(x,T),Ut&&zl(x,S),N;if(T===null){for(;S<w.length;S++)T=d(x,w[S],I),T!==null&&(v=i(T,v,S),A===null?N=T:A.sibling=T,A=T);return Ut&&zl(x,S),N}for(T=s(x,T);S<w.length;S++)E=p(T,x,S,w[S],I),E!==null&&(t&&E.alternate!==null&&T.delete(E.key===null?S:E.key),v=i(E,v,S),A===null?N=E:A.sibling=E,A=E);return t&&T.forEach(function(P){return e(x,P)}),Ut&&zl(x,S),N}function g(x,v,w,I){var N=yp(w);if(typeof N!="function")throw Error(he(150));if(w=N.call(w),w==null)throw Error(he(151));for(var A=N=null,T=v,S=v=0,E=null,$=w.next();T!==null&&!$.done;S++,$=w.next()){T.index>S?(E=T,T=null):E=T.sibling;var P=h(x,T,$.value,I);if(P===null){T===null&&(T=E);break}t&&T&&P.alternate===null&&e(x,T),v=i(P,v,S),A===null?N=P:A.sibling=P,A=P,T=E}if($.done)return n(x,T),Ut&&zl(x,S),N;if(T===null){for(;!$.done;S++,$=w.next())$=d(x,$.value,I),$!==null&&(v=i($,v,S),A===null?N=$:A.sibling=$,A=$);return Ut&&zl(x,S),N}for(T=s(x,T);!$.done;S++,$=w.next())$=p(T,x,S,$.value,I),$!==null&&(t&&$.alternate!==null&&T.delete($.key===null?S:$.key),v=i($,v,S),A===null?N=$:A.sibling=$,A=$);return t&&T.forEach(function(F){return e(x,F)}),Ut&&zl(x,S),N}function y(x,v,w,I){if(typeof w=="object"&&w!==null&&w.type===Eu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case My:e:{for(var N=w.key,A=v;A!==null;){if(A.key===N){if(N=w.type,N===Eu){if(A.tag===7){n(x,A.sibling),v=r(A,w.props.children),v.return=x,x=v;break e}}else if(A.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===xa&&dA(N)===A.type){n(x,A.sibling),v=r(A,w.props),v.ref=Ip(x,A,w),v.return=x,x=v;break e}n(x,A);break}else e(x,A);A=A.sibling}w.type===Eu?(v=cc(w.props.children,x.mode,I,w.key),v.return=x,x=v):(I=zx(w.type,w.key,w.props,null,x.mode,I),I.ref=Ip(x,v,w),I.return=x,x=I)}return o(x);case _u:e:{for(A=w.key;v!==null;){if(v.key===A)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(x,v.sibling),v=r(v,w.children||[]),v.return=x,x=v;break e}else{n(x,v);break}else e(x,v);v=v.sibling}v=yI(w,x.mode,I),v.return=x,x=v}return o(x);case xa:return A=w._init,y(x,v,A(w._payload),I)}if(Lp(w))return f(x,v,w,I);if(yp(w))return g(x,v,w,I);Xy(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(x,v.sibling),v=r(v,w),v.return=x,x=v):(n(x,v),v=gI(w,x.mode,I),v.return=x,x=v),o(x)):n(x,v)}return y}var od=AF(!0),RF=AF(!1),fv=yl(null),mv=null,Fu=null,sN=null;function rN(){sN=Fu=mv=null}function iN(t){var e=fv.current;Vt(fv),t._currentValue=e}function Dk(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Wu(t,e){mv=t,sN=Fu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(er=!0),t.firstContext=null)}function Xr(t){var e=t._currentValue;if(sN!==t)if(t={context:t,memoizedValue:e,next:null},Fu===null){if(mv===null)throw Error(he(308));Fu=t,mv.dependencies={lanes:0,firstContext:t}}else Fu=Fu.next=t;return e}var Zl=null;function oN(t){Zl===null?Zl=[t]:Zl.push(t)}function DF(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,oN(e)):(n.next=r.next,r.next=n),e.interleaved=n,Mo(t,s)}function Mo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var va=!1;function aN(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function PF(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ro(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Va(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,pt&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,Mo(t,n)}return r=s.interleaved,r===null?(e.next=e,oN(s)):(e.next=r.next,r.next=e),s.interleaved=e,Mo(t,n)}function Px(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,HT(t,n)}}function hA(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function gv(t,e,n,s){var r=t.updateQueue;va=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=r.baseState;o=0,u=c=l=null,a=i;do{var h=a.lane,p=a.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=t,g=a;switch(h=e,p=n,g.tag){case 1:if(f=g.payload,typeof f=="function"){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=g.payload,h=typeof f=="function"?f.call(p,d,h):f,h==null)break e;d=Jt({},d,h);break e;case 2:va=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);wc|=o,t.lanes=o,t.memoizedState=d}}function pA(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(he(191,r));r.call(s)}}}var xm={},Wi=yl(xm),Cf=yl(xm),$f=yl(xm);function ec(t){if(t===xm)throw Error(he(174));return t}function lN(t,e){switch(Dt($f,e),Dt(Cf,t),Dt(Wi,xm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pk(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pk(e,t)}Vt(Wi),Dt(Wi,e)}function ad(){Vt(Wi),Vt(Cf),Vt($f)}function OF(t){ec($f.current);var e=ec(Wi.current),n=pk(e,t.type);e!==n&&(Dt(Cf,t),Dt(Wi,n))}function cN(t){Cf.current===t&&(Vt(Wi),Vt(Cf))}var Xt=yl(0);function yv(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var uI=[];function uN(){for(var t=0;t<uI.length;t++)uI[t]._workInProgressVersionPrimary=null;uI.length=0}var Ox=Qo.ReactCurrentDispatcher,dI=Qo.ReactCurrentBatchConfig,bc=0,Qt=null,_n=null,Vn=null,xv=!1,of=!1,Af=0,U9=0;function ps(){throw Error(he(321))}function dN(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ii(t[n],e[n]))return!1;return!0}function hN(t,e,n,s,r,i){if(bc=i,Qt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ox.current=t===null||t.memoizedState===null?q9:K9,t=n(s,r),of){i=0;do{if(of=!1,Af=0,25<=i)throw Error(he(301));i+=1,Vn=_n=null,e.updateQueue=null,Ox.current=X9,t=n(s,r)}while(of)}if(Ox.current=vv,e=_n!==null&&_n.next!==null,bc=0,Vn=_n=Qt=null,xv=!1,e)throw Error(he(300));return t}function pN(){var t=Af!==0;return Af=0,t}function Oi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?Qt.memoizedState=Vn=t:Vn=Vn.next=t,Vn}function Yr(){if(_n===null){var t=Qt.alternate;t=t!==null?t.memoizedState:null}else t=_n.next;var e=Vn===null?Qt.memoizedState:Vn.next;if(e!==null)Vn=e,_n=t;else{if(t===null)throw Error(he(310));_n=t,t={memoizedState:_n.memoizedState,baseState:_n.baseState,baseQueue:_n.baseQueue,queue:_n.queue,next:null},Vn===null?Qt.memoizedState=Vn=t:Vn=Vn.next=t}return Vn}function Rf(t,e){return typeof e=="function"?e(t):e}function hI(t){var e=Yr(),n=e.queue;if(n===null)throw Error(he(311));n.lastRenderedReducer=t;var s=_n,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((bc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=s):l=l.next=d,Qt.lanes|=u,wc|=u}c=c.next}while(c!==null&&c!==i);l===null?o=s:l.next=a,Ii(s,e.memoizedState)||(er=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Qt.lanes|=i,wc|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function pI(t){var e=Yr(),n=e.queue;if(n===null)throw Error(he(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);Ii(i,e.memoizedState)||(er=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function FF(){}function LF(t,e){var n=Qt,s=Yr(),r=e(),i=!Ii(s.memoizedState,r);if(i&&(s.memoizedState=r,er=!0),s=s.queue,fN(zF.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Vn!==null&&Vn.memoizedState.tag&1){if(n.flags|=2048,Df(9,VF.bind(null,n,s,r,e),void 0,null),Bn===null)throw Error(he(349));bc&30||MF(n,e,r)}return r}function MF(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Qt.updateQueue,e===null?(e={lastEffect:null,stores:null},Qt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function VF(t,e,n,s){e.value=n,e.getSnapshot=s,jF(e)&&BF(t)}function zF(t,e,n){return n(function(){jF(e)&&BF(t)})}function jF(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ii(t,n)}catch{return!0}}function BF(t){var e=Mo(t,1);e!==null&&gi(e,t,1,-1)}function fA(t){var e=Oi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rf,lastRenderedState:t},e.queue=t,t=t.dispatch=H9.bind(null,Qt,t),[e.memoizedState,t]}function Df(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Qt.updateQueue,e===null?(e={lastEffect:null,stores:null},Qt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function UF(){return Yr().memoizedState}function Fx(t,e,n,s){var r=Oi();Qt.flags|=t,r.memoizedState=Df(1|e,n,void 0,s===void 0?null:s)}function O0(t,e,n,s){var r=Yr();s=s===void 0?null:s;var i=void 0;if(_n!==null){var o=_n.memoizedState;if(i=o.destroy,s!==null&&dN(s,o.deps)){r.memoizedState=Df(e,n,i,s);return}}Qt.flags|=t,r.memoizedState=Df(1|e,n,i,s)}function mA(t,e){return Fx(8390656,8,t,e)}function fN(t,e){return O0(2048,8,t,e)}function WF(t,e){return O0(4,2,t,e)}function GF(t,e){return O0(4,4,t,e)}function HF(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function qF(t,e,n){return n=n!=null?n.concat([t]):null,O0(4,4,HF.bind(null,e,t),n)}function mN(){}function KF(t,e){var n=Yr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&dN(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function XF(t,e){var n=Yr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&dN(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function YF(t,e,n){return bc&21?(Ii(n,e)||(n=tF(),Qt.lanes|=n,wc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,er=!0),t.memoizedState=n)}function W9(t,e){var n=It;It=n!==0&&4>n?n:4,t(!0);var s=dI.transition;dI.transition={};try{t(!1),e()}finally{It=n,dI.transition=s}}function QF(){return Yr().memoizedState}function G9(t,e,n){var s=ja(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},JF(t))ZF(e,n);else if(n=DF(t,e,n,s),n!==null){var r=Fs();gi(n,t,s,r),eL(n,e,s)}}function H9(t,e,n){var s=ja(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(JF(t))ZF(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(r.hasEagerState=!0,r.eagerState=a,Ii(a,o)){var l=e.interleaved;l===null?(r.next=r,oN(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=DF(t,e,r,s),n!==null&&(r=Fs(),gi(n,t,s,r),eL(n,e,s))}}function JF(t){var e=t.alternate;return t===Qt||e!==null&&e===Qt}function ZF(t,e){of=xv=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function eL(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,HT(t,n)}}var vv={readContext:Xr,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},q9={readContext:Xr,useCallback:function(t,e){return Oi().memoizedState=[t,e===void 0?null:e],t},useContext:Xr,useEffect:mA,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Fx(4194308,4,HF.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Fx(4194308,4,t,e)},useInsertionEffect:function(t,e){return Fx(4,2,t,e)},useMemo:function(t,e){var n=Oi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Oi();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=G9.bind(null,Qt,t),[s.memoizedState,t]},useRef:function(t){var e=Oi();return t={current:t},e.memoizedState=t},useState:fA,useDebugValue:mN,useDeferredValue:function(t){return Oi().memoizedState=t},useTransition:function(){var t=fA(!1),e=t[0];return t=W9.bind(null,t[1]),Oi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Qt,r=Oi();if(Ut){if(n===void 0)throw Error(he(407));n=n()}else{if(n=e(),Bn===null)throw Error(he(349));bc&30||MF(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,mA(zF.bind(null,s,i,t),[t]),s.flags|=2048,Df(9,VF.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=Oi(),e=Bn.identifierPrefix;if(Ut){var n=Eo,s=_o;n=(s&~(1<<32-mi(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Af++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=U9++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},K9={readContext:Xr,useCallback:KF,useContext:Xr,useEffect:fN,useImperativeHandle:qF,useInsertionEffect:WF,useLayoutEffect:GF,useMemo:XF,useReducer:hI,useRef:UF,useState:function(){return hI(Rf)},useDebugValue:mN,useDeferredValue:function(t){var e=Yr();return YF(e,_n.memoizedState,t)},useTransition:function(){var t=hI(Rf)[0],e=Yr().memoizedState;return[t,e]},useMutableSource:FF,useSyncExternalStore:LF,useId:QF,unstable_isNewReconciler:!1},X9={readContext:Xr,useCallback:KF,useContext:Xr,useEffect:fN,useImperativeHandle:qF,useInsertionEffect:WF,useLayoutEffect:GF,useMemo:XF,useReducer:pI,useRef:UF,useState:function(){return pI(Rf)},useDebugValue:mN,useDeferredValue:function(t){var e=Yr();return _n===null?e.memoizedState=t:YF(e,_n.memoizedState,t)},useTransition:function(){var t=pI(Rf)[0],e=Yr().memoizedState;return[t,e]},useMutableSource:FF,useSyncExternalStore:LF,useId:QF,unstable_isNewReconciler:!1};function li(t,e){if(t&&t.defaultProps){e=Jt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pk(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Jt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var F0={isMounted:function(t){return(t=t._reactInternals)?qc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Fs(),r=ja(t),i=Ro(s,r);i.payload=e,n!=null&&(i.callback=n),e=Va(t,i,r),e!==null&&(gi(e,t,r,s),Px(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Fs(),r=ja(t),i=Ro(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Va(t,i,r),e!==null&&(gi(e,t,r,s),Px(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Fs(),s=ja(t),r=Ro(n,s);r.tag=2,e!=null&&(r.callback=e),e=Va(t,r,s),e!==null&&(gi(e,t,s,n),Px(e,t,s))}};function gA(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Tf(n,s)||!Tf(r,i):!0}function tL(t,e,n){var s=!1,r=Qa,i=e.contextType;return typeof i=="object"&&i!==null?i=Xr(i):(r=sr(e)?xc:Ts.current,s=e.contextTypes,i=(s=s!=null)?rd(t,r):Qa),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=F0,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function yA(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&F0.enqueueReplaceState(e,e.state,null)}function Ok(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},aN(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Xr(i):(i=sr(e)?xc:Ts.current,r.context=rd(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Pk(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&F0.enqueueReplaceState(r,r.state,null),gv(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function ld(t,e){try{var n="",s=e;do n+=kG(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function fI(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Fk(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Y9=typeof WeakMap=="function"?WeakMap:Map;function nL(t,e,n){n=Ro(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){wv||(wv=!0,Hk=s),Fk(t,e)},n}function sL(t,e,n){n=Ro(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){Fk(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Fk(t,e),typeof s!="function"&&(za===null?za=new Set([this]):za.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function xA(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new Y9;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=uH.bind(null,t,e,n),e.then(t,t))}function vA(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bA(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ro(-1,1),e.tag=2,Va(n,e,1))),n.lanes|=1),t)}var Q9=Qo.ReactCurrentOwner,er=!1;function Ds(t,e,n,s){e.child=t===null?RF(e,null,n,s):od(e,t.child,n,s)}function wA(t,e,n,s,r){n=n.render;var i=e.ref;return Wu(e,r),s=hN(t,e,n,s,i,r),n=pN(),t!==null&&!er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Vo(t,e,r)):(Ut&&n&&eN(e),e.flags|=1,Ds(t,e,s,r),e.child)}function IA(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!kN(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,rL(t,e,i,s,r)):(t=zx(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Tf,n(o,s)&&t.ref===e.ref)return Vo(t,e,r)}return e.flags|=1,t=Ba(i,s),t.ref=e.ref,t.return=e,e.child=t}function rL(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Tf(i,s)&&t.ref===e.ref)if(er=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(er=!0);else return e.lanes=t.lanes,Vo(t,e,r)}return Lk(t,e,n,s,r)}function iL(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dt(Mu,gr),gr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Dt(Mu,gr),gr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,Dt(Mu,gr),gr|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,Dt(Mu,gr),gr|=s;return Ds(t,e,r,n),e.child}function oL(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Lk(t,e,n,s,r){var i=sr(n)?xc:Ts.current;return i=rd(e,i),Wu(e,r),n=hN(t,e,n,s,i,r),s=pN(),t!==null&&!er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Vo(t,e,r)):(Ut&&s&&eN(e),e.flags|=1,Ds(t,e,n,r),e.child)}function kA(t,e,n,s,r){if(sr(n)){var i=!0;dv(e)}else i=!1;if(Wu(e,r),e.stateNode===null)Lx(t,e),tL(e,n,s),Ok(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Xr(c):(c=sr(n)?xc:Ts.current,c=rd(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==c)&&yA(e,o,s,c),va=!1;var h=e.memoizedState;o.state=h,gv(e,s,o,r),l=e.memoizedState,a!==s||h!==l||nr.current||va?(typeof u=="function"&&(Pk(e,n,u,s),l=e.memoizedState),(a=va||gA(e,n,a,s,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=c,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,PF(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:li(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Xr(l):(l=sr(n)?xc:Ts.current,l=rd(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&yA(e,o,s,l),va=!1,h=e.memoizedState,o.state=h,gv(e,s,o,r);var f=e.memoizedState;a!==d||h!==f||nr.current||va?(typeof p=="function"&&(Pk(e,n,p,s),f=e.memoizedState),(c=va||gA(e,n,c,s,h,f,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,f,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,f,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=f),o.props=s,o.state=f,o.context=l,s=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return Mk(t,e,n,s,i,r)}function Mk(t,e,n,s,r,i){oL(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&lA(e,n,!1),Vo(t,e,i);s=e.stateNode,Q9.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=od(e,t.child,null,i),e.child=od(e,null,a,i)):Ds(t,e,a,i),e.memoizedState=s.state,r&&lA(e,n,!0),e.child}function aL(t){var e=t.stateNode;e.pendingContext?aA(t,e.pendingContext,e.pendingContext!==e.context):e.context&&aA(t,e.context,!1),lN(t,e.containerInfo)}function SA(t,e,n,s,r){return id(),nN(r),e.flags|=256,Ds(t,e,n,s),e.child}var Vk={dehydrated:null,treeContext:null,retryLane:0};function zk(t){return{baseLanes:t,cachePool:null,transitions:null}}function lL(t,e,n){var s=e.pendingProps,r=Xt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Dt(Xt,r&1),t===null)return Rk(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=V0(o,s,0,null),t=cc(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=zk(n),e.memoizedState=Vk,t):gN(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return J9(t,e,o,s,a,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=Ba(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?i=Ba(a,i):(i=cc(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?zk(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Vk,s}return i=t.child,t=i.sibling,s=Ba(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function gN(t,e){return e=V0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yy(t,e,n,s){return s!==null&&nN(s),od(e,t.child,null,n),t=gN(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function J9(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=fI(Error(he(422))),Yy(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=V0({mode:"visible",children:s.children},r,0,null),i=cc(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&od(e,t.child,null,o),e.child.memoizedState=zk(o),e.memoizedState=Vk,i);if(!(e.mode&1))return Yy(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,i=Error(he(419)),s=fI(i,s,void 0),Yy(t,e,o,s)}if(a=(o&t.childLanes)!==0,er||a){if(s=Bn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,Mo(t,r),gi(s,t,r,-1))}return IN(),s=fI(Error(he(421))),Yy(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=dH.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,vr=Ma(r.nextSibling),Sr=e,Ut=!0,hi=null,t!==null&&(Lr[Mr++]=_o,Lr[Mr++]=Eo,Lr[Mr++]=vc,_o=t.id,Eo=t.overflow,vc=e),e=gN(e,s.children),e.flags|=4096,e)}function TA(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Dk(t.return,e,n)}function mI(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function cL(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(Ds(t,e,s.children,n),s=Xt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&TA(t,n,e);else if(t.tag===19)TA(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Dt(Xt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&yv(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),mI(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&yv(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}mI(e,!0,n,null,i);break;case"together":mI(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Lx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Vo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),wc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(he(153));if(e.child!==null){for(t=e.child,n=Ba(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ba(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Z9(t,e,n){switch(e.tag){case 3:aL(e),id();break;case 5:OF(e);break;case 1:sr(e.type)&&dv(e);break;case 4:lN(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;Dt(fv,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Dt(Xt,Xt.current&1),e.flags|=128,null):n&e.child.childLanes?lL(t,e,n):(Dt(Xt,Xt.current&1),t=Vo(t,e,n),t!==null?t.sibling:null);Dt(Xt,Xt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return cL(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Dt(Xt,Xt.current),s)break;return null;case 22:case 23:return e.lanes=0,iL(t,e,n)}return Vo(t,e,n)}var uL,jk,dL,hL;uL=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jk=function(){};dL=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,ec(Wi.current);var i=null;switch(n){case"input":r=ck(t,r),s=ck(t,s),i=[];break;case"select":r=Jt({},r,{value:void 0}),s=Jt({},s,{value:void 0}),i=[];break;case"textarea":r=hk(t,r),s=hk(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=cv)}fk(n,s);var o;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xf.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Lt("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};hL=function(t,e,n,s){n!==s&&(e.flags|=4)};function kp(t,e){if(!Ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function fs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function eH(t,e,n){var s=e.pendingProps;switch(tN(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fs(e),null;case 1:return sr(e.type)&&uv(),fs(e),null;case 3:return s=e.stateNode,ad(),Vt(nr),Vt(Ts),uN(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Ky(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,hi!==null&&(Xk(hi),hi=null))),jk(t,e),fs(e),null;case 5:cN(e);var r=ec($f.current);if(n=e.type,t!==null&&e.stateNode!=null)dL(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(he(166));return fs(e),null}if(t=ec(Wi.current),Ky(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Vi]=e,s[Ef]=i,t=(e.mode&1)!==0,n){case"dialog":Lt("cancel",s),Lt("close",s);break;case"iframe":case"object":case"embed":Lt("load",s);break;case"video":case"audio":for(r=0;r<Vp.length;r++)Lt(Vp[r],s);break;case"source":Lt("error",s);break;case"img":case"image":case"link":Lt("error",s),Lt("load",s);break;case"details":Lt("toggle",s);break;case"input":P$(s,i),Lt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Lt("invalid",s);break;case"textarea":F$(s,i),Lt("invalid",s)}fk(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?s.textContent!==a&&(i.suppressHydrationWarning!==!0&&qy(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&qy(s.textContent,a,t),r=["children",""+a]):xf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Lt("scroll",s)}switch(n){case"input":Vy(s),O$(s,i,!0);break;case"textarea":Vy(s),L$(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=cv)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[Vi]=e,t[Ef]=s,uL(t,e,!1,!1),e.stateNode=t;e:{switch(o=mk(n,s),n){case"dialog":Lt("cancel",t),Lt("close",t),r=s;break;case"iframe":case"object":case"embed":Lt("load",t),r=s;break;case"video":case"audio":for(r=0;r<Vp.length;r++)Lt(Vp[r],t);r=s;break;case"source":Lt("error",t),r=s;break;case"img":case"image":case"link":Lt("error",t),Lt("load",t),r=s;break;case"details":Lt("toggle",t),r=s;break;case"input":P$(t,s),r=ck(t,s),Lt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Jt({},s,{value:void 0}),Lt("invalid",t);break;case"textarea":F$(t,s),r=hk(t,s),Lt("invalid",t);break;default:r=s}fk(n,r),a=r;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?UO(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&jO(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&vf(t,l):typeof l=="number"&&vf(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(xf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Lt("scroll",t):l!=null&&zT(t,i,l,o))}switch(n){case"input":Vy(t),O$(t,s,!1);break;case"textarea":Vy(t),L$(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Ya(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?zu(t,!!s.multiple,i,!1):s.defaultValue!=null&&zu(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=cv)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return fs(e),null;case 6:if(t&&e.stateNode!=null)hL(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(he(166));if(n=ec($f.current),ec(Wi.current),Ky(e)){if(s=e.stateNode,n=e.memoizedProps,s[Vi]=e,(i=s.nodeValue!==n)&&(t=Sr,t!==null))switch(t.tag){case 3:qy(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qy(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Vi]=e,e.stateNode=s}return fs(e),null;case 13:if(Vt(Xt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ut&&vr!==null&&e.mode&1&&!(e.flags&128))$F(),id(),e.flags|=98560,i=!1;else if(i=Ky(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(he(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(he(317));i[Vi]=e}else id(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;fs(e),i=!1}else hi!==null&&(Xk(hi),hi=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Xt.current&1?$n===0&&($n=3):IN())),e.updateQueue!==null&&(e.flags|=4),fs(e),null);case 4:return ad(),jk(t,e),t===null&&Nf(e.stateNode.containerInfo),fs(e),null;case 10:return iN(e.type._context),fs(e),null;case 17:return sr(e.type)&&uv(),fs(e),null;case 19:if(Vt(Xt),i=e.memoizedState,i===null)return fs(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)kp(i,!1);else{if($n!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=yv(t),o!==null){for(e.flags|=128,kp(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Dt(Xt,Xt.current&1|2),e.child}t=t.sibling}i.tail!==null&&fn()>cd&&(e.flags|=128,s=!0,kp(i,!1),e.lanes=4194304)}else{if(!s)if(t=yv(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),kp(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ut)return fs(e),null}else 2*fn()-i.renderingStartTime>cd&&n!==1073741824&&(e.flags|=128,s=!0,kp(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=fn(),e.sibling=null,n=Xt.current,Dt(Xt,s?n&1|2:n&1),e):(fs(e),null);case 22:case 23:return wN(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?gr&1073741824&&(fs(e),e.subtreeFlags&6&&(e.flags|=8192)):fs(e),null;case 24:return null;case 25:return null}throw Error(he(156,e.tag))}function tH(t,e){switch(tN(e),e.tag){case 1:return sr(e.type)&&uv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ad(),Vt(nr),Vt(Ts),uN(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return cN(e),null;case 13:if(Vt(Xt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(he(340));id()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Vt(Xt),null;case 4:return ad(),null;case 10:return iN(e.type._context),null;case 22:case 23:return wN(),null;case 24:return null;default:return null}}var Qy=!1,vs=!1,nH=typeof WeakSet=="function"?WeakSet:Set,ke=null;function Lu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){nn(t,e,s)}else n.current=null}function Bk(t,e,n){try{n()}catch(s){nn(t,e,s)}}var NA=!1;function sH(t,e){if(Tk=ov,t=yF(),ZT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var p;d!==n||r!==0&&d.nodeType!==3||(a=o+r),d!==i||s!==0&&d.nodeType!==3||(l=o+s),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===n&&++c===r&&(a=o),h===i&&++u===s&&(l=o),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nk={focusedElem:t,selectionRange:n},ov=!1,ke=e;ke!==null;)if(e=ke,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ke=t;else for(;ke!==null;){e=ke;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,y=f.memoizedState,x=e.stateNode,v=x.getSnapshotBeforeUpdate(e.elementType===e.type?g:li(e.type,g),y);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(I){nn(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,ke=t;break}ke=e.return}return f=NA,NA=!1,f}function af(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&Bk(e,n,i)}r=r.next}while(r!==s)}}function L0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Uk(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function pL(t){var e=t.alternate;e!==null&&(t.alternate=null,pL(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Vi],delete e[Ef],delete e[Ck],delete e[V9],delete e[z9])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function fL(t){return t.tag===5||t.tag===3||t.tag===4}function _A(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||fL(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Wk(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=cv));else if(s!==4&&(t=t.child,t!==null))for(Wk(t,e,n),t=t.sibling;t!==null;)Wk(t,e,n),t=t.sibling}function Gk(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Gk(t,e,n),t=t.sibling;t!==null;)Gk(t,e,n),t=t.sibling}var es=null,di=!1;function ma(t,e,n){for(n=n.child;n!==null;)mL(t,e,n),n=n.sibling}function mL(t,e,n){if(Ui&&typeof Ui.onCommitFiberUnmount=="function")try{Ui.onCommitFiberUnmount(C0,n)}catch{}switch(n.tag){case 5:vs||Lu(n,e);case 6:var s=es,r=di;es=null,ma(t,e,n),es=s,di=r,es!==null&&(di?(t=es,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):es.removeChild(n.stateNode));break;case 18:es!==null&&(di?(t=es,n=n.stateNode,t.nodeType===8?lI(t.parentNode,n):t.nodeType===1&&lI(t,n),kf(t)):lI(es,n.stateNode));break;case 4:s=es,r=di,es=n.stateNode.containerInfo,di=!0,ma(t,e,n),es=s,di=r;break;case 0:case 11:case 14:case 15:if(!vs&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Bk(n,e,o),r=r.next}while(r!==s)}ma(t,e,n);break;case 1:if(!vs&&(Lu(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){nn(n,e,a)}ma(t,e,n);break;case 21:ma(t,e,n);break;case 22:n.mode&1?(vs=(s=vs)||n.memoizedState!==null,ma(t,e,n),vs=s):ma(t,e,n);break;default:ma(t,e,n)}}function EA(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new nH),e.forEach(function(s){var r=hH.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function ii(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:es=a.stateNode,di=!1;break e;case 3:es=a.stateNode.containerInfo,di=!0;break e;case 4:es=a.stateNode.containerInfo,di=!0;break e}a=a.return}if(es===null)throw Error(he(160));mL(i,o,r),es=null,di=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){nn(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gL(e,t),e=e.sibling}function gL(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ii(e,t),Di(t),s&4){try{af(3,t,t.return),L0(3,t)}catch(g){nn(t,t.return,g)}try{af(5,t,t.return)}catch(g){nn(t,t.return,g)}}break;case 1:ii(e,t),Di(t),s&512&&n!==null&&Lu(n,n.return);break;case 5:if(ii(e,t),Di(t),s&512&&n!==null&&Lu(n,n.return),t.flags&32){var r=t.stateNode;try{vf(r,"")}catch(g){nn(t,t.return,g)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&MO(r,i),mk(a,o);var c=mk(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?UO(r,d):u==="dangerouslySetInnerHTML"?jO(r,d):u==="children"?vf(r,d):zT(r,u,d,c)}switch(a){case"input":uk(r,i);break;case"textarea":VO(r,i);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?zu(r,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?zu(r,!!i.multiple,i.defaultValue,!0):zu(r,!!i.multiple,i.multiple?[]:"",!1))}r[Ef]=i}catch(g){nn(t,t.return,g)}}break;case 6:if(ii(e,t),Di(t),s&4){if(t.stateNode===null)throw Error(he(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(g){nn(t,t.return,g)}}break;case 3:if(ii(e,t),Di(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{kf(e.containerInfo)}catch(g){nn(t,t.return,g)}break;case 4:ii(e,t),Di(t);break;case 13:ii(e,t),Di(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(vN=fn())),s&4&&EA(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(vs=(c=vs)||u,ii(e,t),vs=c):ii(e,t),Di(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(ke=t,u=t.child;u!==null;){for(d=ke=u;ke!==null;){switch(h=ke,p=h.child,h.tag){case 0:case 11:case 14:case 15:af(4,h,h.return);break;case 1:Lu(h,h.return);var f=h.stateNode;if(typeof f.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(g){nn(s,n,g)}}break;case 5:Lu(h,h.return);break;case 22:if(h.memoizedState!==null){$A(d);continue}}p!==null?(p.return=h,ke=p):$A(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=BO("display",o))}catch(g){nn(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){nn(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ii(e,t),Di(t),s&4&&EA(t);break;case 21:break;default:ii(e,t),Di(t)}}function Di(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(fL(n)){var s=n;break e}n=n.return}throw Error(he(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(vf(r,""),s.flags&=-33);var i=_A(t);Gk(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,a=_A(t);Wk(t,a,o);break;default:throw Error(he(161))}}catch(l){nn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function rH(t,e,n){ke=t,yL(t)}function yL(t,e,n){for(var s=(t.mode&1)!==0;ke!==null;){var r=ke,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||Qy;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||vs;a=Qy;var c=vs;if(Qy=o,(vs=l)&&!c)for(ke=r;ke!==null;)o=ke,l=o.child,o.tag===22&&o.memoizedState!==null?AA(r):l!==null?(l.return=o,ke=l):AA(r);for(;i!==null;)ke=i,yL(i),i=i.sibling;ke=r,Qy=a,vs=c}CA(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,ke=i):CA(t)}}function CA(t){for(;ke!==null;){var e=ke;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vs||L0(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!vs)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:li(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&pA(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}pA(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&kf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}vs||e.flags&512&&Uk(e)}catch(h){nn(e,e.return,h)}}if(e===t){ke=null;break}if(n=e.sibling,n!==null){n.return=e.return,ke=n;break}ke=e.return}}function $A(t){for(;ke!==null;){var e=ke;if(e===t){ke=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ke=n;break}ke=e.return}}function AA(t){for(;ke!==null;){var e=ke;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{L0(4,e)}catch(l){nn(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){nn(e,r,l)}}var i=e.return;try{Uk(e)}catch(l){nn(e,i,l)}break;case 5:var o=e.return;try{Uk(e)}catch(l){nn(e,o,l)}}}catch(l){nn(e,e.return,l)}if(e===t){ke=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ke=a;break}ke=e.return}}var iH=Math.ceil,bv=Qo.ReactCurrentDispatcher,yN=Qo.ReactCurrentOwner,qr=Qo.ReactCurrentBatchConfig,pt=0,Bn=null,vn=null,is=0,gr=0,Mu=yl(0),$n=0,Pf=null,wc=0,M0=0,xN=0,lf=null,Qs=null,vN=0,cd=1/0,vo=null,wv=!1,Hk=null,za=null,Jy=!1,Ca=null,Iv=0,cf=0,qk=null,Mx=-1,Vx=0;function Fs(){return pt&6?fn():Mx!==-1?Mx:Mx=fn()}function ja(t){return t.mode&1?pt&2&&is!==0?is&-is:B9.transition!==null?(Vx===0&&(Vx=tF()),Vx):(t=It,t!==0||(t=window.event,t=t===void 0?16:lF(t.type)),t):1}function gi(t,e,n,s){if(50<cf)throw cf=0,qk=null,Error(he(185));mm(t,n,s),(!(pt&2)||t!==Bn)&&(t===Bn&&(!(pt&2)&&(M0|=n),$n===4&&Ia(t,is)),rr(t,s),n===1&&pt===0&&!(e.mode&1)&&(cd=fn()+500,P0&&xl()))}function rr(t,e){var n=t.callbackNode;BG(t,e);var s=iv(t,t===Bn?is:0);if(s===0)n!==null&&z$(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&z$(n),e===1)t.tag===0?j9(RA.bind(null,t)):_F(RA.bind(null,t)),L9(function(){!(pt&6)&&xl()}),n=null;else{switch(nF(s)){case 1:n=GT;break;case 4:n=ZO;break;case 16:n=rv;break;case 536870912:n=eF;break;default:n=rv}n=TL(n,xL.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function xL(t,e){if(Mx=-1,Vx=0,pt&6)throw Error(he(327));var n=t.callbackNode;if(Gu()&&t.callbackNode!==n)return null;var s=iv(t,t===Bn?is:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=kv(t,s);else{e=s;var r=pt;pt|=2;var i=bL();(Bn!==t||is!==e)&&(vo=null,cd=fn()+500,lc(t,e));do try{lH();break}catch(a){vL(t,a)}while(!0);rN(),bv.current=i,pt=r,vn!==null?e=0:(Bn=null,is=0,e=$n)}if(e!==0){if(e===2&&(r=bk(t),r!==0&&(s=r,e=Kk(t,r))),e===1)throw n=Pf,lc(t,0),Ia(t,s),rr(t,fn()),n;if(e===6)Ia(t,s);else{if(r=t.current.alternate,!(s&30)&&!oH(r)&&(e=kv(t,s),e===2&&(i=bk(t),i!==0&&(s=i,e=Kk(t,i))),e===1))throw n=Pf,lc(t,0),Ia(t,s),rr(t,fn()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(he(345));case 2:jl(t,Qs,vo);break;case 3:if(Ia(t,s),(s&130023424)===s&&(e=vN+500-fn(),10<e)){if(iv(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Fs(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Ek(jl.bind(null,t,Qs,vo),e);break}jl(t,Qs,vo);break;case 4:if(Ia(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-mi(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=fn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*iH(s/1960))-s,10<s){t.timeoutHandle=Ek(jl.bind(null,t,Qs,vo),s);break}jl(t,Qs,vo);break;case 5:jl(t,Qs,vo);break;default:throw Error(he(329))}}}return rr(t,fn()),t.callbackNode===n?xL.bind(null,t):null}function Kk(t,e){var n=lf;return t.current.memoizedState.isDehydrated&&(lc(t,e).flags|=256),t=kv(t,e),t!==2&&(e=Qs,Qs=n,e!==null&&Xk(e)),t}function Xk(t){Qs===null?Qs=t:Qs.push.apply(Qs,t)}function oH(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!Ii(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ia(t,e){for(e&=~xN,e&=~M0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-mi(e),s=1<<n;t[n]=-1,e&=~s}}function RA(t){if(pt&6)throw Error(he(327));Gu();var e=iv(t,0);if(!(e&1))return rr(t,fn()),null;var n=kv(t,e);if(t.tag!==0&&n===2){var s=bk(t);s!==0&&(e=s,n=Kk(t,s))}if(n===1)throw n=Pf,lc(t,0),Ia(t,e),rr(t,fn()),n;if(n===6)throw Error(he(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,jl(t,Qs,vo),rr(t,fn()),null}function bN(t,e){var n=pt;pt|=1;try{return t(e)}finally{pt=n,pt===0&&(cd=fn()+500,P0&&xl())}}function Ic(t){Ca!==null&&Ca.tag===0&&!(pt&6)&&Gu();var e=pt;pt|=1;var n=qr.transition,s=It;try{if(qr.transition=null,It=1,t)return t()}finally{It=s,qr.transition=n,pt=e,!(pt&6)&&xl()}}function wN(){gr=Mu.current,Vt(Mu)}function lc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,F9(n)),vn!==null)for(n=vn.return;n!==null;){var s=n;switch(tN(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&uv();break;case 3:ad(),Vt(nr),Vt(Ts),uN();break;case 5:cN(s);break;case 4:ad();break;case 13:Vt(Xt);break;case 19:Vt(Xt);break;case 10:iN(s.type._context);break;case 22:case 23:wN()}n=n.return}if(Bn=t,vn=t=Ba(t.current,null),is=gr=e,$n=0,Pf=null,xN=M0=wc=0,Qs=lf=null,Zl!==null){for(e=0;e<Zl.length;e++)if(n=Zl[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}Zl=null}return t}function vL(t,e){do{var n=vn;try{if(rN(),Ox.current=vv,xv){for(var s=Qt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}xv=!1}if(bc=0,Vn=_n=Qt=null,of=!1,Af=0,yN.current=null,n===null||n.return===null){$n=1,Pf=e,vn=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=is,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=vA(o);if(p!==null){p.flags&=-257,bA(p,o,a,i,e),p.mode&1&&xA(i,c,e),e=p,l=c;var f=e.updateQueue;if(f===null){var g=new Set;g.add(l),e.updateQueue=g}else f.add(l);break e}else{if(!(e&1)){xA(i,c,e),IN();break e}l=Error(he(426))}}else if(Ut&&a.mode&1){var y=vA(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),bA(y,o,a,i,e),nN(ld(l,a));break e}}i=l=ld(l,a),$n!==4&&($n=2),lf===null?lf=[i]:lf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var x=nL(i,l,e);hA(i,x);break e;case 1:a=l;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(za===null||!za.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=sL(i,a,e);hA(i,I);break e}}i=i.return}while(i!==null)}IL(n)}catch(N){e=N,vn===n&&n!==null&&(vn=n=n.return);continue}break}while(!0)}function bL(){var t=bv.current;return bv.current=vv,t===null?vv:t}function IN(){($n===0||$n===3||$n===2)&&($n=4),Bn===null||!(wc&268435455)&&!(M0&268435455)||Ia(Bn,is)}function kv(t,e){var n=pt;pt|=2;var s=bL();(Bn!==t||is!==e)&&(vo=null,lc(t,e));do try{aH();break}catch(r){vL(t,r)}while(!0);if(rN(),pt=n,bv.current=s,vn!==null)throw Error(he(261));return Bn=null,is=0,$n}function aH(){for(;vn!==null;)wL(vn)}function lH(){for(;vn!==null&&!DG();)wL(vn)}function wL(t){var e=SL(t.alternate,t,gr);t.memoizedProps=t.pendingProps,e===null?IL(t):vn=e,yN.current=null}function IL(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=tH(n,e),n!==null){n.flags&=32767,vn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$n=6,vn=null;return}}else if(n=eH(n,e,gr),n!==null){vn=n;return}if(e=e.sibling,e!==null){vn=e;return}vn=e=t}while(e!==null);$n===0&&($n=5)}function jl(t,e,n){var s=It,r=qr.transition;try{qr.transition=null,It=1,cH(t,e,n,s)}finally{qr.transition=r,It=s}return null}function cH(t,e,n,s){do Gu();while(Ca!==null);if(pt&6)throw Error(he(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(he(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(UG(t,i),t===Bn&&(vn=Bn=null,is=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Jy||(Jy=!0,TL(rv,function(){return Gu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=qr.transition,qr.transition=null;var o=It;It=1;var a=pt;pt|=4,yN.current=null,sH(t,n),gL(n,t),C9(Nk),ov=!!Tk,Nk=Tk=null,t.current=n,rH(n),PG(),pt=a,It=o,qr.transition=i}else t.current=n;if(Jy&&(Jy=!1,Ca=t,Iv=r),i=t.pendingLanes,i===0&&(za=null),LG(n.stateNode),rr(t,fn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(wv)throw wv=!1,t=Hk,Hk=null,t;return Iv&1&&t.tag!==0&&Gu(),i=t.pendingLanes,i&1?t===qk?cf++:(cf=0,qk=t):cf=0,xl(),null}function Gu(){if(Ca!==null){var t=nF(Iv),e=qr.transition,n=It;try{if(qr.transition=null,It=16>t?16:t,Ca===null)var s=!1;else{if(t=Ca,Ca=null,Iv=0,pt&6)throw Error(he(331));var r=pt;for(pt|=4,ke=t.current;ke!==null;){var i=ke,o=i.child;if(ke.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ke=c;ke!==null;){var u=ke;switch(u.tag){case 0:case 11:case 15:af(8,u,i)}var d=u.child;if(d!==null)d.return=u,ke=d;else for(;ke!==null;){u=ke;var h=u.sibling,p=u.return;if(pL(u),u===c){ke=null;break}if(h!==null){h.return=p,ke=h;break}ke=p}}}var f=i.alternate;if(f!==null){var g=f.child;if(g!==null){f.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}ke=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ke=o;else e:for(;ke!==null;){if(i=ke,i.flags&2048)switch(i.tag){case 0:case 11:case 15:af(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,ke=x;break e}ke=i.return}}var v=t.current;for(ke=v;ke!==null;){o=ke;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ke=w;else e:for(o=v;ke!==null;){if(a=ke,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:L0(9,a)}}catch(N){nn(a,a.return,N)}if(a===o){ke=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,ke=I;break e}ke=a.return}}if(pt=r,xl(),Ui&&typeof Ui.onPostCommitFiberRoot=="function")try{Ui.onPostCommitFiberRoot(C0,t)}catch{}s=!0}return s}finally{It=n,qr.transition=e}}return!1}function DA(t,e,n){e=ld(n,e),e=nL(t,e,1),t=Va(t,e,1),e=Fs(),t!==null&&(mm(t,1,e),rr(t,e))}function nn(t,e,n){if(t.tag===3)DA(t,t,n);else for(;e!==null;){if(e.tag===3){DA(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(za===null||!za.has(s))){t=ld(n,t),t=sL(e,t,1),e=Va(e,t,1),t=Fs(),e!==null&&(mm(e,1,t),rr(e,t));break}}e=e.return}}function uH(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Fs(),t.pingedLanes|=t.suspendedLanes&n,Bn===t&&(is&n)===n&&($n===4||$n===3&&(is&130023424)===is&&500>fn()-vN?lc(t,0):xN|=n),rr(t,e)}function kL(t,e){e===0&&(t.mode&1?(e=By,By<<=1,!(By&130023424)&&(By=4194304)):e=1);var n=Fs();t=Mo(t,e),t!==null&&(mm(t,e,n),rr(t,n))}function dH(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kL(t,n)}function hH(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(he(314))}s!==null&&s.delete(e),kL(t,n)}var SL;SL=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||nr.current)er=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return er=!1,Z9(t,e,n);er=!!(t.flags&131072)}else er=!1,Ut&&e.flags&1048576&&EF(e,pv,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Lx(t,e),t=e.pendingProps;var r=rd(e,Ts.current);Wu(e,n),r=hN(null,e,s,t,r,n);var i=pN();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,sr(s)?(i=!0,dv(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,aN(e),r.updater=F0,e.stateNode=r,r._reactInternals=e,Ok(e,s,t,n),e=Mk(null,e,s,!0,i,n)):(e.tag=0,Ut&&i&&eN(e),Ds(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Lx(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=fH(s),t=li(s,t),r){case 0:e=Lk(null,e,s,t,n);break e;case 1:e=kA(null,e,s,t,n);break e;case 11:e=wA(null,e,s,t,n);break e;case 14:e=IA(null,e,s,li(s.type,t),n);break e}throw Error(he(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:li(s,r),Lk(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:li(s,r),kA(t,e,s,r,n);case 3:e:{if(aL(e),t===null)throw Error(he(387));s=e.pendingProps,i=e.memoizedState,r=i.element,PF(t,e),gv(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=ld(Error(he(423)),e),e=SA(t,e,s,n,r);break e}else if(s!==r){r=ld(Error(he(424)),e),e=SA(t,e,s,n,r);break e}else for(vr=Ma(e.stateNode.containerInfo.firstChild),Sr=e,Ut=!0,hi=null,n=RF(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(id(),s===r){e=Vo(t,e,n);break e}Ds(t,e,s,n)}e=e.child}return e;case 5:return OF(e),t===null&&Rk(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,_k(s,r)?o=null:i!==null&&_k(s,i)&&(e.flags|=32),oL(t,e),Ds(t,e,o,n),e.child;case 6:return t===null&&Rk(e),null;case 13:return lL(t,e,n);case 4:return lN(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=od(e,null,s,n):Ds(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:li(s,r),wA(t,e,s,r,n);case 7:return Ds(t,e,e.pendingProps,n),e.child;case 8:return Ds(t,e,e.pendingProps.children,n),e.child;case 12:return Ds(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,Dt(fv,s._currentValue),s._currentValue=o,i!==null)if(Ii(i.value,o)){if(i.children===r.children&&!nr.current){e=Vo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(i.tag===1){l=Ro(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Dk(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(he(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Dk(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ds(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Wu(e,n),r=Xr(r),s=s(r),e.flags|=1,Ds(t,e,s,n),e.child;case 14:return s=e.type,r=li(s,e.pendingProps),r=li(s.type,r),IA(t,e,s,r,n);case 15:return rL(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:li(s,r),Lx(t,e),e.tag=1,sr(s)?(t=!0,dv(e)):t=!1,Wu(e,n),tL(e,s,r),Ok(e,s,r,n),Mk(null,e,s,!0,t,n);case 19:return cL(t,e,n);case 22:return iL(t,e,n)}throw Error(he(156,e.tag))};function TL(t,e){return JO(t,e)}function pH(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(t,e,n,s){return new pH(t,e,n,s)}function kN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function fH(t){if(typeof t=="function")return kN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===BT)return 11;if(t===UT)return 14}return 2}function Ba(t,e){var n=t.alternate;return n===null?(n=Vr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function zx(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")kN(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Eu:return cc(n.children,r,i,e);case jT:o=8,r|=8;break;case ik:return t=Vr(12,n,e,r|2),t.elementType=ik,t.lanes=i,t;case ok:return t=Vr(13,n,e,r),t.elementType=ok,t.lanes=i,t;case ak:return t=Vr(19,n,e,r),t.elementType=ak,t.lanes=i,t;case OO:return V0(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case DO:o=10;break e;case PO:o=9;break e;case BT:o=11;break e;case UT:o=14;break e;case xa:o=16,s=null;break e}throw Error(he(130,t==null?t:typeof t,""))}return e=Vr(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function cc(t,e,n,s){return t=Vr(7,t,s,e),t.lanes=n,t}function V0(t,e,n,s){return t=Vr(22,t,s,e),t.elementType=OO,t.lanes=n,t.stateNode={isHidden:!1},t}function gI(t,e,n){return t=Vr(6,t,null,e),t.lanes=n,t}function yI(t,e,n){return e=Vr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mH(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q1(0),this.expirationTimes=Q1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q1(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function SN(t,e,n,s,r,i,o,a,l){return t=new mH(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Vr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},aN(i),t}function gH(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_u,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function NL(t){if(!t)return Qa;t=t._reactInternals;e:{if(qc(t)!==t||t.tag!==1)throw Error(he(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(sr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(he(171))}if(t.tag===1){var n=t.type;if(sr(n))return NF(t,n,e)}return e}function _L(t,e,n,s,r,i,o,a,l){return t=SN(n,s,!0,t,r,i,o,a,l),t.context=NL(null),n=t.current,s=Fs(),r=ja(n),i=Ro(s,r),i.callback=e??null,Va(n,i,r),t.current.lanes=r,mm(t,r,s),rr(t,s),t}function z0(t,e,n,s){var r=e.current,i=Fs(),o=ja(r);return n=NL(n),e.context===null?e.context=n:e.pendingContext=n,e=Ro(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Va(r,e,o),t!==null&&(gi(t,r,o,i),Px(t,r,o)),o}function Sv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function PA(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function TN(t,e){PA(t,e),(t=t.alternate)&&PA(t,e)}function yH(){return null}var EL=typeof reportError=="function"?reportError:function(t){console.error(t)};function NN(t){this._internalRoot=t}j0.prototype.render=NN.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(he(409));z0(t,e,null,null)};j0.prototype.unmount=NN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ic(function(){z0(null,t,null,null)}),e[Lo]=null}};function j0(t){this._internalRoot=t}j0.prototype.unstable_scheduleHydration=function(t){if(t){var e=iF();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wa.length&&e!==0&&e<wa[n].priority;n++);wa.splice(n,0,t),n===0&&aF(t)}};function _N(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function B0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function OA(){}function xH(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var c=Sv(o);i.call(c)}}var o=_L(e,s,t,0,null,!1,!1,"",OA);return t._reactRootContainer=o,t[Lo]=o.current,Nf(t.nodeType===8?t.parentNode:t),Ic(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=Sv(l);a.call(c)}}var l=SN(t,0,!1,null,null,!1,!1,"",OA);return t._reactRootContainer=l,t[Lo]=l.current,Nf(t.nodeType===8?t.parentNode:t),Ic(function(){z0(e,l,n,s)}),l}function U0(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var a=r;r=function(){var l=Sv(o);a.call(l)}}z0(e,o,t,r)}else o=xH(n,e,t,r,s);return Sv(o)}sF=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Mp(e.pendingLanes);n!==0&&(HT(e,n|1),rr(e,fn()),!(pt&6)&&(cd=fn()+500,xl()))}break;case 13:Ic(function(){var s=Mo(t,1);if(s!==null){var r=Fs();gi(s,t,1,r)}}),TN(t,1)}};qT=function(t){if(t.tag===13){var e=Mo(t,134217728);if(e!==null){var n=Fs();gi(e,t,134217728,n)}TN(t,134217728)}};rF=function(t){if(t.tag===13){var e=ja(t),n=Mo(t,e);if(n!==null){var s=Fs();gi(n,t,e,s)}TN(t,e)}};iF=function(){return It};oF=function(t,e){var n=It;try{return It=t,e()}finally{It=n}};yk=function(t,e,n){switch(e){case"input":if(uk(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=D0(s);if(!r)throw Error(he(90));LO(s),uk(s,r)}}}break;case"textarea":VO(t,n);break;case"select":e=n.value,e!=null&&zu(t,!!n.multiple,e,!1)}};HO=bN;qO=Ic;var vH={usingClientEntryPoint:!1,Events:[ym,Ru,D0,WO,GO,bN]},Sp={findFiberByHostInstance:Jl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bH={bundleType:Sp.bundleType,version:Sp.version,rendererPackageName:Sp.rendererPackageName,rendererConfig:Sp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=YO(t),t===null?null:t.stateNode},findFiberByHostInstance:Sp.findFiberByHostInstance||yH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zy.isDisabled&&Zy.supportsFiber)try{C0=Zy.inject(bH),Ui=Zy}catch{}}$r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vH;$r.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_N(e))throw Error(he(200));return gH(t,e,null,n)};$r.createRoot=function(t,e){if(!_N(t))throw Error(he(299));var n=!1,s="",r=EL;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=SN(t,1,!1,null,null,n,!1,s,r),t[Lo]=e.current,Nf(t.nodeType===8?t.parentNode:t),new NN(e)};$r.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(he(188)):(t=Object.keys(t).join(","),Error(he(268,t)));return t=YO(e),t=t===null?null:t.stateNode,t};$r.flushSync=function(t){return Ic(t)};$r.hydrate=function(t,e,n){if(!B0(e))throw Error(he(200));return U0(null,t,e,!0,n)};$r.hydrateRoot=function(t,e,n){if(!_N(t))throw Error(he(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=EL;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=_L(e,null,t,1,n??null,r,!1,i,o),t[Lo]=e.current,Nf(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new j0(e)};$r.render=function(t,e,n){if(!B0(e))throw Error(he(200));return U0(null,t,e,!1,n)};$r.unmountComponentAtNode=function(t){if(!B0(t))throw Error(he(40));return t._reactRootContainer?(Ic(function(){U0(null,null,t,!1,function(){t._reactRootContainer=null,t[Lo]=null})}),!0):!1};$r.unstable_batchedUpdates=bN;$r.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!B0(n))throw Error(he(200));if(t==null||t._reactInternals===void 0)throw Error(he(38));return U0(t,e,n,!1,s)};$r.version="18.3.1-next-f1338f8080-20240426";function CL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CL)}catch(t){console.error(t)}}CL(),CO.exports=$r;var $L=CO.exports,FA=$L;sk.createRoot=FA.createRoot,sk.hydrateRoot=FA.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Of(){return Of=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Of.apply(this,arguments)}var $a;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})($a||($a={}));const LA="popstate";function wH(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:a}=s.location;return Yk("",{pathname:i,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Tv(r)}return kH(e,n,null,t)}function mn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function AL(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IH(){return Math.random().toString(36).substr(2,8)}function MA(t,e){return{usr:t.state,key:t.key,idx:e}}function Yk(t,e,n,s){return n===void 0&&(n=null),Of({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Fd(e):e,{state:n,key:e&&e.key||s||IH()})}function Tv(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Fd(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function kH(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,a=$a.Pop,l=null,c=u();c==null&&(c=0,o.replaceState(Of({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function d(){a=$a.Pop;let y=u(),x=y==null?null:y-c;c=y,l&&l({action:a,location:g.location,delta:x})}function h(y,x){a=$a.Push;let v=Yk(g.location,y,x);c=u()+1;let w=MA(v,c),I=g.createHref(v);try{o.pushState(w,"",I)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;r.location.assign(I)}i&&l&&l({action:a,location:g.location,delta:1})}function p(y,x){a=$a.Replace;let v=Yk(g.location,y,x);c=u();let w=MA(v,c),I=g.createHref(v);o.replaceState(w,"",I),i&&l&&l({action:a,location:g.location,delta:0})}function f(y){let x=r.location.origin!=="null"?r.location.origin:r.location.href,v=typeof y=="string"?y:Tv(y);return v=v.replace(/ $/,"%20"),mn(x,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,x)}let g={get action(){return a},get location(){return t(r,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(LA,d),l=y,()=>{r.removeEventListener(LA,d),l=null}},createHref(y){return e(r,y)},createURL:f,encodeLocation(y){let x=f(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:p,go(y){return o.go(y)}};return g}var VA;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(VA||(VA={}));function SH(t,e,n){return n===void 0&&(n="/"),TH(t,e,n,!1)}function TH(t,e,n,s){let r=typeof e=="string"?Fd(e):e,i=EN(r.pathname||"/",n);if(i==null)return null;let o=RL(t);NH(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=LH(i);a=OH(o[l],c,s)}return a}function RL(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(mn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let c=Ua([s,l.relativePath]),u=n.concat(l);i.children&&i.children.length>0&&(mn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),RL(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:DH(c,i.index),routesMeta:u})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))r(i,o);else for(let l of DL(i.path))r(i,o,l)}),e}function DL(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=DL(s.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function NH(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:PH(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const _H=/^:[\w-]+$/,EH=3,CH=2,$H=1,AH=10,RH=-2,zA=t=>t==="*";function DH(t,e){let n=t.split("/"),s=n.length;return n.some(zA)&&(s+=RH),e&&(s+=CH),n.filter(r=>!zA(r)).reduce((r,i)=>r+(_H.test(i)?EH:i===""?$H:AH),s)}function PH(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function OH(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=jA({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d&&c&&n&&!s[s.length-1].route.index&&(d=jA({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:Ua([i,d.pathname]),pathnameBase:jH(Ua([i,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(i=Ua([i,d.pathnameBase]))}return o}function jA(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=FH(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((c,u,d)=>{let{paramName:h,isOptional:p}=u;if(h==="*"){let g=a[d]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const f=a[d];return p&&!f?c[h]=void 0:c[h]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:t}}function FH(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),AL(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function LH(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return AL(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function EN(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function MH(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Fd(t):t;return{pathname:n?n.startsWith("/")?n:VH(n,e):e,search:BH(s),hash:UH(r)}}function VH(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function xI(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zH(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function CN(t,e){let n=zH(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function $N(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=Fd(t):(r=Of({},t),mn(!r.pathname||!r.pathname.includes("?"),xI("?","pathname","search",r)),mn(!r.pathname||!r.pathname.includes("#"),xI("#","pathname","hash",r)),mn(!r.search||!r.search.includes("#"),xI("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,a;if(o==null)a=n;else{let d=e.length-1;if(!s&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),d-=1;r.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=MH(r,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ua=t=>t.join("/").replace(/\/\/+/g,"/"),jH=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),BH=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,UH=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function WH(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const PL=["post","put","patch","delete"];new Set(PL);const GH=["get",...PL];new Set(GH);/**
 * React Router v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ff(){return Ff=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ff.apply(this,arguments)}const AN=M.createContext(null),HH=M.createContext(null),vl=M.createContext(null),W0=M.createContext(null),Jo=M.createContext({outlet:null,matches:[],isDataRoute:!1}),OL=M.createContext(null);function qH(t,e){let{relative:n}=e===void 0?{}:e;Ld()||mn(!1);let{basename:s,navigator:r}=M.useContext(vl),{hash:i,pathname:o,search:a}=ML(t,{relative:n}),l=o;return s!=="/"&&(l=o==="/"?s:Ua([s,o])),r.createHref({pathname:l,search:a,hash:i})}function Ld(){return M.useContext(W0)!=null}function bl(){return Ld()||mn(!1),M.useContext(W0).location}function FL(t){M.useContext(vl).static||M.useLayoutEffect(t)}function Es(){let{isDataRoute:t}=M.useContext(Jo);return t?o8():KH()}function KH(){Ld()||mn(!1);let t=M.useContext(AN),{basename:e,future:n,navigator:s}=M.useContext(vl),{matches:r}=M.useContext(Jo),{pathname:i}=bl(),o=JSON.stringify(CN(r,n.v7_relativeSplatPath)),a=M.useRef(!1);return FL(()=>{a.current=!0}),M.useCallback(function(c,u){if(u===void 0&&(u={}),!a.current)return;if(typeof c=="number"){s.go(c);return}let d=$N(c,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Ua([e,d.pathname])),(u.replace?s.replace:s.push)(d,u.state,u)},[e,s,o,i,t])}function LL(){let{matches:t}=M.useContext(Jo),e=t[t.length-1];return e?e.params:{}}function ML(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=M.useContext(vl),{matches:r}=M.useContext(Jo),{pathname:i}=bl(),o=JSON.stringify(CN(r,s.v7_relativeSplatPath));return M.useMemo(()=>$N(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function XH(t,e){return YH(t,e)}function YH(t,e,n,s){Ld()||mn(!1);let{navigator:r}=M.useContext(vl),{matches:i}=M.useContext(Jo),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let c=bl(),u;if(e){var d;let y=typeof e=="string"?Fd(e):e;l==="/"||(d=y.pathname)!=null&&d.startsWith(l)||mn(!1),u=y}else u=c;let h=u.pathname||"/",p=h;if(l!=="/"){let y=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let f=SH(t,{pathname:p}),g=t8(f&&f.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:Ua([l,r.encodeLocation?r.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Ua([l,r.encodeLocation?r.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,s);return e&&g?M.createElement(W0.Provider,{value:{location:Ff({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:$a.Pop}},g):g}function QH(){let t=i8(),e=WH(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),n?M.createElement("pre",{style:r},n):null,null)}const JH=M.createElement(QH,null);class ZH extends M.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?M.createElement(Jo.Provider,{value:this.props.routeContext},M.createElement(OL.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function e8(t){let{routeContext:e,match:n,children:s}=t,r=M.useContext(AN);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),M.createElement(Jo.Provider,{value:e},s)}function t8(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let u=o.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id])!==void 0);u>=0||mn(!1),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:p}=n,f=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||f){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,h)=>{let p,f=!1,g=null,y=null;n&&(p=a&&d.route.id?a[d.route.id]:void 0,g=d.route.errorElement||JH,l&&(c<0&&h===0?(f=!0,y=null):c===h&&(f=!0,y=d.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,h+1)),v=()=>{let w;return p?w=g:f?w=y:d.route.Component?w=M.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=u,M.createElement(e8,{match:d,routeContext:{outlet:u,matches:x,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?M.createElement(ZH,{location:n.location,revalidation:n.revalidation,component:g,error:p,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}var VL=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(VL||{}),Nv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Nv||{});function n8(t){let e=M.useContext(AN);return e||mn(!1),e}function s8(t){let e=M.useContext(HH);return e||mn(!1),e}function r8(t){let e=M.useContext(Jo);return e||mn(!1),e}function zL(t){let e=r8(),n=e.matches[e.matches.length-1];return n.route.id||mn(!1),n.route.id}function i8(){var t;let e=M.useContext(OL),n=s8(Nv.UseRouteError),s=zL(Nv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function o8(){let{router:t}=n8(VL.UseNavigateStable),e=zL(Nv.UseNavigateStable),n=M.useRef(!1);return FL(()=>{n.current=!0}),M.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Ff({fromRouteId:e},i)))},[t,e])}const BA={};function a8(t,e){BA[e]||(BA[e]=!0,console.warn(e))}const UA=(t,e,n)=>a8(t,"⚠️ React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+n+"."));function l8(t,e){t!=null&&t.v7_startTransition||UA("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),!(t!=null&&t.v7_relativeSplatPath)&&!e&&UA("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function c8(t){let{to:e,replace:n,state:s,relative:r}=t;Ld()||mn(!1);let{future:i,static:o}=M.useContext(vl),{matches:a}=M.useContext(Jo),{pathname:l}=bl(),c=Es(),u=$N(e,CN(a,i.v7_relativeSplatPath),l,r==="path"),d=JSON.stringify(u);return M.useEffect(()=>c(JSON.parse(d),{replace:n,state:s,relative:r}),[c,d,r,n,s]),null}function Ln(t){mn(!1)}function u8(t){let{basename:e="/",children:n=null,location:s,navigationType:r=$a.Pop,navigator:i,static:o=!1,future:a}=t;Ld()&&mn(!1);let l=e.replace(/^\/*/,"/"),c=M.useMemo(()=>({basename:l,navigator:i,static:o,future:Ff({v7_relativeSplatPath:!1},a)}),[l,a,i,o]);typeof s=="string"&&(s=Fd(s));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:f="default"}=s,g=M.useMemo(()=>{let y=EN(u,l);return y==null?null:{location:{pathname:y,search:d,hash:h,state:p,key:f},navigationType:r}},[l,u,d,h,p,f,r]);return g==null?null:M.createElement(vl.Provider,{value:c},M.createElement(W0.Provider,{children:n,value:g}))}function d8(t){let{children:e,location:n}=t;return XH(Qk(e),n)}new Promise(()=>{});function Qk(t,e){e===void 0&&(e=[]);let n=[];return M.Children.forEach(t,(s,r)=>{if(!M.isValidElement(s))return;let i=[...e,r];if(s.type===M.Fragment){n.push.apply(n,Qk(s.props.children,i));return}s.type!==Ln&&mn(!1),!s.props.index||!s.props.children||mn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Qk(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.28.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jk(){return Jk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Jk.apply(this,arguments)}function h8(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function p8(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function f8(t,e){return t.button===0&&(!e||e==="_self")&&!p8(t)}const m8=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],g8="6";try{window.__reactRouterVersion=g8}catch{}const y8="startTransition",WA=nd[y8];function x8(t){let{basename:e,children:n,future:s,window:r}=t,i=M.useRef();i.current==null&&(i.current=wH({window:r,v5Compat:!0}));let o=i.current,[a,l]=M.useState({action:o.action,location:o.location}),{v7_startTransition:c}=s||{},u=M.useCallback(d=>{c&&WA?WA(()=>l(d)):l(d)},[l,c]);return M.useLayoutEffect(()=>o.listen(u),[o,u]),M.useEffect(()=>l8(s),[s]),M.createElement(u8,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:s})}const v8=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",b8=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ja=M.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,h=h8(e,m8),{basename:p}=M.useContext(vl),f,g=!1;if(typeof c=="string"&&b8.test(c)&&(f=c,v8))try{let w=new URL(window.location.href),I=c.startsWith("//")?new URL(w.protocol+c):new URL(c),N=EN(I.pathname,p);I.origin===w.origin&&N!=null?c=N+I.search+I.hash:g=!0}catch{}let y=qH(c,{relative:r}),x=w8(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:r,viewTransition:d});function v(w){s&&s(w),w.defaultPrevented||x(w)}return M.createElement("a",Jk({},h,{href:f||y,onClick:g||i?s:v,ref:n,target:l}))});var GA;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(GA||(GA={}));var HA;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(HA||(HA={}));function w8(t,e){let{target:n,replace:s,state:r,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,l=Es(),c=bl(),u=ML(t,{relative:o});return M.useCallback(d=>{if(f8(d,n)){d.preventDefault();let h=s!==void 0?s:Tv(c)===Tv(u);l(t,{replace:h,state:r,preventScrollReset:i,relative:o,viewTransition:a})}},[c,l,u,s,r,n,t,i,o,a])}var qA={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},I8=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],l=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},BL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,u=i>>2,d=(i&3)<<4|a>>4;let h=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(h=64)),s.push(n[u],n[d],n[h],n[p])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(jL(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):I8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const c=r<t.length?n[t.charAt(r)]:64;++r;const d=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||c==null||d==null)throw new k8;const h=i<<2|a>>4;if(s.push(h),c!==64){const p=a<<4&240|c>>2;if(s.push(p),d!==64){const f=c<<6&192|d;s.push(f)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class k8 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const S8=function(t){const e=jL(t);return BL.encodeByteArray(e,!0)},_v=function(t){return S8(t).replace(/\./g,"")},UL=function(t){try{return BL.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N8=()=>T8().__FIREBASE_DEFAULTS__,_8=()=>{if(typeof process>"u"||typeof qA>"u")return;const t=qA.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},E8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&UL(t[1]);return e&&JSON.parse(e)},G0=()=>{try{return N8()||_8()||E8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},WL=t=>{var e,n;return(n=(e=G0())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},GL=t=>{const e=WL(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},HL=()=>{var t;return(t=G0())===null||t===void 0?void 0:t.config},qL=t=>{var e;return(e=G0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C8{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KL(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[_v(JSON.stringify(n)),_v(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ns(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ns())}function A8(){var t;const e=(t=G0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function R8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function D8(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function P8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function O8(){const t=Ns();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function F8(){return!A8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L8(){try{return typeof indexedDB=="object"}catch{return!1}}function M8(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V8="FirebaseError";class lo extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=V8,Object.setPrototypeOf(this,lo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vm.prototype.create)}}class vm{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?z8(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new lo(r,a,s)}}function z8(t,e){return t.replace(j8,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const j8=/\{\$([^}]+)}/g;function B8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ev(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(KA(i)&&KA(o)){if(!Ev(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function KA(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function zp(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function jp(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function U8(t,e){const n=new W8(t,e);return n.subscribe.bind(n)}class W8{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");G8(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=vI),r.error===void 0&&(r.error=vI),r.complete===void 0&&(r.complete=vI);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function G8(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function vI(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(t){return t&&t._delegate?t._delegate:t}class Za{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new C8;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(K8(e))try{this.getOrInitializeService({instanceIdentifier:Bl})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Bl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Bl){return this.instances.has(e)}getOptions(e=Bl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:q8(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Bl){return this.component?this.component.multipleInstances?e:Bl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function q8(t){return t===Bl?void 0:t}function K8(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X8{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new H8(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var at;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(at||(at={}));const Y8={debug:at.DEBUG,verbose:at.VERBOSE,info:at.INFO,warn:at.WARN,error:at.ERROR,silent:at.SILENT},Q8=at.INFO,J8={[at.DEBUG]:"log",[at.VERBOSE]:"log",[at.INFO]:"info",[at.WARN]:"warn",[at.ERROR]:"error"},Z8=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=J8[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let RN=class{constructor(e){this.name=e,this._logLevel=Q8,this._logHandler=Z8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in at))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Y8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,at.DEBUG,...e),this._logHandler(this,at.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,at.VERBOSE,...e),this._logHandler(this,at.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,at.INFO,...e),this._logHandler(this,at.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,at.WARN,...e),this._logHandler(this,at.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,at.ERROR,...e),this._logHandler(this,at.ERROR,...e)}};const e7=(t,e)=>e.some(n=>t instanceof n);let XA,YA;function t7(){return XA||(XA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function n7(){return YA||(YA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const XL=new WeakMap,Zk=new WeakMap,YL=new WeakMap,bI=new WeakMap,DN=new WeakMap;function s7(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Wa(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&XL.set(n,t)}).catch(()=>{}),DN.set(e,t),e}function r7(t){if(Zk.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Zk.set(t,e)}let eS={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Zk.get(t);if(e==="objectStoreNames")return t.objectStoreNames||YL.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wa(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function i7(t){eS=t(eS)}function o7(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(wI(this),e,...n);return YL.set(s,e.sort?e.sort():[e]),Wa(s)}:n7().includes(t)?function(...e){return t.apply(wI(this),e),Wa(XL.get(this))}:function(...e){return Wa(t.apply(wI(this),e))}}function a7(t){return typeof t=="function"?o7(t):(t instanceof IDBTransaction&&r7(t),e7(t,t7())?new Proxy(t,eS):t)}function Wa(t){if(t instanceof IDBRequest)return s7(t);if(bI.has(t))return bI.get(t);const e=a7(t);return e!==t&&(bI.set(t,e),DN.set(e,t)),e}const wI=t=>DN.get(t);function l7(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=Wa(o);return s&&o.addEventListener("upgradeneeded",l=>{s(Wa(o.result),l.oldVersion,l.newVersion,Wa(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const c7=["get","getKey","getAll","getAllKeys","count"],u7=["put","add","delete","clear"],II=new Map;function QA(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(II.get(e))return II.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=u7.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||c7.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),r&&l.done]))[0]};return II.set(e,i),i}i7(t=>({...t,get:(e,n,s)=>QA(e,n)||t.get(e,n,s),has:(e,n)=>!!QA(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(h7(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function h7(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tS="@firebase/app",JA="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo=new RN("@firebase/app"),p7="@firebase/app-compat",f7="@firebase/analytics-compat",m7="@firebase/analytics",g7="@firebase/app-check-compat",y7="@firebase/app-check",x7="@firebase/auth",v7="@firebase/auth-compat",b7="@firebase/database",w7="@firebase/data-connect",I7="@firebase/database-compat",k7="@firebase/functions",S7="@firebase/functions-compat",T7="@firebase/installations",N7="@firebase/installations-compat",_7="@firebase/messaging",E7="@firebase/messaging-compat",C7="@firebase/performance",$7="@firebase/performance-compat",A7="@firebase/remote-config",R7="@firebase/remote-config-compat",D7="@firebase/storage",P7="@firebase/storage-compat",O7="@firebase/firestore",F7="@firebase/vertexai-preview",L7="@firebase/firestore-compat",M7="firebase",V7="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="[DEFAULT]",z7={[tS]:"fire-core",[p7]:"fire-core-compat",[m7]:"fire-analytics",[f7]:"fire-analytics-compat",[y7]:"fire-app-check",[g7]:"fire-app-check-compat",[x7]:"fire-auth",[v7]:"fire-auth-compat",[b7]:"fire-rtdb",[w7]:"fire-data-connect",[I7]:"fire-rtdb-compat",[k7]:"fire-fn",[S7]:"fire-fn-compat",[T7]:"fire-iid",[N7]:"fire-iid-compat",[_7]:"fire-fcm",[E7]:"fire-fcm-compat",[C7]:"fire-perf",[$7]:"fire-perf-compat",[A7]:"fire-rc",[R7]:"fire-rc-compat",[D7]:"fire-gcs",[P7]:"fire-gcs-compat",[O7]:"fire-fst",[L7]:"fire-fst-compat",[F7]:"fire-vertex","fire-js":"fire-js",[M7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv=new Map,j7=new Map,sS=new Map;function ZA(t,e){try{t.container.addComponent(e)}catch(n){zo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function kc(t){const e=t.name;if(sS.has(e))return zo.debug(`There were multiple attempts to register component ${e}.`),!1;sS.set(e,t);for(const n of Cv.values())ZA(n,t);for(const n of j7.values())ZA(n,t);return!0}function H0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ga=new vm("app","Firebase",B7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U7{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Za("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ga.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=V7;function QL(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:nS,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw Ga.create("bad-app-name",{appName:String(r)});if(n||(n=HL()),!n)throw Ga.create("no-options");const i=Cv.get(r);if(i){if(Ev(n,i.options)&&Ev(s,i.config))return i;throw Ga.create("duplicate-app",{appName:r})}const o=new X8(r);for(const l of sS.values())o.addComponent(l);const a=new U7(n,s,o);return Cv.set(r,a),a}function PN(t=nS){const e=Cv.get(t);if(!e&&t===nS&&HL())return QL();if(!e)throw Ga.create("no-app",{appName:t});return e}function Gi(t,e,n){var s;let r=(s=z7[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zo.warn(a.join(" "));return}kc(new Za(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W7="firebase-heartbeat-database",G7=1,Lf="firebase-heartbeat-store";let kI=null;function JL(){return kI||(kI=l7(W7,G7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Lf)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ga.create("idb-open",{originalErrorMessage:t.message})})),kI}async function H7(t){try{const n=(await JL()).transaction(Lf),s=await n.objectStore(Lf).get(ZL(t));return await n.done,s}catch(e){if(e instanceof lo)zo.warn(e.message);else{const n=Ga.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zo.warn(n.message)}}}async function eR(t,e){try{const s=(await JL()).transaction(Lf,"readwrite");await s.objectStore(Lf).put(e,ZL(t)),await s.done}catch(n){if(n instanceof lo)zo.warn(n.message);else{const s=Ga.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});zo.warn(s.message)}}}function ZL(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q7=1024,K7=30*24*60*60*1e3;class X7{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Q7(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=tR();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=K7}),this._storage.overwrite(this._heartbeatsCache))}catch(s){zo.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=tR(),{heartbeatsToSend:s,unsentEntries:r}=Y7(this._heartbeatsCache.heartbeats),i=_v(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return zo.warn(n),""}}}function tR(){return new Date().toISOString().substring(0,10)}function Y7(t,e=q7){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),nR(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),nR(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class Q7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return L8()?M8().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await H7(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return eR(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return eR(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function nR(t){return _v(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J7(t){kc(new Za("platform-logger",e=>new d7(e),"PRIVATE")),kc(new Za("heartbeat",e=>new X7(e),"PRIVATE")),Gi(tS,JA,t),Gi(tS,JA,"esm2017"),Gi("fire-js","")}J7("");var Z7="firebase",eq="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gi(Z7,eq,"app");function ON(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function Xc(t,e,n,s){function r(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(d){o(d)}}function l(u){try{c(s.throw(u))}catch(d){o(d)}}function c(u){u.done?i(u.value):r(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})}function e3(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tq=e3,t3=new vm("auth","Firebase",e3());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v=new RN("@firebase/auth");function nq(t,...e){$v.logLevel<=at.WARN&&$v.warn(`Auth (${Kc}): ${t}`,...e)}function jx(t,...e){$v.logLevel<=at.ERROR&&$v.error(`Auth (${Kc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(t,...e){throw LN(t,...e)}function yi(t,...e){return LN(t,...e)}function FN(t,e,n){const s=Object.assign(Object.assign({},tq()),{[e]:n});return new vm("auth","Firebase",s).create(e,{appName:t.name})}function Hi(t){return FN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function n3(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&Qr(t,"argument-error"),FN(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function LN(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return t3.create(t,...e)}function Ve(t,e,...n){if(!t)throw LN(e,...n)}function Co(t){const e="INTERNAL ASSERTION FAILED: "+t;throw jx(e),new Error(e)}function jo(t,e){t||Co(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function sq(){return sR()==="http:"||sR()==="https:"}function sR(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rq(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sq()||D8()||"connection"in navigator)?navigator.onLine:!0}function iq(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e,n){this.shortDelay=e,this.longDelay=n,jo(n>e,"Short delay should be less than long delay!"),this.isMobile=$8()||P8()}get(){return rq()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MN(t,e){jo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Co("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Co("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Co("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aq=new wm(3e4,6e4);function Zo(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ea(t,e,n,s,r={}){return r3(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=bm(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return R8()||(c.referrerPolicy="no-referrer"),s3.fetch()(i3(t,t.config.apiHost,n,a),c)})}async function r3(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},oq),e);try{const r=new cq(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ex(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ex(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw ex(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw ex(t,"user-disabled",o);const u=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw FN(t,u,c);Qr(t,u)}}catch(r){if(r instanceof lo)throw r;Qr(t,"network-request-failed",{message:String(r)})}}async function Im(t,e,n,s,r={}){const i=await ea(t,e,n,s,r);return"mfaPendingCredential"in i&&Qr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function i3(t,e,n,s){const r=`${e}${n}?${s}`;return t.config.emulator?MN(t.config,r):`${t.config.apiScheme}://${r}`}function lq(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class cq{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(yi(this.auth,"network-request-failed")),aq.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ex(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=yi(t,e,s);return r.customData._tokenResponse=n,r}function rR(t){return t!==void 0&&t.enterprise!==void 0}class uq{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return lq(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function dq(t,e){return ea(t,"GET","/v2/recaptchaConfig",Zo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hq(t,e){return ea(t,"POST","/v1/accounts:delete",e)}async function o3(t,e){return ea(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function pq(t,e=!1){const n=Zt(t),s=await n.getIdToken(e),r=VN(s);Ve(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:uf(SI(r.auth_time)),issuedAtTime:uf(SI(r.iat)),expirationTime:uf(SI(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function SI(t){return Number(t)*1e3}function VN(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return jx("JWT malformed, contained fewer than 3 sections"),null;try{const r=UL(n);return r?JSON.parse(r):(jx("Failed to decode base64 JWT payload"),null)}catch(r){return jx("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function iR(t){const e=VN(t);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mf(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof lo&&fq(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function fq({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mq{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=uf(this.lastLoginAt),this.creationTime=uf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Av(t){var e;const n=t.auth,s=await t.getIdToken(),r=await Mf(t,o3(n,{idToken:s}));Ve(r==null?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?a3(i.providerUserInfo):[],a=yq(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new iS(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function gq(t){const e=Zt(t);await Av(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yq(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function a3(t){return t.map(e=>{var{providerId:n}=e,s=ON(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xq(t,e){const n=await r3(t,{},async()=>{const s=bm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=i3(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",s3.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function vq(t,e){return ea(t,"POST","/v2/accounts:revokeToken",Zo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):iR(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const n=iR(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await xq(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new Hu;return s&&(Ve(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(Ve(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(Ve(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hu,this.toJSON())}_performRefresh(){return Co("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(t,e){Ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $o{constructor(e){var{uid:n,auth:s,stsTokenManager:r}=e,i=ON(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new iS(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Mf(this,this.stsTokenManager.getToken(this.auth,e));return Ve(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return pq(this,e)}reload(){return gq(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new $o(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Av(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zr(this.auth.app))return Promise.reject(Hi(this.auth));const e=await this.getIdToken();return await Mf(this,hq(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,r,i,o,a,l,c,u;const d=(s=n.displayName)!==null&&s!==void 0?s:void 0,h=(r=n.email)!==null&&r!==void 0?r:void 0,p=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,f=(o=n.photoURL)!==null&&o!==void 0?o:void 0,g=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,x=(c=n.createdAt)!==null&&c!==void 0?c:void 0,v=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:w,emailVerified:I,isAnonymous:N,providerData:A,stsTokenManager:T}=n;Ve(w&&T,e,"internal-error");const S=Hu.fromJSON(this.name,T);Ve(typeof w=="string",e,"internal-error"),ga(d,e.name),ga(h,e.name),Ve(typeof I=="boolean",e,"internal-error"),Ve(typeof N=="boolean",e,"internal-error"),ga(p,e.name),ga(f,e.name),ga(g,e.name),ga(y,e.name),ga(x,e.name),ga(v,e.name);const E=new $o({uid:w,auth:e,email:h,emailVerified:I,displayName:d,isAnonymous:N,photoURL:f,phoneNumber:p,tenantId:g,stsTokenManager:S,createdAt:x,lastLoginAt:v});return A&&Array.isArray(A)&&(E.providerData=A.map($=>Object.assign({},$))),y&&(E._redirectEventId=y),E}static async _fromIdTokenResponse(e,n,s=!1){const r=new Hu;r.updateFromServerResponse(n);const i=new $o({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Av(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];Ve(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?a3(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),a=new Hu;a.updateFromIdToken(s);const l=new $o({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new iS(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR=new Map;function Ao(t){jo(t instanceof Function,"Expected a class definition");let e=oR.get(t);return e?(jo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,oR.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}l3.type="NONE";const aR=l3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(t,e,n){return`firebase:${t}:${e}:${n}`}class qu{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=Bx(this.userKey,r.apiKey,i),this.fullPersistenceKey=Bx("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$o._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new qu(Ao(aR),e,s);const r=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=r[0]||Ao(aR);const o=Bx(s,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){const d=$o._fromJSON(e,u);c!==i&&(a=d),i=c;break}}catch{}const l=r.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new qu(i,e,s):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new qu(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(h3(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(c3(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(f3(e))return"Blackberry";if(m3(e))return"Webos";if(u3(e))return"Safari";if((e.includes("chrome/")||d3(e))&&!e.includes("edge/"))return"Chrome";if(p3(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function c3(t=Ns()){return/firefox\//i.test(t)}function u3(t=Ns()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function d3(t=Ns()){return/crios\//i.test(t)}function h3(t=Ns()){return/iemobile/i.test(t)}function p3(t=Ns()){return/android/i.test(t)}function f3(t=Ns()){return/blackberry/i.test(t)}function m3(t=Ns()){return/webos/i.test(t)}function zN(t=Ns()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function bq(t=Ns()){var e;return zN(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function wq(){return O8()&&document.documentMode===10}function g3(t=Ns()){return zN(t)||p3(t)||m3(t)||f3(t)||/windows phone/i.test(t)||h3(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y3(t,e=[]){let n;switch(t){case"Browser":n=lR(Ns());break;case"Worker":n=`${lR(Ns())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Kc}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iq{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kq(t,e={}){return ea(t,"GET","/v2/passwordPolicy",Zo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sq=6;class Tq{constructor(e){var n,s,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Sq,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,s,r,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nq{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cR(this),this.idTokenSubscription=new cR(this),this.beforeStateQueue=new Iq(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=t3,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ao(n)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await qu.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await o3(this,{idToken:e}),s=await $o._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(zr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Av(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iq()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zr(this.app))return Promise.reject(Hi(this));const n=e?Zt(e):null;return n&&Ve(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zr(this.app)?Promise.reject(Hi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zr(this.app)?Promise.reject(Hi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ao(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kq(this),n=new Tq(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new vm("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await vq(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ao(e)||this._popupRedirectResolver;Ve(n,this,"argument-error"),this.redirectPersistenceManager=await qu.create(this,[Ao(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,s,r);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(n["X-Firebase-Client"]=s);const r=await this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&nq(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ei(t){return Zt(t)}class cR{constructor(e){this.auth=e,this.observer=null,this.addObserver=U8(n=>this.observer=n)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let q0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _q(t){q0=t}function x3(t){return q0.loadJS(t)}function Eq(){return q0.recaptchaEnterpriseScript}function Cq(){return q0.gapiScript}function $q(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const Aq="recaptcha-enterprise",Rq="NO_RECAPTCHA";class Dq{constructor(e){this.type=Aq,this.auth=Ei(e)}async verify(e="verify",n=!1){async function s(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{dq(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new uq(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function r(i,o,a){const l=window.grecaptcha;rR(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(Rq)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{s(this.auth).then(a=>{if(!n&&rR(window.grecaptcha))r(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Eq();l.length!==0&&(l+=a),x3(l).then(()=>{r(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function uR(t,e,n,s=!1){const r=new Dq(t);let i;try{i=await r.verify(n)}catch{i=await r.verify(n,!0)}const o=Object.assign({},e);return s?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Rv(t,e,n,s){var r;if(!((r=t._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await uR(t,e,n,n==="getOobCode");return s(t,i)}else return s(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await uR(t,e,n,n==="getOobCode");return s(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pq(t,e){const n=H0(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(Ev(i,e??{}))return r;Qr(r,"already-initialized")}return n.initialize({options:e})}function Oq(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Ao);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function Fq(t,e,n){const s=Ei(t);Ve(s._canInitEmulator,s,"emulator-config-failed"),Ve(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=v3(e),{host:o,port:a}=Lq(e),l=a===null?"":`:${a}`;s.config.emulator={url:`${i}//${o}${l}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),Mq()}function v3(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Lq(t){const e=v3(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:dR(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:dR(o)}}}function dR(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Mq(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Co("not implemented")}_getIdTokenResponse(e){return Co("not implemented")}_linkToIdToken(e,n){return Co("not implemented")}_getReauthenticationResolver(e){return Co("not implemented")}}async function Vq(t,e){return ea(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zq(t,e){return Im(t,"POST","/v1/accounts:signInWithPassword",Zo(t,e))}async function jq(t,e){return ea(t,"POST","/v1/accounts:sendOobCode",Zo(t,e))}async function Bq(t,e){return jq(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uq(t,e){return Im(t,"POST","/v1/accounts:signInWithEmailLink",Zo(t,e))}async function Wq(t,e){return Im(t,"POST","/v1/accounts:signInWithEmailLink",Zo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf extends jN{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new Vf(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Vf(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rv(e,n,"signInWithPassword",zq);case"emailLink":return Uq(e,{email:this._email,oobCode:this._password});default:Qr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rv(e,s,"signUpPassword",Vq);case"emailLink":return Wq(e,{idToken:n,email:this._email,oobCode:this._password});default:Qr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ku(t,e){return Im(t,"POST","/v1/accounts:signInWithIdp",Zo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gq="http://localhost";class Sc extends jN{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Sc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Qr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=n,i=ON(n,["providerId","signInMethod"]);if(!s||!r)return null;const o=new Sc(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ku(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,Ku(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ku(e,n)}buildRequest(){const e={requestUri:Gq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=bm(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hq(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qq(t){const e=zp(jp(t)).link,n=e?zp(jp(e)).deep_link_id:null,s=zp(jp(t)).deep_link_id;return(s?zp(jp(s)).link:null)||s||n||e||t}class BN{constructor(e){var n,s,r,i,o,a;const l=zp(jp(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,u=(s=l.oobCode)!==null&&s!==void 0?s:null,d=Hq((r=l.mode)!==null&&r!==void 0?r:null);Ve(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=qq(e);try{return new BN(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(){this.providerId=Md.PROVIDER_ID}static credential(e,n){return Vf._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=BN.parseLink(n);return Ve(s,"argument-error"),Vf._fromEmailAndCode(e,s.code,s.tenantId)}}Md.PROVIDER_ID="password";Md.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Md.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km extends K0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka extends km{constructor(){super("facebook.com")}static credential(e){return Sc._fromParams({providerId:ka.PROVIDER_ID,signInMethod:ka.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ka.credentialFromTaggedObject(e)}static credentialFromError(e){return ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ka.credential(e.oauthAccessToken)}catch{return null}}}ka.FACEBOOK_SIGN_IN_METHOD="facebook.com";ka.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So extends km{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Sc._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return So.credential(n,s)}catch{return null}}}So.GOOGLE_SIGN_IN_METHOD="google.com";So.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa extends km{constructor(){super("github.com")}static credential(e){return Sc._fromParams({providerId:Sa.PROVIDER_ID,signInMethod:Sa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sa.credentialFromTaggedObject(e)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sa.credential(e.oauthAccessToken)}catch{return null}}}Sa.GITHUB_SIGN_IN_METHOD="github.com";Sa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta extends km{constructor(){super("twitter.com")}static credential(e,n){return Sc._fromParams({providerId:Ta.PROVIDER_ID,signInMethod:Ta.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ta.credentialFromTaggedObject(e)}static credentialFromError(e){return Ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Ta.credential(n,s)}catch{return null}}}Ta.TWITTER_SIGN_IN_METHOD="twitter.com";Ta.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kq(t,e){return Im(t,"POST","/v1/accounts:signUp",Zo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await $o._fromIdTokenResponse(e,s,r),o=hR(s);return new Tc({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=hR(s);return new Tc({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function hR(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv extends lo{constructor(e,n,s,r){var i;super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,Dv.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new Dv(e,n,s,r)}}function b3(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Dv._fromErrorAndOperation(t,i,e,s):i})}async function Xq(t,e,n=!1){const s=await Mf(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Tc._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yq(t,e,n=!1){const{auth:s}=t;if(zr(s.app))return Promise.reject(Hi(s));const r="reauthenticate";try{const i=await Mf(t,b3(s,r,e,t),n);Ve(i.idToken,s,"internal-error");const o=VN(i.idToken);Ve(o,s,"internal-error");const{sub:a}=o;return Ve(t.uid===a,s,"user-mismatch"),Tc._forOperation(t,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Qr(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w3(t,e,n=!1){if(zr(t.app))return Promise.reject(Hi(t));const s="signIn",r=await b3(t,s,e),i=await Tc._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function Qq(t,e){return w3(Ei(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I3(t){const e=Ei(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Jq(t,e,n){const s=Ei(t);await Rv(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Bq)}async function Zq(t,e,n){if(zr(t.app))return Promise.reject(Hi(t));const s=Ei(t),o=await Rv(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Kq).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&I3(t),l}),a=await Tc._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(a.user),a}function eK(t,e,n){return zr(t.app)?Promise.reject(Hi(t)):Qq(Zt(t),Md.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&I3(t),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tK(t,e){return Zt(t).setPersistence(e)}function nK(t,e,n,s){return Zt(t).onIdTokenChanged(e,n,s)}function sK(t,e,n){return Zt(t).beforeAuthStateChanged(e,n)}function rK(t,e,n,s){return Zt(t).onAuthStateChanged(e,n,s)}function iK(t){return Zt(t).signOut()}const Pv="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Pv,"1"),this.storage.removeItem(Pv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oK=1e3,aK=10;class S3 extends k3{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=g3(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);wq()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,aK):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},oK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}S3.type="LOCAL";const T3=S3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3 extends k3{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}N3.type="SESSION";const _3=N3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lK(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new X0(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async c=>c(n.origin,i)),l=await lK(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}X0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cK{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=UN("",20);r.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(d){const h=d;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(h.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(){return window}function uK(t){qi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E3(){return typeof qi().WorkerGlobalScope<"u"&&typeof qi().importScripts=="function"}async function dK(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hK(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function pK(){return E3()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C3="firebaseLocalStorageDb",fK=1,Ov="firebaseLocalStorage",$3="fbase_key";class Sm{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Y0(t,e){return t.transaction([Ov],e?"readwrite":"readonly").objectStore(Ov)}function mK(){const t=indexedDB.deleteDatabase(C3);return new Sm(t).toPromise()}function oS(){const t=indexedDB.open(C3,fK);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(Ov,{keyPath:$3})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(Ov)?e(s):(s.close(),await mK(),e(await oS()))})})}async function pR(t,e,n){const s=Y0(t,!0).put({[$3]:e,value:n});return new Sm(s).toPromise()}async function gK(t,e){const n=Y0(t,!1).get(e),s=await new Sm(n).toPromise();return s===void 0?null:s.value}function fR(t,e){const n=Y0(t,!0).delete(e);return new Sm(n).toPromise()}const yK=800,xK=3;class A3{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await oS(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>xK)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return E3()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=X0._getInstance(pK()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await dK(),!this.activeServiceWorker)return;this.sender=new cK(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((n=s[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hK()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await oS();return await pR(e,Pv,"1"),await fR(e,Pv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>pR(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>gK(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>fR(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=Y0(r,!1).getAll();return new Sm(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),yK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}A3.type="LOCAL";const vK=A3;new wm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(t,e){return e?Ao(e):(Ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN extends jN{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ku(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ku(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ku(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function bK(t){return w3(t.auth,new GN(t),t.bypassAuthState)}function wK(t){const{auth:e,user:n}=t;return Ve(n,e,"internal-error"),Yq(n,new GN(t),t.bypassAuthState)}async function IK(t){const{auth:e,user:n}=t;return Ve(n,e,"internal-error"),Xq(n,new GN(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bK;case"linkViaPopup":case"linkViaRedirect":return IK;case"reauthViaPopup":case"reauthViaRedirect":return wK;default:Qr(this.auth,"internal-error")}}resolve(e){jo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){jo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kK=new wm(2e3,1e4);async function SK(t,e,n){if(zr(t.app))return Promise.reject(yi(t,"operation-not-supported-in-this-environment"));const s=Ei(t);n3(t,e,K0);const r=WN(s,n);return new tc(s,"signInViaPopup",e,r).executeNotNull()}class tc extends R3{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,tc.currentPopupAction&&tc.currentPopupAction.cancel(),tc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){jo(this.filter.length===1,"Popup operations only handle one event");const e=UN();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(yi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(yi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,kK.get())};e()}}tc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TK="pendingRedirect",Ux=new Map;class NK extends R3{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=Ux.get(this.auth._key());if(!e){try{const s=await _K(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}Ux.set(this.auth._key(),e)}return this.bypassAuthState||Ux.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _K(t,e){const n=P3(e),s=D3(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}async function EK(t,e){return D3(t)._set(P3(e),"true")}function CK(t,e){Ux.set(t._key(),e)}function D3(t){return Ao(t._redirectPersistence)}function P3(t){return Bx(TK,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $K(t,e,n){return AK(t,e,n)}async function AK(t,e,n){if(zr(t.app))return Promise.reject(Hi(t));const s=Ei(t);n3(t,e,K0),await s._initializationPromise;const r=WN(s,n);return await EK(r,s),r._openRedirect(s,e,"signInViaRedirect")}async function RK(t,e){return await Ei(t)._initializationPromise,O3(t,e,!1)}async function O3(t,e,n=!1){if(zr(t.app))return Promise.reject(Hi(t));const s=Ei(t),r=WN(s,e),o=await new NK(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DK=10*60*1e3;class PK{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!OK(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!F3(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(yi(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=DK&&this.cachedEventUids.clear(),this.cachedEventUids.has(mR(e))}saveEventToCache(e){this.cachedEventUids.add(mR(e)),this.lastProcessedEventTime=Date.now()}}function mR(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function F3({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function OK(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return F3(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FK(t,e={}){return ea(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LK=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MK=/^https?/;async function VK(t){if(t.config.emulator)return;const{authorizedDomains:e}=await FK(t);for(const n of e)try{if(zK(n))return}catch{}Qr(t,"unauthorized-domain")}function zK(t){const e=rS(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!MK.test(n))return!1;if(LK.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jK=new wm(3e4,6e4);function gR(){const t=qi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function BK(t){return new Promise((e,n)=>{var s,r,i;function o(){gR(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gR(),n(yi(t,"network-request-failed"))},timeout:jK.get()})}if(!((r=(s=qi().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=qi().gapi)===null||i===void 0)&&i.load)o();else{const a=$q("iframefcb");return qi()[a]=()=>{gapi.load?o():n(yi(t,"network-request-failed"))},x3(`${Cq()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Wx=null,e})}let Wx=null;function UK(t){return Wx=Wx||BK(t),Wx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WK=new wm(5e3,15e3),GK="__/auth/iframe",HK="emulator/auth/iframe",qK={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},KK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XK(t){const e=t.config;Ve(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?MN(e,HK):`https://${t.config.authDomain}/${GK}`,s={apiKey:e.apiKey,appName:t.name,v:Kc},r=KK.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${bm(s).slice(1)}`}async function YK(t){const e=await UK(t),n=qi().gapi;return Ve(n,t,"internal-error"),e.open({where:document.body,url:XK(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qK,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=yi(t,"network-request-failed"),a=qi().setTimeout(()=>{i(o)},WK.get());function l(){qi().clearTimeout(a),r(s)}s.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QK={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},JK=500,ZK=600,eX="_blank",tX="http://localhost";class yR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function nX(t,e,n,s=JK,r=ZK){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l=Object.assign(Object.assign({},QK),{width:s.toString(),height:r.toString(),top:i,left:o}),c=Ns().toLowerCase();n&&(a=d3(c)?eX:n),c3(c)&&(e=e||tX,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[p,f])=>`${h}${p}=${f},`,"");if(bq(c)&&a!=="_self")return sX(e||"",a),new yR(null);const d=window.open(e||"",a,u);Ve(d,t,"popup-blocked");try{d.focus()}catch{}return new yR(d)}function sX(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rX="__/auth/handler",iX="emulator/auth/handler",oX=encodeURIComponent("fac");async function xR(t,e,n,s,r,i){Ve(t.config.authDomain,t,"auth-domain-config-required"),Ve(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Kc,eventId:r};if(e instanceof K0){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",B8(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof km){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${oX}=${encodeURIComponent(l)}`:"";return`${aX(t)}?${bm(a).slice(1)}${c}`}function aX({config:t}){return t.emulator?MN(t,iX):`https://${t.authDomain}/${rX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI="webStorageSupport";class lX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_3,this._completeRedirectFn=O3,this._overrideRedirectResult=CK}async _openPopup(e,n,s,r){var i;jo((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await xR(e,n,s,rS(),r);return nX(e,o,UN())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await xR(e,n,s,rS(),r);return uK(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(jo(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await YK(e),s=new PK(e);return n.register("authEvent",r=>(Ve(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(TI,{type:TI},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[TI];o!==void 0&&n(!!o),Qr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=VK(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return g3()||u3()||zN()}}const cX=lX;var vR="@firebase/auth",bR="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dX(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function hX(t){kc(new Za("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;Ve(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y3(t)},c=new Nq(s,r,i,l);return Oq(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),kc(new Za("auth-internal",e=>{const n=Ei(e.getProvider("auth").getImmediate());return(s=>new uX(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Gi(vR,bR,dX(t)),Gi(vR,bR,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pX=5*60,fX=qL("authIdTokenMaxAge")||pX;let wR=null;const mX=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>fX)return;const r=n==null?void 0:n.token;wR!==r&&(wR=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function gX(t=PN()){const e=H0(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Pq(t,{popupRedirectResolver:cX,persistence:[vK,T3,_3]}),s=qL("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=mX(i.toString());sK(n,o,()=>o(n.currentUser)),nK(n,a=>o(a))}}const r=WL("auth");return r&&Fq(n,`http://${r}`),n}function yX(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}_q({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=yi("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",yX().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});hX("Browser");var IR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uc,L3;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,S){function E(){}E.prototype=S.prototype,T.D=S.prototype,T.prototype=new E,T.prototype.constructor=T,T.C=function($,P,F){for(var R=Array(arguments.length-2),G=2;G<arguments.length;G++)R[G-2]=arguments[G];return S.prototype[P].apply($,R)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,n),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(T,S,E){E||(E=0);var $=Array(16);if(typeof S=="string")for(var P=0;16>P;++P)$[P]=S.charCodeAt(E++)|S.charCodeAt(E++)<<8|S.charCodeAt(E++)<<16|S.charCodeAt(E++)<<24;else for(P=0;16>P;++P)$[P]=S[E++]|S[E++]<<8|S[E++]<<16|S[E++]<<24;S=T.g[0],E=T.g[1],P=T.g[2];var F=T.g[3],R=S+(F^E&(P^F))+$[0]+3614090360&4294967295;S=E+(R<<7&4294967295|R>>>25),R=F+(P^S&(E^P))+$[1]+3905402710&4294967295,F=S+(R<<12&4294967295|R>>>20),R=P+(E^F&(S^E))+$[2]+606105819&4294967295,P=F+(R<<17&4294967295|R>>>15),R=E+(S^P&(F^S))+$[3]+3250441966&4294967295,E=P+(R<<22&4294967295|R>>>10),R=S+(F^E&(P^F))+$[4]+4118548399&4294967295,S=E+(R<<7&4294967295|R>>>25),R=F+(P^S&(E^P))+$[5]+1200080426&4294967295,F=S+(R<<12&4294967295|R>>>20),R=P+(E^F&(S^E))+$[6]+2821735955&4294967295,P=F+(R<<17&4294967295|R>>>15),R=E+(S^P&(F^S))+$[7]+4249261313&4294967295,E=P+(R<<22&4294967295|R>>>10),R=S+(F^E&(P^F))+$[8]+1770035416&4294967295,S=E+(R<<7&4294967295|R>>>25),R=F+(P^S&(E^P))+$[9]+2336552879&4294967295,F=S+(R<<12&4294967295|R>>>20),R=P+(E^F&(S^E))+$[10]+4294925233&4294967295,P=F+(R<<17&4294967295|R>>>15),R=E+(S^P&(F^S))+$[11]+2304563134&4294967295,E=P+(R<<22&4294967295|R>>>10),R=S+(F^E&(P^F))+$[12]+1804603682&4294967295,S=E+(R<<7&4294967295|R>>>25),R=F+(P^S&(E^P))+$[13]+4254626195&4294967295,F=S+(R<<12&4294967295|R>>>20),R=P+(E^F&(S^E))+$[14]+2792965006&4294967295,P=F+(R<<17&4294967295|R>>>15),R=E+(S^P&(F^S))+$[15]+1236535329&4294967295,E=P+(R<<22&4294967295|R>>>10),R=S+(P^F&(E^P))+$[1]+4129170786&4294967295,S=E+(R<<5&4294967295|R>>>27),R=F+(E^P&(S^E))+$[6]+3225465664&4294967295,F=S+(R<<9&4294967295|R>>>23),R=P+(S^E&(F^S))+$[11]+643717713&4294967295,P=F+(R<<14&4294967295|R>>>18),R=E+(F^S&(P^F))+$[0]+3921069994&4294967295,E=P+(R<<20&4294967295|R>>>12),R=S+(P^F&(E^P))+$[5]+3593408605&4294967295,S=E+(R<<5&4294967295|R>>>27),R=F+(E^P&(S^E))+$[10]+38016083&4294967295,F=S+(R<<9&4294967295|R>>>23),R=P+(S^E&(F^S))+$[15]+3634488961&4294967295,P=F+(R<<14&4294967295|R>>>18),R=E+(F^S&(P^F))+$[4]+3889429448&4294967295,E=P+(R<<20&4294967295|R>>>12),R=S+(P^F&(E^P))+$[9]+568446438&4294967295,S=E+(R<<5&4294967295|R>>>27),R=F+(E^P&(S^E))+$[14]+3275163606&4294967295,F=S+(R<<9&4294967295|R>>>23),R=P+(S^E&(F^S))+$[3]+4107603335&4294967295,P=F+(R<<14&4294967295|R>>>18),R=E+(F^S&(P^F))+$[8]+1163531501&4294967295,E=P+(R<<20&4294967295|R>>>12),R=S+(P^F&(E^P))+$[13]+2850285829&4294967295,S=E+(R<<5&4294967295|R>>>27),R=F+(E^P&(S^E))+$[2]+4243563512&4294967295,F=S+(R<<9&4294967295|R>>>23),R=P+(S^E&(F^S))+$[7]+1735328473&4294967295,P=F+(R<<14&4294967295|R>>>18),R=E+(F^S&(P^F))+$[12]+2368359562&4294967295,E=P+(R<<20&4294967295|R>>>12),R=S+(E^P^F)+$[5]+4294588738&4294967295,S=E+(R<<4&4294967295|R>>>28),R=F+(S^E^P)+$[8]+2272392833&4294967295,F=S+(R<<11&4294967295|R>>>21),R=P+(F^S^E)+$[11]+1839030562&4294967295,P=F+(R<<16&4294967295|R>>>16),R=E+(P^F^S)+$[14]+4259657740&4294967295,E=P+(R<<23&4294967295|R>>>9),R=S+(E^P^F)+$[1]+2763975236&4294967295,S=E+(R<<4&4294967295|R>>>28),R=F+(S^E^P)+$[4]+1272893353&4294967295,F=S+(R<<11&4294967295|R>>>21),R=P+(F^S^E)+$[7]+4139469664&4294967295,P=F+(R<<16&4294967295|R>>>16),R=E+(P^F^S)+$[10]+3200236656&4294967295,E=P+(R<<23&4294967295|R>>>9),R=S+(E^P^F)+$[13]+681279174&4294967295,S=E+(R<<4&4294967295|R>>>28),R=F+(S^E^P)+$[0]+3936430074&4294967295,F=S+(R<<11&4294967295|R>>>21),R=P+(F^S^E)+$[3]+3572445317&4294967295,P=F+(R<<16&4294967295|R>>>16),R=E+(P^F^S)+$[6]+76029189&4294967295,E=P+(R<<23&4294967295|R>>>9),R=S+(E^P^F)+$[9]+3654602809&4294967295,S=E+(R<<4&4294967295|R>>>28),R=F+(S^E^P)+$[12]+3873151461&4294967295,F=S+(R<<11&4294967295|R>>>21),R=P+(F^S^E)+$[15]+530742520&4294967295,P=F+(R<<16&4294967295|R>>>16),R=E+(P^F^S)+$[2]+3299628645&4294967295,E=P+(R<<23&4294967295|R>>>9),R=S+(P^(E|~F))+$[0]+4096336452&4294967295,S=E+(R<<6&4294967295|R>>>26),R=F+(E^(S|~P))+$[7]+1126891415&4294967295,F=S+(R<<10&4294967295|R>>>22),R=P+(S^(F|~E))+$[14]+2878612391&4294967295,P=F+(R<<15&4294967295|R>>>17),R=E+(F^(P|~S))+$[5]+4237533241&4294967295,E=P+(R<<21&4294967295|R>>>11),R=S+(P^(E|~F))+$[12]+1700485571&4294967295,S=E+(R<<6&4294967295|R>>>26),R=F+(E^(S|~P))+$[3]+2399980690&4294967295,F=S+(R<<10&4294967295|R>>>22),R=P+(S^(F|~E))+$[10]+4293915773&4294967295,P=F+(R<<15&4294967295|R>>>17),R=E+(F^(P|~S))+$[1]+2240044497&4294967295,E=P+(R<<21&4294967295|R>>>11),R=S+(P^(E|~F))+$[8]+1873313359&4294967295,S=E+(R<<6&4294967295|R>>>26),R=F+(E^(S|~P))+$[15]+4264355552&4294967295,F=S+(R<<10&4294967295|R>>>22),R=P+(S^(F|~E))+$[6]+2734768916&4294967295,P=F+(R<<15&4294967295|R>>>17),R=E+(F^(P|~S))+$[13]+1309151649&4294967295,E=P+(R<<21&4294967295|R>>>11),R=S+(P^(E|~F))+$[4]+4149444226&4294967295,S=E+(R<<6&4294967295|R>>>26),R=F+(E^(S|~P))+$[11]+3174756917&4294967295,F=S+(R<<10&4294967295|R>>>22),R=P+(S^(F|~E))+$[2]+718787259&4294967295,P=F+(R<<15&4294967295|R>>>17),R=E+(F^(P|~S))+$[9]+3951481745&4294967295,T.g[0]=T.g[0]+S&4294967295,T.g[1]=T.g[1]+(P+(R<<21&4294967295|R>>>11))&4294967295,T.g[2]=T.g[2]+P&4294967295,T.g[3]=T.g[3]+F&4294967295}s.prototype.u=function(T,S){S===void 0&&(S=T.length);for(var E=S-this.blockSize,$=this.B,P=this.h,F=0;F<S;){if(P==0)for(;F<=E;)r(this,T,F),F+=this.blockSize;if(typeof T=="string"){for(;F<S;)if($[P++]=T.charCodeAt(F++),P==this.blockSize){r(this,$),P=0;break}}else for(;F<S;)if($[P++]=T[F++],P==this.blockSize){r(this,$),P=0;break}}this.h=P,this.o+=S},s.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var S=1;S<T.length-8;++S)T[S]=0;var E=8*this.o;for(S=T.length-8;S<T.length;++S)T[S]=E&255,E/=256;for(this.u(T),T=Array(16),S=E=0;4>S;++S)for(var $=0;32>$;$+=8)T[E++]=this.g[S]>>>$&255;return T};function i(T,S){var E=a;return Object.prototype.hasOwnProperty.call(E,T)?E[T]:E[T]=S(T)}function o(T,S){this.h=S;for(var E=[],$=!0,P=T.length-1;0<=P;P--){var F=T[P]|0;$&&F==S||(E[P]=F,$=!1)}this.g=E}var a={};function l(T){return-128<=T&&128>T?i(T,function(S){return new o([S|0],0>S?-1:0)}):new o([T|0],0>T?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return d;if(0>T)return y(c(-T));for(var S=[],E=1,$=0;T>=E;$++)S[$]=T/E|0,E*=4294967296;return new o(S,0)}function u(T,S){if(T.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(T.charAt(0)=="-")return y(u(T.substring(1),S));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=c(Math.pow(S,8)),$=d,P=0;P<T.length;P+=8){var F=Math.min(8,T.length-P),R=parseInt(T.substring(P,P+F),S);8>F?(F=c(Math.pow(S,F)),$=$.j(F).add(c(R))):($=$.j(E),$=$.add(c(R)))}return $}var d=l(0),h=l(1),p=l(16777216);t=o.prototype,t.m=function(){if(g(this))return-y(this).m();for(var T=0,S=1,E=0;E<this.g.length;E++){var $=this.i(E);T+=(0<=$?$:4294967296+$)*S,S*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(f(this))return"0";if(g(this))return"-"+y(this).toString(T);for(var S=c(Math.pow(T,6)),E=this,$="";;){var P=I(E,S).g;E=x(E,P.j(S));var F=((0<E.g.length?E.g[0]:E.h)>>>0).toString(T);if(E=P,f(E))return F+$;for(;6>F.length;)F="0"+F;$=F+$}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function f(T){if(T.h!=0)return!1;for(var S=0;S<T.g.length;S++)if(T.g[S]!=0)return!1;return!0}function g(T){return T.h==-1}t.l=function(T){return T=x(this,T),g(T)?-1:f(T)?0:1};function y(T){for(var S=T.g.length,E=[],$=0;$<S;$++)E[$]=~T.g[$];return new o(E,~T.h).add(h)}t.abs=function(){return g(this)?y(this):this},t.add=function(T){for(var S=Math.max(this.g.length,T.g.length),E=[],$=0,P=0;P<=S;P++){var F=$+(this.i(P)&65535)+(T.i(P)&65535),R=(F>>>16)+(this.i(P)>>>16)+(T.i(P)>>>16);$=R>>>16,F&=65535,R&=65535,E[P]=R<<16|F}return new o(E,E[E.length-1]&-2147483648?-1:0)};function x(T,S){return T.add(y(S))}t.j=function(T){if(f(this)||f(T))return d;if(g(this))return g(T)?y(this).j(y(T)):y(y(this).j(T));if(g(T))return y(this.j(y(T)));if(0>this.l(p)&&0>T.l(p))return c(this.m()*T.m());for(var S=this.g.length+T.g.length,E=[],$=0;$<2*S;$++)E[$]=0;for($=0;$<this.g.length;$++)for(var P=0;P<T.g.length;P++){var F=this.i($)>>>16,R=this.i($)&65535,G=T.i(P)>>>16,q=T.i(P)&65535;E[2*$+2*P]+=R*q,v(E,2*$+2*P),E[2*$+2*P+1]+=F*q,v(E,2*$+2*P+1),E[2*$+2*P+1]+=R*G,v(E,2*$+2*P+1),E[2*$+2*P+2]+=F*G,v(E,2*$+2*P+2)}for($=0;$<S;$++)E[$]=E[2*$+1]<<16|E[2*$];for($=S;$<2*S;$++)E[$]=0;return new o(E,0)};function v(T,S){for(;(T[S]&65535)!=T[S];)T[S+1]+=T[S]>>>16,T[S]&=65535,S++}function w(T,S){this.g=T,this.h=S}function I(T,S){if(f(S))throw Error("division by zero");if(f(T))return new w(d,d);if(g(T))return S=I(y(T),S),new w(y(S.g),y(S.h));if(g(S))return S=I(T,y(S)),new w(y(S.g),S.h);if(30<T.g.length){if(g(T)||g(S))throw Error("slowDivide_ only works with positive integers.");for(var E=h,$=S;0>=$.l(T);)E=N(E),$=N($);var P=A(E,1),F=A($,1);for($=A($,2),E=A(E,2);!f($);){var R=F.add($);0>=R.l(T)&&(P=P.add(E),F=R),$=A($,1),E=A(E,1)}return S=x(T,P.j(S)),new w(P,S)}for(P=d;0<=T.l(S);){for(E=Math.max(1,Math.floor(T.m()/S.m())),$=Math.ceil(Math.log(E)/Math.LN2),$=48>=$?1:Math.pow(2,$-48),F=c(E),R=F.j(S);g(R)||0<R.l(T);)E-=$,F=c(E),R=F.j(S);f(F)&&(F=h),P=P.add(F),T=x(T,R)}return new w(P,T)}t.A=function(T){return I(this,T).h},t.and=function(T){for(var S=Math.max(this.g.length,T.g.length),E=[],$=0;$<S;$++)E[$]=this.i($)&T.i($);return new o(E,this.h&T.h)},t.or=function(T){for(var S=Math.max(this.g.length,T.g.length),E=[],$=0;$<S;$++)E[$]=this.i($)|T.i($);return new o(E,this.h|T.h)},t.xor=function(T){for(var S=Math.max(this.g.length,T.g.length),E=[],$=0;$<S;$++)E[$]=this.i($)^T.i($);return new o(E,this.h^T.h)};function N(T){for(var S=T.g.length+1,E=[],$=0;$<S;$++)E[$]=T.i($)<<1|T.i($-1)>>>31;return new o(E,T.h)}function A(T,S){var E=S>>5;S%=32;for(var $=T.g.length-E,P=[],F=0;F<$;F++)P[F]=0<S?T.i(F+E)>>>S|T.i(F+E+1)<<32-S:T.i(F+E);return new o(P,T.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,L3=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,uc=o}).apply(typeof IR<"u"?IR:typeof self<"u"?self:typeof window<"u"?window:{});var tx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var M3,Bp,V3,Gx,aS,z3,j3,B3;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,k,C){return m==Array.prototype||m==Object.prototype||(m[k]=C.value),m};function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof tx=="object"&&tx];for(var k=0;k<m.length;++k){var C=m[k];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var s=n(this);function r(m,k){if(k)e:{var C=s;m=m.split(".");for(var L=0;L<m.length-1;L++){var Y=m[L];if(!(Y in C))break e;C=C[Y]}m=m[m.length-1],L=C[m],k=k(L),k!=L&&k!=null&&e(C,m,{configurable:!0,writable:!0,value:k})}}function i(m,k){m instanceof String&&(m+="");var C=0,L=!1,Y={next:function(){if(!L&&C<m.length){var ne=C++;return{value:k(ne,m[ne]),done:!1}}return L=!0,{done:!0,value:void 0}}};return Y[Symbol.iterator]=function(){return Y},Y}r("Array.prototype.values",function(m){return m||function(){return i(this,function(k,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(m){var k=typeof m;return k=k!="object"?k:m?Array.isArray(m)?"array":k:"null",k=="array"||k=="object"&&typeof m.length=="number"}function c(m){var k=typeof m;return k=="object"&&m!=null||k=="function"}function u(m,k,C){return m.call.apply(m.bind,arguments)}function d(m,k,C){if(!m)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var Y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Y,L),m.apply(k,Y)}}return function(){return m.apply(k,arguments)}}function h(m,k,C){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,h.apply(null,arguments)}function p(m,k){var C=Array.prototype.slice.call(arguments,1);return function(){var L=C.slice();return L.push.apply(L,arguments),m.apply(this,L)}}function f(m,k){function C(){}C.prototype=k.prototype,m.aa=k.prototype,m.prototype=new C,m.prototype.constructor=m,m.Qb=function(L,Y,ne){for(var ge=Array(arguments.length-2),Et=2;Et<arguments.length;Et++)ge[Et-2]=arguments[Et];return k.prototype[Y].apply(L,ge)}}function g(m){const k=m.length;if(0<k){const C=Array(k);for(let L=0;L<k;L++)C[L]=m[L];return C}return[]}function y(m,k){for(let C=1;C<arguments.length;C++){const L=arguments[C];if(l(L)){const Y=m.length||0,ne=L.length||0;m.length=Y+ne;for(let ge=0;ge<ne;ge++)m[Y+ge]=L[ge]}else m.push(L)}}class x{constructor(k,C){this.i=k,this.j=C,this.h=0,this.g=null}get(){let k;return 0<this.h?(this.h--,k=this.g,this.g=k.next,k.next=null):k=this.i(),k}}function v(m){return/^[\s\xa0]*$/.test(m)}function w(){var m=a.navigator;return m&&(m=m.userAgent)?m:""}function I(m){return I[" "](m),m}I[" "]=function(){};var N=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function A(m,k,C){for(const L in m)k.call(C,m[L],L,m)}function T(m,k){for(const C in m)k.call(void 0,m[C],C,m)}function S(m){const k={};for(const C in m)k[C]=m[C];return k}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(m,k){let C,L;for(let Y=1;Y<arguments.length;Y++){L=arguments[Y];for(C in L)m[C]=L[C];for(let ne=0;ne<E.length;ne++)C=E[ne],Object.prototype.hasOwnProperty.call(L,C)&&(m[C]=L[C])}}function P(m){var k=1;m=m.split(":");const C=[];for(;0<k&&m.length;)C.push(m.shift()),k--;return m.length&&C.push(m.join(":")),C}function F(m){a.setTimeout(()=>{throw m},0)}function R(){var m=H;let k=null;return m.g&&(k=m.g,m.g=m.g.next,m.g||(m.h=null),k.next=null),k}class G{constructor(){this.h=this.g=null}add(k,C){const L=q.get();L.set(k,C),this.h?this.h.next=L:this.g=L,this.h=L}}var q=new x(()=>new Q,m=>m.reset());class Q{constructor(){this.next=this.g=this.h=null}set(k,C){this.h=k,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let te,B=!1,H=new G,Z=()=>{const m=a.Promise.resolve(void 0);te=()=>{m.then(se)}};var se=()=>{for(var m;m=R();){try{m.h.call(m.g)}catch(C){F(C)}var k=q;k.j(m),100>k.h&&(k.h++,m.next=k.g,k.g=m)}B=!1};function re(){this.s=this.s,this.C=this.C}re.prototype.s=!1,re.prototype.ma=function(){this.s||(this.s=!0,this.N())},re.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(m,k){this.type=m,this.g=this.target=k,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var de=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var m=!1,k=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const C=()=>{};a.addEventListener("test",C,k),a.removeEventListener("test",C,k)}catch{}return m}();function ce(m,k){if(ie.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var C=this.type=m.type,L=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=k,k=m.relatedTarget){if(N){e:{try{I(k.nodeName);var Y=!0;break e}catch{}Y=!1}Y||(k=null)}}else C=="mouseover"?k=m.fromElement:C=="mouseout"&&(k=m.toElement);this.relatedTarget=k,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:pe[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&ce.aa.h.call(this)}}f(ce,ie);var pe={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var we="closure_listenable_"+(1e6*Math.random()|0),De=0;function $e(m,k,C,L,Y){this.listener=m,this.proxy=null,this.src=k,this.type=C,this.capture=!!L,this.ha=Y,this.key=++De,this.da=this.fa=!1}function Oe(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function ve(m){this.src=m,this.g={},this.h=0}ve.prototype.add=function(m,k,C,L,Y){var ne=m.toString();m=this.g[ne],m||(m=this.g[ne]=[],this.h++);var ge=ze(m,k,L,Y);return-1<ge?(k=m[ge],C||(k.fa=!1)):(k=new $e(k,this.src,ne,!!L,Y),k.fa=C,m.push(k)),k};function Le(m,k){var C=k.type;if(C in m.g){var L=m.g[C],Y=Array.prototype.indexOf.call(L,k,void 0),ne;(ne=0<=Y)&&Array.prototype.splice.call(L,Y,1),ne&&(Oe(k),m.g[C].length==0&&(delete m.g[C],m.h--))}}function ze(m,k,C,L){for(var Y=0;Y<m.length;++Y){var ne=m[Y];if(!ne.da&&ne.listener==k&&ne.capture==!!C&&ne.ha==L)return Y}return-1}var it="closure_lm_"+(1e6*Math.random()|0),ct={};function ot(m,k,C,L,Y){if(Array.isArray(k)){for(var ne=0;ne<k.length;ne++)ot(m,k[ne],C,L,Y);return null}return C=Ae(C),m&&m[we]?m.K(k,C,c(L)?!!L.capture:!!L,Y):ht(m,k,C,!1,L,Y)}function ht(m,k,C,L,Y,ne){if(!k)throw Error("Invalid event type");var ge=c(Y)?!!Y.capture:!!Y,Et=pr(m);if(Et||(m[it]=Et=new ve(m)),C=Et.add(k,C,L,ge,ne),C.proxy)return C;if(L=yt(),C.proxy=L,L.src=m,L.listener=C,m.addEventListener)de||(Y=ge),Y===void 0&&(Y=!1),m.addEventListener(k.toString(),L,Y);else if(m.attachEvent)m.attachEvent(hr(k.toString()),L);else if(m.addListener&&m.removeListener)m.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return C}function yt(){function m(C){return k.call(m.src,m.listener,C)}const k=Qn;return m}function Yn(m,k,C,L,Y){if(Array.isArray(k))for(var ne=0;ne<k.length;ne++)Yn(m,k[ne],C,L,Y);else L=c(L)?!!L.capture:!!L,C=Ae(C),m&&m[we]?(m=m.i,k=String(k).toString(),k in m.g&&(ne=m.g[k],C=ze(ne,C,L,Y),-1<C&&(Oe(ne[C]),Array.prototype.splice.call(ne,C,1),ne.length==0&&(delete m.g[k],m.h--)))):m&&(m=pr(m))&&(k=m.g[k.toString()],m=-1,k&&(m=ze(k,C,L,Y)),(C=-1<m?k[m]:null)&&Nt(C))}function Nt(m){if(typeof m!="number"&&m&&!m.da){var k=m.src;if(k&&k[we])Le(k.i,m);else{var C=m.type,L=m.proxy;k.removeEventListener?k.removeEventListener(C,L,m.capture):k.detachEvent?k.detachEvent(hr(C),L):k.addListener&&k.removeListener&&k.removeListener(L),(C=pr(k))?(Le(C,m),C.h==0&&(C.src=null,k[it]=null)):Oe(m)}}}function hr(m){return m in ct?ct[m]:ct[m]="on"+m}function Qn(m,k){if(m.da)m=!0;else{k=new ce(k,this);var C=m.listener,L=m.ha||m.src;m.fa&&Nt(m),m=C.call(L,k)}return m}function pr(m){return m=m[it],m instanceof ve?m:null}var fe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ae(m){return typeof m=="function"?m:(m[fe]||(m[fe]=function(k){return m.handleEvent(k)}),m[fe])}function je(){re.call(this),this.i=new ve(this),this.M=this,this.F=null}f(je,re),je.prototype[we]=!0,je.prototype.removeEventListener=function(m,k,C,L){Yn(this,m,k,C,L)};function He(m,k){var C,L=m.F;if(L)for(C=[];L;L=L.F)C.push(L);if(m=m.M,L=k.type||k,typeof k=="string")k=new ie(k,m);else if(k instanceof ie)k.target=k.target||m;else{var Y=k;k=new ie(L,m),$(k,Y)}if(Y=!0,C)for(var ne=C.length-1;0<=ne;ne--){var ge=k.g=C[ne];Y=_t(ge,L,!0,k)&&Y}if(ge=k.g=m,Y=_t(ge,L,!0,k)&&Y,Y=_t(ge,L,!1,k)&&Y,C)for(ne=0;ne<C.length;ne++)ge=k.g=C[ne],Y=_t(ge,L,!1,k)&&Y}je.prototype.N=function(){if(je.aa.N.call(this),this.i){var m=this.i,k;for(k in m.g){for(var C=m.g[k],L=0;L<C.length;L++)Oe(C[L]);delete m.g[k],m.h--}}this.F=null},je.prototype.K=function(m,k,C,L){return this.i.add(String(m),k,!1,C,L)},je.prototype.L=function(m,k,C,L){return this.i.add(String(m),k,!0,C,L)};function _t(m,k,C,L){if(k=m.i.g[String(k)],!k)return!0;k=k.concat();for(var Y=!0,ne=0;ne<k.length;++ne){var ge=k[ne];if(ge&&!ge.da&&ge.capture==C){var Et=ge.listener,Jn=ge.ha||ge.src;ge.fa&&Le(m.i,ge),Y=Et.call(Jn,L)!==!1&&Y}}return Y&&!L.defaultPrevented}function qs(m,k,C){if(typeof m=="function")C&&(m=h(m,C));else if(m&&typeof m.handleEvent=="function")m=h(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(k)?-1:a.setTimeout(m,k||0)}function fr(m){m.g=qs(()=>{m.g=null,m.i&&(m.i=!1,fr(m))},m.l);const k=m.h;m.h=null,m.m.apply(null,k)}class fo extends re{constructor(k,C){super(),this.m=k,this.l=C,this.h=null,this.i=!1,this.g=null}j(k){this.h=arguments,this.g?this.i=!0:fr(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ni(m){re.call(this),this.h=m,this.g={}}f(ni,re);var si=[];function mo(m){A(m.g,function(k,C){this.g.hasOwnProperty(C)&&Nt(k)},m),m.g={}}ni.prototype.N=function(){ni.aa.N.call(this),mo(this)},ni.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var go=a.JSON.stringify,sp=a.JSON.parse,rp=class{stringify(m){return a.JSON.stringify(m,void 0)}parse(m){return a.JSON.parse(m,void 0)}};function Rl(){}Rl.prototype.h=null;function wy(m){return m.h||(m.h=m.i())}function M2(){}var ip={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function R1(){ie.call(this,"d")}f(R1,ie);function D1(){ie.call(this,"c")}f(D1,ie);var Dl={},V2=null;function Iy(){return V2=V2||new je}Dl.La="serverreachability";function z2(m){ie.call(this,Dl.La,m)}f(z2,ie);function op(m){const k=Iy();He(k,new z2(k))}Dl.STAT_EVENT="statevent";function j2(m,k){ie.call(this,Dl.STAT_EVENT,m),this.stat=k}f(j2,ie);function As(m){const k=Iy();He(k,new j2(k,m))}Dl.Ma="timingevent";function B2(m,k){ie.call(this,Dl.Ma,m),this.size=k}f(B2,ie);function ap(m,k){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){m()},k)}function lp(){this.g=!0}lp.prototype.xa=function(){this.g=!1};function N5(m,k,C,L,Y,ne){m.info(function(){if(m.g)if(ne)for(var ge="",Et=ne.split("&"),Jn=0;Jn<Et.length;Jn++){var ft=Et[Jn].split("=");if(1<ft.length){var ds=ft[0];ft=ft[1];var hs=ds.split("_");ge=2<=hs.length&&hs[1]=="type"?ge+(ds+"="+ft+"&"):ge+(ds+"=redacted&")}}else ge=null;else ge=ne;return"XMLHTTP REQ ("+L+") [attempt "+Y+"]: "+k+`
`+C+`
`+ge})}function _5(m,k,C,L,Y,ne,ge){m.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+Y+"]: "+k+`
`+C+`
`+ne+" "+ge})}function fu(m,k,C,L){m.info(function(){return"XMLHTTP TEXT ("+k+"): "+C5(m,C)+(L?" "+L:"")})}function E5(m,k){m.info(function(){return"TIMEOUT: "+k})}lp.prototype.info=function(){};function C5(m,k){if(!m.g)return k;if(!k)return null;try{var C=JSON.parse(k);if(C){for(m=0;m<C.length;m++)if(Array.isArray(C[m])){var L=C[m];if(!(2>L.length)){var Y=L[1];if(Array.isArray(Y)&&!(1>Y.length)){var ne=Y[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(var ge=1;ge<Y.length;ge++)Y[ge]=""}}}}return go(C)}catch{return k}}var ky={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},U2={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},P1;function Sy(){}f(Sy,Rl),Sy.prototype.g=function(){return new XMLHttpRequest},Sy.prototype.i=function(){return{}},P1=new Sy;function ha(m,k,C,L){this.j=m,this.i=k,this.l=C,this.R=L||1,this.U=new ni(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new W2}function W2(){this.i=null,this.g="",this.h=!1}var G2={},O1={};function F1(m,k,C){m.L=1,m.v=Ey(yo(k)),m.m=C,m.P=!0,H2(m,null)}function H2(m,k){m.F=Date.now(),Ty(m),m.A=yo(m.v);var C=m.A,L=m.R;Array.isArray(L)||(L=[String(L)]),o$(C.i,"t",L),m.C=0,C=m.j.J,m.h=new W2,m.g=S$(m.j,C?k:null,!m.m),0<m.O&&(m.M=new fo(h(m.Y,m,m.g),m.O)),k=m.U,C=m.g,L=m.ca;var Y="readystatechange";Array.isArray(Y)||(Y&&(si[0]=Y.toString()),Y=si);for(var ne=0;ne<Y.length;ne++){var ge=ot(C,Y[ne],L||k.handleEvent,!1,k.h||k);if(!ge)break;k.g[ge.key]=ge}k=m.H?S(m.H):{},m.m?(m.u||(m.u="POST"),k["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,k)):(m.u="GET",m.g.ea(m.A,m.u,null,k)),op(),N5(m.i,m.u,m.A,m.l,m.R,m.m)}ha.prototype.ca=function(m){m=m.target;const k=this.M;k&&xo(m)==3?k.j():this.Y(m)},ha.prototype.Y=function(m){try{if(m==this.g)e:{const hs=xo(this.g);var k=this.g.Ba();const yu=this.g.Z();if(!(3>hs)&&(hs!=3||this.g&&(this.h.h||this.g.oa()||p$(this.g)))){this.J||hs!=4||k==7||(k==8||0>=yu?op(3):op(2)),L1(this);var C=this.g.Z();this.X=C;t:if(q2(this)){var L=p$(this.g);m="";var Y=L.length,ne=xo(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Pl(this),cp(this);var ge="";break t}this.h.i=new a.TextDecoder}for(k=0;k<Y;k++)this.h.h=!0,m+=this.h.i.decode(L[k],{stream:!(ne&&k==Y-1)});L.length=0,this.h.g+=m,this.C=0,ge=this.h.g}else ge=this.g.oa();if(this.o=C==200,_5(this.i,this.u,this.A,this.l,this.R,hs,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Et,Jn=this.g;if((Et=Jn.g?Jn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Et)){var ft=Et;break t}}ft=null}if(C=ft)fu(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,M1(this,C);else{this.o=!1,this.s=3,As(12),Pl(this),cp(this);break e}}if(this.P){C=!0;let ri;for(;!this.J&&this.C<ge.length;)if(ri=$5(this,ge),ri==O1){hs==4&&(this.s=4,As(14),C=!1),fu(this.i,this.l,null,"[Incomplete Response]");break}else if(ri==G2){this.s=4,As(15),fu(this.i,this.l,ge,"[Invalid Chunk]"),C=!1;break}else fu(this.i,this.l,ri,null),M1(this,ri);if(q2(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),hs!=4||ge.length!=0||this.h.h||(this.s=1,As(16),C=!1),this.o=this.o&&C,!C)fu(this.i,this.l,ge,"[Invalid Chunked Response]"),Pl(this),cp(this);else if(0<ge.length&&!this.W){this.W=!0;var ds=this.j;ds.g==this&&ds.ba&&!ds.M&&(ds.j.info("Great, no buffering proxy detected. Bytes received: "+ge.length),W1(ds),ds.M=!0,As(11))}}else fu(this.i,this.l,ge,null),M1(this,ge);hs==4&&Pl(this),this.o&&!this.J&&(hs==4?b$(this.j,this):(this.o=!1,Ty(this)))}else q5(this.g),C==400&&0<ge.indexOf("Unknown SID")?(this.s=3,As(12)):(this.s=0,As(13)),Pl(this),cp(this)}}}catch{}finally{}};function q2(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function $5(m,k){var C=m.C,L=k.indexOf(`
`,C);return L==-1?O1:(C=Number(k.substring(C,L)),isNaN(C)?G2:(L+=1,L+C>k.length?O1:(k=k.slice(L,L+C),m.C=L+C,k)))}ha.prototype.cancel=function(){this.J=!0,Pl(this)};function Ty(m){m.S=Date.now()+m.I,K2(m,m.I)}function K2(m,k){if(m.B!=null)throw Error("WatchDog timer not null");m.B=ap(h(m.ba,m),k)}function L1(m){m.B&&(a.clearTimeout(m.B),m.B=null)}ha.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(E5(this.i,this.A),this.L!=2&&(op(),As(17)),Pl(this),this.s=2,cp(this)):K2(this,this.S-m)};function cp(m){m.j.G==0||m.J||b$(m.j,m)}function Pl(m){L1(m);var k=m.M;k&&typeof k.ma=="function"&&k.ma(),m.M=null,mo(m.U),m.g&&(k=m.g,m.g=null,k.abort(),k.ma())}function M1(m,k){try{var C=m.j;if(C.G!=0&&(C.g==m||V1(C.h,m))){if(!m.K&&V1(C.h,m)&&C.G==3){try{var L=C.Da.g.parse(k)}catch{L=null}if(Array.isArray(L)&&L.length==3){var Y=L;if(Y[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<m.F)Py(C),Ry(C);else break e;U1(C),As(18)}}else C.za=Y[1],0<C.za-C.T&&37500>Y[2]&&C.F&&C.v==0&&!C.C&&(C.C=ap(h(C.Za,C),6e3));if(1>=Q2(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Fl(C,11)}else if((m.K||C.g==m)&&Py(C),!v(k))for(Y=C.Da.g.parse(k),k=0;k<Y.length;k++){let ft=Y[k];if(C.T=ft[0],ft=ft[1],C.G==2)if(ft[0]=="c"){C.K=ft[1],C.ia=ft[2];const ds=ft[3];ds!=null&&(C.la=ds,C.j.info("VER="+C.la));const hs=ft[4];hs!=null&&(C.Aa=hs,C.j.info("SVER="+C.Aa));const yu=ft[5];yu!=null&&typeof yu=="number"&&0<yu&&(L=1.5*yu,C.L=L,C.j.info("backChannelRequestTimeoutMs_="+L)),L=C;const ri=m.g;if(ri){const Fy=ri.g?ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fy){var ne=L.h;ne.g||Fy.indexOf("spdy")==-1&&Fy.indexOf("quic")==-1&&Fy.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(z1(ne,ne.h),ne.h=null))}if(L.D){const G1=ri.g?ri.g.getResponseHeader("X-HTTP-Session-Id"):null;G1&&(L.ya=G1,Ft(L.I,L.D,G1))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-m.F,C.j.info("Handshake RTT: "+C.R+"ms")),L=C;var ge=m;if(L.qa=k$(L,L.J?L.ia:null,L.W),ge.K){J2(L.h,ge);var Et=ge,Jn=L.L;Jn&&(Et.I=Jn),Et.B&&(L1(Et),Ty(Et)),L.g=ge}else x$(L);0<C.i.length&&Dy(C)}else ft[0]!="stop"&&ft[0]!="close"||Fl(C,7);else C.G==3&&(ft[0]=="stop"||ft[0]=="close"?ft[0]=="stop"?Fl(C,7):B1(C):ft[0]!="noop"&&C.l&&C.l.ta(ft),C.v=0)}}op(4)}catch{}}var A5=class{constructor(m,k){this.g=m,this.map=k}};function X2(m){this.l=m||10,a.PerformanceNavigationTiming?(m=a.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Y2(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Q2(m){return m.h?1:m.g?m.g.size:0}function V1(m,k){return m.h?m.h==k:m.g?m.g.has(k):!1}function z1(m,k){m.g?m.g.add(k):m.h=k}function J2(m,k){m.h&&m.h==k?m.h=null:m.g&&m.g.has(k)&&m.g.delete(k)}X2.prototype.cancel=function(){if(this.i=Z2(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Z2(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let k=m.i;for(const C of m.g.values())k=k.concat(C.D);return k}return g(m.i)}function R5(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(l(m)){for(var k=[],C=m.length,L=0;L<C;L++)k.push(m[L]);return k}k=[],C=0;for(L in m)k[C++]=m[L];return k}function D5(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(l(m)||typeof m=="string"){var k=[];m=m.length;for(var C=0;C<m;C++)k.push(C);return k}k=[],C=0;for(const L in m)k[C++]=L;return k}}}function e$(m,k){if(m.forEach&&typeof m.forEach=="function")m.forEach(k,void 0);else if(l(m)||typeof m=="string")Array.prototype.forEach.call(m,k,void 0);else for(var C=D5(m),L=R5(m),Y=L.length,ne=0;ne<Y;ne++)k.call(void 0,L[ne],C&&C[ne],m)}var t$=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function P5(m,k){if(m){m=m.split("&");for(var C=0;C<m.length;C++){var L=m[C].indexOf("="),Y=null;if(0<=L){var ne=m[C].substring(0,L);Y=m[C].substring(L+1)}else ne=m[C];k(ne,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function Ol(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof Ol){this.h=m.h,Ny(this,m.j),this.o=m.o,this.g=m.g,_y(this,m.s),this.l=m.l;var k=m.i,C=new hp;C.i=k.i,k.g&&(C.g=new Map(k.g),C.h=k.h),n$(this,C),this.m=m.m}else m&&(k=String(m).match(t$))?(this.h=!1,Ny(this,k[1]||"",!0),this.o=up(k[2]||""),this.g=up(k[3]||"",!0),_y(this,k[4]),this.l=up(k[5]||"",!0),n$(this,k[6]||"",!0),this.m=up(k[7]||"")):(this.h=!1,this.i=new hp(null,this.h))}Ol.prototype.toString=function(){var m=[],k=this.j;k&&m.push(dp(k,s$,!0),":");var C=this.g;return(C||k=="file")&&(m.push("//"),(k=this.o)&&m.push(dp(k,s$,!0),"@"),m.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&m.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&m.push("/"),m.push(dp(C,C.charAt(0)=="/"?L5:F5,!0))),(C=this.i.toString())&&m.push("?",C),(C=this.m)&&m.push("#",dp(C,V5)),m.join("")};function yo(m){return new Ol(m)}function Ny(m,k,C){m.j=C?up(k,!0):k,m.j&&(m.j=m.j.replace(/:$/,""))}function _y(m,k){if(k){if(k=Number(k),isNaN(k)||0>k)throw Error("Bad port number "+k);m.s=k}else m.s=null}function n$(m,k,C){k instanceof hp?(m.i=k,z5(m.i,m.h)):(C||(k=dp(k,M5)),m.i=new hp(k,m.h))}function Ft(m,k,C){m.i.set(k,C)}function Ey(m){return Ft(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function up(m,k){return m?k?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function dp(m,k,C){return typeof m=="string"?(m=encodeURI(m).replace(k,O5),C&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function O5(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var s$=/[#\/\?@]/g,F5=/[#\?:]/g,L5=/[#\?]/g,M5=/[#\?@]/g,V5=/#/g;function hp(m,k){this.h=this.g=null,this.i=m||null,this.j=!!k}function pa(m){m.g||(m.g=new Map,m.h=0,m.i&&P5(m.i,function(k,C){m.add(decodeURIComponent(k.replace(/\+/g," ")),C)}))}t=hp.prototype,t.add=function(m,k){pa(this),this.i=null,m=mu(this,m);var C=this.g.get(m);return C||this.g.set(m,C=[]),C.push(k),this.h+=1,this};function r$(m,k){pa(m),k=mu(m,k),m.g.has(k)&&(m.i=null,m.h-=m.g.get(k).length,m.g.delete(k))}function i$(m,k){return pa(m),k=mu(m,k),m.g.has(k)}t.forEach=function(m,k){pa(this),this.g.forEach(function(C,L){C.forEach(function(Y){m.call(k,Y,L,this)},this)},this)},t.na=function(){pa(this);const m=Array.from(this.g.values()),k=Array.from(this.g.keys()),C=[];for(let L=0;L<k.length;L++){const Y=m[L];for(let ne=0;ne<Y.length;ne++)C.push(k[L])}return C},t.V=function(m){pa(this);let k=[];if(typeof m=="string")i$(this,m)&&(k=k.concat(this.g.get(mu(this,m))));else{m=Array.from(this.g.values());for(let C=0;C<m.length;C++)k=k.concat(m[C])}return k},t.set=function(m,k){return pa(this),this.i=null,m=mu(this,m),i$(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[k]),this.h+=1,this},t.get=function(m,k){return m?(m=this.V(m),0<m.length?String(m[0]):k):k};function o$(m,k,C){r$(m,k),0<C.length&&(m.i=null,m.g.set(mu(m,k),g(C)),m.h+=C.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],k=Array.from(this.g.keys());for(var C=0;C<k.length;C++){var L=k[C];const ne=encodeURIComponent(String(L)),ge=this.V(L);for(L=0;L<ge.length;L++){var Y=ne;ge[L]!==""&&(Y+="="+encodeURIComponent(String(ge[L]))),m.push(Y)}}return this.i=m.join("&")};function mu(m,k){return k=String(k),m.j&&(k=k.toLowerCase()),k}function z5(m,k){k&&!m.j&&(pa(m),m.i=null,m.g.forEach(function(C,L){var Y=L.toLowerCase();L!=Y&&(r$(this,L),o$(this,Y,C))},m)),m.j=k}function j5(m,k){const C=new lp;if(a.Image){const L=new Image;L.onload=p(fa,C,"TestLoadImage: loaded",!0,k,L),L.onerror=p(fa,C,"TestLoadImage: error",!1,k,L),L.onabort=p(fa,C,"TestLoadImage: abort",!1,k,L),L.ontimeout=p(fa,C,"TestLoadImage: timeout",!1,k,L),a.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=m}else k(!1)}function B5(m,k){const C=new lp,L=new AbortController,Y=setTimeout(()=>{L.abort(),fa(C,"TestPingServer: timeout",!1,k)},1e4);fetch(m,{signal:L.signal}).then(ne=>{clearTimeout(Y),ne.ok?fa(C,"TestPingServer: ok",!0,k):fa(C,"TestPingServer: server error",!1,k)}).catch(()=>{clearTimeout(Y),fa(C,"TestPingServer: error",!1,k)})}function fa(m,k,C,L,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),L(C)}catch{}}function U5(){this.g=new rp}function W5(m,k,C){const L=C||"";try{e$(m,function(Y,ne){let ge=Y;c(Y)&&(ge=go(Y)),k.push(L+ne+"="+encodeURIComponent(ge))})}catch(Y){throw k.push(L+"type="+encodeURIComponent("_badmap")),Y}}function Cy(m){this.l=m.Ub||null,this.j=m.eb||!1}f(Cy,Rl),Cy.prototype.g=function(){return new $y(this.l,this.j)},Cy.prototype.i=function(m){return function(){return m}}({});function $y(m,k){je.call(this),this.D=m,this.o=k,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}f($y,je),t=$y.prototype,t.open=function(m,k){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=k,this.readyState=1,fp(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const k={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(k.body=m),(this.D||a).fetch(new Request(this.A,k)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,pp(this)),this.readyState=0},t.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,fp(this)),this.g&&(this.readyState=3,fp(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;a$(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function a$(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}t.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var k=m.value?m.value:new Uint8Array(0);(k=this.v.decode(k,{stream:!m.done}))&&(this.response=this.responseText+=k)}m.done?pp(this):fp(this),this.readyState==3&&a$(this)}},t.Ra=function(m){this.g&&(this.response=this.responseText=m,pp(this))},t.Qa=function(m){this.g&&(this.response=m,pp(this))},t.ga=function(){this.g&&pp(this)};function pp(m){m.readyState=4,m.l=null,m.j=null,m.v=null,fp(m)}t.setRequestHeader=function(m,k){this.u.append(m,k)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],k=this.h.entries();for(var C=k.next();!C.done;)C=C.value,m.push(C[0]+": "+C[1]),C=k.next();return m.join(`\r
`)};function fp(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty($y.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function l$(m){let k="";return A(m,function(C,L){k+=L,k+=":",k+=C,k+=`\r
`}),k}function j1(m,k,C){e:{for(L in C){var L=!1;break e}L=!0}L||(C=l$(C),typeof m=="string"?C!=null&&encodeURIComponent(String(C)):Ft(m,k,C))}function tn(m){je.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}f(tn,je);var G5=/^https?$/i,H5=["POST","PUT"];t=tn.prototype,t.Ha=function(m){this.J=m},t.ea=function(m,k,C,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);k=k?k.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():P1.g(),this.v=this.o?wy(this.o):wy(P1),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(k,String(m),!0),this.B=!1}catch(ne){c$(this,ne);return}if(m=C||"",C=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var Y in L)C.set(Y,L[Y]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const ne of L.keys())C.set(ne,L.get(ne));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(C.keys()).find(ne=>ne.toLowerCase()=="content-type"),Y=a.FormData&&m instanceof a.FormData,!(0<=Array.prototype.indexOf.call(H5,k,void 0))||L||Y||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,ge]of C)this.g.setRequestHeader(ne,ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{h$(this),this.u=!0,this.g.send(m),this.u=!1}catch(ne){c$(this,ne)}};function c$(m,k){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=k,m.m=5,u$(m),Ay(m)}function u$(m){m.A||(m.A=!0,He(m,"complete"),He(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,He(this,"complete"),He(this,"abort"),Ay(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ay(this,!0)),tn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?d$(this):this.bb())},t.bb=function(){d$(this)};function d$(m){if(m.h&&typeof o<"u"&&(!m.v[1]||xo(m)!=4||m.Z()!=2)){if(m.u&&xo(m)==4)qs(m.Ea,0,m);else if(He(m,"readystatechange"),xo(m)==4){m.h=!1;try{const ge=m.Z();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var k=!0;break e;default:k=!1}var C;if(!(C=k)){var L;if(L=ge===0){var Y=String(m.D).match(t$)[1]||null;!Y&&a.self&&a.self.location&&(Y=a.self.location.protocol.slice(0,-1)),L=!G5.test(Y?Y.toLowerCase():"")}C=L}if(C)He(m,"complete"),He(m,"success");else{m.m=6;try{var ne=2<xo(m)?m.g.statusText:""}catch{ne=""}m.l=ne+" ["+m.Z()+"]",u$(m)}}finally{Ay(m)}}}}function Ay(m,k){if(m.g){h$(m);const C=m.g,L=m.v[0]?()=>{}:null;m.g=null,m.v=null,k||He(m,"ready");try{C.onreadystatechange=L}catch{}}}function h$(m){m.I&&(a.clearTimeout(m.I),m.I=null)}t.isActive=function(){return!!this.g};function xo(m){return m.g?m.g.readyState:0}t.Z=function(){try{return 2<xo(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(m){if(this.g){var k=this.g.responseText;return m&&k.indexOf(m)==0&&(k=k.substring(m.length)),sp(k)}};function p$(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function q5(m){const k={};m=(m.g&&2<=xo(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<m.length;L++){if(v(m[L]))continue;var C=P(m[L]);const Y=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const ne=k[Y]||[];k[Y]=ne,ne.push(C)}T(k,function(L){return L.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function mp(m,k,C){return C&&C.internalChannelParams&&C.internalChannelParams[m]||k}function f$(m){this.Aa=0,this.i=[],this.j=new lp,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=mp("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=mp("baseRetryDelayMs",5e3,m),this.cb=mp("retryDelaySeedMs",1e4,m),this.Wa=mp("forwardChannelMaxRetries",2,m),this.wa=mp("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new X2(m&&m.concurrentRequestLimit),this.Da=new U5,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=f$.prototype,t.la=8,t.G=1,t.connect=function(m,k,C,L){As(0),this.W=m,this.H=k||{},C&&L!==void 0&&(this.H.OSID=C,this.H.OAID=L),this.F=this.X,this.I=k$(this,null,this.W),Dy(this)};function B1(m){if(m$(m),m.G==3){var k=m.U++,C=yo(m.I);if(Ft(C,"SID",m.K),Ft(C,"RID",k),Ft(C,"TYPE","terminate"),gp(m,C),k=new ha(m,m.j,k),k.L=2,k.v=Ey(yo(C)),C=!1,a.navigator&&a.navigator.sendBeacon)try{C=a.navigator.sendBeacon(k.v.toString(),"")}catch{}!C&&a.Image&&(new Image().src=k.v,C=!0),C||(k.g=S$(k.j,null),k.g.ea(k.v)),k.F=Date.now(),Ty(k)}I$(m)}function Ry(m){m.g&&(W1(m),m.g.cancel(),m.g=null)}function m$(m){Ry(m),m.u&&(a.clearTimeout(m.u),m.u=null),Py(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&a.clearTimeout(m.s),m.s=null)}function Dy(m){if(!Y2(m.h)&&!m.s){m.s=!0;var k=m.Ga;te||Z(),B||(te(),B=!0),H.add(k,m),m.B=0}}function K5(m,k){return Q2(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=k.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=ap(h(m.Ga,m,k),w$(m,m.B)),m.B++,!0)}t.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const Y=new ha(this,this.j,m);let ne=this.o;if(this.S&&(ne?(ne=S(ne),$(ne,this.S)):ne=this.S),this.m!==null||this.O||(Y.H=ne,ne=null),this.P)e:{for(var k=0,C=0;C<this.i.length;C++){t:{var L=this.i[C];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(k+=L,4096<k){k=C;break e}if(k===4096||C===this.i.length-1){k=C+1;break e}}k=1e3}else k=1e3;k=y$(this,Y,k),C=yo(this.I),Ft(C,"RID",m),Ft(C,"CVER",22),this.D&&Ft(C,"X-HTTP-Session-Id",this.D),gp(this,C),ne&&(this.O?k="headers="+encodeURIComponent(String(l$(ne)))+"&"+k:this.m&&j1(C,this.m,ne)),z1(this.h,Y),this.Ua&&Ft(C,"TYPE","init"),this.P?(Ft(C,"$req",k),Ft(C,"SID","null"),Y.T=!0,F1(Y,C,null)):F1(Y,C,k),this.G=2}}else this.G==3&&(m?g$(this,m):this.i.length==0||Y2(this.h)||g$(this))};function g$(m,k){var C;k?C=k.l:C=m.U++;const L=yo(m.I);Ft(L,"SID",m.K),Ft(L,"RID",C),Ft(L,"AID",m.T),gp(m,L),m.m&&m.o&&j1(L,m.m,m.o),C=new ha(m,m.j,C,m.B+1),m.m===null&&(C.H=m.o),k&&(m.i=k.D.concat(m.i)),k=y$(m,C,1e3),C.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),z1(m.h,C),F1(C,L,k)}function gp(m,k){m.H&&A(m.H,function(C,L){Ft(k,L,C)}),m.l&&e$({},function(C,L){Ft(k,L,C)})}function y$(m,k,C){C=Math.min(m.i.length,C);var L=m.l?h(m.l.Na,m.l,m):null;e:{var Y=m.i;let ne=-1;for(;;){const ge=["count="+C];ne==-1?0<C?(ne=Y[0].g,ge.push("ofs="+ne)):ne=0:ge.push("ofs="+ne);let Et=!0;for(let Jn=0;Jn<C;Jn++){let ft=Y[Jn].g;const ds=Y[Jn].map;if(ft-=ne,0>ft)ne=Math.max(0,Y[Jn].g-100),Et=!1;else try{W5(ds,ge,"req"+ft+"_")}catch{L&&L(ds)}}if(Et){L=ge.join("&");break e}}}return m=m.i.splice(0,C),k.D=m,L}function x$(m){if(!m.g&&!m.u){m.Y=1;var k=m.Fa;te||Z(),B||(te(),B=!0),H.add(k,m),m.v=0}}function U1(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=ap(h(m.Fa,m),w$(m,m.v)),m.v++,!0)}t.Fa=function(){if(this.u=null,v$(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=ap(h(this.ab,this),m)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,As(10),Ry(this),v$(this))};function W1(m){m.A!=null&&(a.clearTimeout(m.A),m.A=null)}function v$(m){m.g=new ha(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var k=yo(m.qa);Ft(k,"RID","rpc"),Ft(k,"SID",m.K),Ft(k,"AID",m.T),Ft(k,"CI",m.F?"0":"1"),!m.F&&m.ja&&Ft(k,"TO",m.ja),Ft(k,"TYPE","xmlhttp"),gp(m,k),m.m&&m.o&&j1(k,m.m,m.o),m.L&&(m.g.I=m.L);var C=m.g;m=m.ia,C.L=1,C.v=Ey(yo(k)),C.m=null,C.P=!0,H2(C,m)}t.Za=function(){this.C!=null&&(this.C=null,Ry(this),U1(this),As(19))};function Py(m){m.C!=null&&(a.clearTimeout(m.C),m.C=null)}function b$(m,k){var C=null;if(m.g==k){Py(m),W1(m),m.g=null;var L=2}else if(V1(m.h,k))C=k.D,J2(m.h,k),L=1;else return;if(m.G!=0){if(k.o)if(L==1){C=k.m?k.m.length:0,k=Date.now()-k.F;var Y=m.B;L=Iy(),He(L,new B2(L,C)),Dy(m)}else x$(m);else if(Y=k.s,Y==3||Y==0&&0<k.X||!(L==1&&K5(m,k)||L==2&&U1(m)))switch(C&&0<C.length&&(k=m.h,k.i=k.i.concat(C)),Y){case 1:Fl(m,5);break;case 4:Fl(m,10);break;case 3:Fl(m,6);break;default:Fl(m,2)}}}function w$(m,k){let C=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(C*=2),C*k}function Fl(m,k){if(m.j.info("Error code "+k),k==2){var C=h(m.fb,m),L=m.Xa;const Y=!L;L=new Ol(L||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ny(L,"https"),Ey(L),Y?j5(L.toString(),C):B5(L.toString(),C)}else As(2);m.G=0,m.l&&m.l.sa(k),I$(m),m$(m)}t.fb=function(m){m?(this.j.info("Successfully pinged google.com"),As(2)):(this.j.info("Failed to ping google.com"),As(1))};function I$(m){if(m.G=0,m.ka=[],m.l){const k=Z2(m.h);(k.length!=0||m.i.length!=0)&&(y(m.ka,k),y(m.ka,m.i),m.h.i.length=0,g(m.i),m.i.length=0),m.l.ra()}}function k$(m,k,C){var L=C instanceof Ol?yo(C):new Ol(C);if(L.g!="")k&&(L.g=k+"."+L.g),_y(L,L.s);else{var Y=a.location;L=Y.protocol,k=k?k+"."+Y.hostname:Y.hostname,Y=+Y.port;var ne=new Ol(null);L&&Ny(ne,L),k&&(ne.g=k),Y&&_y(ne,Y),C&&(ne.l=C),L=ne}return C=m.D,k=m.ya,C&&k&&Ft(L,C,k),Ft(L,"VER",m.la),gp(m,L),L}function S$(m,k,C){if(k&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return k=m.Ca&&!m.pa?new tn(new Cy({eb:C})):new tn(m.pa),k.Ha(m.J),k}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function T$(){}t=T$.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Oy(){}Oy.prototype.g=function(m,k){return new mr(m,k)};function mr(m,k){je.call(this),this.g=new f$(k),this.l=m,this.h=k&&k.messageUrlParams||null,m=k&&k.messageHeaders||null,k&&k.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=k&&k.initMessageHeaders||null,k&&k.messageContentType&&(m?m["X-WebChannel-Content-Type"]=k.messageContentType:m={"X-WebChannel-Content-Type":k.messageContentType}),k&&k.va&&(m?m["X-WebChannel-Client-Profile"]=k.va:m={"X-WebChannel-Client-Profile":k.va}),this.g.S=m,(m=k&&k.Sb)&&!v(m)&&(this.g.m=m),this.v=k&&k.supportsCrossDomainXhr||!1,this.u=k&&k.sendRawJson||!1,(k=k&&k.httpSessionIdParam)&&!v(k)&&(this.g.D=k,m=this.h,m!==null&&k in m&&(m=this.h,k in m&&delete m[k])),this.j=new gu(this)}f(mr,je),mr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mr.prototype.close=function(){B1(this.g)},mr.prototype.o=function(m){var k=this.g;if(typeof m=="string"){var C={};C.__data__=m,m=C}else this.u&&(C={},C.__data__=go(m),m=C);k.i.push(new A5(k.Ya++,m)),k.G==3&&Dy(k)},mr.prototype.N=function(){this.g.l=null,delete this.j,B1(this.g),delete this.g,mr.aa.N.call(this)};function N$(m){R1.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var k=m.__sm__;if(k){e:{for(const C in k){m=C;break e}m=void 0}(this.i=m)&&(m=this.i,k=k!==null&&m in k?k[m]:void 0),this.data=k}else this.data=m}f(N$,R1);function _$(){D1.call(this),this.status=1}f(_$,D1);function gu(m){this.g=m}f(gu,T$),gu.prototype.ua=function(){He(this.g,"a")},gu.prototype.ta=function(m){He(this.g,new N$(m))},gu.prototype.sa=function(m){He(this.g,new _$)},gu.prototype.ra=function(){He(this.g,"b")},Oy.prototype.createWebChannel=Oy.prototype.g,mr.prototype.send=mr.prototype.o,mr.prototype.open=mr.prototype.m,mr.prototype.close=mr.prototype.close,B3=function(){return new Oy},j3=function(){return Iy()},z3=Dl,aS={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ky.NO_ERROR=0,ky.TIMEOUT=8,ky.HTTP_ERROR=6,Gx=ky,U2.COMPLETE="complete",V3=U2,M2.EventType=ip,ip.OPEN="a",ip.CLOSE="b",ip.ERROR="c",ip.MESSAGE="d",je.prototype.listen=je.prototype.K,Bp=M2,tn.prototype.listenOnce=tn.prototype.L,tn.prototype.getLastError=tn.prototype.Ka,tn.prototype.getLastErrorCode=tn.prototype.Ba,tn.prototype.getStatus=tn.prototype.Z,tn.prototype.getResponseJson=tn.prototype.Oa,tn.prototype.getResponseText=tn.prototype.oa,tn.prototype.send=tn.prototype.ea,tn.prototype.setWithCredentials=tn.prototype.Ha,M3=tn}).apply(typeof tx<"u"?tx:typeof self<"u"?self:typeof window<"u"?window:{});const kR="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gs.UNAUTHENTICATED=new gs(null),gs.GOOGLE_CREDENTIALS=new gs("google-credentials-uid"),gs.FIRST_PARTY=new gs("first-party-uid"),gs.MOCK_USER=new gs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vd="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc=new RN("@firebase/firestore");function Tp(){return Nc.logLevel}function Ce(t,...e){if(Nc.logLevel<=at.DEBUG){const n=e.map(HN);Nc.debug(`Firestore (${Vd}): ${t}`,...n)}}function Bo(t,...e){if(Nc.logLevel<=at.ERROR){const n=e.map(HN);Nc.error(`Firestore (${Vd}): ${t}`,...n)}}function ud(t,...e){if(Nc.logLevel<=at.WARN){const n=e.map(HN);Nc.warn(`Firestore (${Vd}): ${t}`,...n)}}function HN(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Be(t="Unexpected state"){const e=`FIRESTORE (${Vd}) INTERNAL ASSERTION FAILED: `+t;throw Bo(e),new Error(e)}function kt(t,e){t||Be()}function Ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends lo{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xX{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(gs.UNAUTHENTICATED))}shutdown(){}}class vX{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class bX{constructor(e){this.t=e,this.currentUser=gs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){kt(this.o===void 0);let s=this.i;const r=l=>this.i!==s?(s=this.i,n(l)):Promise.resolve();let i=new Do;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Do,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Do)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(kt(typeof s.accessToken=="string"),new U3(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return kt(e===null||typeof e=="string"),new gs(e)}}class wX{constructor(e,n,s){this.l=e,this.h=n,this.P=s,this.type="FirstParty",this.user=gs.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class IX{constructor(e,n,s){this.l=e,this.h=n,this.P=s}getToken(){return Promise.resolve(new wX(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(gs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class kX{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class SX{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){kt(this.o===void 0);const s=i=>{i.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Ce("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?r(i):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(kt(typeof n.token=="string"),this.R=n.token,new kX(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TX(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=TX(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function mt(t,e){return t<e?-1:t>e?1:0}function dd(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Se(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Rn.fromMillis(Date.now())}static fromDate(e){return Rn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new Rn(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.timestamp=e}static fromTimestamp(e){return new We(e)}static min(){return new We(new Rn(0,0))}static max(){return new We(new Rn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,n,s){n===void 0?n=0:n>e.length&&Be(),s===void 0?s=e.length-n:s>e.length-n&&Be(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return zf.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof zf?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=e.get(r),o=n.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Mt extends zf{construct(e,n,s){return new Mt(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new Se(ae.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new Mt(n)}static emptyPath(){return new Mt([])}}const NX=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ss extends zf{construct(e,n,s){return new ss(e,n,s)}static isValidIdentifier(e){return NX.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ss.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ss(["__name__"])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new Se(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new Se(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Se(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new Se(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ss(n)}static emptyPath(){return new ss([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(Mt.fromString(e))}static fromName(e){return new Fe(Mt.fromString(e).popFirst(5))}static empty(){return new Fe(Mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Mt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new Mt(e.slice()))}}function _X(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=We.fromTimestamp(s===1e9?new Rn(n+1,0):new Rn(n,s));return new el(r,Fe.empty(),e)}function EX(t){return new el(t.readTime,t.key,-1)}class el{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new el(We.min(),Fe.empty(),-1)}static max(){return new el(We.max(),Fe.empty(),-1)}}function CX(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Fe.comparator(t.documentKey,e.documentKey),n!==0?n:mt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $X="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AX{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tm(t){if(t.code!==ae.FAILED_PRECONDITION||t.message!==$X)throw t;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Be(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ue((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ue?n:ue.resolve(n)}catch(n){return ue.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ue.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ue.reject(n)}static resolve(e){return new ue((n,s)=>{n(e)})}static reject(e){return new ue((n,s)=>{s(e)})}static waitFor(e){return new ue((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},l=>s(l))}),o=!0,i===r&&n()})}static or(e){let n=ue.resolve(!1);for(const s of e)n=n.next(r=>r?ue.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new ue((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===i&&s(o)},u=>r(u))}})}static doWhile(e,n){return new ue((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}function RX(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Nm(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ie(s),this.se=s=>n.writeSequenceNumber(s))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}qN.oe=-1;function Q0(t){return t==null}function Fv(t){return t===0&&1/t==-1/0}function DX(t){return typeof t=="number"&&Number.isInteger(t)&&!Fv(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Yc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function G3(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,n){this.comparator=e,this.root=n||ts.EMPTY}insert(e,n){return new en(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ts.BLACK,null,null))}remove(e){return new en(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ts.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nx(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nx(this.root,e,this.comparator,!1)}getReverseIterator(){return new nx(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nx(this.root,e,this.comparator,!0)}}class nx{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ts{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??ts.RED,this.left=r??ts.EMPTY,this.right=i??ts.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new ts(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ts.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return ts.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ts.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ts.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Be();const e=this.left.check();if(e!==this.right.check())throw Be();return e+(this.isRed()?0:1)}}ts.EMPTY=null,ts.RED=!0,ts.BLACK=!1;ts.EMPTY=new class{constructor(){this.size=0}get key(){throw Be()}get value(){throw Be()}get color(){throw Be()}get left(){throw Be()}get right(){throw Be()}copy(e,n,s,r,i){return this}insert(e,n,s){return new ts(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this.comparator=e,this.data=new en(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new TR(this.data.getIterator())}getIteratorFrom(e){return new TR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof os)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new os(this.comparator);return n.data=e,n}}class TR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this.fields=e,e.sort(ss.comparator)}static empty(){return new br([])}unionWith(e){let n=new os(ss.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new br(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return dd(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new H3("Invalid base64 string: "+i):i}}(e);return new ls(n)}static fromUint8Array(e){const n=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new ls(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ls.EMPTY_BYTE_STRING=new ls("");const PX=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function tl(t){if(kt(!!t),typeof t=="string"){let e=0;const n=PX.exec(t);if(kt(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:hn(t.seconds),nanos:hn(t.nanos)}}function hn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function _c(t){return typeof t=="string"?ls.fromBase64String(t):ls.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function XN(t){const e=t.mapValue.fields.__previous_value__;return KN(e)?XN(e):e}function jf(t){const e=tl(t.mapValue.fields.__local_write_time__.timestampValue);return new Rn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OX{constructor(e,n,s,r,i,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class Bf{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Bf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Bf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ec(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?KN(t)?4:LX(t)?9007199254740991:FX(t)?10:11:Be()}function to(t,e){if(t===e)return!0;const n=Ec(t);if(n!==Ec(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jf(t).isEqual(jf(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=tl(r.timestampValue),a=tl(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return _c(r.bytesValue).isEqual(_c(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return hn(r.geoPointValue.latitude)===hn(i.geoPointValue.latitude)&&hn(r.geoPointValue.longitude)===hn(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return hn(r.integerValue)===hn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=hn(r.doubleValue),a=hn(i.doubleValue);return o===a?Fv(o)===Fv(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return dd(t.arrayValue.values||[],e.arrayValue.values||[],to);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},a=i.mapValue.fields||{};if(SR(o)!==SR(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!to(o[l],a[l])))return!1;return!0}(t,e);default:return Be()}}function Uf(t,e){return(t.values||[]).find(n=>to(n,e))!==void 0}function hd(t,e){if(t===e)return 0;const n=Ec(t),s=Ec(e);if(n!==s)return mt(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return mt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=hn(i.integerValue||i.doubleValue),l=hn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return NR(t.timestampValue,e.timestampValue);case 4:return NR(jf(t),jf(e));case 5:return mt(t.stringValue,e.stringValue);case 6:return function(i,o){const a=_c(i),l=_c(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=mt(a[c],l[c]);if(u!==0)return u}return mt(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=mt(hn(i.latitude),hn(o.latitude));return a!==0?a:mt(hn(i.longitude),hn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _R(t.arrayValue,e.arrayValue);case 10:return function(i,o){var a,l,c,u;const d=i.fields||{},h=o.fields||{},p=(a=d.value)===null||a===void 0?void 0:a.arrayValue,f=(l=h.value)===null||l===void 0?void 0:l.arrayValue,g=mt(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=f==null?void 0:f.values)===null||u===void 0?void 0:u.length)||0);return g!==0?g:_R(p,f)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===sx.mapValue&&o===sx.mapValue)return 0;if(i===sx.mapValue)return 1;if(o===sx.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const h=mt(l[d],u[d]);if(h!==0)return h;const p=hd(a[l[d]],c[u[d]]);if(p!==0)return p}return mt(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Be()}}function NR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return mt(t,e);const n=tl(t),s=tl(e),r=mt(n.seconds,s.seconds);return r!==0?r:mt(n.nanos,s.nanos)}function _R(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=hd(n[r],s[r]);if(i)return i}return mt(n.length,s.length)}function pd(t){return lS(t)}function lS(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=tl(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return _c(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Fe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",r=!0;for(const i of n.values||[])r?r=!1:s+=",",s+=lS(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${lS(n.fields[o])}`;return r+"}"}(t.mapValue):Be()}function ER(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function cS(t){return!!t&&"integerValue"in t}function YN(t){return!!t&&"arrayValue"in t}function CR(t){return!!t&&"nullValue"in t}function $R(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hx(t){return!!t&&"mapValue"in t}function FX(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function df(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Yc(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=df(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=df(t.arrayValue.values[n]);return e}return Object.assign({},t)}function LX(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e){this.value=e}static empty(){return new Js({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Hx(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=df(n)}setAll(e){let n=ss.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=df(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());Hx(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return to(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];Hx(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Yc(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Js(df(this.value))}}function q3(t){const e=[];return Yc(t.fields,(n,s)=>{const r=new ss([n]);if(Hx(s)){const i=q3(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new br(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n,s,r,i,o,a){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new bs(e,0,We.min(),We.min(),We.min(),Js.empty(),0)}static newFoundDocument(e,n,s,r){return new bs(e,1,n,We.min(),s,r,0)}static newNoDocument(e,n){return new bs(e,2,n,We.min(),We.min(),Js.empty(),0)}static newUnknownDocument(e,n){return new bs(e,3,n,We.min(),We.min(),Js.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(We.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Js.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Js.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=We.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,n){this.position=e,this.inclusive=n}}function AR(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=Fe.comparator(Fe.fromName(o.referenceValue),n.key):s=hd(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function RR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!to(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n="asc"){this.field=e,this.dir=n}}function MX(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{}class bn extends K3{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new zX(e,n,s):n==="array-contains"?new UX(e,s):n==="in"?new WX(e,s):n==="not-in"?new GX(e,s):n==="array-contains-any"?new HX(e,s):new bn(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new jX(e,s):new BX(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(hd(n,this.value)):n!==null&&Ec(this.value)===Ec(n)&&this.matchesComparison(hd(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Be()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ki extends K3{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new ki(e,n)}matches(e){return X3(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function X3(t){return t.op==="and"}function Y3(t){return VX(t)&&X3(t)}function VX(t){for(const e of t.filters)if(e instanceof ki)return!1;return!0}function uS(t){if(t instanceof bn)return t.field.canonicalString()+t.op.toString()+pd(t.value);if(Y3(t))return t.filters.map(e=>uS(e)).join(",");{const e=t.filters.map(n=>uS(n)).join(",");return`${t.op}(${e})`}}function Q3(t,e){return t instanceof bn?function(s,r){return r instanceof bn&&s.op===r.op&&s.field.isEqual(r.field)&&to(s.value,r.value)}(t,e):t instanceof ki?function(s,r){return r instanceof ki&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,a)=>i&&Q3(o,r.filters[a]),!0):!1}(t,e):void Be()}function J3(t){return t instanceof bn?function(n){return`${n.field.canonicalString()} ${n.op} ${pd(n.value)}`}(t):t instanceof ki?function(n){return n.op.toString()+" {"+n.getFilters().map(J3).join(" ,")+"}"}(t):"Filter"}class zX extends bn{constructor(e,n,s){super(e,n,s),this.key=Fe.fromName(s.referenceValue)}matches(e){const n=Fe.comparator(e.key,this.key);return this.matchesComparison(n)}}class jX extends bn{constructor(e,n){super(e,"in",n),this.keys=Z3("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class BX extends bn{constructor(e,n){super(e,"not-in",n),this.keys=Z3("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Z3(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>Fe.fromName(s.referenceValue))}class UX extends bn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return YN(n)&&Uf(n.arrayValue,this.value)}}class WX extends bn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Uf(this.value.arrayValue,n)}}class GX extends bn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Uf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Uf(this.value.arrayValue,n)}}class HX extends bn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!YN(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>Uf(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qX{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function DR(t,e=null,n=[],s=[],r=null,i=null,o=null){return new qX(t,e,n,s,r,i,o)}function QN(t){const e=Ge(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>uS(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Q0(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>pd(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>pd(s)).join(",")),e.ue=n}return e.ue}function JN(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!MX(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Q3(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!RR(t.startAt,e.startAt)&&RR(t.endAt,e.endAt)}function dS(t){return Fe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function KX(t,e,n,s,r,i,o,a){return new _m(t,e,n,s,r,i,o,a)}function ZN(t){return new _m(t)}function PR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function e4(t){return t.collectionGroup!==null}function hf(t){const e=Ge(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new os(ss.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Mv(i,s))}),n.has(ss.keyField().canonicalString())||e.ce.push(new Mv(ss.keyField(),s))}return e.ce}function Ki(t){const e=Ge(t);return e.le||(e.le=XX(e,hf(t))),e.le}function XX(t,e){if(t.limitType==="F")return DR(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new Mv(r.field,i)});const n=t.endAt?new Lv(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new Lv(t.startAt.position,t.startAt.inclusive):null;return DR(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function hS(t,e){const n=t.filters.concat([e]);return new _m(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function pS(t,e,n){return new _m(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function J0(t,e){return JN(Ki(t),Ki(e))&&t.limitType===e.limitType}function t4(t){return`${QN(Ki(t))}|lt:${t.limitType}`}function wu(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(r=>J3(r)).join(", ")}]`),Q0(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(r=>pd(r)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(r=>pd(r)).join(",")),`Target(${s})`}(Ki(t))}; limitType=${t.limitType})`}function Z0(t,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):Fe.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(t,e)&&function(s,r){for(const i of hf(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(s,r){return!(s.startAt&&!function(o,a,l){const c=AR(o,a,l);return o.inclusive?c<=0:c<0}(s.startAt,hf(s),r)||s.endAt&&!function(o,a,l){const c=AR(o,a,l);return o.inclusive?c>=0:c>0}(s.endAt,hf(s),r))}(t,e)}function YX(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function n4(t){return(e,n)=>{let s=!1;for(const r of hf(t)){const i=QX(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function QX(t,e,n){const s=t.field.isKeyField()?Fe.comparator(e.key,n.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?hd(l,c):Be()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return Be()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Yc(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return G3(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JX=new en(Fe.comparator);function Uo(){return JX}const s4=new en(Fe.comparator);function Up(...t){let e=s4;for(const n of t)e=e.insert(n.key,n);return e}function r4(t){let e=s4;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function nc(){return pf()}function i4(){return pf()}function pf(){return new zd(t=>t.toString(),(t,e)=>t.isEqual(e))}const ZX=new en(Fe.comparator),eY=new os(Fe.comparator);function rt(...t){let e=eY;for(const n of t)e=e.add(n);return e}const tY=new os(mt);function nY(){return tY}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fv(e)?"-0":e}}function o4(t){return{integerValue:""+t}}function sY(t,e){return DX(e)?o4(e):e_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(){this._=void 0}}function rY(t,e,n){return t instanceof Wf?function(r,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&KN(i)&&(i=XN(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Gf?l4(t,e):t instanceof Hf?c4(t,e):function(r,i){const o=a4(r,i),a=OR(o)+OR(r.Pe);return cS(o)&&cS(r.Pe)?o4(a):e_(r.serializer,a)}(t,e)}function iY(t,e,n){return t instanceof Gf?l4(t,e):t instanceof Hf?c4(t,e):n}function a4(t,e){return t instanceof Vv?function(s){return cS(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class Wf extends eb{}class Gf extends eb{constructor(e){super(),this.elements=e}}function l4(t,e){const n=u4(e);for(const s of t.elements)n.some(r=>to(r,s))||n.push(s);return{arrayValue:{values:n}}}class Hf extends eb{constructor(e){super(),this.elements=e}}function c4(t,e){let n=u4(e);for(const s of t.elements)n=n.filter(r=>!to(r,s));return{arrayValue:{values:n}}}class Vv extends eb{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function OR(t){return hn(t.integerValue||t.doubleValue)}function u4(t){return YN(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oY{constructor(e,n){this.field=e,this.transform=n}}function aY(t,e){return t.field.isEqual(e.field)&&function(s,r){return s instanceof Gf&&r instanceof Gf||s instanceof Hf&&r instanceof Hf?dd(s.elements,r.elements,to):s instanceof Vv&&r instanceof Vv?to(s.Pe,r.Pe):s instanceof Wf&&r instanceof Wf}(t.transform,e.transform)}class lY{constructor(e,n){this.version=e,this.transformResults=n}}class xi{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new xi}static exists(e){return new xi(void 0,e)}static updateTime(e){return new xi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qx(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class tb{}function d4(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new t_(t.key,xi.none()):new Em(t.key,t.data,xi.none());{const n=t.data,s=Js.empty();let r=new os(ss.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new wl(t.key,s,new br(r.toArray()),xi.none())}}function cY(t,e,n){t instanceof Em?function(r,i,o){const a=r.value.clone(),l=LR(r.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof wl?function(r,i,o){if(!qx(r.precondition,i))return void i.convertToUnknownDocument(o.version);const a=LR(r.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(h4(r)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ff(t,e,n,s){return t instanceof Em?function(i,o,a,l){if(!qx(i.precondition,o))return a;const c=i.value.clone(),u=MR(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,s):t instanceof wl?function(i,o,a,l){if(!qx(i.precondition,o))return a;const c=MR(i.fieldTransforms,l,o),u=o.data;return u.setAll(h4(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(t,e,n,s):function(i,o,a){return qx(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function uY(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=a4(s.transform,r||null);i!=null&&(n===null&&(n=Js.empty()),n.set(s.field,i))}return n||null}function FR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&dd(s,r,(i,o)=>aY(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Em extends tb{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class wl extends tb{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function h4(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function LR(t,e,n){const s=new Map;kt(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,iY(o,a,n[r]))}return s}function MR(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,rY(i,o,e))}return s}class t_ extends tb{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dY extends tb{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hY{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&cY(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=ff(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=ff(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=i4();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const l=d4(o,a);l!==null&&s.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(We.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),rt())}isEqual(e){return this.batchId===e.batchId&&dd(this.mutations,e.mutations,(n,s)=>FR(n,s))&&dd(this.baseMutations,e.baseMutations,(n,s)=>FR(n,s))}}class n_{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){kt(e.mutations.length===s.length);let r=function(){return ZX}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new n_(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pY{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fY{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xn,ut;function mY(t){switch(t){default:return Be();case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0}}function p4(t){if(t===void 0)return Bo("GRPC error has no .code"),ae.UNKNOWN;switch(t){case xn.OK:return ae.OK;case xn.CANCELLED:return ae.CANCELLED;case xn.UNKNOWN:return ae.UNKNOWN;case xn.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case xn.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case xn.INTERNAL:return ae.INTERNAL;case xn.UNAVAILABLE:return ae.UNAVAILABLE;case xn.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case xn.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case xn.NOT_FOUND:return ae.NOT_FOUND;case xn.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case xn.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case xn.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case xn.ABORTED:return ae.ABORTED;case xn.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case xn.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case xn.DATA_LOSS:return ae.DATA_LOSS;default:return Be()}}(ut=xn||(xn={}))[ut.OK=0]="OK",ut[ut.CANCELLED=1]="CANCELLED",ut[ut.UNKNOWN=2]="UNKNOWN",ut[ut.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ut[ut.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ut[ut.NOT_FOUND=5]="NOT_FOUND",ut[ut.ALREADY_EXISTS=6]="ALREADY_EXISTS",ut[ut.PERMISSION_DENIED=7]="PERMISSION_DENIED",ut[ut.UNAUTHENTICATED=16]="UNAUTHENTICATED",ut[ut.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ut[ut.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ut[ut.ABORTED=10]="ABORTED",ut[ut.OUT_OF_RANGE=11]="OUT_OF_RANGE",ut[ut.UNIMPLEMENTED=12]="UNIMPLEMENTED",ut[ut.INTERNAL=13]="INTERNAL",ut[ut.UNAVAILABLE=14]="UNAVAILABLE",ut[ut.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gY(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yY=new uc([4294967295,4294967295],0);function VR(t){const e=gY().encode(t),n=new L3;return n.update(e),new Uint8Array(n.digest())}function zR(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new uc([n,s],0),new uc([r,i],0)]}class s_{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new Wp(`Invalid padding: ${n}`);if(s<0)throw new Wp(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Wp(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new Wp(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=uc.fromNumber(this.Ie)}Ee(e,n,s){let r=e.add(n.multiply(uc.fromNumber(s)));return r.compare(yY)===1&&(r=new uc([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=VR(e),[s,r]=zR(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(s,r,i);if(!this.de(o))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new s_(i,r,n);return s.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=VR(e),[s,r]=zR(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(s,r,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class Wp extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,Cm.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new nb(We.min(),r,new en(mt),Uo(),rt())}}class Cm{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new Cm(s,n,rt(),rt(),rt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kx{constructor(e,n,s,r){this.Re=e,this.removedTargetIds=n,this.key=s,this.Ve=r}}class f4{constructor(e,n){this.targetId=e,this.me=n}}class m4{constructor(e,n,s=ls.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class jR{constructor(){this.fe=0,this.ge=UR(),this.pe=ls.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=rt(),n=rt(),s=rt();return this.ge.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:Be()}}),new Cm(this.pe,this.ye,e,n,s)}Ce(){this.we=!1,this.ge=UR()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,kt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class xY{constructor(e){this.Le=e,this.Be=new Map,this.ke=Uo(),this.qe=BR(),this.Qe=new en(mt)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const s=this.Ge(n);switch(e.state){case 0:this.ze(n)&&s.De(e.resumeToken);break;case 1:s.Oe(),s.Se||s.Ce(),s.De(e.resumeToken);break;case 2:s.Oe(),s.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(s.Ne(),s.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),s.De(e.resumeToken));break;default:Be()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((s,r)=>{this.ze(r)&&n(r)})}He(e){const n=e.targetId,s=e.me.count,r=this.Je(n);if(r){const i=r.target;if(dS(i))if(s===0){const o=new Fe(i.path);this.Ue(n,o,bs.newNoDocument(o,We.min()))}else kt(s===1);else{const o=this.Ye(n);if(o!==s){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let o,a;try{o=_c(s).toUint8Array()}catch(l){if(l instanceof H3)return ud("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new s_(o,r,i)}catch(l){return ud(l instanceof Wp?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,s){return n.me.count===s-this.nt(e,n.targetId)?0:2}nt(e,n){const s=this.Le.getRemoteKeysForTarget(n);let r=0;return s.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,i,null),r++)}),r}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&dS(a.target)){const l=new Fe(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,bs.newNoDocument(l,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let s=rt();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const r=new nb(e,n,this.Qe,this.ke,s);return this.ke=Uo(),this.qe=BR(),this.Qe=new en(mt),r}$e(e,n){if(!this.ze(e))return;const s=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,s),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,s){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,n)?r.Fe(n,1):r.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),s&&(this.ke=this.ke.insert(n,s))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new jR,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new os(mt),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Ce("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new jR),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function BR(){return new en(Fe.comparator)}function UR(){return new en(Fe.comparator)}const vY={asc:"ASCENDING",desc:"DESCENDING"},bY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wY={and:"AND",or:"OR"};class IY{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function fS(t,e){return t.useProto3Json||Q0(e)?e:{value:e}}function zv(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function g4(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function kY(t,e){return zv(t,e.toTimestamp())}function Xi(t){return kt(!!t),We.fromTimestamp(function(n){const s=tl(n);return new Rn(s.seconds,s.nanos)}(t))}function r_(t,e){return mS(t,e).canonicalString()}function mS(t,e){const n=function(r){return new Mt(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function y4(t){const e=Mt.fromString(t);return kt(I4(e)),e}function gS(t,e){return r_(t.databaseId,e.path)}function NI(t,e){const n=y4(e);if(n.get(1)!==t.databaseId.projectId)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Se(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Fe(v4(n))}function x4(t,e){return r_(t.databaseId,e)}function SY(t){const e=y4(t);return e.length===4?Mt.emptyPath():v4(e)}function yS(t){return new Mt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function v4(t){return kt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function WR(t,e,n){return{name:gS(t,e),fields:n.value.mapValue.fields}}function TY(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Be()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(kt(u===void 0||typeof u=="string"),ls.fromBase64String(u||"")):(kt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),ls.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?ae.UNKNOWN:p4(c.code);return new Se(u,c.message||"")}(o);n=new m4(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=NI(t,s.document.name),i=Xi(s.document.updateTime),o=s.document.createTime?Xi(s.document.createTime):We.min(),a=new Js({mapValue:{fields:s.document.fields}}),l=bs.newFoundDocument(r,i,o,a),c=s.targetIds||[],u=s.removedTargetIds||[];n=new Kx(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=NI(t,s.document),i=s.readTime?Xi(s.readTime):We.min(),o=bs.newNoDocument(r,i),a=s.removedTargetIds||[];n=new Kx([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=NI(t,s.document),i=s.removedTargetIds||[];n=new Kx([],i,r,null)}else{if(!("filter"in e))return Be();{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new fY(r,i),a=s.targetId;n=new f4(a,o)}}return n}function NY(t,e){let n;if(e instanceof Em)n={update:WR(t,e.key,e.value)};else if(e instanceof t_)n={delete:gS(t,e.key)};else if(e instanceof wl)n={update:WR(t,e.key,e.data),updateMask:OY(e.fieldMask)};else{if(!(e instanceof dY))return Be();n={verify:gS(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const a=o.transform;if(a instanceof Wf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Gf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Hf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Vv)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Be()}(0,s))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:kY(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Be()}(t,e.precondition)),n}function _Y(t,e){return t&&t.length>0?(kt(e!==void 0),t.map(n=>function(r,i){let o=r.updateTime?Xi(r.updateTime):Xi(i);return o.isEqual(We.min())&&(o=Xi(i)),new lY(o,r.transformResults||[])}(n,e))):[]}function EY(t,e){return{documents:[x4(t,e.path)]}}function CY(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=x4(t,r);const i=function(c){if(c.length!==0)return w4(ki.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:Iu(h.field),direction:RY(h.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=fS(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:r}}function $Y(t){let e=SY(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){kt(s===1);const u=n.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=function(d){const h=b4(d);return h instanceof ki&&Y3(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(f){return new Mv(ku(f.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(f.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Q0(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(d){const h=!!d.before,p=d.values||[];return new Lv(p,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){const h=!d.before,p=d.values||[];return new Lv(p,h)}(n.endAt)),KX(e,r,o,i,a,"F",l,c)}function AY(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Be()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function b4(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=ku(n.unaryFilter.field);return bn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=ku(n.unaryFilter.field);return bn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ku(n.unaryFilter.field);return bn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ku(n.unaryFilter.field);return bn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Be()}}(t):t.fieldFilter!==void 0?function(n){return bn.create(ku(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Be()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ki.create(n.compositeFilter.filters.map(s=>b4(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Be()}}(n.compositeFilter.op))}(t):Be()}function RY(t){return vY[t]}function DY(t){return bY[t]}function PY(t){return wY[t]}function Iu(t){return{fieldPath:t.canonicalString()}}function ku(t){return ss.fromServerFormat(t.fieldPath)}function w4(t){return t instanceof bn?function(n){if(n.op==="=="){if($R(n.value))return{unaryFilter:{field:Iu(n.field),op:"IS_NAN"}};if(CR(n.value))return{unaryFilter:{field:Iu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if($R(n.value))return{unaryFilter:{field:Iu(n.field),op:"IS_NOT_NAN"}};if(CR(n.value))return{unaryFilter:{field:Iu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Iu(n.field),op:DY(n.op),value:n.value}}}(t):t instanceof ki?function(n){const s=n.getFilters().map(r=>w4(r));return s.length===1?s[0]:{compositeFilter:{op:PY(n.op),filters:s}}}(t):Be()}function OY(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function I4(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,n,s,r,i=We.min(),o=We.min(),a=ls.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Aa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Aa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FY{constructor(e){this.ct=e}}function LY(t){const e=$Y({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?pS(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MY{constructor(){this.un=new VY}addToCollectionParentIndex(e,n){return this.un.add(n),ue.resolve()}getCollectionParents(e,n){return ue.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return ue.resolve()}deleteFieldIndex(e,n){return ue.resolve()}deleteAllFieldIndexes(e){return ue.resolve()}createTargetIndexes(e,n){return ue.resolve()}getDocumentsMatchingTarget(e,n){return ue.resolve(null)}getIndexType(e,n){return ue.resolve(0)}getFieldIndexes(e,n){return ue.resolve([])}getNextCollectionGroupToUpdate(e){return ue.resolve(null)}getMinOffset(e,n){return ue.resolve(el.min())}getMinOffsetFromCollectionGroup(e,n){return ue.resolve(el.min())}updateCollectionGroup(e,n,s){return ue.resolve()}updateIndexEntries(e,n){return ue.resolve()}}class VY{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new os(Mt.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new os(Mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new fd(0)}static kn(){return new fd(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zY{constructor(){this.changes=new zd(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,bs.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?ue.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jY{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BY{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&ff(s.mutation,r,br.empty(),Rn.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,rt()).next(()=>s))}getLocalViewOfDocuments(e,n,s=rt()){const r=nc();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=Up();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=nc();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,rt()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=Uo();const o=pf(),a=function(){return pf()}();return n.forEach((l,c)=>{const u=s.get(c.key);r.has(c.key)&&(u===void 0||u.mutation instanceof wl)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),ff(u.mutation,c,u.mutation.getFieldMask(),Rn.now())):o.set(c.key,br.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var d;return a.set(c,new jY(u,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){const s=pf();let r=new en((o,a)=>o-a),i=rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=s.get(l)||br.empty();u=a.applyToLocalView(c,u),s.set(l,u);const d=(r.get(a.batchId)||rt()).add(l);r=r.insert(a.batchId,d)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,d=i4();u.forEach(h=>{if(!i.has(h)){const p=d4(n.get(h),s.get(h));p!==null&&d.set(h,p),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return ue.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(o){return Fe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):e4(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):ue.resolve(nc());let a=-1,l=i;return o.next(c=>ue.forEach(c,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(u)?ue.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,rt())).next(u=>({batchId:a,changes:r4(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Fe(n)).next(s=>{let r=Up();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let o=Up();return this.indexManager.getCollectionParents(e,i).next(a=>ue.forEach(a,l=>{const c=function(d,h){return new _m(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,s,r).next(u=>{u.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,bs.newInvalidDocument(u)))});let a=Up();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&ff(u.mutation,c,br.empty(),Rn.now()),Z0(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UY{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return ue.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Xi(r.createTime)}}(n)),ue.resolve()}getNamedQuery(e,n){return ue.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(r){return{name:r.name,query:LY(r.bundledQuery),readTime:Xi(r.readTime)}}(n)),ue.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WY{constructor(){this.overlays=new en(Fe.comparator),this.Ir=new Map}getOverlay(e,n){return ue.resolve(this.overlays.get(n))}getOverlays(e,n){const s=nc();return ue.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.ht(e,n,i)}),ue.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.Ir.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(s)),ue.resolve()}getOverlaysForCollection(e,n,s){const r=nc(),i=n.length+1,o=new Fe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>s&&r.set(l.getKey(),l)}return ue.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new en((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>s){let u=i.get(c.largestBatchId);u===null&&(u=nc(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=nc(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=r)););return ue.resolve(a)}ht(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.Ir.get(r.largestBatchId).delete(s.key);this.Ir.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new pY(n,s));let i=this.Ir.get(n);i===void 0&&(i=rt(),this.Ir.set(n,i)),this.Ir.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GY{constructor(){this.sessionToken=ls.EMPTY_BYTE_STRING}getSessionToken(e){return ue.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ue.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(){this.Tr=new os(Mn.Er),this.dr=new os(Mn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const s=new Mn(e,n);this.Tr=this.Tr.add(s),this.dr=this.dr.add(s)}Rr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Vr(new Mn(e,n))}mr(e,n){e.forEach(s=>this.removeReference(s,n))}gr(e){const n=new Fe(new Mt([])),s=new Mn(n,e),r=new Mn(n,e+1),i=[];return this.dr.forEachInRange([s,r],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Fe(new Mt([])),s=new Mn(n,e),r=new Mn(n,e+1);let i=rt();return this.dr.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Mn(e,0),s=this.Tr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Mn{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Fe.comparator(e.key,n.key)||mt(e.wr,n.wr)}static Ar(e,n){return mt(e.wr,n.wr)||Fe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HY{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new os(Mn.Er)}checkEmpty(e){return ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new hY(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.br=this.br.add(new Mn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ue.resolve(o)}lookupMutationBatch(e,n){return ue.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.vr(s),i=r<0?0:r;return ue.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ue.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Mn(n,0),r=new Mn(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([s,r],o=>{const a=this.Dr(o.wr);i.push(a)}),ue.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new os(mt);return n.forEach(r=>{const i=new Mn(r,0),o=new Mn(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{s=s.add(a.wr)})}),ue.resolve(this.Cr(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;Fe.isDocumentKey(i)||(i=i.child(""));const o=new Mn(new Fe(i),0);let a=new os(mt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!s.isPrefixOf(c)&&(c.length===r&&(a=a.add(l.wr)),!0)},o),ue.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(s=>{const r=this.Dr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){kt(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.br;return ue.forEach(n.mutations,r=>{const i=new Mn(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=s})}On(e){}containsKey(e,n){const s=new Mn(n,0),r=this.br.firstAfterOrEqual(s);return ue.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ue.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qY{constructor(e){this.Mr=e,this.docs=function(){return new en(Fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.Mr(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return ue.resolve(s?s.document.mutableCopy():bs.newInvalidDocument(n))}getEntries(e,n){let s=Uo();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():bs.newInvalidDocument(r))}),ue.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=Uo();const o=n.path,a=new Fe(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||CX(EX(u),s)<=0||(r.has(u.key)||Z0(n,u))&&(i=i.insert(u.key,u.mutableCopy()))}return ue.resolve(i)}getAllFromCollectionGroup(e,n,s,r){Be()}Or(e,n){return ue.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new KY(this)}getSize(e){return ue.resolve(this.size)}}class KY extends zY{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.cr.addEntry(e,r)):this.cr.removeEntry(s)}),ue.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XY{constructor(e){this.persistence=e,this.Nr=new zd(n=>QN(n),JN),this.lastRemoteSnapshotVersion=We.min(),this.highestTargetId=0,this.Lr=0,this.Br=new i_,this.targetCount=0,this.kr=fd.Bn()}forEachTarget(e,n){return this.Nr.forEach((s,r)=>n(r)),ue.resolve()}getLastRemoteSnapshotVersion(e){return ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ue.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ue.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.Lr&&(this.Lr=n),ue.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new fd(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,ue.resolve()}updateTargetData(e,n){return this.Kn(n),ue.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,ue.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),ue.waitFor(i).next(()=>r)}getTargetCount(e){return ue.resolve(this.targetCount)}getTargetData(e,n){const s=this.Nr.get(n)||null;return ue.resolve(s)}addMatchingKeys(e,n,s){return this.Br.Rr(n,s),ue.resolve()}removeMatchingKeys(e,n,s){this.Br.mr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),ue.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),ue.resolve()}getMatchingKeysForTargetId(e,n){const s=this.Br.yr(n);return ue.resolve(s)}containsKey(e,n){return ue.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YY{constructor(e,n){this.qr={},this.overlays={},this.Qr=new qN(0),this.Kr=!1,this.Kr=!0,this.$r=new GY,this.referenceDelegate=e(this),this.Ur=new XY(this),this.indexManager=new MY,this.remoteDocumentCache=function(r){return new qY(r)}(s=>this.referenceDelegate.Wr(s)),this.serializer=new FY(n),this.Gr=new UY(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new WY,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.qr[e.toKey()];return s||(s=new HY(n,this.referenceDelegate),this.qr[e.toKey()]=s),s}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,s){Ce("MemoryPersistence","Starting transaction:",e);const r=new QY(this.Qr.next());return this.referenceDelegate.zr(),s(r).next(i=>this.referenceDelegate.jr(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Hr(e,n){return ue.or(Object.values(this.qr).map(s=>()=>s.containsKey(e,n)))}}class QY extends AX{constructor(e){super(),this.currentSequenceNumber=e}}class o_{constructor(e){this.persistence=e,this.Jr=new i_,this.Yr=null}static Zr(e){return new o_(e)}get Xr(){if(this.Yr)return this.Yr;throw Be()}addReference(e,n,s){return this.Jr.addReference(s,n),this.Xr.delete(s.toString()),ue.resolve()}removeReference(e,n,s){return this.Jr.removeReference(s,n),this.Xr.add(s.toString()),ue.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),ue.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(r=>this.Xr.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.Xr.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ue.forEach(this.Xr,s=>{const r=Fe.fromPath(s);return this.ei(e,r).next(i=>{i||n.removeEntry(r,We.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(s=>{s?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return ue.or([()=>ue.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.$i=s,this.Ui=r}static Wi(e,n){let s=rt(),r=rt();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new a_(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JY{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZY{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return F8()?8:RX(Ns())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new JY;return this.Xi(e,n,o).next(a=>{if(i.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>i.result)}es(e,n,s,r){return s.documentReadCount<this.ji?(Tp()<=at.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",wu(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ue.resolve()):(Tp()<=at.DEBUG&&Ce("QueryEngine","Query:",wu(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.Hi*r?(Tp()<=at.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",wu(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ki(n))):ue.resolve())}Yi(e,n){if(PR(n))return ue.resolve(null);let s=Ki(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=pS(n,null,"F"),s=Ki(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=rt(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(l=>{const c=this.ts(n,a);return this.ns(n,c,o,l.readTime)?this.Yi(e,pS(n,null,"F")):this.rs(e,c,n,l)}))})))}Zi(e,n,s,r){return PR(n)||r.isEqual(We.min())?ue.resolve(null):this.Ji.getDocuments(e,s).next(i=>{const o=this.ts(n,i);return this.ns(n,o,s,r)?ue.resolve(null):(Tp()<=at.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),wu(n)),this.rs(e,o,n,_X(r,-1)).next(a=>a))})}ts(e,n){let s=new os(n4(e));return n.forEach((r,i)=>{Z0(e,i)&&(s=s.add(i))}),s}ns(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,n,s){return Tp()<=at.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",wu(n)),this.Ji.getDocumentsMatchingQuery(e,n,el.min(),s)}rs(e,n,s,r){return this.Ji.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eQ{constructor(e,n,s,r){this.persistence=e,this.ss=n,this.serializer=r,this.os=new en(mt),this._s=new zd(i=>QN(i),JN),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(s)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BY(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function tQ(t,e,n,s){return new eQ(t,e,n,s)}async function k4(t,e){const n=Ge(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.ls(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let l=rt();for(const c of r){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(s,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function nQ(t,e){const n=Ge(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const d=c.batch,h=d.keys();let p=ue.resolve();return h.forEach(f=>{p=p.next(()=>u.getEntry(l,f)).next(g=>{const y=c.docVersions.get(f);kt(y!==null),g.version.compareTo(y)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),u.addEntry(g)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let l=rt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function S4(t){const e=Ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function sQ(t,e){const n=Ge(t),s=e.snapshotVersion;let r=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});r=n.os;const a=[];e.targetChanges.forEach((u,d)=>{const h=r.get(d);if(!h)return;a.push(n.Ur.removeMatchingKeys(i,u.removedDocuments,d).next(()=>n.Ur.addMatchingKeys(i,u.addedDocuments,d)));let p=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(ls.EMPTY_BYTE_STRING,We.min()).withLastLimboFreeSnapshotVersion(We.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,s)),r=r.insert(d,p),function(g,y,x){return g.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(h,p,u)&&a.push(n.Ur.updateTargetData(i,p))});let l=Uo(),c=rt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(rQ(i,o,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!s.isEqual(We.min())){const u=n.Ur.getLastRemoteSnapshotVersion(i).next(d=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(u)}return ue.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.os=r,i))}function rQ(t,e,n){let s=rt(),r=rt();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=Uo();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(We.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Ce("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:r}})}function iQ(t,e){const n=Ge(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function oQ(t,e){const n=Ge(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Ur.getTargetData(s,e).next(i=>i?(r=i,ue.resolve(r)):n.Ur.allocateTargetId(s).next(o=>(r=new Aa(e,o,"TargetPurposeListen",s.currentSequenceNumber),n.Ur.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.os.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(s.targetId,s),n._s.set(e,s.targetId)),s})}async function xS(t,e,n){const s=Ge(t),r=s.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Nm(o))throw o;Ce("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.os=s.os.remove(e),s._s.delete(r.target)}function GR(t,e,n){const s=Ge(t);let r=We.min(),i=rt();return s.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const d=Ge(l),h=d._s.get(u);return h!==void 0?ue.resolve(d.os.get(h)):d.Ur.getTargetData(c,u)}(s,o,Ki(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>s.ss.getDocumentsMatchingQuery(o,e,n?r:We.min(),n?i:rt())).next(a=>(aQ(s,YX(e),a),{documents:a,Ts:i})))}function aQ(t,e,n){let s=t.us.get(e)||We.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.us.set(e,s)}class HR{constructor(){this.activeTargetIds=nY()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lQ{constructor(){this.so=new HR,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,s){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new HR,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cQ{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ce("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ce("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rx=null;function _I(){return rx===null?rx=function(){return 268435456+Math.round(2147483648*Math.random())}():rx++,"0x"+rx.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dQ{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms="WebChannelConnection";class hQ extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const s=n.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=s+"://"+n.host,this.vo=`projects/${r}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${i}`}get Fo(){return!1}Mo(n,s,r,i,o){const a=_I(),l=this.xo(n,s.toUriEncodedString());Ce("RestConnection",`Sending RPC '${n}' ${a}:`,l,r);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,o),this.No(n,l,c,r).then(u=>(Ce("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw ud("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",l,"request:",r),u})}Lo(n,s,r,i,o,a){return this.Mo(n,s,r,i,o)}Oo(n,s,r){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vd}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((i,o)=>n[o]=i),r&&r.headers.forEach((i,o)=>n[o]=i)}xo(n,s){const r=uQ[n];return`${this.Do}/v1/${s}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,s,r){const i=_I();return new Promise((o,a)=>{const l=new M3;l.setWithCredentials(!0),l.listenOnce(V3.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Gx.NO_ERROR:const u=l.getResponseJson();Ce(ms,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),o(u);break;case Gx.TIMEOUT:Ce(ms,`RPC '${e}' ${i} timed out`),a(new Se(ae.DEADLINE_EXCEEDED,"Request time out"));break;case Gx.HTTP_ERROR:const d=l.getStatus();if(Ce(ms,`RPC '${e}' ${i} failed with status:`,d,"response text:",l.getResponseText()),d>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const p=h==null?void 0:h.error;if(p&&p.status&&p.message){const f=function(y){const x=y.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(x)>=0?x:ae.UNKNOWN}(p.status);a(new Se(f,p.message))}else a(new Se(ae.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Se(ae.UNAVAILABLE,"Connection failed."));break;default:Be()}}finally{Ce(ms,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(r);Ce(ms,`RPC '${e}' ${i} sending request:`,r),l.send(n,"POST",c,s,15)})}Bo(e,n,s){const r=_I(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=B3(),a=j3(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,s),l.encodeInitMessageHeaders=!0;const u=i.join("");Ce(ms,`Creating RPC '${e}' stream ${r}: ${u}`,l);const d=o.createWebChannel(u,l);let h=!1,p=!1;const f=new dQ({Io:y=>{p?Ce(ms,`Not sending because RPC '${e}' stream ${r} is closed:`,y):(h||(Ce(ms,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),Ce(ms,`RPC '${e}' stream ${r} sending:`,y),d.send(y))},To:()=>d.close()}),g=(y,x,v)=>{y.listen(x,w=>{try{v(w)}catch(I){setTimeout(()=>{throw I},0)}})};return g(d,Bp.EventType.OPEN,()=>{p||(Ce(ms,`RPC '${e}' stream ${r} transport opened.`),f.yo())}),g(d,Bp.EventType.CLOSE,()=>{p||(p=!0,Ce(ms,`RPC '${e}' stream ${r} transport closed`),f.So())}),g(d,Bp.EventType.ERROR,y=>{p||(p=!0,ud(ms,`RPC '${e}' stream ${r} transport errored:`,y),f.So(new Se(ae.UNAVAILABLE,"The operation could not be completed")))}),g(d,Bp.EventType.MESSAGE,y=>{var x;if(!p){const v=y.data[0];kt(!!v);const w=v,I=w.error||((x=w[0])===null||x===void 0?void 0:x.error);if(I){Ce(ms,`RPC '${e}' stream ${r} received error:`,I);const N=I.status;let A=function(E){const $=xn[E];if($!==void 0)return p4($)}(N),T=I.message;A===void 0&&(A=ae.INTERNAL,T="Unknown error status: "+N+" with message "+I.message),p=!0,f.So(new Se(A,T)),d.close()}else Ce(ms,`RPC '${e}' stream ${r} received:`,v),f.bo(v)}}),g(a,z3.STAT_EVENT,y=>{y.stat===aS.PROXY?Ce(ms,`RPC '${e}' stream ${r} detected buffering proxy`):y.stat===aS.NOPROXY&&Ce(ms,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.wo()},0),f}}function EI(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(t){return new IY(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e,n,s=1e3,r=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=s,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),s=Math.max(0,Date.now()-this.Uo),r=Math.max(0,n-s);r>0&&Ce("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e,n,s,r,i,o,a,l){this.ui=e,this.Ho=s,this.Jo=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new T4(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===ae.RESOURCE_EXHAUSTED?(Bo(n.toString()),Bo("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Yo===n&&this.P_(s,r)},s=>{e(()=>{const r=new Se(ae.UNKNOWN,"Fetching auth token failed: "+s.message);return this.I_(r)})})}P_(e,n){const s=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{s(()=>this.listener.Eo())}),this.stream.Ro(()=>{s(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{s(()=>this.I_(r))}),this.stream.onMessage(r=>{s(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ce("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Ce("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class pQ extends N4{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=TY(this.serializer,e),s=function(i){if(!("targetChange"in i))return We.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?We.min():o.readTime?Xi(o.readTime):We.min()}(e);return this.listener.d_(n,s)}A_(e){const n={};n.database=yS(this.serializer),n.addTarget=function(i,o){let a;const l=o.target;if(a=dS(l)?{documents:EY(i,l)}:{query:CY(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=g4(i,o.resumeToken);const c=fS(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(We.min())>0){a.readTime=zv(i,o.snapshotVersion.toTimestamp());const c=fS(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const s=AY(this.serializer,e);s&&(n.labels=s),this.a_(n)}R_(e){const n={};n.database=yS(this.serializer),n.removeTarget=e,this.a_(n)}}class fQ extends N4{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return kt(!!e.streamToken),this.lastStreamToken=e.streamToken,kt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){kt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=_Y(e.writeResults,e.commitTime),s=Xi(e.commitTime);return this.listener.g_(s,n)}p_(){const e={};e.database=yS(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>NY(this.serializer,s))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mQ extends class{}{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Se(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,s,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,mS(n,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Se(ae.UNKNOWN,i.toString())})}Lo(e,n,s,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,mS(n,s),r,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Se(ae.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class gQ{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Bo(n),this.D_=!1):Ce("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yQ{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{s.enqueueAndForget(async()=>{Qc(this)&&(Ce("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Ge(l);c.L_.add(4),await $m(c),c.q_.set("Unknown"),c.L_.delete(4),await rb(c)}(this))})}),this.q_=new gQ(s,r)}}async function rb(t){if(Qc(t))for(const e of t.B_)await e(!0)}async function $m(t){for(const e of t.B_)await e(!1)}function _4(t,e){const n=Ge(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),d_(n)?u_(n):jd(n).r_()&&c_(n,e))}function l_(t,e){const n=Ge(t),s=jd(n);n.N_.delete(e),s.r_()&&E4(n,e),n.N_.size===0&&(s.r_()?s.o_():Qc(n)&&n.q_.set("Unknown"))}function c_(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(We.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}jd(t).A_(e)}function E4(t,e){t.Q_.xe(e),jd(t).R_(e)}function u_(t){t.Q_=new xY({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),jd(t).start(),t.q_.v_()}function d_(t){return Qc(t)&&!jd(t).n_()&&t.N_.size>0}function Qc(t){return Ge(t).L_.size===0}function C4(t){t.Q_=void 0}async function xQ(t){t.q_.set("Online")}async function vQ(t){t.N_.forEach((e,n)=>{c_(t,e)})}async function bQ(t,e){C4(t),d_(t)?(t.q_.M_(e),u_(t)):t.q_.set("Unknown")}async function wQ(t,e,n){if(t.q_.set("Online"),e instanceof m4&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const a of i.targetIds)r.N_.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.N_.delete(a),r.Q_.removeTarget(a))}(t,e)}catch(s){Ce("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await jv(t,s)}else if(e instanceof Kx?t.Q_.Ke(e):e instanceof f4?t.Q_.He(e):t.Q_.We(e),!n.isEqual(We.min()))try{const s=await S4(t.localStore);n.compareTo(s)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(ls.EMPTY_BYTE_STRING,u.snapshotVersion)),E4(i,l);const d=new Aa(u.target,l,c,u.sequenceNumber);c_(i,d)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(s){Ce("RemoteStore","Failed to raise snapshot:",s),await jv(t,s)}}async function jv(t,e,n){if(!Nm(e))throw e;t.L_.add(1),await $m(t),t.q_.set("Offline"),n||(n=()=>S4(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ce("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await rb(t)})}function $4(t,e){return e().catch(n=>jv(t,n,e))}async function ib(t){const e=Ge(t),n=nl(e);let s=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;IQ(e);)try{const r=await iQ(e.localStore,s);if(r===null){e.O_.length===0&&n.o_();break}s=r.batchId,kQ(e,r)}catch(r){await jv(e,r)}A4(e)&&R4(e)}function IQ(t){return Qc(t)&&t.O_.length<10}function kQ(t,e){t.O_.push(e);const n=nl(t);n.r_()&&n.V_&&n.m_(e.mutations)}function A4(t){return Qc(t)&&!nl(t).n_()&&t.O_.length>0}function R4(t){nl(t).start()}async function SQ(t){nl(t).p_()}async function TQ(t){const e=nl(t);for(const n of t.O_)e.m_(n.mutations)}async function NQ(t,e,n){const s=t.O_.shift(),r=n_.from(s,e,n);await $4(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await ib(t)}async function _Q(t,e){e&&nl(t).V_&&await async function(s,r){if(function(o){return mY(o)&&o!==ae.ABORTED}(r.code)){const i=s.O_.shift();nl(s).s_(),await $4(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await ib(s)}}(t,e),A4(t)&&R4(t)}async function KR(t,e){const n=Ge(t);n.asyncQueue.verifyOperationInProgress(),Ce("RemoteStore","RemoteStore received new credentials");const s=Qc(n);n.L_.add(3),await $m(n),s&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await rb(n)}async function EQ(t,e){const n=Ge(t);e?(n.L_.delete(2),await rb(n)):e||(n.L_.add(2),await $m(n),n.q_.set("Unknown"))}function jd(t){return t.K_||(t.K_=function(n,s,r){const i=Ge(n);return i.w_(),new pQ(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Eo:xQ.bind(null,t),Ro:vQ.bind(null,t),mo:bQ.bind(null,t),d_:wQ.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),d_(t)?u_(t):t.q_.set("Unknown")):(await t.K_.stop(),C4(t))})),t.K_}function nl(t){return t.U_||(t.U_=function(n,s,r){const i=Ge(n);return i.w_(),new fQ(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:SQ.bind(null,t),mo:_Q.bind(null,t),f_:TQ.bind(null,t),g_:NQ.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await ib(t)):(await t.U_.stop(),t.O_.length>0&&(Ce("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Do,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new h_(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function p_(t,e){if(Bo("AsyncQueue",`${e}: ${t}`),Nm(t))return new Se(ae.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e){this.comparator=e?(n,s)=>e(n,s)||Fe.comparator(n.key,s.key):(n,s)=>Fe.comparator(n.key,s.key),this.keyedMap=Up(),this.sortedSet=new en(this.comparator)}static emptySet(e){return new Xu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Xu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Xu;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(){this.W_=new en(Fe.comparator)}track(e){const n=e.doc.key,s=this.W_.get(n);s?e.type!==0&&s.type===3?this.W_=this.W_.insert(n,e):e.type===3&&s.type!==1?this.W_=this.W_.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.W_=this.W_.remove(n):e.type===1&&s.type===2?this.W_=this.W_.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Be():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,s)=>{e.push(s)}),e}}class md{constructor(e,n,s,r,i,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,s,r,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new md(e,n,Xu.emptySet(n),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&J0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CQ{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class $Q{constructor(){this.queries=YR(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,s){const r=Ge(n),i=r.queries;r.queries=YR(),i.forEach((o,a)=>{for(const l of a.j_)l.onError(s)})})(this,new Se(ae.ABORTED,"Firestore shutting down"))}}function YR(){return new zd(t=>t4(t),J0)}async function D4(t,e){const n=Ge(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.H_()&&e.J_()&&(s=2):(i=new CQ,s=e.J_()?0:1);try{switch(s){case 0:i.z_=await n.onListen(r,!0);break;case 1:i.z_=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const a=p_(o,`Initialization of query '${wu(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&f_(n)}async function P4(t,e){const n=Ge(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?r=e.J_()?0:1:!i.H_()&&e.J_()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function AQ(t,e){const n=Ge(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.j_)a.X_(r)&&(s=!0);o.z_=r}}s&&f_(n)}function RQ(t,e,n){const s=Ge(t),r=s.queries.get(e);if(r)for(const i of r.j_)i.onError(n);s.queries.delete(e)}function f_(t){t.Y_.forEach(e=>{e.next()})}var vS,QR;(QR=vS||(vS={})).ea="default",QR.Cache="cache";class O4{constructor(e,n,s){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=s||{}}X_(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new md(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const s=n!=="Offline";return(!this.options._a||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=md.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==vS.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e){this.key=e}}class L4{constructor(e){this.key=e}}class DQ{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=rt(),this.mutatedKeys=rt(),this.Aa=n4(e),this.Ra=new Xu(this.Aa)}get Va(){return this.Ta}ma(e,n){const s=n?n.fa:new XR,r=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,d)=>{const h=r.get(u),p=Z0(this.query,d)?d:null,f=!!h&&this.mutatedKeys.has(h.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let y=!1;h&&p?h.data.isEqual(p.data)?f!==g&&(s.track({type:3,doc:p}),y=!0):this.ga(h,p)||(s.track({type:2,doc:p}),y=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(a=!0)):!h&&p?(s.track({type:0,doc:p}),y=!0):h&&!p&&(s.track({type:1,doc:h}),y=!0,(l||c)&&(a=!0)),y&&(p?(o=o.add(p),i=g?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),s.track({type:1,doc:u})}return{Ra:o,fa:s,ns:a,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((u,d)=>function(p,f){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Be()}};return g(p)-g(f)}(u.type,d.type)||this.Aa(u.doc,d.doc)),this.pa(s),r=r!=null&&r;const a=n&&!r?this.ya():[],l=this.da.size===0&&this.current&&!r?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new md(this.query,e.Ra,i,o,e.mutatedKeys,l===0,c,!1,!!s&&s.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new XR,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=rt(),this.Ra.forEach(s=>{this.Sa(s.key)&&(this.da=this.da.add(s.key))});const n=[];return e.forEach(s=>{this.da.has(s)||n.push(new L4(s))}),this.da.forEach(s=>{e.has(s)||n.push(new F4(s))}),n}ba(e){this.Ta=e.Ts,this.da=rt();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return md.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class PQ{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class OQ{constructor(e){this.key=e,this.va=!1}}class FQ{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new zd(a=>t4(a),J0),this.Ma=new Map,this.xa=new Set,this.Oa=new en(Fe.comparator),this.Na=new Map,this.La=new i_,this.Ba={},this.ka=new Map,this.qa=fd.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function LQ(t,e,n=!0){const s=U4(t);let r;const i=s.Fa.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Da()):r=await M4(s,e,n,!0),r}async function MQ(t,e){const n=U4(t);await M4(n,e,!0,!1)}async function M4(t,e,n,s){const r=await oQ(t.localStore,Ki(e)),i=r.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return s&&(a=await VQ(t,e,i,o==="current",r.resumeToken)),t.isPrimaryClient&&n&&_4(t.remoteStore,r),a}async function VQ(t,e,n,s,r){t.Ka=(d,h,p)=>async function(g,y,x,v){let w=y.view.ma(x);w.ns&&(w=await GR(g.localStore,y.query,!1).then(({documents:T})=>y.view.ma(T,w)));const I=v&&v.targetChanges.get(y.targetId),N=v&&v.targetMismatches.get(y.targetId)!=null,A=y.view.applyChanges(w,g.isPrimaryClient,I,N);return ZR(g,y.targetId,A.wa),A.snapshot}(t,d,h,p);const i=await GR(t.localStore,e,!0),o=new DQ(e,i.Ts),a=o.ma(i.documents),l=Cm.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),c=o.applyChanges(a,t.isPrimaryClient,l);ZR(t,n,c.wa);const u=new PQ(e,n,o);return t.Fa.set(e,u),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function zQ(t,e,n){const s=Ge(t),r=s.Fa.get(e),i=s.Ma.get(r.targetId);if(i.length>1)return s.Ma.set(r.targetId,i.filter(o=>!J0(o,e))),void s.Fa.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await xS(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&l_(s.remoteStore,r.targetId),bS(s,r.targetId)}).catch(Tm)):(bS(s,r.targetId),await xS(s.localStore,r.targetId,!0))}async function jQ(t,e){const n=Ge(t),s=n.Fa.get(e),r=n.Ma.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),l_(n.remoteStore,s.targetId))}async function BQ(t,e,n){const s=XQ(t);try{const r=await function(o,a){const l=Ge(o),c=Rn.now(),u=a.reduce((p,f)=>p.add(f.key),rt());let d,h;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let f=Uo(),g=rt();return l.cs.getEntries(p,u).next(y=>{f=y,f.forEach((x,v)=>{v.isValidDocument()||(g=g.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,f)).next(y=>{d=y;const x=[];for(const v of a){const w=uY(v,d.get(v.key).overlayedDocument);w!=null&&x.push(new wl(v.key,w,q3(w.value.mapValue),xi.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,x,a)}).next(y=>{h=y;const x=y.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(p,y.batchId,x)})}).then(()=>({batchId:h.batchId,changes:r4(d)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new en(mt)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(s,r.batchId,n),await Am(s,r.changes),await ib(s.remoteStore)}catch(r){const i=p_(r,"Failed to persist write");n.reject(i)}}async function V4(t,e){const n=Ge(t);try{const s=await sQ(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.Na.get(i);o&&(kt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.va=!0:r.modifiedDocuments.size>0?kt(o.va):r.removedDocuments.size>0&&(kt(o.va),o.va=!1))}),await Am(n,s,e)}catch(s){await Tm(s)}}function JR(t,e,n){const s=Ge(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const l=Ge(o);l.onlineState=a;let c=!1;l.queries.forEach((u,d)=>{for(const h of d.j_)h.Z_(a)&&(c=!0)}),c&&f_(l)}(s.eventManager,e),r.length&&s.Ca.d_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function UQ(t,e,n){const s=Ge(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Na.get(e),i=r&&r.key;if(i){let o=new en(Fe.comparator);o=o.insert(i,bs.newNoDocument(i,We.min()));const a=rt().add(i),l=new nb(We.min(),new Map,new en(mt),o,a);await V4(s,l),s.Oa=s.Oa.remove(i),s.Na.delete(e),m_(s)}else await xS(s.localStore,e,!1).then(()=>bS(s,e,n)).catch(Tm)}async function WQ(t,e){const n=Ge(t),s=e.batch.batchId;try{const r=await nQ(n.localStore,e);j4(n,s,null),z4(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Am(n,r)}catch(r){await Tm(r)}}async function GQ(t,e,n){const s=Ge(t);try{const r=await function(o,a){const l=Ge(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(kt(d!==null),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(s.localStore,e);j4(s,e,n),z4(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Am(s,r)}catch(r){await Tm(r)}}function z4(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function j4(t,e,n){const s=Ge(t);let r=s.Ba[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Ba[s.currentUser.toKey()]=r}}function bS(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Ma.get(e))t.Fa.delete(s),n&&t.Ca.$a(s,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(s=>{t.La.containsKey(s)||B4(t,s)})}function B4(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(l_(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),m_(t))}function ZR(t,e,n){for(const s of n)s instanceof F4?(t.La.addReference(s.key,e),HQ(t,s)):s instanceof L4?(Ce("SyncEngine","Document no longer in limbo: "+s.key),t.La.removeReference(s.key,e),t.La.containsKey(s.key)||B4(t,s.key)):Be()}function HQ(t,e){const n=e.key,s=n.path.canonicalString();t.Oa.get(n)||t.xa.has(s)||(Ce("SyncEngine","New document in limbo: "+n),t.xa.add(s),m_(t))}function m_(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Fe(Mt.fromString(e)),s=t.qa.next();t.Na.set(s,new OQ(n)),t.Oa=t.Oa.insert(n,s),_4(t.remoteStore,new Aa(Ki(ZN(n.path)),s,"TargetPurposeLimboResolution",qN.oe))}}async function Am(t,e,n){const s=Ge(t),r=[],i=[],o=[];s.Fa.isEmpty()||(s.Fa.forEach((a,l)=>{o.push(s.Ka(l,e,n).then(c=>{var u;if((c||n)&&s.isPrimaryClient){const d=c?!c.fromCache:(u=n==null?void 0:n.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;s.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){r.push(c);const d=a_.Wi(l.targetId,c);i.push(d)}}))}),await Promise.all(o),s.Ca.d_(r),await async function(l,c){const u=Ge(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ue.forEach(c,h=>ue.forEach(h.$i,p=>u.persistence.referenceDelegate.addReference(d,h.targetId,p)).next(()=>ue.forEach(h.Ui,p=>u.persistence.referenceDelegate.removeReference(d,h.targetId,p)))))}catch(d){if(!Nm(d))throw d;Ce("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const h=d.targetId;if(!d.fromCache){const p=u.os.get(h),f=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(f);u.os=u.os.insert(h,g)}}}(s.localStore,i))}async function qQ(t,e){const n=Ge(t);if(!n.currentUser.isEqual(e)){Ce("SyncEngine","User change. New user:",e.toKey());const s=await k4(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(l=>{l.reject(new Se(ae.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Am(n,s.hs)}}function KQ(t,e){const n=Ge(t),s=n.Na.get(e);if(s&&s.va)return rt().add(s.key);{let r=rt();const i=n.Ma.get(e);if(!i)return r;for(const o of i){const a=n.Fa.get(o);r=r.unionWith(a.view.Va)}return r}}function U4(t){const e=Ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=V4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UQ.bind(null,e),e.Ca.d_=AQ.bind(null,e.eventManager),e.Ca.$a=RQ.bind(null,e.eventManager),e}function XQ(t){const e=Ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=WQ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GQ.bind(null,e),e}class Bv{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sb(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return tQ(this.persistence,new ZY,e.initialUser,this.serializer)}Ga(e){return new YY(o_.Zr,this.serializer)}Wa(e){return new lQ}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bv.provider={build:()=>new Bv};class wS{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>JR(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=qQ.bind(null,this.syncEngine),await EQ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $Q}()}createDatastore(e){const n=sb(e.databaseInfo.databaseId),s=function(i){return new hQ(i)}(e.databaseInfo);return function(i,o,a,l){return new mQ(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,r,i,o,a){return new yQ(s,r,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>JR(this.syncEngine,n,0),function(){return qR.D()?new qR:new cQ}())}createSyncEngine(e,n){return function(r,i,o,a,l,c,u){const d=new FQ(r,i,o,a,l,c);return u&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const i=Ge(r);Ce("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await $m(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}wS.provider={build:()=>new wS};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Bo("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YQ{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=gs.UNAUTHENTICATED,this.clientId=W3.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{Ce("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(Ce("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Do;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=p_(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function CI(t,e){t.asyncQueue.verifyOperationInProgress(),Ce("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await k4(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function eD(t,e){t.asyncQueue.verifyOperationInProgress();const n=await QQ(t);Ce("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>KR(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>KR(e.remoteStore,r)),t._onlineComponents=e}async function QQ(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ce("FirestoreClient","Using user provided OfflineComponentProvider");try{await CI(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===ae.FAILED_PRECONDITION||r.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;ud("Error using user provided cache. Falling back to memory cache: "+n),await CI(t,new Bv)}}else Ce("FirestoreClient","Using default OfflineComponentProvider"),await CI(t,new Bv);return t._offlineComponents}async function G4(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ce("FirestoreClient","Using user provided OnlineComponentProvider"),await eD(t,t._uninitializedComponentsProvider._online)):(Ce("FirestoreClient","Using default OnlineComponentProvider"),await eD(t,new wS))),t._onlineComponents}function JQ(t){return G4(t).then(e=>e.syncEngine)}async function H4(t){const e=await G4(t),n=e.eventManager;return n.onListen=LQ.bind(null,e.syncEngine),n.onUnlisten=zQ.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=MQ.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=jQ.bind(null,e.syncEngine),n}function ZQ(t,e,n={}){const s=new Do;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new W4({next:h=>{u.Za(),o.enqueueAndForget(()=>P4(i,d));const p=h.docs.has(a);!p&&h.fromCache?c.reject(new Se(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&h.fromCache&&l&&l.source==="server"?c.reject(new Se(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new O4(ZN(a.path),u,{includeMetadataChanges:!0,_a:!0});return D4(i,d)}(await H4(t),t.asyncQueue,e,n,s)),s.promise}function eJ(t,e,n={}){const s=new Do;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new W4({next:h=>{u.Za(),o.enqueueAndForget(()=>P4(i,d)),h.fromCache&&l.source==="server"?c.reject(new Se(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new O4(a,u,{includeMetadataChanges:!0,_a:!0});return D4(i,d)}(await H4(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q4(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K4(t,e,n){if(!n)throw new Se(ae.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function tJ(t,e,n,s){if(e===!0&&s===!0)throw new Se(ae.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nD(t){if(!Fe.isDocumentKey(t))throw new Se(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function sD(t){if(Fe.isDocumentKey(t))throw new Se(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ob(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Be()}function Wo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Se(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ob(t);throw new Se(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e){var n,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Se(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}tJ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=q4((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ab{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rD({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rD(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new xX;switch(s.type){case"firstParty":return new IX(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Se(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=tD.get(n);s&&(Ce("ComponentProvider","Removing Datastore"),tD.delete(n),s.terminate())}(this),Promise.resolve()}}function nJ(t,e,n,s={}){var r;const i=(t=Wo(t,ab))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&ud("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),s.mockUserToken){let a,l;if(typeof s.mockUserToken=="string")a=s.mockUserToken,l=gs.MOCK_USER;else{a=KL(s.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=s.mockUserToken.sub||s.mockUserToken.user_id;if(!c)throw new Se(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new gs(c)}t._authCredentials=new vX(new U3(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Bd(this.firestore,e,this._query)}}class ir{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ha(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ir(this.firestore,e,this._key)}}class Ha extends Bd{constructor(e,n,s){super(e,n,ZN(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ir(this.firestore,null,new Fe(e))}withConverter(e){return new Ha(this.firestore,e,this._path)}}function Uv(t,e,...n){if(t=Zt(t),K4("collection","path",e),t instanceof ab){const s=Mt.fromString(e,...n);return sD(s),new Ha(t,null,s)}{if(!(t instanceof ir||t instanceof Ha))throw new Se(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Mt.fromString(e,...n));return sD(s),new Ha(t.firestore,null,s)}}function Wv(t,e,...n){if(t=Zt(t),arguments.length===1&&(e=W3.newId()),K4("doc","path",e),t instanceof ab){const s=Mt.fromString(e,...n);return nD(s),new ir(t,null,new Fe(s))}{if(!(t instanceof ir||t instanceof Ha))throw new Se(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Mt.fromString(e,...n));return nD(s),new ir(t.firestore,t instanceof Ha?t.converter:null,new Fe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new T4(this,"async_queue_retry"),this.Vu=()=>{const s=EI();s&&Ce("AsyncQueue","Visibility state changed to "+s.visibilityState),this.t_.jo()},this.mu=e;const n=EI();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=EI();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Do;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Nm(e))throw e;Ce("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(s=>{this.Eu=s,this.du=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(s);throw Bo("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.du=!1,s))));return this.mu=n,n}enqueueAfterDelay(e,n,s){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const r=h_.createAndSchedule(this,e,n,s,i=>this.yu(i));return this.Tu.push(r),r}fu(){this.Eu&&Be()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Ud extends ab{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new iD,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new iD(e),this._firestoreClient=void 0,await e}}}function sJ(t,e){const n=typeof t=="object"?t:PN(),s=typeof t=="string"?t:"(default)",r=H0(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=GL("firestore");i&&nJ(r,...i)}return r}function g_(t){if(t._terminated)throw new Se(ae.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||rJ(t),t._firestoreClient}function rJ(t){var e,n,s;const r=t._freezeSettings(),i=function(a,l,c,u){return new OX(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,q4(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._componentsProvider||!((n=r.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((s=r.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),t._firestoreClient=new YQ(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gd(ls.fromBase64String(e))}catch(n){throw new Se(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new gd(ls.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Se(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ss(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Se(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Se(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iJ=/^__.*__$/;class oJ{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new wl(e,this.data,this.fieldMask,n,this.fieldTransforms):new Em(e,this.data,n,this.fieldTransforms)}}class X4{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new wl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Y4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Be()}}class v_{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new v_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.Fu({path:s,xu:!1});return r.Ou(e),r}Nu(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.Fu({path:s,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Gv(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Y4(this.Cu)&&iJ.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class aJ{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||sb(e)}Qu(e,n,s,r=!1){return new v_({Cu:e,methodName:n,qu:s,path:ss.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function b_(t){const e=t._freezeSettings(),n=sb(t._databaseId);return new aJ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function lJ(t,e,n,s,r,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,r);I_("Data must be an object, but it was:",o,s);const a=Q4(s,o);let l,c;if(i.merge)l=new br(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const d of i.mergeFields){const h=IS(e,d,n);if(!o.contains(h))throw new Se(ae.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Z4(u,h)||u.push(h)}l=new br(u),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new oJ(new Js(a),l,c)}class ub extends cb{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ub}}class w_ extends cb{_toFieldTransform(e){return new oY(e.path,new Wf)}isEqual(e){return e instanceof w_}}function cJ(t,e,n,s){const r=t.Qu(1,e,n);I_("Data must be an object, but it was:",r,s);const i=[],o=Js.empty();Yc(s,(l,c)=>{const u=k_(e,l,n);c=Zt(c);const d=r.Nu(u);if(c instanceof ub)i.push(u);else{const h=Rm(c,d);h!=null&&(i.push(u),o.set(u,h))}});const a=new br(i);return new X4(o,a,r.fieldTransforms)}function uJ(t,e,n,s,r,i){const o=t.Qu(1,e,n),a=[IS(e,s,n)],l=[r];if(i.length%2!=0)throw new Se(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)a.push(IS(e,i[h])),l.push(i[h+1]);const c=[],u=Js.empty();for(let h=a.length-1;h>=0;--h)if(!Z4(c,a[h])){const p=a[h];let f=l[h];f=Zt(f);const g=o.Nu(p);if(f instanceof ub)c.push(p);else{const y=Rm(f,g);y!=null&&(c.push(p),u.set(p,y))}}const d=new br(c);return new X4(u,d,o.fieldTransforms)}function dJ(t,e,n,s=!1){return Rm(n,t.Qu(s?4:3,e))}function Rm(t,e){if(J4(t=Zt(t)))return I_("Unsupported field value:",e,t),Q4(t,e);if(t instanceof cb)return function(s,r){if(!Y4(r.Cu))throw r.Bu(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const a of s){let l=Rm(a,r.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(s,r){if((s=Zt(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return sY(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=Rn.fromDate(s);return{timestampValue:zv(r.serializer,i)}}if(s instanceof Rn){const i=new Rn(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:zv(r.serializer,i)}}if(s instanceof y_)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof gd)return{bytesValue:g4(r.serializer,s._byteString)};if(s instanceof ir){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:r_(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof x_)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return e_(a.serializer,l)})}}}}}}(s,r);throw r.Bu(`Unsupported field value: ${ob(s)}`)}(t,e)}function Q4(t,e){const n={};return G3(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yc(t,(s,r)=>{const i=Rm(r,e.Mu(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function J4(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Rn||t instanceof y_||t instanceof gd||t instanceof ir||t instanceof cb||t instanceof x_)}function I_(t,e,n){if(!J4(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const s=ob(n);throw s==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+s)}}function IS(t,e,n){if((e=Zt(e))instanceof lb)return e._internalPath;if(typeof e=="string")return k_(t,e);throw Gv("Field path arguments must be of type string or ",t,!1,void 0,n)}const hJ=new RegExp("[~\\*/\\[\\]]");function k_(t,e,n){if(e.search(hJ)>=0)throw Gv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new lb(...e.split("."))._internalPath}catch{throw Gv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Gv(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${s}`),o&&(l+=` in document ${r}`),l+=")"),new Se(ae.INVALID_ARGUMENT,a+t+l)}function Z4(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ir(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(S_("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class pJ extends eM{data(){return super.data()}}function S_(t,e){return typeof e=="string"?k_(t,e):e instanceof lb?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fJ(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Se(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class T_{}class mJ extends T_{}function gJ(t,e,...n){let s=[];e instanceof T_&&s.push(e),s=s.concat(n),function(i){const o=i.filter(l=>l instanceof N_).length,a=i.filter(l=>l instanceof db).length;if(o>1||o>0&&a>0)throw new Se(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)t=r._apply(t);return t}class db extends mJ{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new db(e,n,s)}_apply(e){const n=this._parse(e);return tM(e._query,n),new Bd(e.firestore,e.converter,hS(e._query,n))}_parse(e){const n=b_(e.firestore);return function(i,o,a,l,c,u,d){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Se(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){aD(d,u);const p=[];for(const f of d)p.push(oD(l,i,f));h={arrayValue:{values:p}}}else h=oD(l,i,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||aD(d,u),h=dJ(a,o,d,u==="in"||u==="not-in");return bn.create(c,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function yJ(t,e,n){const s=e,r=S_("where",t);return db._create(r,s,n)}class N_ extends T_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new N_(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:ki.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,i){let o=r;const a=i.getFlattenedFilters();for(const l of a)tM(o,l),o=hS(o,l)}(e._query,n),new Bd(e.firestore,e.converter,hS(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function oD(t,e,n){if(typeof(n=Zt(n))=="string"){if(n==="")throw new Se(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!e4(e)&&n.indexOf("/")!==-1)throw new Se(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(Mt.fromString(n));if(!Fe.isDocumentKey(s))throw new Se(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return ER(t,new Fe(s))}if(n instanceof ir)return ER(t,n._key);throw new Se(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ob(n)}.`)}function aD(t,e){if(!Array.isArray(t)||t.length===0)throw new Se(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tM(t,e){const n=function(r,i){for(const o of r)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Se(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Se(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class xJ{convertValue(e,n="none"){switch(Ec(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(_c(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Be()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Yc(e,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertVectorValue(e){var n,s,r;const i=(r=(s=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||s===void 0?void 0:s.values)===null||r===void 0?void 0:r.map(o=>hn(o.doubleValue));return new x_(i)}convertGeoPoint(e){return new y_(hn(e.latitude),hn(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=XN(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(jf(e));default:return null}}convertTimestamp(e){const n=tl(e);return new Rn(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=Mt.fromString(e);kt(I4(s));const r=new Bf(s.get(1),s.get(3)),i=new Fe(s.popFirst(5));return r.isEqual(n)||Bo(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vJ(t,e,n){let s;return s=t?t.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nM extends eM{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Xx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(S_("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class Xx extends nM{data(e={}){return super.data(e)}}class bJ{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Gp(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new Xx(this._firestore,this._userDataWriter,s.key,s,new Gp(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Se(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const l=new Xx(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Gp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Xx(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Gp(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:wJ(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function wJ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Be()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IJ(t){t=Wo(t,ir);const e=Wo(t.firestore,Ud);return ZQ(g_(e),t._key).then(n=>TJ(e,t,n))}class sM extends xJ{constructor(e){super(),this.firestore=e}convertBytes(e){return new gd(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ir(this.firestore,null,n)}}function kJ(t){t=Wo(t,Bd);const e=Wo(t.firestore,Ud),n=g_(e),s=new sM(e);return fJ(t._query),eJ(n,t._query).then(r=>new bJ(e,s,t,r))}function rM(t,e,n,...s){t=Wo(t,ir);const r=Wo(t.firestore,Ud),i=b_(r);let o;return o=typeof(e=Zt(e))=="string"||e instanceof lb?uJ(i,"updateDoc",t._key,e,n,s):cJ(i,"updateDoc",t._key,e),E_(r,[o.toMutation(t._key,xi.exists(!0))])}function SJ(t){return E_(Wo(t.firestore,Ud),[new t_(t._key,xi.none())])}function __(t,e){const n=Wo(t.firestore,Ud),s=Wv(t),r=vJ(t.converter,e);return E_(n,[lJ(b_(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,xi.exists(!1))]).then(()=>s)}function E_(t,e){return function(s,r){const i=new Do;return s.asyncQueue.enqueueAndForget(async()=>BQ(await JQ(s),r,i)),i.promise}(g_(t),e)}function TJ(t,e,n){const s=n.docs.get(e._key),r=new sM(t);return new nM(t,r,e._key,s,new Gp(n.hasPendingWrites,n.fromCache),e.converter)}function NJ(){return new w_("serverTimestamp")}(function(e,n=!0){(function(r){Vd=r})(Kc),kc(new Za("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),a=new Ud(new bX(s.getProvider("auth-internal")),new SX(s.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Se(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bf(c.options.projectId,u)}(o,r),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Gi(kR,"4.7.3",e),Gi(kR,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM="firebasestorage.googleapis.com",oM="storageBucket",_J=2*60*1e3,EJ=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln extends lo{constructor(e,n,s=0){super($I(e),`Firebase Storage: ${n} (${$I(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ln.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return $I(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var on;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(on||(on={}));function $I(t){return"storage/"+t}function C_(){const t="An unknown error occurred, please check the error payload for server response.";return new ln(on.UNKNOWN,t)}function CJ(t){return new ln(on.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function $J(t){return new ln(on.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function AJ(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ln(on.UNAUTHENTICATED,t)}function RJ(){return new ln(on.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function DJ(t){return new ln(on.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function PJ(){return new ln(on.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function OJ(){return new ln(on.CANCELED,"User canceled the upload/download.")}function FJ(t){return new ln(on.INVALID_URL,"Invalid URL '"+t+"'.")}function LJ(t){return new ln(on.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function MJ(){return new ln(on.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+oM+"' property when initializing the app?")}function VJ(){return new ln(on.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function zJ(){return new ln(on.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function jJ(t){return new ln(on.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function kS(t){return new ln(on.INVALID_ARGUMENT,t)}function aM(){return new ln(on.APP_DELETED,"The Firebase app was deleted.")}function BJ(t){return new ln(on.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function mf(t,e){return new ln(on.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Np(t){throw new ln(on.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=wr.makeFromUrl(e,n)}catch{return new wr(e,"")}if(s.path==="")return s;throw LJ(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(I){I.path_=decodeURIComponent(I.path)}const u="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${u}/b/${r}/o${h}`,"i"),f={bucket:1,path:3},g=n===iM?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",x=new RegExp(`^https?://${g}/${r}/${y}`,"i"),w=[{regex:a,indices:l,postModify:i},{regex:p,indices:f,postModify:c},{regex:x,indices:{bucket:1,path:2},postModify:c}];for(let I=0;I<w.length;I++){const N=w[I],A=N.regex.exec(e);if(A){const T=A[N.indices.bucket];let S=A[N.indices.path];S||(S=""),s=new wr(T,S),N.postModify(s);break}}if(s==null)throw FJ(e);return s}}class UJ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WJ(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...y){c||(c=!0,e.apply(null,y))}function d(y){r=setTimeout(()=>{r=null,t(p,l())},y)}function h(){i&&clearTimeout(i)}function p(y,...x){if(c){h();return}if(y){h(),u.call(null,y,...x);return}if(l()||o){h(),u.call(null,y,...x);return}s<64&&(s*=2);let w;a===1?(a=2,w=0):w=(s+Math.random())*1e3,d(w)}let f=!1;function g(y){f||(f=!0,h(),!c&&(r!==null?(y||(a=2),clearTimeout(r),d(0)):y||(a=1)))}return d(0),i=setTimeout(()=>{o=!0,g(!0)},n),g}function GJ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HJ(t){return t!==void 0}function qJ(t){return typeof t=="object"&&!Array.isArray(t)}function $_(t){return typeof t=="string"||t instanceof String}function lD(t){return A_()&&t instanceof Blob}function A_(){return typeof Blob<"u"}function cD(t,e,n,s){if(s<e)throw kS(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw kS(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function lM(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var dc;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(dc||(dc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KJ(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XJ{constructor(e,n,s,r,i,o,a,l,c,u,d,h=!0){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,f)=>{this.resolve_=p,this.reject_=f,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new ix(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===dc.NO_ERROR,l=i.getStatus();if(!a||KJ(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===dc.ABORT;s(!1,new ix(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;s(!0,new ix(c,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());HJ(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=C_();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?aM():OJ();o(l)}else{const l=PJ();o(l)}};this.canceled_?n(!1,new ix(!1,null,!0)):this.backoffId_=WJ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&GJ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ix{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function YJ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function QJ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function JJ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ZJ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function eZ(t,e,n,s,r,i,o=!0){const a=lM(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return JJ(c,e),YJ(c,n),QJ(c,i),ZJ(c,s),new XJ(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tZ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function nZ(...t){const e=tZ();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(A_())return new Blob(t);throw new ln(on.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function sZ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rZ(t){if(typeof atob>"u")throw jJ("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class AI{constructor(e,n){this.data=e,this.contentType=n||null}}function iZ(t,e){switch(t){case zi.RAW:return new AI(cM(e));case zi.BASE64:case zi.BASE64URL:return new AI(uM(t,e));case zi.DATA_URL:return new AI(aZ(e),lZ(e))}throw C_()}function cM(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=t.charCodeAt(++n);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function oZ(t){let e;try{e=decodeURIComponent(t)}catch{throw mf(zi.DATA_URL,"Malformed data URL.")}return cM(e)}function uM(t,e){switch(t){case zi.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw mf(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case zi.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw mf(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=rZ(e)}catch(r){throw r.message.includes("polyfill")?r:mf(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class dM{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw mf(zi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=cZ(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function aZ(t){const e=new dM(t);return e.base64?uM(zi.BASE64,e.rest):oZ(e.rest)}function lZ(t){return new dM(t).contentType}function cZ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,n){let s=0,r="";lD(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(lD(this.data_)){const s=this.data_,r=sZ(s,e,n);return r===null?null:new Na(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new Na(s,!0)}}static getBlob(...e){if(A_()){const n=e.map(s=>s instanceof Na?s.data_:s);return new Na(nZ.apply(null,n))}else{const n=e.map(o=>$_(o)?iZ(zi.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new Na(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hM(t){let e;try{e=JSON.parse(t)}catch{return null}return qJ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uZ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function dZ(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function pM(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hZ(t,e){return e}class Rs{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||hZ}}let ox=null;function pZ(t){return!$_(t)||t.length<2?t:pM(t)}function fM(){if(ox)return ox;const t=[];t.push(new Rs("bucket")),t.push(new Rs("generation")),t.push(new Rs("metageneration")),t.push(new Rs("name","fullPath",!0));function e(i,o){return pZ(o)}const n=new Rs("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new Rs("size");return r.xform=s,t.push(r),t.push(new Rs("timeCreated")),t.push(new Rs("updated")),t.push(new Rs("md5Hash",null,!0)),t.push(new Rs("cacheControl",null,!0)),t.push(new Rs("contentDisposition",null,!0)),t.push(new Rs("contentEncoding",null,!0)),t.push(new Rs("contentLanguage",null,!0)),t.push(new Rs("contentType",null,!0)),t.push(new Rs("metadata","customMetadata",!0)),ox=t,ox}function fZ(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new wr(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function mZ(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return fZ(s,t),s}function mM(t,e,n){const s=hM(e);return s===null?null:mZ(t,s,n)}function gZ(t,e,n,s){const r=hM(e);if(r===null||!$_(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const u=t.bucket,d=t.fullPath,h="/b/"+o(u)+"/o/"+o(d),p=R_(h,n,s),f=lM({alt:"media",token:c});return p+f})[0]}function yZ(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class gM{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(t){if(!t)throw C_()}function xZ(t,e){function n(s,r){const i=mM(t,r,e);return yM(i!==null),i}return n}function vZ(t,e){function n(s,r){const i=mM(t,r,e);return yM(i!==null),gZ(i,r,t.host,t._protocol)}return n}function xM(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=RJ():r=AJ():n.getStatus()===402?r=$J(t.bucket):n.getStatus()===403?r=DJ(t.path):r=s,r.status=n.getStatus(),r.serverResponse=s.serverResponse,r}return e}function bZ(t){const e=xM(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=CJ(t.path)),i.serverResponse=r.serverResponse,i}return n}function wZ(t,e,n){const s=e.fullServerUrl(),r=R_(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new gM(r,i,vZ(t,n),o);return a.errorHandler=bZ(e),a}function IZ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function kZ(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=IZ(null,e)),s}function SZ(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let I=0;I<2;I++)w=w+Math.random().toString().slice(2);return w}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=kZ(e,s,r),u=yZ(c,n),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",p=Na.getBlob(d,s,h);if(p===null)throw VJ();const f={name:c.fullPath},g=R_(i,t.host,t._protocol),y="POST",x=t.maxUploadRetryTime,v=new gM(g,y,xZ(t,n),x);return v.urlParams=f,v.headers=o,v.body=p.uploadData(),v.errorHandler=xM(e),v}class TZ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=dc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=dc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=dc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r){if(this.sent_)throw Np("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Np("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Np("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Np("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Np("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class NZ extends TZ{initXhr(){this.xhr_.responseType="text"}}function vM(){return new NZ}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,n){this._service=e,n instanceof wr?this._location=n:this._location=wr.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Cc(e,n)}get root(){const e=new wr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return pM(this._location.path)}get storage(){return this._service}get parent(){const e=uZ(this._location.path);if(e===null)return null;const n=new wr(this._location.bucket,e);return new Cc(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw BJ(e)}}function _Z(t,e,n){t._throwIfRoot("uploadBytes");const s=SZ(t.storage,t._location,fM(),new Na(e,!0),n);return t.storage.makeRequestWithTokens(s,vM).then(r=>({metadata:r,ref:t}))}function EZ(t){t._throwIfRoot("getDownloadURL");const e=wZ(t.storage,t._location,fM());return t.storage.makeRequestWithTokens(e,vM).then(n=>{if(n===null)throw zJ();return n})}function CZ(t,e){const n=dZ(t._location.path,e),s=new wr(t._location.bucket,n);return new Cc(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $Z(t){return/^[A-Za-z]+:\/\//.test(t)}function AZ(t,e){return new Cc(t,e)}function bM(t,e){if(t instanceof D_){const n=t;if(n._bucket==null)throw MJ();const s=new Cc(n,n._bucket);return e!=null?bM(s,e):s}else return e!==void 0?CZ(t,e):t}function RZ(t,e){if(e&&$Z(e)){if(t instanceof D_)return AZ(t,e);throw kS("To use ref(service, url), the first argument must be a Storage instance.")}else return bM(t,e)}function uD(t,e){const n=e==null?void 0:e[oM];return n==null?null:wr.makeFromBucketSpec(n,t)}function DZ(t,e,n,s={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=s;r&&(t._overrideAuthToken=typeof r=="string"?r:KL(r,t.app.options.projectId))}class D_{constructor(e,n,s,r,i){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=iM,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_J,this._maxUploadRetryTime=EJ,this._requests=new Set,r!=null?this._bucket=wr.makeFromBucketSpec(r,this._host):this._bucket=uD(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=wr.makeFromBucketSpec(this._url,e):this._bucket=uD(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cD("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cD("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Cc(this,e)}_makeRequest(e,n,s,r,i=!0){if(this._deleted)return new UJ(aM());{const o=eZ(e,this._appId,s,r,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const dD="@firebase/storage",hD="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wM="storage";function IM(t,e,n){return t=Zt(t),_Z(t,e,n)}function kM(t){return t=Zt(t),EZ(t)}function SM(t,e){return t=Zt(t),RZ(t,e)}function PZ(t=PN(),e){t=Zt(t);const s=H0(t,wM).getImmediate({identifier:e}),r=GL("storage");return r&&OZ(s,...r),s}function OZ(t,e,n,s={}){DZ(t,e,n,s)}function FZ(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new D_(n,s,r,e,Kc)}function LZ(){kc(new Za(wM,FZ,"PUBLIC").setMultipleInstances(!0)),Gi(dD,hD,""),Gi(dD,hD,"esm2017")}LZ();const MZ={apiKey:"AIzaSyBkkFF0XhNZeWuDmOfEhsgdfX1VBG7WTas",authDomain:"welinkyou-dev.firebaseapp.com",projectId:"welinkyou-dev",storageBucket:"welinkyou-dev.appspot.com",messagingSenderId:"123456789012",appId:"1:123456789012:web:a1b2c3d4e5f6g7h8i9j0k1"},P_=QL(MZ),ci=gX(P_);ci.useDeviceLanguage();const VZ={persistence:!0,popupRedirectResolver:void 0};ci.settings=VZ;const sc=sJ(P_),TM=PZ(P_),NM=M.createContext(null),zZ=({children:t})=>{const[e,n]=M.useState(null),[s,r]=M.useState(!0);M.useEffect(()=>rK(ci,a=>{n(a),r(!1)}),[]);const i={user:e,loading:s};return b.jsx(NM.Provider,{value:i,children:!s&&t})},O_=()=>{const t=M.useContext(NM);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};function _M(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=_M(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function SS(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=_M(t))&&(s&&(s+=" "),s+=e);return s}function jZ(){const t=Es(),[e,n]=M.useState("swap"),s=r=>{n(r),r==="swap"?t("/swap"):r==="buy-sell"&&t("/buy-sell")};return b.jsx("div",{className:"min-h-screen landing-gradient",children:b.jsxs("div",{className:"container mx-auto px-4 py-12",children:[b.jsxs("div",{className:"text-center mb-16",children:[b.jsx("h1",{className:"text-6xl font-bold text-white mb-4",children:"weLINCyou"}),b.jsx("p",{className:"text-xl text-white mb-2",children:"securely · reliably · fastest"})]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto mb-12",children:[b.jsx("button",{onClick:()=>s("buy-sell"),className:SS("bg-white rounded-2xl p-8 text-center transition-all transform hover:scale-105",e==="buy-sell"&&"ring-4 ring-primary"),children:b.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Buy & Sell"})}),b.jsx("button",{onClick:()=>s("swap"),className:SS("bg-white rounded-2xl p-8 text-center transition-all transform hover:scale-105",e==="swap"&&"ring-4 ring-primary"),children:b.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Swap"})})]}),b.jsx("div",{className:"text-center text-white",children:b.jsxs("div",{className:"grid grid-cols-3 max-w-lg mx-auto",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-2xl font-bold",children:"50K+"}),b.jsx("p",{children:"Users"})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-2xl font-bold",children:"100K+"}),b.jsx("p",{children:"Transactions"})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-2xl font-bold",children:"4.9★"}),b.jsx("p",{children:"Rating"})]})]})})]})})}function BZ({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const F_=M.forwardRef(BZ);function UZ({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}))}const WZ=M.forwardRef(UZ);function GZ({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const HZ=M.forwardRef(GZ);function qZ({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const KZ=M.forwardRef(qZ);function XZ({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const YZ=M.forwardRef(XZ);function QZ({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const EM=M.forwardRef(QZ);function JZ({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const Dm=M.forwardRef(JZ);function ZZ({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const eee=M.forwardRef(ZZ);function tee({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6Z"}))}const nee=M.forwardRef(tee);function see({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const ree=M.forwardRef(see);function iee({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const CM=M.forwardRef(iee);function oee({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const L_=M.forwardRef(oee);function aee({onPostAd:t}){const e=Es();return b.jsx("nav",{className:"bg-white shadow",children:b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"flex justify-between h-16",children:[b.jsx("div",{className:"flex",children:b.jsx(Ja,{to:"/",className:"flex items-center",children:b.jsx("span",{className:"text-2xl font-bold text-primary",children:"weLINKyou"})})}),b.jsxs("div",{className:"flex items-center space-x-4",children:[b.jsx("button",{onClick:t,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-secondary transition-colors",children:"Post Ad"}),b.jsx(F_,{className:"h-6 w-6 text-gray-500 cursor-pointer"}),b.jsx(CM,{className:"h-6 w-6 text-gray-500 cursor-pointer",onClick:()=>e("/profile")})]})]})})})}const lee=["Vehicles","Property","Electronics","Furniture","Fashion","Sports","Collectibles","Jobs","Services"];function cee(){return b.jsx("div",{className:"bg-white border-b",children:b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:b.jsx("div",{className:"flex space-x-8 overflow-x-auto py-4",children:lee.map(t=>b.jsx("button",{className:"text-gray-600 hover:text-primary whitespace-nowrap",children:t},t))})})})}function uee({id:t=1,title:e,price:n,location:s,imageUrl:r,date:i}){return b.jsx(Ja,{to:`/product/${t}`,className:"block",children:b.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-shadow",children:[b.jsx("img",{src:r,alt:e,className:"w-full h-48 object-cover"}),b.jsxs("div",{className:"p-4",children:[b.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:e}),b.jsxs("p",{className:"text-xl font-bold text-primary",children:["R ",n.toLocaleString()]}),b.jsxs("div",{className:"mt-2 flex justify-between items-center text-sm text-gray-500",children:[b.jsx("span",{children:s}),b.jsx("span",{children:i})]})]})]})})}const $M=[{title:"2019 Tesla Model 3 Long Range",price:799e3,location:"Cape Town, WC",imageUrl:"https://images.unsplash.com/photo-1560958089-b8a1929cea89?auto=format&fit=crop&w=800",date:"Just now"},{title:"iPhone 14 Pro Max - 256GB",price:19999,location:"Johannesburg, GP",imageUrl:"https://images.unsplash.com/photo-1678911820864-e2c567c655d7?auto=format&fit=crop&w=800",date:"2 hours ago"},{title:"Modern Apartment in Sandton",price:25e3,location:"Sandton, GP",imageUrl:"https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?auto=format&fit=crop&w=800",date:"5 hours ago"},{title:"MacBook Pro M2 - 512GB",price:35999,location:"Durban, KZN",imageUrl:"https://images.unsplash.com/photo-1517336714731-489689fd1ca8?auto=format&fit=crop&w=800",date:"1 day ago"},{title:"Professional Camera Kit",price:65e3,location:"Pretoria, GP",imageUrl:"https://images.unsplash.com/photo-1516035069371-29a1b244cc32?auto=format&fit=crop&w=800",date:"2 days ago"},{title:"Vintage Record Collection",price:8500,location:"Port Elizabeth, EC",imageUrl:"https://images.unsplash.com/photo-1489641493513-ba4ee84ccea9?auto=format&fit=crop&w=800",date:"3 days ago"}];function dee(){return b.jsxs("div",{children:[b.jsxs("div",{className:"flex justify-between items-center mb-6",children:[b.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Featured Listings"}),b.jsx("button",{className:"text-primary hover:text-secondary",children:"View all"})]}),b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:$M.map((t,e)=>b.jsx(uee,{...t},e))})]})}function hee(){const t=[{title:"Safe & Secure",description:"Verified users and secure transactions for peace of mind"},{title:"Easy to Use",description:"Simple listing process and intuitive interface"},{title:"Item Swapping",description:"Unique feature to exchange items of similar value"}];return b.jsxs("div",{className:"mt-12 text-center",children:[b.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Why choose weLINKyou?"}),b.jsx("div",{className:"grid md:grid-cols-3 gap-8 mt-8",children:t.map((e,n)=>b.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-sm",children:[b.jsx("h3",{className:"text-xl font-semibold mb-2",children:e.title}),b.jsx("p",{className:"text-gray-600",children:e.description})]},n))})]})}function pee(){return b.jsx("footer",{className:"bg-white border-t mt-16",children:b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:b.jsx("div",{className:"text-center text-gray-500",children:b.jsx("p",{children:"© 2024 weLINKyou. All rights reserved."})})})})}function fee(){const t=Es(),{user:e}=O_(),n=()=>{e?t("/post-ad"):t("/login",{state:{from:"/post-ad"}})};return b.jsxs("div",{className:"min-h-screen bg-gray-50",children:[b.jsx(aee,{onPostAd:n}),b.jsx(cee,{}),b.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[b.jsx(dee,{}),b.jsx(hee,{})]}),b.jsx(pee,{})]})}function mee(){const t=Es();return b.jsx("div",{className:"min-h-screen landing-gradient",children:b.jsxs("div",{className:"container mx-auto px-4 py-12",children:[b.jsxs("div",{className:"text-center mb-16",children:[b.jsx("h1",{className:"text-6xl font-bold text-white mb-4",children:"weLINKyou"}),b.jsx("p",{className:"text-xl text-white/90 mb-2",children:"securely · reliably · fastest"})]}),b.jsxs("div",{className:"flex flex-col items-center gap-6 mb-12",children:[b.jsx("button",{onClick:()=>t("/dashboard"),className:"bg-white text-primary font-bold py-4 px-8 rounded-xl w-[45%] hover:bg-gray-50 transition-all duration-300 shadow-button",children:"Browse"}),b.jsx("button",{onClick:()=>t("/login"),className:"bg-white text-primary font-bold py-4 px-8 rounded-xl w-[45%] hover:bg-gray-50 transition-all duration-300 shadow-button",children:"Login"}),b.jsx("button",{onClick:()=>t("/signup"),className:"bg-white text-primary font-bold py-4 px-8 rounded-xl w-[45%] hover:bg-gray-50 transition-all duration-300 shadow-button",children:"Register"})]}),b.jsxs("div",{className:"text-center text-white",children:[b.jsx("h4",{className:"text-xl font-medium mb-8",children:"Trusted by South African Swappers"}),b.jsxs("div",{className:"grid grid-cols-3 max-w-lg mx-auto",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-3xl font-bold",children:"10K+"}),b.jsx("p",{className:"text-white/90",children:"Users"})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-3xl font-bold",children:"50K+"}),b.jsx("p",{className:"text-white/90",children:"Swaps"})]}),b.jsxs("div",{children:[b.jsx("p",{className:"text-3xl font-bold",children:"4.9★"}),b.jsx("p",{className:"text-white/90",children:"Rating"})]})]})]})]})})}class hb{constructor(){tK(ci,T3)}async signInWithGoogle(){try{const e=new So;e.setCustomParameters({prompt:"select_account"});try{return(await SK(ci,e)).user}catch(n){console.log("Popup failed, falling back to redirect:",n),await $K(ci,e);const s=await RK(ci);if(s)return s.user}}catch(e){throw console.error("Authentication error:",e),this.handleAuthError(e)}}async signUp(e,n){try{return(await Zq(ci,e,n)).user}catch(s){throw this.handleAuthError(s)}}async signIn(e,n){try{return(await eK(ci,e,n)).user}catch(s){throw this.handleAuthError(s)}}async resetPassword(e){try{await Jq(ci,e)}catch(n){throw this.handleAuthError(n)}}async logout(){try{await iK(ci)}catch(e){throw this.handleAuthError(e)}}handleAuthError(e){const n={"auth/email-already-in-use":"This email is already registered.","auth/invalid-email":"Invalid email address.","auth/operation-not-allowed":"Operation not allowed.","auth/weak-password":"Password is too weak.","auth/user-disabled":"This account has been disabled.","auth/user-not-found":"No account found with this email.","auth/wrong-password":"Incorrect password.","auth/popup-blocked":"The sign-in popup was blocked by your browser. Please allow popups or try again.","auth/cancelled-popup-request":"The sign-in popup was closed.","auth/popup-closed-by-user":"The sign-in popup was closed before completing the sign-in process.","auth/network-request-failed":"A network error occurred. Please check your connection and try again.","auth/too-many-requests":"Too many unsuccessful sign-in attempts. Please try again later.","auth/unauthorized-domain":"This domain is not authorized for Firebase Authentication. Please contact support.","auth/invalid-api-key":"Invalid Firebase configuration. Please contact support."};return new Error(n[e.code]||e.message)}}function AM({title:t,subtitle:e}){return b.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[b.jsx(Ja,{to:"/",className:"flex justify-center mb-6",children:b.jsx("span",{className:"text-3xl font-bold text-primary",children:"weLINKyou"})}),b.jsx("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:t}),e&&b.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:e})]})}function RM({children:t}){return b.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[t,b.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:b.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:t})})]})}function DM(){const t=Es(),e=new hb,n=async()=>{try{await e.signInWithGoogle(),t("/dashboard")}catch(s){console.error("Google sign-in error:",s)}};return b.jsxs("div",{className:"mt-6",children:[b.jsxs("div",{className:"relative",children:[b.jsx("div",{className:"absolute inset-0 flex items-center",children:b.jsx("div",{className:"w-full border-t border-gray-300"})}),b.jsx("div",{className:"relative flex justify-center text-sm",children:b.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),b.jsx("div",{className:"mt-6",children:b.jsxs("button",{onClick:n,className:"w-full flex justify-center items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:[b.jsx("img",{className:"h-5 w-5 mr-2",src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google logo"}),"Continue with Google"]})})]})}function gee(){const t=Es(),[e,n]=M.useState({email:"",password:"",confirmPassword:"",fullName:"",location:""}),[s,r]=M.useState(""),[i,o]=M.useState(!1),a=new hb,l=async c=>{if(c.preventDefault(),r(""),e.password!==e.confirmPassword){r("Passwords do not match");return}o(!0);try{await a.signUp(e.email,e.password),t("/dashboard")}catch(u){r(u.message)}finally{o(!1)}};return b.jsxs(RM,{children:[b.jsx(AM,{title:"Create your account",subtitle:"Join South Africa's trusted item swapping community"}),b.jsxs("form",{onSubmit:l,className:"space-y-6",children:[s&&b.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:s}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),b.jsx("input",{type:"text",required:!0,value:e.fullName,onChange:c=>n({...e,fullName:c.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email address"}),b.jsx("input",{type:"email",required:!0,value:e.email,onChange:c=>n({...e,email:c.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),b.jsx("input",{type:"text",required:!0,value:e.location,onChange:c=>n({...e,location:c.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:"City, Province"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),b.jsx("input",{type:"password",required:!0,value:e.password,onChange:c=>n({...e,password:c.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),b.jsx("input",{type:"password",required:!0,value:e.confirmPassword,onChange:c=>n({...e,confirmPassword:c.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50",children:i?"Creating account...":"Create account"}),b.jsx(DM,{}),b.jsxs("div",{className:"text-center mt-4",children:[b.jsx("span",{className:"text-gray-600",children:"Already have an account?"}),b.jsx(Ja,{to:"/login",className:"ml-1 text-primary hover:text-secondary font-medium",children:"Sign in"})]})]})]})}function yee(){var d;const t=Es(),n=((d=bl().state)==null?void 0:d.from)||"/dashboard",[s,r]=M.useState({email:"",password:""}),[i,o]=M.useState(""),[a,l]=M.useState(!1),c=new hb,u=async h=>{h.preventDefault(),o("");try{l(!0),await c.signIn(s.email,s.password),t(n,{replace:!0})}catch(p){o(p.message)}finally{l(!1)}};return b.jsxs(RM,{children:[b.jsx(AM,{title:"Welcome back",subtitle:"Sign in to access your account"}),b.jsxs("form",{onSubmit:u,className:"space-y-6",children:[i&&b.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:i}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email address"}),b.jsx("input",{type:"email",required:!0,value:s.email,onChange:h=>r({...s,email:h.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),b.jsx("input",{type:"password",required:!0,value:s.password,onChange:h=>r({...s,password:h.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsx("div",{className:"flex items-center justify-end",children:b.jsx(Ja,{to:"/forgot-password",className:"text-sm text-primary hover:text-secondary",children:"Forgot your password?"})}),b.jsx("button",{type:"submit",disabled:a,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50",children:a?"Signing in...":"Sign in"}),b.jsx(DM,{}),b.jsxs("div",{className:"text-center",children:[b.jsx("span",{className:"text-gray-600",children:"Don't have an account?"}),b.jsx(Ja,{to:"/signup",className:"ml-1 text-primary hover:text-secondary font-medium",children:"Sign up"})]})]})]})}function xee(){const t=Es(),[e,n]=M.useState(""),[s,r]=M.useState(""),[i,o]=M.useState(!1),[a,l]=M.useState(!1),c=new hb,u=async d=>{d.preventDefault(),r(""),o(!1);try{l(!0),await c.resetPassword(e),o(!0)}catch(h){r(h.message)}finally{l(!1)}};return b.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[b.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[b.jsx("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Reset your password"}),b.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Enter your email address and we'll send you a link to reset your password."})]}),b.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:b.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[s&&b.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:s}),i&&b.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:"Check your email for password reset instructions."}),b.jsxs("form",{onSubmit:u,className:"space-y-6",children:[b.jsxs("div",{children:[b.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),b.jsx("input",{id:"email",type:"email",required:!0,value:e,onChange:d=>n(d.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsx("button",{type:"submit",disabled:a,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:a?"Sending...":"Send reset link"})]}),b.jsx("div",{className:"mt-6",children:b.jsx("div",{className:"relative",children:b.jsx("div",{className:"relative flex justify-center text-sm",children:b.jsxs("span",{className:"px-2 bg-white text-gray-500",children:["Remember your password?"," ",b.jsx("button",{onClick:()=>t("/login"),className:"font-medium text-primary hover:text-secondary",children:"Sign in"})]})})})})]})})]})}function vee({onSearch:t}){const[e,n]=M.useState(""),s=r=>{r.preventDefault(),t(e)};return b.jsx("form",{onSubmit:s,children:b.jsxs("div",{className:"relative",children:[b.jsx("input",{type:"text",value:e,onChange:r=>n(r.target.value),placeholder:"Search items or categories...",className:"w-full border border-gray-300 rounded-lg py-3 px-8 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),b.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary transition-colors",children:"Search"})]})})}const bee=[{id:1,title:"PlayStation 5",description:"Digital Edition, excellent condition with 2 controllers",image:"https://images.unsplash.com/photo-1606813907291-d86efa9b94db?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80",value:8500,category:"Electronics",location:"Cape Town",condition:"Excellent",features:["Digital Edition","2 Controllers","Original Box","All Cables"]},{id:2,title:"iPhone 14 Pro",description:"256GB, Excellent condition",image:"https://images.unsplash.com/photo-1678911820864-e2c567c655d7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80",value:18e3,category:"Electronics",location:"Johannesburg"}];function wee(){return b.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:bee.map(t=>b.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[b.jsx("div",{className:"aspect-w-16 aspect-h-9",children:b.jsx("img",{src:t.image,alt:t.title,className:"w-full h-48 object-cover"})}),b.jsxs("div",{className:"p-4",children:[b.jsx("h3",{className:"font-bold text-lg mb-1",children:t.title}),b.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:t.description}),b.jsxs("div",{className:"flex justify-between items-center",children:[b.jsxs("div",{children:[b.jsx("span",{className:"text-sm text-gray-600",children:t.category}),b.jsx("span",{className:"text-xs text-gray-500 block",children:t.location})]}),b.jsxs("span",{className:"text-primary font-medium",children:["R ",t.value.toLocaleString()]})]})]})]},t.id))})}var Iee=Object.defineProperty,kee=(t,e,n)=>e in t?Iee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,RI=(t,e,n)=>(kee(t,typeof e!="symbol"?e+"":e,n),n);let See=class{constructor(){RI(this,"current",this.detect()),RI(this,"handoffState","pending"),RI(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Po=new See,Go=(t,e)=>{Po.isServer?M.useEffect(t,e):M.useLayoutEffect(t,e)};function pb(t){let e=M.useRef(t);return Go(()=>{e.current=t},[t]),e}let Ss=function(t){let e=pb(t);return bt.useCallback((...n)=>e.current(...n),[e])};function fb(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function mb(){let t=[],e={addEventListener(n,s,r,i){return n.addEventListener(s,r,i),e.add(()=>n.removeEventListener(s,r,i))},requestAnimationFrame(...n){let s=requestAnimationFrame(...n);return e.add(()=>cancelAnimationFrame(s))},nextFrame(...n){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...n))},setTimeout(...n){let s=setTimeout(...n);return e.add(()=>clearTimeout(s))},microTask(...n){let s={current:!0};return fb(()=>{s.current&&n[0]()}),e.add(()=>{s.current=!1})},style(n,s,r){let i=n.style.getPropertyValue(s);return Object.assign(n.style,{[s]:r}),this.add(()=>{Object.assign(n.style,{[s]:i})})},group(n){let s=mb();return n(s),this.add(()=>s.dispose())},add(n){return t.push(n),()=>{let s=t.indexOf(n);if(s>=0)for(let r of t.splice(s,1))r()}},dispose(){for(let n of t.splice(0))n()}};return e}function Tee(){let[t]=M.useState(mb);return M.useEffect(()=>()=>t.dispose(),[t]),t}function Nee(){let t=typeof document>"u";return"useSyncExternalStore"in nd?(e=>e.useSyncExternalStore)(nd)(()=>()=>{},()=>!1,()=>!t):!1}function gb(){let t=Nee(),[e,n]=M.useState(Po.isHandoffComplete);return e&&Po.isHandoffComplete===!1&&n(!1),M.useEffect(()=>{e!==!0&&n(!0)},[e]),M.useEffect(()=>Po.handoff(),[]),t?!1:e}var pD;let Wd=(pD=bt.useId)!=null?pD:function(){let t=gb(),[e,n]=bt.useState(t?()=>Po.nextId():null);return Go(()=>{e===null&&n(Po.nextId())},[e]),e!=null?""+e:void 0};function sl(t,e,...n){if(t in e){let r=e[t];return typeof r=="function"?r(...n):r}let s=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(r=>`"${r}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,sl),s}function PM(t){return Po.isServer?null:t instanceof Node?t.ownerDocument:t!=null&&t.hasOwnProperty("current")&&t.current instanceof Node?t.current.ownerDocument:document}let TS=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var Gl=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t))(Gl||{}),OM=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(OM||{}),_ee=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(_ee||{});function Eee(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(TS)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var FM=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(FM||{});function Cee(t,e=0){var n;return t===((n=PM(t))==null?void 0:n.body)?!1:sl(e,{0(){return t.matches(TS)},1(){let s=t;for(;s!==null;){if(s.matches(TS))return!0;s=s.parentElement}return!1}})}var $ee=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))($ee||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function hc(t){t==null||t.focus({preventScroll:!0})}let Aee=["textarea","input"].join(",");function Ree(t){var e,n;return(n=(e=t==null?void 0:t.matches)==null?void 0:e.call(t,Aee))!=null?n:!1}function Dee(t,e=n=>n){return t.slice().sort((n,s)=>{let r=e(n),i=e(s);if(r===null||i===null)return 0;let o=r.compareDocumentPosition(i);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Yx(t,e,{sorted:n=!0,relativeTo:s=null,skipElements:r=[]}={}){let i=Array.isArray(t)?t.length>0?t[0].ownerDocument:document:t.ownerDocument,o=Array.isArray(t)?n?Dee(t):t:Eee(t);r.length>0&&o.length>1&&(o=o.filter(p=>!r.includes(p))),s=s??i.activeElement;let a=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),l=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(s))-1;if(e&4)return Math.max(0,o.indexOf(s))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=e&32?{preventScroll:!0}:{},u=0,d=o.length,h;do{if(u>=d||u+d<=0)return 0;let p=l+u;if(e&16)p=(p+d)%d;else{if(p<0)return 3;if(p>=d)return 1}h=o[p],h==null||h.focus(c),u+=a}while(h!==i.activeElement);return e&6&&Ree(h)&&h.select(),2}function LM(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Pee(){return/Android/gi.test(window.navigator.userAgent)}function Oee(){return LM()||Pee()}function ax(t,e,n){let s=pb(e);M.useEffect(()=>{function r(i){s.current(i)}return document.addEventListener(t,r,n),()=>document.removeEventListener(t,r,n)},[t,n])}function MM(t,e,n){let s=pb(e);M.useEffect(()=>{function r(i){s.current(i)}return window.addEventListener(t,r,n),()=>window.removeEventListener(t,r,n)},[t,n])}function Fee(t,e,n=!0){let s=M.useRef(!1);M.useEffect(()=>{requestAnimationFrame(()=>{s.current=n})},[n]);function r(o,a){if(!s.current||o.defaultPrevented)return;let l=a(o);if(l===null||!l.getRootNode().contains(l)||!l.isConnected)return;let c=function u(d){return typeof d=="function"?u(d()):Array.isArray(d)||d instanceof Set?d:[d]}(t);for(let u of c){if(u===null)continue;let d=u instanceof HTMLElement?u:u.current;if(d!=null&&d.contains(l)||o.composed&&o.composedPath().includes(d))return}return!Cee(l,FM.Loose)&&l.tabIndex!==-1&&o.preventDefault(),e(o,l)}let i=M.useRef(null);ax("pointerdown",o=>{var a,l;s.current&&(i.current=((l=(a=o.composedPath)==null?void 0:a.call(o))==null?void 0:l[0])||o.target)},!0),ax("mousedown",o=>{var a,l;s.current&&(i.current=((l=(a=o.composedPath)==null?void 0:a.call(o))==null?void 0:l[0])||o.target)},!0),ax("click",o=>{Oee()||i.current&&(r(o,()=>i.current),i.current=null)},!0),ax("touchend",o=>r(o,()=>o.target instanceof HTMLElement?o.target:null),!0),MM("blur",o=>r(o,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Pm(...t){return M.useMemo(()=>PM(...t),[...t])}let VM=Symbol();function Lee(t,e=!0){return Object.assign(t,{[VM]:e})}function ta(...t){let e=M.useRef(t);M.useEffect(()=>{e.current=t},[t]);let n=Ss(s=>{for(let r of e.current)r!=null&&(typeof r=="function"?r(s):r.current=s)});return t.every(s=>s==null||(s==null?void 0:s[VM]))?void 0:n}function M_(t,e){let n=M.useRef([]),s=Ss(t);M.useEffect(()=>{let r=[...n.current];for(let[i,o]of e.entries())if(n.current[i]!==o){let a=s(e,r);return n.current=e,a}},[s,...e])}function fD(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}var NS=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(NS||{}),Mee=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(Mee||{});function co({ourProps:t,theirProps:e,slot:n,defaultTag:s,features:r,visible:i=!0,name:o,mergeRefs:a}){a=a??Vee;let l=zM(e,t);if(i)return lx(l,n,s,o,a);let c=r??0;if(c&2){let{static:u=!1,...d}=l;if(u)return lx(d,n,s,o,a)}if(c&1){let{unmount:u=!0,...d}=l;return sl(u?0:1,{0(){return null},1(){return lx({...d,hidden:!0,style:{display:"none"}},n,s,o,a)}})}return lx(l,n,s,o,a)}function lx(t,e={},n,s,r){let{as:i=n,children:o,refName:a="ref",...l}=DI(t,["unmount","static"]),c=t.ref!==void 0?{[a]:t.ref}:{},u=typeof o=="function"?o(e):o;"className"in l&&l.className&&typeof l.className=="function"&&(l.className=l.className(e));let d={};if(e){let h=!1,p=[];for(let[f,g]of Object.entries(e))typeof g=="boolean"&&(h=!0),g===!0&&p.push(f);h&&(d["data-headlessui-state"]=p.join(" "))}if(i===M.Fragment&&Object.keys(mD(l)).length>0){if(!M.isValidElement(u)||Array.isArray(u)&&u.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${s} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(l).map(g=>`  - ${g}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(g=>`  - ${g}`).join(`
`)].join(`
`));let h=u.props,p=typeof(h==null?void 0:h.className)=="function"?(...g)=>fD(h==null?void 0:h.className(...g),l.className):fD(h==null?void 0:h.className,l.className),f=p?{className:p}:{};return M.cloneElement(u,Object.assign({},zM(u.props,mD(DI(l,["ref"]))),d,c,{ref:r(u.ref,c.ref)},f))}return M.createElement(i,Object.assign({},DI(l,["ref"]),i!==M.Fragment&&c,i!==M.Fragment&&d),u)}function Vee(...t){return t.every(e=>e==null)?void 0:e=>{for(let n of t)n!=null&&(typeof n=="function"?n(e):n.current=e)}}function zM(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let s of t)for(let r in s)r.startsWith("on")&&typeof s[r]=="function"?(n[r]!=null||(n[r]=[]),n[r].push(s[r])):e[r]=s[r];if(e.disabled||e["aria-disabled"])return Object.assign(e,Object.fromEntries(Object.keys(n).map(s=>[s,void 0])));for(let s in n)Object.assign(e,{[s](r,...i){let o=n[s];for(let a of o){if((r instanceof Event||(r==null?void 0:r.nativeEvent)instanceof Event)&&r.defaultPrevented)return;a(r,...i)}}});return e}function uo(t){var e;return Object.assign(M.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function mD(t){let e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function DI(t,e=[]){let n=Object.assign({},t);for(let s of e)s in n&&delete n[s];return n}let zee="div";var Hv=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(Hv||{});function jee(t,e){var n;let{features:s=1,...r}=t,i={ref:e,"aria-hidden":(s&2)===2?!0:(n=r["aria-hidden"])!=null?n:void 0,hidden:(s&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(s&4)===4&&(s&2)!==2&&{display:"none"}}};return co({ourProps:i,theirProps:r,slot:{},defaultTag:zee,name:"Hidden"})}let _S=uo(jee),jM=M.createContext(null);jM.displayName="OpenClosedContext";var Hp=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(Hp||{});function Bee(){return M.useContext(jM)}function Uee(t){function e(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let _a=[];Uee(()=>{function t(e){e.target instanceof HTMLElement&&e.target!==document.body&&_a[0]!==e.target&&(_a.unshift(e.target),_a=_a.filter(n=>n!=null&&n.isConnected),_a.splice(10))}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function Wee(t){let e=t.parentElement,n=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(n=e),e=e.parentElement;let s=(e==null?void 0:e.getAttribute("disabled"))==="";return s&&Gee(n)?!1:s}function Gee(t){if(!t)return!1;let e=t.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}var BM=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(BM||{});function UM(t,e,n,s){let r=pb(n);M.useEffect(()=>{t=t??window;function i(o){r.current(o)}return t.addEventListener(e,i,s),()=>t.removeEventListener(e,i,s)},[t,e,s])}function WM(){let t=M.useRef(!1);return Go(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function GM(t){let e=Ss(t),n=M.useRef(!1);M.useEffect(()=>(n.current=!1,()=>{n.current=!0,fb(()=>{n.current&&e()})}),[e])}var qp=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(qp||{});function Hee(){let t=M.useRef(0);return MM("keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function HM(t){if(!t)return new Set;if(typeof t=="function")return new Set(t());let e=new Set;for(let n of t.current)n.current instanceof HTMLElement&&e.add(n.current);return e}let qee="div";var qM=(t=>(t[t.None=1]="None",t[t.InitialFocus=2]="InitialFocus",t[t.TabLock=4]="TabLock",t[t.FocusLock=8]="FocusLock",t[t.RestoreFocus=16]="RestoreFocus",t[t.All=30]="All",t))(qM||{});function Kee(t,e){let n=M.useRef(null),s=ta(n,e),{initialFocus:r,containers:i,features:o=30,...a}=t;gb()||(o=1);let l=Pm(n);Qee({ownerDocument:l},!!(o&16));let c=Jee({ownerDocument:l,container:n,initialFocus:r},!!(o&2));Zee({ownerDocument:l,container:n,containers:i,previousActiveElement:c},!!(o&8));let u=Hee(),d=Ss(g=>{let y=n.current;y&&(x=>x())(()=>{sl(u.current,{[qp.Forwards]:()=>{Yx(y,Gl.First,{skipElements:[g.relatedTarget]})},[qp.Backwards]:()=>{Yx(y,Gl.Last,{skipElements:[g.relatedTarget]})}})})}),h=Tee(),p=M.useRef(!1),f={ref:s,onKeyDown(g){g.key=="Tab"&&(p.current=!0,h.requestAnimationFrame(()=>{p.current=!1}))},onBlur(g){let y=HM(i);n.current instanceof HTMLElement&&y.add(n.current);let x=g.relatedTarget;x instanceof HTMLElement&&x.dataset.headlessuiFocusGuard!=="true"&&(KM(y,x)||(p.current?Yx(n.current,sl(u.current,{[qp.Forwards]:()=>Gl.Next,[qp.Backwards]:()=>Gl.Previous})|Gl.WrapAround,{relativeTo:g.target}):g.target instanceof HTMLElement&&hc(g.target)))}};return bt.createElement(bt.Fragment,null,!!(o&4)&&bt.createElement(_S,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:d,features:Hv.Focusable}),co({ourProps:f,theirProps:a,defaultTag:qee,name:"FocusTrap"}),!!(o&4)&&bt.createElement(_S,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:d,features:Hv.Focusable}))}let Xee=uo(Kee),_p=Object.assign(Xee,{features:qM});function Yee(t=!0){let e=M.useRef(_a.slice());return M_(([n],[s])=>{s===!0&&n===!1&&fb(()=>{e.current.splice(0)}),s===!1&&n===!0&&(e.current=_a.slice())},[t,_a,e]),Ss(()=>{var n;return(n=e.current.find(s=>s!=null&&s.isConnected))!=null?n:null})}function Qee({ownerDocument:t},e){let n=Yee(e);M_(()=>{e||(t==null?void 0:t.activeElement)===(t==null?void 0:t.body)&&hc(n())},[e]),GM(()=>{e&&hc(n())})}function Jee({ownerDocument:t,container:e,initialFocus:n},s){let r=M.useRef(null),i=WM();return M_(()=>{if(!s)return;let o=e.current;o&&fb(()=>{if(!i.current)return;let a=t==null?void 0:t.activeElement;if(n!=null&&n.current){if((n==null?void 0:n.current)===a){r.current=a;return}}else if(o.contains(a)){r.current=a;return}n!=null&&n.current?hc(n.current):Yx(o,Gl.First)===OM.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),r.current=t==null?void 0:t.activeElement})},[s]),r}function Zee({ownerDocument:t,container:e,containers:n,previousActiveElement:s},r){let i=WM();UM(t==null?void 0:t.defaultView,"focus",o=>{if(!r||!i.current)return;let a=HM(n);e.current instanceof HTMLElement&&a.add(e.current);let l=s.current;if(!l)return;let c=o.target;c&&c instanceof HTMLElement?KM(a,c)?(s.current=c,hc(c)):(o.preventDefault(),o.stopPropagation(),hc(l)):hc(s.current)},!0)}function KM(t,e){for(let n of t)if(n.contains(e))return!0;return!1}let XM=M.createContext(!1);function ete(){return M.useContext(XM)}function ES(t){return bt.createElement(XM.Provider,{value:t.force},t.children)}function tte(t){let e=ete(),n=M.useContext(YM),s=Pm(t),[r,i]=M.useState(()=>{if(!e&&n!==null||Po.isServer)return null;let o=s==null?void 0:s.getElementById("headlessui-portal-root");if(o)return o;if(s===null)return null;let a=s.createElement("div");return a.setAttribute("id","headlessui-portal-root"),s.body.appendChild(a)});return M.useEffect(()=>{r!==null&&(s!=null&&s.body.contains(r)||s==null||s.body.appendChild(r))},[r,s]),M.useEffect(()=>{e||n!==null&&i(n.current)},[n,i,e]),r}let nte=M.Fragment;function ste(t,e){let n=t,s=M.useRef(null),r=ta(Lee(u=>{s.current=u}),e),i=Pm(s),o=tte(s),[a]=M.useState(()=>{var u;return Po.isServer?null:(u=i==null?void 0:i.createElement("div"))!=null?u:null}),l=M.useContext(CS),c=gb();return Go(()=>{!o||!a||o.contains(a)||(a.setAttribute("data-headlessui-portal",""),o.appendChild(a))},[o,a]),Go(()=>{if(a&&l)return l.register(a)},[l,a]),GM(()=>{var u;!o||!a||(a instanceof Node&&o.contains(a)&&o.removeChild(a),o.childNodes.length<=0&&((u=o.parentElement)==null||u.removeChild(o)))}),c?!o||!a?null:$L.createPortal(co({ourProps:{ref:r},theirProps:n,defaultTag:nte,name:"Portal"}),a):null}let rte=M.Fragment,YM=M.createContext(null);function ite(t,e){let{target:n,...s}=t,r={ref:ta(e)};return bt.createElement(YM.Provider,{value:n},co({ourProps:r,theirProps:s,defaultTag:rte,name:"Popover.Group"}))}let CS=M.createContext(null);function ote(){let t=M.useContext(CS),e=M.useRef([]),n=Ss(i=>(e.current.push(i),t&&t.register(i),()=>s(i))),s=Ss(i=>{let o=e.current.indexOf(i);o!==-1&&e.current.splice(o,1),t&&t.unregister(i)}),r=M.useMemo(()=>({register:n,unregister:s,portals:e}),[n,s,e]);return[e,M.useMemo(()=>function({children:i}){return bt.createElement(CS.Provider,{value:r},i)},[r])]}let ate=uo(ste),lte=uo(ite),$S=Object.assign(ate,{Group:lte});function cte(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}const ute=typeof Object.is=="function"?Object.is:cte,{useState:dte,useEffect:hte,useLayoutEffect:pte,useDebugValue:fte}=nd;function mte(t,e,n){const s=e(),[{inst:r},i]=dte({inst:{value:s,getSnapshot:e}});return pte(()=>{r.value=s,r.getSnapshot=e,PI(r)&&i({inst:r})},[t,s,e]),hte(()=>(PI(r)&&i({inst:r}),t(()=>{PI(r)&&i({inst:r})})),[t]),fte(s),s}function PI(t){const e=t.getSnapshot,n=t.value;try{const s=e();return!ute(n,s)}catch{return!0}}function gte(t,e,n){return e()}const yte=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",xte=!yte,vte=xte?gte:mte,bte="useSyncExternalStore"in nd?(t=>t.useSyncExternalStore)(nd):vte;function wte(t){return bte(t.subscribe,t.getSnapshot,t.getSnapshot)}function Ite(t,e){let n=t(),s=new Set;return{getSnapshot(){return n},subscribe(r){return s.add(r),()=>s.delete(r)},dispatch(r,...i){let o=e[r].call(n,...i);o&&(n=o,s.forEach(a=>a()))}}}function kte(){let t;return{before({doc:e}){var n;let s=e.documentElement;t=((n=e.defaultView)!=null?n:window).innerWidth-s.clientWidth},after({doc:e,d:n}){let s=e.documentElement,r=s.clientWidth-s.offsetWidth,i=t-r;n.style(s,"paddingRight",`${i}px`)}}}function Ste(){return LM()?{before({doc:t,d:e,meta:n}){function s(r){return n.containers.flatMap(i=>i()).some(i=>i.contains(r))}e.microTask(()=>{var r;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let a=mb();a.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>a.dispose()))}let i=(r=window.scrollY)!=null?r:window.pageYOffset,o=null;e.addEventListener(t,"click",a=>{if(a.target instanceof HTMLElement)try{let l=a.target.closest("a");if(!l)return;let{hash:c}=new URL(l.href),u=t.querySelector(c);u&&!s(u)&&(o=u)}catch{}},!0),e.addEventListener(t,"touchstart",a=>{if(a.target instanceof HTMLElement)if(s(a.target)){let l=a.target;for(;l.parentElement&&s(l.parentElement);)l=l.parentElement;e.style(l,"overscrollBehavior","contain")}else e.style(a.target,"touchAction","none")}),e.addEventListener(t,"touchmove",a=>{if(a.target instanceof HTMLElement)if(s(a.target)){let l=a.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&a.preventDefault()}else a.preventDefault()},{passive:!1}),e.add(()=>{var a;let l=(a=window.scrollY)!=null?a:window.pageYOffset;i!==l&&window.scrollTo(0,i),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function Tte(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function Nte(t){let e={};for(let n of t)Object.assign(e,n(e));return e}let rc=Ite(()=>new Map,{PUSH(t,e){var n;let s=(n=this.get(t))!=null?n:{doc:t,count:0,d:mb(),meta:new Set};return s.count++,s.meta.add(e),this.set(t,s),this},POP(t,e){let n=this.get(t);return n&&(n.count--,n.meta.delete(e)),this},SCROLL_PREVENT({doc:t,d:e,meta:n}){let s={doc:t,d:e,meta:Nte(n)},r=[Ste(),kte(),Tte()];r.forEach(({before:i})=>i==null?void 0:i(s)),r.forEach(({after:i})=>i==null?void 0:i(s))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});rc.subscribe(()=>{let t=rc.getSnapshot(),e=new Map;for(let[n]of t)e.set(n,n.documentElement.style.overflow);for(let n of t.values()){let s=e.get(n.doc)==="hidden",r=n.count!==0;(r&&!s||!r&&s)&&rc.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&rc.dispatch("TEARDOWN",n)}});function _te(t,e,n){let s=wte(rc),r=t?s.get(t):void 0,i=r?r.count>0:!1;return Go(()=>{if(!(!t||!e))return rc.dispatch("PUSH",t,n),()=>rc.dispatch("POP",t,n)},[e,t]),i}let OI=new Map,Ep=new Map;function gD(t,e=!0){Go(()=>{var n;if(!e)return;let s=typeof t=="function"?t():t.current;if(!s)return;function r(){var o;if(!s)return;let a=(o=Ep.get(s))!=null?o:1;if(a===1?Ep.delete(s):Ep.set(s,a-1),a!==1)return;let l=OI.get(s);l&&(l["aria-hidden"]===null?s.removeAttribute("aria-hidden"):s.setAttribute("aria-hidden",l["aria-hidden"]),s.inert=l.inert,OI.delete(s))}let i=(n=Ep.get(s))!=null?n:0;return Ep.set(s,i+1),i!==0||(OI.set(s,{"aria-hidden":s.getAttribute("aria-hidden"),inert:s.inert}),s.setAttribute("aria-hidden","true"),s.inert=!0),r},[t,e])}function Ete({defaultContainers:t=[],portals:e,mainTreeNodeRef:n}={}){var s;let r=M.useRef((s=n==null?void 0:n.current)!=null?s:null),i=Pm(r),o=Ss(()=>{var a,l,c;let u=[];for(let d of t)d!==null&&(d instanceof HTMLElement?u.push(d):"current"in d&&d.current instanceof HTMLElement&&u.push(d.current));if(e!=null&&e.current)for(let d of e.current)u.push(d);for(let d of(a=i==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?a:[])d!==document.body&&d!==document.head&&d instanceof HTMLElement&&d.id!=="headlessui-portal-root"&&(d.contains(r.current)||d.contains((c=(l=r.current)==null?void 0:l.getRootNode())==null?void 0:c.host)||u.some(h=>d.contains(h))||u.push(d));return u});return{resolveContainers:o,contains:Ss(a=>o().some(l=>l.contains(a))),mainTreeNodeRef:r,MainTreeNode:M.useMemo(()=>function(){return n!=null?null:bt.createElement(_S,{features:Hv.Hidden,ref:r})},[r,n])}}let V_=M.createContext(()=>{});V_.displayName="StackContext";var AS=(t=>(t[t.Add=0]="Add",t[t.Remove=1]="Remove",t))(AS||{});function Cte(){return M.useContext(V_)}function $te({children:t,onUpdate:e,type:n,element:s,enabled:r}){let i=Cte(),o=Ss((...a)=>{e==null||e(...a),i(...a)});return Go(()=>{let a=r===void 0||r===!0;return a&&o(0,n,s),()=>{a&&o(1,n,s)}},[o,n,s,r]),bt.createElement(V_.Provider,{value:o},t)}let QM=M.createContext(null);function JM(){let t=M.useContext(QM);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,JM),e}return t}function Ate(){let[t,e]=M.useState([]);return[t.length>0?t.join(" "):void 0,M.useMemo(()=>function(n){let s=Ss(i=>(e(o=>[...o,i]),()=>e(o=>{let a=o.slice(),l=a.indexOf(i);return l!==-1&&a.splice(l,1),a}))),r=M.useMemo(()=>({register:s,slot:n.slot,name:n.name,props:n.props}),[s,n.slot,n.name,n.props]);return bt.createElement(QM.Provider,{value:r},n.children)},[e])]}let Rte="p";function Dte(t,e){let n=Wd(),{id:s=`headlessui-description-${n}`,...r}=t,i=JM(),o=ta(e);Go(()=>i.register(s),[s,i.register]);let a={ref:o,...i.props,id:s};return co({ourProps:a,theirProps:r,slot:i.slot||{},defaultTag:Rte,name:i.name||"Description"})}let Pte=uo(Dte),Ote=Object.assign(Pte,{});var Fte=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Fte||{}),Lte=(t=>(t[t.SetTitleId=0]="SetTitleId",t))(Lte||{});let Mte={0(t,e){return t.titleId===e.id?t:{...t,titleId:e.id}}},qv=M.createContext(null);qv.displayName="DialogContext";function Om(t){let e=M.useContext(qv);if(e===null){let n=new Error(`<${t} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Om),n}return e}function Vte(t,e,n=()=>[document.body]){_te(t,e,s=>{var r;return{containers:[...(r=s.containers)!=null?r:[],n]}})}function zte(t,e){return sl(e.type,Mte,t,e)}let jte="div",Bte=NS.RenderStrategy|NS.Static;function Ute(t,e){let n=Wd(),{id:s=`headlessui-dialog-${n}`,open:r,onClose:i,initialFocus:o,role:a="dialog",__demoMode:l=!1,...c}=t,[u,d]=M.useState(0),h=M.useRef(!1);a=function(){return a==="dialog"||a==="alertdialog"?a:(h.current||(h.current=!0,console.warn(`Invalid role [${a}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let p=Bee();r===void 0&&p!==null&&(r=(p&Hp.Open)===Hp.Open);let f=M.useRef(null),g=ta(f,e),y=Pm(f),x=t.hasOwnProperty("open")||p!==null,v=t.hasOwnProperty("onClose");if(!x&&!v)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!x)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!v)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof r!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${r}`);if(typeof i!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${i}`);let w=r?0:1,[I,N]=M.useReducer(zte,{titleId:null,descriptionId:null,panelRef:M.createRef()}),A=Ss(()=>i(!1)),T=Ss(ve=>N({type:0,id:ve})),S=gb()?l?!1:w===0:!1,E=u>1,$=M.useContext(qv)!==null,[P,F]=ote(),R={get current(){var ve;return(ve=I.panelRef.current)!=null?ve:f.current}},{resolveContainers:G,mainTreeNodeRef:q,MainTreeNode:Q}=Ete({portals:P,defaultContainers:[R]}),te=E?"parent":"leaf",B=p!==null?(p&Hp.Closing)===Hp.Closing:!1,H=$||B?!1:S,Z=M.useCallback(()=>{var ve,Le;return(Le=Array.from((ve=y==null?void 0:y.querySelectorAll("body > *"))!=null?ve:[]).find(ze=>ze.id==="headlessui-portal-root"?!1:ze.contains(q.current)&&ze instanceof HTMLElement))!=null?Le:null},[q]);gD(Z,H);let se=E?!0:S,re=M.useCallback(()=>{var ve,Le;return(Le=Array.from((ve=y==null?void 0:y.querySelectorAll("[data-headlessui-portal]"))!=null?ve:[]).find(ze=>ze.contains(q.current)&&ze instanceof HTMLElement))!=null?Le:null},[q]);gD(re,se),Fee(G,ve=>{ve.preventDefault(),A()},!(!S||E));let de=!(E||w!==0);UM(y==null?void 0:y.defaultView,"keydown",ve=>{de&&(ve.defaultPrevented||ve.key===BM.Escape&&(ve.preventDefault(),ve.stopPropagation(),A()))}),Vte(y,!(B||w!==0||$),G),M.useEffect(()=>{if(w!==0||!f.current)return;let ve=new ResizeObserver(Le=>{for(let ze of Le){let it=ze.target.getBoundingClientRect();it.x===0&&it.y===0&&it.width===0&&it.height===0&&A()}});return ve.observe(f.current),()=>ve.disconnect()},[w,f,A]);let[pe,we]=Ate(),De=M.useMemo(()=>[{dialogState:w,close:A,setTitleId:T},I],[w,I,A,T]),$e=M.useMemo(()=>({open:w===0}),[w]),Oe={ref:g,id:s,role:a,"aria-modal":w===0?!0:void 0,"aria-labelledby":I.titleId,"aria-describedby":pe};return bt.createElement($te,{type:"Dialog",enabled:w===0,element:f,onUpdate:Ss((ve,Le)=>{Le==="Dialog"&&sl(ve,{[AS.Add]:()=>d(ze=>ze+1),[AS.Remove]:()=>d(ze=>ze-1)})})},bt.createElement(ES,{force:!0},bt.createElement($S,null,bt.createElement(qv.Provider,{value:De},bt.createElement($S.Group,{target:f},bt.createElement(ES,{force:!1},bt.createElement(we,{slot:$e,name:"Dialog.Description"},bt.createElement(_p,{initialFocus:o,containers:G,features:S?sl(te,{parent:_p.features.RestoreFocus,leaf:_p.features.All&~_p.features.FocusLock}):_p.features.None},bt.createElement(F,null,co({ourProps:Oe,theirProps:c,slot:$e,defaultTag:jte,features:Bte,visible:w===0,name:"Dialog"}))))))))),bt.createElement(Q,null))}let Wte="div";function Gte(t,e){let n=Wd(),{id:s=`headlessui-dialog-overlay-${n}`,...r}=t,[{dialogState:i,close:o}]=Om("Dialog.Overlay"),a=ta(e),l=Ss(u=>{if(u.target===u.currentTarget){if(Wee(u.currentTarget))return u.preventDefault();u.preventDefault(),u.stopPropagation(),o()}}),c=M.useMemo(()=>({open:i===0}),[i]);return co({ourProps:{ref:a,id:s,"aria-hidden":!0,onClick:l},theirProps:r,slot:c,defaultTag:Wte,name:"Dialog.Overlay"})}let Hte="div";function qte(t,e){let n=Wd(),{id:s=`headlessui-dialog-backdrop-${n}`,...r}=t,[{dialogState:i},o]=Om("Dialog.Backdrop"),a=ta(e);M.useEffect(()=>{if(o.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[o.panelRef]);let l=M.useMemo(()=>({open:i===0}),[i]);return bt.createElement(ES,{force:!0},bt.createElement($S,null,co({ourProps:{ref:a,id:s,"aria-hidden":!0},theirProps:r,slot:l,defaultTag:Hte,name:"Dialog.Backdrop"})))}let Kte="div";function Xte(t,e){let n=Wd(),{id:s=`headlessui-dialog-panel-${n}`,...r}=t,[{dialogState:i},o]=Om("Dialog.Panel"),a=ta(e,o.panelRef),l=M.useMemo(()=>({open:i===0}),[i]),c=Ss(u=>{u.stopPropagation()});return co({ourProps:{ref:a,id:s,onClick:c},theirProps:r,slot:l,defaultTag:Kte,name:"Dialog.Panel"})}let Yte="h2";function Qte(t,e){let n=Wd(),{id:s=`headlessui-dialog-title-${n}`,...r}=t,[{dialogState:i,setTitleId:o}]=Om("Dialog.Title"),a=ta(e);M.useEffect(()=>(o(s),()=>o(null)),[s,o]);let l=M.useMemo(()=>({open:i===0}),[i]);return co({ourProps:{ref:a,id:s},theirProps:r,slot:l,defaultTag:Yte,name:"Dialog.Title"})}let Jte=uo(Ute),Zte=uo(qte),ene=uo(Xte),tne=uo(Gte),nne=uo(Qte),gf=Object.assign(Jte,{Backdrop:Zte,Panel:ene,Overlay:tne,Title:nne,Description:Ote});function sne({currentStep:t,steps:e}){return b.jsx("div",{className:"flex justify-between mb-8",children:e.map(n=>b.jsxs("div",{className:`flex flex-col items-center ${n.number<=t?"text-primary":"text-gray-400"}`,children:[b.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center mb-2 ${n.number<=t?"bg-primary text-white":"bg-gray-200"}`,children:n.number}),b.jsx("span",{className:"text-sm",children:n.title})]},n.number))})}function Cp({children:t,variant:e="primary",className:n,...s}){return b.jsx("button",{className:SS("font-bold py-4 px-8 rounded-xl transition-all duration-300",{"bg-primary text-white hover:bg-secondary shadow-button":e==="primary","bg-white text-primary hover:bg-gray-50":e==="secondary","border-2 border-primary text-primary hover:bg-primary hover:text-white":e==="outline"},n),...s,children:t})}function rne({item1:t,item2:e,onClose:n}){const[s,r]=M.useState(1),i=[{number:1,title:"Review Items"},{number:2,title:"VeriLINC Check"},{number:3,title:"Escrow Setup"},{number:4,title:"Delivery"},{number:5,title:"Complete"}];return b.jsx(gf,{open:!0,onClose:n,className:"fixed inset-0 z-50 overflow-y-auto",children:b.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[b.jsx(gf.Overlay,{className:"fixed inset-0 bg-black opacity-30"}),b.jsxs("div",{className:"relative bg-white rounded-lg max-w-3xl w-full mx-auto p-6",children:[b.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-500",children:b.jsx(L_,{className:"h-6 w-6"})}),b.jsx(sne,{currentStep:s,steps:i}),s===1&&b.jsxs("div",{className:"space-y-6",children:[b.jsx("h2",{className:"text-2xl font-bold text-center",children:"Review Swap Items"}),b.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[b.jsxs("div",{className:"text-center",children:[b.jsx("img",{src:t.image,alt:t.title,className:"w-full h-48 object-cover rounded-lg mb-4"}),b.jsx("h3",{className:"font-semibold",children:t.title}),b.jsxs("p",{className:"text-primary",children:["R ",t.value.toLocaleString()]})]}),b.jsxs("div",{className:"text-center",children:[b.jsx("img",{src:e.image,alt:e.title,className:"w-full h-48 object-cover rounded-lg mb-4"}),b.jsx("h3",{className:"font-semibold",children:e.title}),b.jsxs("p",{className:"text-primary",children:["R ",e.value.toLocaleString()]})]})]}),b.jsx(Cp,{onClick:()=>r(2),className:"w-full",children:"Continue to VeriLINC Check"})]}),s===2&&b.jsxs("div",{className:"space-y-6",children:[b.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:b.jsxs("div",{className:"flex items-center space-x-3",children:[b.jsx(Dm,{className:"h-6 w-6 text-green-600"}),b.jsxs("div",{children:[b.jsx("h3",{className:"font-semibold text-green-800",children:"VeriLINC Verification"}),b.jsx("p",{className:"text-sm text-green-600",children:"Both items have been verified"})]})]})}),b.jsx(Cp,{onClick:()=>r(3),className:"w-full",children:"Proceed to Escrow"})]}),s===3&&b.jsxs("div",{className:"space-y-6",children:[b.jsx("h2",{className:"text-2xl font-bold text-center",children:"Escrow Setup"}),b.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[b.jsxs("p",{className:"text-blue-800",children:["Escrow fee: R ",Math.max(t.value*.02,50).toFixed(2)]}),b.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Protects both parties during the swap"})]}),b.jsx(Cp,{onClick:()=>r(4),className:"w-full",children:"Set Up Delivery"})]}),s===4&&b.jsxs("div",{className:"space-y-6",children:[b.jsx("h2",{className:"text-2xl font-bold text-center",children:"Delivery Options"}),b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{className:"border rounded-lg p-4 cursor-pointer hover:border-primary",children:[b.jsx("h3",{className:"font-semibold",children:"Meet in Person"}),b.jsx("p",{className:"text-sm text-gray-600",children:"Arrange a safe meeting point"})]}),b.jsxs("div",{className:"border rounded-lg p-4 cursor-pointer hover:border-primary",children:[b.jsx("h3",{className:"font-semibold",children:"Courier Service"}),b.jsx("p",{className:"text-sm text-gray-600",children:"Professional delivery service"})]})]}),b.jsx(Cp,{onClick:()=>r(5),className:"w-full",children:"Complete Swap"})]}),s===5&&b.jsxs("div",{className:"text-center space-y-6",children:[b.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[b.jsx("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:"Swap Initiated!"}),b.jsx("p",{className:"text-green-600",children:"Your swap has been successfully initiated. You'll receive updates via email."})]}),b.jsx(Cp,{onClick:n,className:"w-full",children:"Return to Dashboard"})]})]})]})})}function ine(){const[t,e]=M.useState(!1),[n,s]=M.useState(null),r=[{id:1,item1:{title:"Mountain Bike",image:"https://images.unsplash.com/photo-1576435728678-68d0fbf94e91?auto=format&fit=crop&w=1470&q=80",value:15e3},item2:{title:"iPhone 11",image:"https://images.unsplash.com/photo-1678911820864-e2c567c655d7?auto=format&fit=crop&w=1470&q=80",value:14e3}}],i=o=>{s(o),e(!0)};return b.jsxs("div",{className:"space-y-4",children:[r.map(o=>b.jsxs("div",{className:"flex items-center bg-white rounded-lg p-4 shadow-sm",children:[b.jsxs("div",{className:"flex-1",children:[b.jsx("img",{src:o.item1.image,alt:o.item1.title,className:"w-20 h-20 object-cover rounded-lg"}),b.jsx("p",{className:"mt-2 text-sm font-medium",children:o.item1.title}),b.jsxs("p",{className:"text-sm text-primary",children:["R ",o.item1.value.toLocaleString()]})]}),b.jsx("div",{className:"flex-shrink-0 px-4",children:b.jsx("span",{className:"text-2xl",children:"↔️"})}),b.jsxs("div",{className:"flex-1",children:[b.jsx("img",{src:o.item2.image,alt:o.item2.title,className:"w-20 h-20 object-cover rounded-lg"}),b.jsx("p",{className:"mt-2 text-sm font-medium",children:o.item2.title}),b.jsxs("p",{className:"text-sm text-primary",children:["R ",o.item2.value.toLocaleString()]})]}),b.jsx("button",{onClick:()=>i(o),className:"ml-4 bg-primary text-white px-4 py-2 rounded-lg hover:bg-secondary transition-colors",children:"View Match"})]},o.id)),t&&n&&b.jsx(rne,{item1:n.item1,item2:n.item2,onClose:()=>e(!1)})]})}function one(){const[t,e]=M.useState(!1);return b.jsxs("div",{className:"relative",children:[b.jsxs("button",{onClick:()=>e(!t),className:"relative p-2 rounded-full hover:bg-gray-100",children:[b.jsx(F_,{className:"h-6 w-6 text-gray-600"}),b.jsx("span",{className:"absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-500 transform translate-x-1/2 -translate-y-1/2"})]}),t&&b.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg py-2 z-50",children:[b.jsx("div",{className:"px-4 py-2 border-b border-gray-200",children:b.jsx("h3",{className:"text-sm font-semibold",children:"Notifications"})}),b.jsx("div",{className:"max-h-96 overflow-y-auto",children:b.jsxs("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer",children:[b.jsx("p",{className:"text-sm",children:"New swap suggestion for your item"}),b.jsx("p",{className:"text-xs text-gray-500",children:"2 minutes ago"})]})})]})]})}function ane(){const[t,e]=M.useState(!1),n=Es();return b.jsxs("div",{className:"relative",children:[b.jsx("button",{onClick:()=>e(!t),className:"flex items-center space-x-2 p-2 rounded-full hover:bg-gray-100",children:b.jsx(CM,{className:"h-6 w-6 text-gray-600"})}),t&&b.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-50",children:[b.jsx("button",{onClick:()=>n("/profile"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Your Profile"}),b.jsx("button",{onClick:()=>n("/settings"),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Settings"}),b.jsx("div",{className:"border-t border-gray-200 my-1"}),b.jsx("button",{onClick:()=>{},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100",children:"Sign out"})]})]})}function lne({onClick:t}){return b.jsxs("button",{onClick:t,className:"w-full bg-primary text-white rounded-lg px-4 py-3 flex items-center justify-center space-x-2 hover:bg-secondary transition-colors",children:[b.jsx(EM,{className:"h-5 w-5"}),b.jsx("span",{children:"Post New Item"})]})}function cne(){const[t,e]=M.useState(""),n=Es(),s=i=>{e(i)},r=()=>{n("/items/new")};return b.jsxs("div",{className:"min-h-screen bg-gray-50",children:[b.jsx("header",{className:"bg-white shadow",children:b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:b.jsxs("div",{className:"flex justify-between items-center",children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"weLINKyou"}),b.jsxs("div",{className:"flex items-center space-x-4",children:[b.jsx(one,{}),b.jsx(ane,{})]})]})})}),b.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:b.jsxs("div",{className:"space-y-8",children:[b.jsx(vee,{onSearch:s}),b.jsxs("div",{className:"grid gap-8",children:[b.jsxs("section",{children:[b.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Featured Items"}),b.jsx(wee,{})]}),b.jsxs("section",{children:[b.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Swap Suggestions"}),b.jsx(ine,{})]})]}),b.jsx("div",{className:"fixed bottom-8 right-8",children:b.jsx(lne,{onClick:r})})]})})]})}function une(){const{user:t}=O_(),[e,n]=M.useState({fullName:(t==null?void 0:t.displayName)||"",email:(t==null?void 0:t.email)||"",phone:"",location:"",notifications:!0}),s=async r=>{r.preventDefault()};return b.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[b.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Account Settings"}),b.jsxs("form",{onSubmit:s,className:"space-y-6",children:[b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),b.jsx("input",{type:"text",value:e.fullName,onChange:r=>n({...e,fullName:r.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),b.jsx("input",{type:"email",value:e.email,onChange:r=>n({...e,email:r.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),b.jsx("input",{type:"tel",value:e.phone,onChange:r=>n({...e,phone:r.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),b.jsx("input",{type:"text",value:e.location,onChange:r=>n({...e,location:r.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2"})]})]}),b.jsxs("div",{className:"flex items-center",children:[b.jsx("input",{type:"checkbox",id:"notifications",checked:e.notifications,onChange:r=>n({...e,notifications:r.target.checked}),className:"h-4 w-4 text-primary rounded border-gray-300"}),b.jsx("label",{htmlFor:"notifications",className:"ml-2 text-sm text-gray-700",children:"Receive notifications about new swap matches and messages"})]}),b.jsx("div",{className:"flex justify-end",children:b.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-secondary transition-colors",children:"Save Changes"})})]})]})}function dne(){const e=[{id:1,type:"earned",amount:10,description:"Successful swap completed",date:"2023-12-20"},{id:2,type:"spent",amount:5,description:"VeriLINC certificate",date:"2023-12-18"}];return b.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[b.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Swap Tokens"}),b.jsxs("div",{className:"text-center mb-6",children:[b.jsx("div",{className:"text-3xl font-bold text-primary",children:50}),b.jsx("div",{className:"text-sm text-gray-600",children:"Available Tokens"})]}),b.jsxs("div",{className:"space-y-4",children:[b.jsx("h3",{className:"text-lg font-medium",children:"Token History"}),e.map(n=>b.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[b.jsxs("div",{children:[b.jsx("p",{className:"font-medium",children:n.description}),b.jsx("p",{className:"text-sm text-gray-600",children:n.date})]}),b.jsxs("span",{className:`font-medium ${n.type==="earned"?"text-green-600":"text-red-600"}`,children:[n.type==="earned"?"+":"-",n.amount]})]},n.id))]}),b.jsx("button",{className:"w-full mt-6 bg-primary text-white py-2 rounded-lg hover:bg-secondary transition-colors",children:"Buy More Tokens"})]})}function hne(){const t=["No fees on VeriLINC certificates","Priority swap matching","Advanced analytics","Premium badge on listings"];return b.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[b.jsxs("div",{className:"flex items-center justify-between mb-4",children:[b.jsx("h2",{className:"text-xl font-semibold",children:"Membership Status"}),b.jsx(eee,{className:"h-6 w-6 text-gray-400"})]}),b.jsx("div",{className:"mb-6",children:b.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800",children:"Basic Member"})}),b.jsxs(b.Fragment,{children:[b.jsxs("div",{className:"mb-6",children:[b.jsx("h3",{className:"text-lg font-medium mb-2",children:"Premium Benefits"}),b.jsx("ul",{className:"space-y-2",children:t.map((e,n)=>b.jsxs("li",{className:"flex items-center text-sm text-gray-600",children:[b.jsx("span",{className:"mr-2",children:"✓"}),e]},n))})]}),b.jsx("button",{className:"w-full bg-primary text-white py-2 rounded-lg hover:bg-secondary transition-colors",children:"Upgrade to Premium"})]})]})}function pne({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{d:"m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z"}))}const fne=M.forwardRef(pne);function mne({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{fillRule:"evenodd",d:"M12.516 2.17a.75.75 0 0 0-1.032 0 11.209 11.209 0 0 1-7.877 3.08.75.75 0 0 0-.722.515A12.74 12.74 0 0 0 2.25 9.75c0 5.942 4.064 10.933 9.563 12.348a.749.749 0 0 0 .374 0c5.499-1.415 9.563-6.406 9.563-12.348 0-1.39-.223-2.73-.635-3.985a.75.75 0 0 0-.722-.516l-.143.001c-2.996 0-5.717-1.17-7.734-3.08Zm3.094 8.016a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const ZM=M.forwardRef(mne);function gne({title:t,titleId:e,...n},s){return M.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":e},n),t?M.createElement("title",{id:e},t):null,M.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const yD=M.forwardRef(gne);function yne(){const t=[{id:1,rating:5,comment:"Great swap! Item was exactly as described.",date:"2023-12-15"},{id:2,rating:4,comment:"Smooth transaction, good communication.",date:"2023-12-10"}],e=t.reduce((n,s)=>n+s.rating,0)/t.length;return b.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[b.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Swap Ratings & Reviews"}),b.jsxs("div",{className:"flex items-center mb-6",children:[b.jsx("div",{className:"text-3xl font-bold mr-4",children:e.toFixed(1)}),b.jsxs("div",{className:"flex items-center",children:[[1,2,3,4,5].map(n=>b.jsx(yD,{className:`h-5 w-5 ${n<=e?"text-yellow-400":"text-gray-300"}`},n)),b.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",t.length," reviews)"]})]})]}),b.jsx("div",{className:"space-y-4",children:t.map(n=>b.jsxs("div",{className:"border-b pb-4",children:[b.jsxs("div",{className:"flex items-center mb-2",children:[b.jsx("div",{className:"flex",children:[1,2,3,4,5].map(s=>b.jsx(yD,{className:`h-4 w-4 ${s<=n.rating?"text-yellow-400":"text-gray-300"}`},s))}),b.jsx("span",{className:"ml-2 text-sm text-gray-600",children:n.date})]}),b.jsx("p",{className:"text-gray-700",children:n.comment})]},n.id))})]})}function xne(){const t=[{id:1,title:"iPhone 13",image:"https://placehold.co/600x400?text=iPhone",value:11e3,location:"Cape Town"},{id:2,title:"PlayStation 5",image:"https://placehold.co/600x400?text=PS5",value:8500,location:"Johannesburg"}];return b.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[b.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Saved Items"}),b.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>b.jsxs("div",{className:"border rounded-lg overflow-hidden hover:shadow-md transition-shadow",children:[b.jsxs("div",{className:"relative",children:[b.jsx("img",{src:e.image,alt:e.title,className:"w-full h-48 object-cover"}),b.jsx("button",{className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow-md",children:b.jsx(fne,{className:"h-5 w-5 text-red-500"})})]}),b.jsxs("div",{className:"p-4",children:[b.jsx("h3",{className:"font-medium",children:e.title}),b.jsxs("p",{className:"text-primary font-medium",children:["R ",e.value.toLocaleString()]}),b.jsx("p",{className:"text-sm text-gray-600",children:e.location})]})]},e.id))}),t.length===0&&b.jsx("div",{className:"text-center py-8 text-gray-500",children:"No saved items yet."})]})}function vne(){return b.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:b.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Profile"}),b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[b.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[b.jsx(une,{}),b.jsx(yne,{}),b.jsx(xne,{})]}),b.jsxs("div",{className:"space-y-8",children:[b.jsx(hne,{}),b.jsx(dne,{})]})]})]})})}function bne({images:t}){const[e,n]=M.useState(0);return b.jsxs("div",{className:"space-y-4",children:[b.jsx("div",{className:"aspect-w-16 aspect-h-9 rounded-lg overflow-hidden",children:b.jsx("img",{src:t[e],alt:"Main view",className:"w-full h-full object-cover"})}),b.jsx("div",{className:"grid grid-cols-4 gap-4",children:t.map((s,r)=>b.jsx("button",{onClick:()=>n(r),className:`aspect-w-1 aspect-h-1 rounded-lg overflow-hidden ${e===r?"ring-2 ring-primary":""}`,children:b.jsx("img",{src:s,alt:`Thumbnail ${r+1}`,className:"w-full h-full object-cover"})},r))})]})}function wne({certificate:t}){return b.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[b.jsxs("div",{className:"flex items-center space-x-3",children:[b.jsx(ZM,{className:"h-6 w-6 text-green-600"}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-sm font-semibold text-green-800",children:"VeriLINC Certified"}),b.jsxs("p",{className:"text-sm text-green-600",children:["Certificate #",t.certificateNumber]})]})]}),b.jsxs("div",{className:"mt-2 text-sm text-green-700",children:[b.jsxs("p",{children:["Estimated Value: R ",t.estimatedValue.toLocaleString()]}),b.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Last Updated: ",new Date(t.lastUpdated).toLocaleDateString()]})]})]})}var Ine={};async function kne(t,e){try{const s=await(await fetch(`https://maps.googleapis.com/maps/api/distancematrix/json?origins=${t}&destinations=${e}&key=${Ine.GOOGLE_MAPS_API_KEY}`)).json();if(s.rows[0].elements[0].status==="OK")return s.rows[0].elements[0].distance.value/1e3;throw new Error("Unable to calculate distance")}catch(n){return console.error("Error calculating distance:",n),Sne(t,e)}}function Sne(t,e){const[n,s]=t.split(",").map(d=>parseFloat(d)),[r,i]=e.split(",").map(d=>parseFloat(d)),o=6371,a=cx(r-n),l=cx(i-s),c=Math.sin(a/2)*Math.sin(a/2)+Math.cos(cx(n))*Math.cos(cx(r))*Math.sin(l/2)*Math.sin(l/2),u=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return o*u}function cx(t){return t*(Math.PI/180)}class Tne{constructor(){this.deliveryProviders={eHailing:{maxDistance:50,baseRate:15,minCharge:50},postNet:{baseRate:100,weightRate:20,insuranceRate:.01},pepStore:{baseRate:80,weightRate:15,maxWeight:20}}}async calculateDeliveryOptions(e,n,s){const r=await kne(e,n),i=[];if(r<=this.deliveryProviders.eHailing.maxDistance){const a=Math.max(r*this.deliveryProviders.eHailing.baseRate,this.deliveryProviders.eHailing.minCharge);i.push({provider:"E-Hailing",type:"Local",estimatedTime:`${Math.ceil(r*3)} minutes`,cost:a,features:["Real-time tracking","Direct delivery","Instant pickup"]})}const o=this.calculatePostNetCost(s);if(i.push({provider:"PostNet",type:"National",estimatedTime:"2-3 business days",cost:o,features:["Insurance included","Tracking number","Signature required"]}),s.weight<=this.deliveryProviders.pepStore.maxWeight){const a=this.calculatePepStoreCost(s);i.push({provider:"PEP Store",type:"National",estimatedTime:"3-5 business days",cost:a,features:["Affordable rates","Nationwide coverage","Collection at any PEP Store"]})}return i}calculatePostNetCost(e){const{weight:n,declaredValue:s}=e,r=n*this.deliveryProviders.postNet.weightRate,i=s*this.deliveryProviders.postNet.insuranceRate;return this.deliveryProviders.postNet.baseRate+r+i}calculatePepStoreCost(e){const{weight:n}=e,s=n*this.deliveryProviders.pepStore.weightRate;return this.deliveryProviders.pepStore.baseRate+s}}function Nne({pickup:t,dropoff:e,packageDetails:n}){const[s,r]=M.useState([]),[i,o]=M.useState(!0),[a,l]=M.useState(null),c=new Tne;return M.useEffect(()=>{async function u(){try{const d=await c.calculateDeliveryOptions(t,e,n);r(d)}catch(d){console.error("Error fetching delivery options:",d)}finally{o(!1)}}u()},[t,e,n]),i?b.jsx("div",{className:"flex justify-center items-center p-4",children:b.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):b.jsxs("div",{className:"space-y-4",children:[b.jsx("h3",{className:"text-lg font-semibold",children:"Available Delivery Options"}),s.map((u,d)=>b.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${a===d?"border-primary bg-orange-50":"border-gray-200"}`,onClick:()=>l(d),children:[b.jsxs("div",{className:"flex justify-between items-center mb-2",children:[b.jsx("h4",{className:"font-semibold",children:u.provider}),b.jsxs("span",{className:"text-primary font-bold",children:["R ",u.cost.toFixed(2)]})]}),b.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[b.jsxs("span",{className:"mr-4",children:["Type: ",u.type]}),b.jsxs("span",{children:["Estimated Time: ",u.estimatedTime]})]}),b.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:u.features.map((h,p)=>b.jsx("span",{className:"bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded",children:h},p))})]},d)),a!==null&&b.jsx("button",{className:"w-full bg-primary text-white py-2 rounded-lg hover:bg-secondary transition-colors",onClick:()=>{console.log("Selected delivery option:",s[a])},children:"Confirm Delivery Option"})]})}function _ne({item:t,onClose:e}){const[n,s]=M.useState(null),[r,i]=M.useState(""),o=[{id:1,title:"iPhone 13",value:11e3,image:"https://placehold.co/600x400?text=iPhone"},{id:2,title:"PlayStation 5",value:8500,image:"https://placehold.co/600x400?text=PS5"}],a=l=>{l.preventDefault(),console.log("Proposing swap:",{selectedItem:n,message:r}),e()};return b.jsx(gf,{open:!0,onClose:e,className:"fixed inset-0 z-50 overflow-y-auto",children:b.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[b.jsx(gf.Overlay,{className:"fixed inset-0 bg-black opacity-30"}),b.jsxs("div",{className:"relative bg-white rounded-lg max-w-2xl w-full mx-auto p-6",children:[b.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-500",children:b.jsx(L_,{className:"h-6 w-6"})}),b.jsx(gf.Title,{className:"text-xl font-semibold mb-4",children:"Propose a Swap"}),b.jsxs("form",{onSubmit:a,className:"space-y-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select one of your items to swap"}),b.jsx("div",{className:"grid grid-cols-2 gap-4",children:o.map(l=>b.jsxs("button",{type:"button",onClick:()=>s(l),className:`border rounded-lg p-4 text-left ${(n==null?void 0:n.id)===l.id?"border-primary ring-2 ring-primary ring-opacity-50":"border-gray-200"}`,children:[b.jsx("img",{src:l.image,alt:l.title,className:"w-full h-32 object-cover rounded-md mb-2"}),b.jsx("h3",{className:"font-medium",children:l.title}),b.jsxs("p",{className:"text-primary",children:["R ",l.value.toLocaleString()]})]},l.id))})]}),b.jsxs("div",{children:[b.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Message to owner (optional)"}),b.jsx("textarea",{id:"message",rows:4,value:r,onChange:l=>i(l.target.value),className:"w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:"Tell them why this would be a great swap..."})]}),b.jsxs("div",{className:"flex justify-end space-x-4",children:[b.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),b.jsx("button",{type:"submit",disabled:!n,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary disabled:opacity-50",children:"Propose Swap"})]})]})]})]})})}function Ene(){const{id:t}=LL(),[e,n]=M.useState(!1),[s,r]=M.useState(!1),i={id:t,title:"Mountain Bike",description:"Trek mountain bike in excellent condition",images:["https://placehold.co/600x400?text=Mountain+Bike+1","https://placehold.co/600x400?text=Mountain+Bike+2"],value:12e3,category:"Sports",condition:"Excellent",location:"Cape Town",owner:{name:"John Doe",rating:4.8,swapsCompleted:15},veriLINC:{certified:!0,certificateNumber:"VL123456",estimatedValue:11800,lastUpdated:"2023-12-20"}};return b.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[b.jsx("div",{children:b.jsx(bne,{images:i.images})}),b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"flex justify-between items-start",children:[b.jsxs("div",{children:[b.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:i.title}),b.jsxs("p",{className:"text-lg text-primary font-semibold mt-2",children:["R ",i.value.toLocaleString()]})]}),b.jsx("button",{onClick:()=>r(!s),className:`p-2 rounded-full ${s?"text-red-500":"text-gray-400"} hover:bg-gray-100`,children:b.jsx(YZ,{className:"h-6 w-6"})})]}),i.veriLINC.certified&&b.jsx(wne,{certificate:i.veriLINC}),b.jsxs("div",{className:"border-t border-b py-4",children:[b.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Item Details"}),b.jsxs("dl",{className:"grid grid-cols-2 gap-4",children:[b.jsxs("div",{children:[b.jsx("dt",{className:"text-sm text-gray-500",children:"Category"}),b.jsx("dd",{className:"text-sm font-medium",children:i.category})]}),b.jsxs("div",{children:[b.jsx("dt",{className:"text-sm text-gray-500",children:"Condition"}),b.jsx("dd",{className:"text-sm font-medium",children:i.condition})]}),b.jsxs("div",{children:[b.jsx("dt",{className:"text-sm text-gray-500",children:"Location"}),b.jsx("dd",{className:"text-sm font-medium",children:i.location})]})]})]}),b.jsxs("div",{children:[b.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Description"}),b.jsx("p",{className:"text-gray-600",children:i.description})]}),b.jsxs("div",{className:"border-t pt-4",children:[b.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Delivery Options"}),b.jsx(Nne,{pickup:i.location,dropoff:"User's location",packageDetails:{weight:10,declaredValue:i.value}})]}),b.jsx("div",{className:"border-t pt-4",children:b.jsx("button",{onClick:()=>n(!0),className:"w-full bg-primary text-white py-3 rounded-lg hover:bg-secondary transition-colors",children:"Propose Swap"})})]})]})}),e&&b.jsx(_ne,{item:i,onClose:()=>n(!1)})]})}var eV={exports:{}},Cne="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$ne=Cne,Ane=$ne;function tV(){}function nV(){}nV.resetWarningCache=tV;var Rne=function(){function t(s,r,i,o,a,l){if(l!==Ane){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:nV,resetWarningCache:tV};return n.PropTypes=n,n};eV.exports=Rne();var Dne=eV.exports;const Ct=DT(Dne),Pne=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function yd(t,e,n){const s=One(t),{webkitRelativePath:r}=t,i=typeof e=="string"?e:typeof r=="string"&&r.length>0?r:`./${t.name}`;return typeof s.path!="string"&&xD(s,"path",i),xD(s,"relativePath",i),s}function One(t){const{name:e}=t;if(e&&e.lastIndexOf(".")!==-1&&!t.type){const s=e.split(".").pop().toLowerCase(),r=Pne.get(s);r&&Object.defineProperty(t,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return t}function xD(t,e,n){Object.defineProperty(t,e,{value:n,writable:!1,configurable:!1,enumerable:!0})}const Fne=[".DS_Store","Thumbs.db"];function Lne(t){return Xc(this,void 0,void 0,function*(){return Kv(t)&&Mne(t.dataTransfer)?Bne(t.dataTransfer,t.type):Vne(t)?zne(t):Array.isArray(t)&&t.every(e=>"getFile"in e&&typeof e.getFile=="function")?jne(t):[]})}function Mne(t){return Kv(t)}function Vne(t){return Kv(t)&&Kv(t.target)}function Kv(t){return typeof t=="object"&&t!==null}function zne(t){return RS(t.target.files).map(e=>yd(e))}function jne(t){return Xc(this,void 0,void 0,function*(){return(yield Promise.all(t.map(n=>n.getFile()))).map(n=>yd(n))})}function Bne(t,e){return Xc(this,void 0,void 0,function*(){if(t.items){const n=RS(t.items).filter(r=>r.kind==="file");if(e!=="drop")return n;const s=yield Promise.all(n.map(Une));return vD(sV(s))}return vD(RS(t.files).map(n=>yd(n)))})}function vD(t){return t.filter(e=>Fne.indexOf(e.name)===-1)}function RS(t){if(t===null)return[];const e=[];for(let n=0;n<t.length;n++){const s=t[n];e.push(s)}return e}function Une(t){if(typeof t.webkitGetAsEntry!="function")return bD(t);const e=t.webkitGetAsEntry();return e&&e.isDirectory?rV(e):bD(t,e)}function sV(t){return t.reduce((e,n)=>[...e,...Array.isArray(n)?sV(n):[n]],[])}function bD(t,e){return Xc(this,void 0,void 0,function*(){var n;if(globalThis.isSecureContext&&typeof t.getAsFileSystemHandle=="function"){const i=yield t.getAsFileSystemHandle();if(i===null)throw new Error(`${t} is not a File`);if(i!==void 0){const o=yield i.getFile();return o.handle=i,yd(o)}}const s=t.getAsFile();if(!s)throw new Error(`${t} is not a File`);return yd(s,(n=e==null?void 0:e.fullPath)!==null&&n!==void 0?n:void 0)})}function Wne(t){return Xc(this,void 0,void 0,function*(){return t.isDirectory?rV(t):Gne(t)})}function rV(t){const e=t.createReader();return new Promise((n,s)=>{const r=[];function i(){e.readEntries(o=>Xc(this,void 0,void 0,function*(){if(o.length){const a=Promise.all(o.map(Wne));r.push(a),i()}else try{const a=yield Promise.all(r);n(a)}catch(a){s(a)}}),o=>{s(o)})}i()})}function Gne(t){return Xc(this,void 0,void 0,function*(){return new Promise((e,n)=>{t.file(s=>{const r=yd(s,t.fullPath);e(r)},s=>{n(s)})})})}var FI=function(t,e){if(t&&e){var n=Array.isArray(e)?e:e.split(",");if(n.length===0)return!0;var s=t.name||"",r=(t.type||"").toLowerCase(),i=r.replace(/\/.*$/,"");return n.some(function(o){var a=o.trim().toLowerCase();return a.charAt(0)==="."?s.toLowerCase().endsWith(a):a.endsWith("/*")?i===a.replace(/\/.*$/,""):r===a})}return!0};function wD(t){return Kne(t)||qne(t)||oV(t)||Hne()}function Hne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Kne(t){if(Array.isArray(t))return DS(t)}function ID(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function kD(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ID(Object(n),!0).forEach(function(s){iV(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ID(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function iV(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qf(t,e){return Qne(t)||Yne(t,e)||oV(t,e)||Xne()}function Xne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oV(t,e){if(t){if(typeof t=="string")return DS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DS(t,e)}}function DS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}function Yne(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var s=[],r=!0,i=!1,o,a;try{for(n=n.call(t);!(r=(o=n.next()).done)&&(s.push(o.value),!(e&&s.length===e));r=!0);}catch(l){i=!0,a=l}finally{try{!r&&n.return!=null&&n.return()}finally{if(i)throw a}}return s}}function Qne(t){if(Array.isArray(t))return t}var Jne=typeof FI=="function"?FI:FI.default,Zne="file-invalid-type",ese="file-too-large",tse="file-too-small",nse="too-many-files",sse=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=e.split(","),s=n.length>1?"one of ".concat(n.join(", ")):n[0];return{code:Zne,message:"File type must be ".concat(s)}},SD=function(e){return{code:ese,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},TD=function(e){return{code:tse,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},rse={code:nse,message:"Too many files"};function aV(t,e){var n=t.type==="application/x-moz-file"||Jne(t,e);return[n,n?null:sse(e)]}function lV(t,e,n){if(Hl(t.size))if(Hl(e)&&Hl(n)){if(t.size>n)return[!1,SD(n)];if(t.size<e)return[!1,TD(e)]}else{if(Hl(e)&&t.size<e)return[!1,TD(e)];if(Hl(n)&&t.size>n)return[!1,SD(n)]}return[!0,null]}function Hl(t){return t!=null}function ise(t){var e=t.files,n=t.accept,s=t.minSize,r=t.maxSize,i=t.multiple,o=t.maxFiles,a=t.validator;return!i&&e.length>1||i&&o>=1&&e.length>o?!1:e.every(function(l){var c=aV(l,n),u=qf(c,1),d=u[0],h=lV(l,s,r),p=qf(h,1),f=p[0],g=a?a(l):null;return d&&f&&!g})}function Xv(t){return typeof t.isPropagationStopped=="function"?t.isPropagationStopped():typeof t.cancelBubble<"u"?t.cancelBubble:!1}function ux(t){return t.dataTransfer?Array.prototype.some.call(t.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!t.target&&!!t.target.files}function ND(t){t.preventDefault()}function ose(t){return t.indexOf("MSIE")!==-1||t.indexOf("Trident/")!==-1}function ase(t){return t.indexOf("Edge/")!==-1}function lse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return ose(t)||ase(t)}function Pi(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(s){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return e.some(function(a){return!Xv(s)&&a&&a.apply(void 0,[s].concat(i)),Xv(s)})}}function cse(){return"showOpenFilePicker"in window}function use(t){if(Hl(t)){var e=Object.entries(t).filter(function(n){var s=qf(n,2),r=s[0],i=s[1],o=!0;return cV(r)||(console.warn('Skipped "'.concat(r,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),o=!1),(!Array.isArray(i)||!i.every(uV))&&(console.warn('Skipped "'.concat(r,'" because an invalid file extension was provided.')),o=!1),o}).reduce(function(n,s){var r=qf(s,2),i=r[0],o=r[1];return kD(kD({},n),{},iV({},i,o))},{});return[{description:"Files",accept:e}]}return t}function dse(t){if(Hl(t))return Object.entries(t).reduce(function(e,n){var s=qf(n,2),r=s[0],i=s[1];return[].concat(wD(e),[r],wD(i))},[]).filter(function(e){return cV(e)||uV(e)}).join(",")}function hse(t){return t instanceof DOMException&&(t.name==="AbortError"||t.code===t.ABORT_ERR)}function pse(t){return t instanceof DOMException&&(t.name==="SecurityError"||t.code===t.SECURITY_ERR)}function cV(t){return t==="audio/*"||t==="video/*"||t==="image/*"||t==="text/*"||t==="application/*"||/\w+\/[-+.\w]+/g.test(t)}function uV(t){return/^.*\.[\w]+$/.test(t)}var fse=["children"],mse=["open"],gse=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],yse=["refKey","onChange","onClick"];function xse(t){return wse(t)||bse(t)||dV(t)||vse()}function vse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bse(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function wse(t){if(Array.isArray(t))return PS(t)}function LI(t,e){return Sse(t)||kse(t,e)||dV(t,e)||Ise()}function Ise(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dV(t,e){if(t){if(typeof t=="string")return PS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PS(t,e)}}function PS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}function kse(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var s=[],r=!0,i=!1,o,a;try{for(n=n.call(t);!(r=(o=n.next()).done)&&(s.push(o.value),!(e&&s.length===e));r=!0);}catch(l){i=!0,a=l}finally{try{!r&&n.return!=null&&n.return()}finally{if(i)throw a}}return s}}function Sse(t){if(Array.isArray(t))return t}function _D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Kt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_D(Object(n),!0).forEach(function(s){OS(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_D(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function OS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yv(t,e){if(t==null)return{};var n=Tse(t,e),s,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)s=i[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Tse(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}var z_=M.forwardRef(function(t,e){var n=t.children,s=Yv(t,fse),r=pV(s),i=r.open,o=Yv(r,mse);return M.useImperativeHandle(e,function(){return{open:i}},[i]),bt.createElement(M.Fragment,null,n(Kt(Kt({},o),{},{open:i})))});z_.displayName="Dropzone";var hV={disabled:!1,getFilesFromEvent:Lne,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};z_.defaultProps=hV;z_.propTypes={children:Ct.func,accept:Ct.objectOf(Ct.arrayOf(Ct.string)),multiple:Ct.bool,preventDropOnDocument:Ct.bool,noClick:Ct.bool,noKeyboard:Ct.bool,noDrag:Ct.bool,noDragEventsBubbling:Ct.bool,minSize:Ct.number,maxSize:Ct.number,maxFiles:Ct.number,disabled:Ct.bool,getFilesFromEvent:Ct.func,onFileDialogCancel:Ct.func,onFileDialogOpen:Ct.func,useFsAccessApi:Ct.bool,autoFocus:Ct.bool,onDragEnter:Ct.func,onDragLeave:Ct.func,onDragOver:Ct.func,onDrop:Ct.func,onDropAccepted:Ct.func,onDropRejected:Ct.func,onError:Ct.func,validator:Ct.func};var FS={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function pV(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=Kt(Kt({},hV),t),n=e.accept,s=e.disabled,r=e.getFilesFromEvent,i=e.maxSize,o=e.minSize,a=e.multiple,l=e.maxFiles,c=e.onDragEnter,u=e.onDragLeave,d=e.onDragOver,h=e.onDrop,p=e.onDropAccepted,f=e.onDropRejected,g=e.onFileDialogCancel,y=e.onFileDialogOpen,x=e.useFsAccessApi,v=e.autoFocus,w=e.preventDropOnDocument,I=e.noClick,N=e.noKeyboard,A=e.noDrag,T=e.noDragEventsBubbling,S=e.onError,E=e.validator,$=M.useMemo(function(){return dse(n)},[n]),P=M.useMemo(function(){return use(n)},[n]),F=M.useMemo(function(){return typeof y=="function"?y:ED},[y]),R=M.useMemo(function(){return typeof g=="function"?g:ED},[g]),G=M.useRef(null),q=M.useRef(null),Q=M.useReducer(Nse,FS),te=LI(Q,2),B=te[0],H=te[1],Z=B.isFocused,se=B.isFileDialogActive,re=M.useRef(typeof window<"u"&&window.isSecureContext&&x&&cse()),ie=function(){!re.current&&se&&setTimeout(function(){if(q.current){var Ae=q.current.files;Ae.length||(H({type:"closeDialog"}),R())}},300)};M.useEffect(function(){return window.addEventListener("focus",ie,!1),function(){window.removeEventListener("focus",ie,!1)}},[q,se,R,re]);var de=M.useRef([]),ce=function(Ae){G.current&&G.current.contains(Ae.target)||(Ae.preventDefault(),de.current=[])};M.useEffect(function(){return w&&(document.addEventListener("dragover",ND,!1),document.addEventListener("drop",ce,!1)),function(){w&&(document.removeEventListener("dragover",ND),document.removeEventListener("drop",ce))}},[G,w]),M.useEffect(function(){return!s&&v&&G.current&&G.current.focus(),function(){}},[G,v,s]);var pe=M.useCallback(function(fe){S?S(fe):console.error(fe)},[S]),we=M.useCallback(function(fe){fe.preventDefault(),fe.persist(),Nt(fe),de.current=[].concat(xse(de.current),[fe.target]),ux(fe)&&Promise.resolve(r(fe)).then(function(Ae){if(!(Xv(fe)&&!T)){var je=Ae.length,He=je>0&&ise({files:Ae,accept:$,minSize:o,maxSize:i,multiple:a,maxFiles:l,validator:E}),_t=je>0&&!He;H({isDragAccept:He,isDragReject:_t,isDragActive:!0,type:"setDraggedFiles"}),c&&c(fe)}}).catch(function(Ae){return pe(Ae)})},[r,c,pe,T,$,o,i,a,l,E]),De=M.useCallback(function(fe){fe.preventDefault(),fe.persist(),Nt(fe);var Ae=ux(fe);if(Ae&&fe.dataTransfer)try{fe.dataTransfer.dropEffect="copy"}catch{}return Ae&&d&&d(fe),!1},[d,T]),$e=M.useCallback(function(fe){fe.preventDefault(),fe.persist(),Nt(fe);var Ae=de.current.filter(function(He){return G.current&&G.current.contains(He)}),je=Ae.indexOf(fe.target);je!==-1&&Ae.splice(je,1),de.current=Ae,!(Ae.length>0)&&(H({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),ux(fe)&&u&&u(fe))},[G,u,T]),Oe=M.useCallback(function(fe,Ae){var je=[],He=[];fe.forEach(function(_t){var qs=aV(_t,$),fr=LI(qs,2),fo=fr[0],ni=fr[1],si=lV(_t,o,i),mo=LI(si,2),go=mo[0],sp=mo[1],rp=E?E(_t):null;if(fo&&go&&!rp)je.push(_t);else{var Rl=[ni,sp];rp&&(Rl=Rl.concat(rp)),He.push({file:_t,errors:Rl.filter(function(wy){return wy})})}}),(!a&&je.length>1||a&&l>=1&&je.length>l)&&(je.forEach(function(_t){He.push({file:_t,errors:[rse]})}),je.splice(0)),H({acceptedFiles:je,fileRejections:He,isDragReject:He.length>0,type:"setFiles"}),h&&h(je,He,Ae),He.length>0&&f&&f(He,Ae),je.length>0&&p&&p(je,Ae)},[H,a,$,o,i,l,h,p,f,E]),ve=M.useCallback(function(fe){fe.preventDefault(),fe.persist(),Nt(fe),de.current=[],ux(fe)&&Promise.resolve(r(fe)).then(function(Ae){Xv(fe)&&!T||Oe(Ae,fe)}).catch(function(Ae){return pe(Ae)}),H({type:"reset"})},[r,Oe,pe,T]),Le=M.useCallback(function(){if(re.current){H({type:"openDialog"}),F();var fe={multiple:a,types:P};window.showOpenFilePicker(fe).then(function(Ae){return r(Ae)}).then(function(Ae){Oe(Ae,null),H({type:"closeDialog"})}).catch(function(Ae){hse(Ae)?(R(Ae),H({type:"closeDialog"})):pse(Ae)?(re.current=!1,q.current?(q.current.value=null,q.current.click()):pe(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):pe(Ae)});return}q.current&&(H({type:"openDialog"}),F(),q.current.value=null,q.current.click())},[H,F,R,x,Oe,pe,P,a]),ze=M.useCallback(function(fe){!G.current||!G.current.isEqualNode(fe.target)||(fe.key===" "||fe.key==="Enter"||fe.keyCode===32||fe.keyCode===13)&&(fe.preventDefault(),Le())},[G,Le]),it=M.useCallback(function(){H({type:"focus"})},[]),ct=M.useCallback(function(){H({type:"blur"})},[]),ot=M.useCallback(function(){I||(lse()?setTimeout(Le,0):Le())},[I,Le]),ht=function(Ae){return s?null:Ae},yt=function(Ae){return N?null:ht(Ae)},Yn=function(Ae){return A?null:ht(Ae)},Nt=function(Ae){T&&Ae.stopPropagation()},hr=M.useMemo(function(){return function(){var fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ae=fe.refKey,je=Ae===void 0?"ref":Ae,He=fe.role,_t=fe.onKeyDown,qs=fe.onFocus,fr=fe.onBlur,fo=fe.onClick,ni=fe.onDragEnter,si=fe.onDragOver,mo=fe.onDragLeave,go=fe.onDrop,sp=Yv(fe,gse);return Kt(Kt(OS({onKeyDown:yt(Pi(_t,ze)),onFocus:yt(Pi(qs,it)),onBlur:yt(Pi(fr,ct)),onClick:ht(Pi(fo,ot)),onDragEnter:Yn(Pi(ni,we)),onDragOver:Yn(Pi(si,De)),onDragLeave:Yn(Pi(mo,$e)),onDrop:Yn(Pi(go,ve)),role:typeof He=="string"&&He!==""?He:"presentation"},je,G),!s&&!N?{tabIndex:0}:{}),sp)}},[G,ze,it,ct,ot,we,De,$e,ve,N,A,s]),Qn=M.useCallback(function(fe){fe.stopPropagation()},[]),pr=M.useMemo(function(){return function(){var fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ae=fe.refKey,je=Ae===void 0?"ref":Ae,He=fe.onChange,_t=fe.onClick,qs=Yv(fe,yse),fr=OS({accept:$,multiple:a,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:ht(Pi(He,ve)),onClick:ht(Pi(_t,Qn)),tabIndex:-1},je,q);return Kt(Kt({},fr),qs)}},[q,n,a,ve,s]);return Kt(Kt({},B),{},{isFocused:Z&&!s,getRootProps:hr,getInputProps:pr,rootRef:G,inputRef:q,open:ht(Le)})}function Nse(t,e){switch(e.type){case"focus":return Kt(Kt({},t),{},{isFocused:!0});case"blur":return Kt(Kt({},t),{},{isFocused:!1});case"openDialog":return Kt(Kt({},FS),{},{isFileDialogActive:!0});case"closeDialog":return Kt(Kt({},t),{},{isFileDialogActive:!1});case"setDraggedFiles":return Kt(Kt({},t),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return Kt(Kt({},t),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return Kt({},FS);default:return t}}function ED(){}function Yu({onUpload:t,maxImages:e=5}){const[n,s]=bt.useState([]),r=M.useCallback(c=>{const u=c.map(h=>({file:h,preview:URL.createObjectURL(h)})),d=[...n,...u].slice(0,e);s(d),t(d.map(h=>h.file))},[n,e,t]),{getRootProps:i,getInputProps:o,isDragActive:a}=pV({onDrop:r,accept:{"image/*":[".jpeg",".jpg",".png"]},maxFiles:e}),l=c=>{const u=n.filter((d,h)=>h!==c);s(u),t(u.map(d=>d.file))};return b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{...i(),className:`border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors
          ${a?"border-primary bg-orange-50":"border-gray-300 hover:border-primary"}`,children:[b.jsx("input",{...o()}),b.jsx(WZ,{className:"mx-auto h-12 w-12 text-gray-400"}),b.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Drag & drop images here, or click to select files"}),b.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Up to ",e," images (JPEG, PNG)"]})]}),n.length>0&&b.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:n.map((c,u)=>b.jsxs("div",{className:"relative",children:[b.jsx("img",{src:c.preview,alt:`Preview ${u+1}`,className:"w-full h-32 object-cover rounded-lg"}),b.jsx("button",{onClick:()=>l(u),className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow-md hover:bg-gray-100",children:b.jsx(L_,{className:"h-4 w-4 text-gray-600"})})]},u))})]})}function _se({onSubmit:t}){const[e,n]=M.useState({title:"",description:"",category:"",condition:"",features:[],estimatedValue:"",preferredSwapItems:[]}),s=["Electronics","Furniture","Clothing","Sports","Books","Collectibles","Home & Garden","Toys & Games","Other"],r=["New","Like New","Good","Fair","Poor"],i=l=>{l.preventDefault(),t(e)},o=()=>{const l=document.getElementById("feature-input").value.trim();l&&!e.features.includes(l)&&(n({...e,features:[...e.features,l]}),document.getElementById("feature-input").value="")},a=()=>{const l=document.getElementById("preferred-item-input").value.trim();l&&!e.preferredSwapItems.includes(l)&&(n({...e,preferredSwapItems:[...e.preferredSwapItems,l]}),document.getElementById("preferred-item-input").value="")};return b.jsxs("form",{onSubmit:i,className:"space-y-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),b.jsx("input",{type:"text",required:!0,value:e.title,onChange:l=>n({...e,title:l.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),b.jsx("textarea",{required:!0,value:e.description,onChange:l=>n({...e,description:l.target.value}),rows:4,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2"})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),b.jsxs("select",{required:!0,value:e.category,onChange:l=>n({...e,category:l.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2",children:[b.jsx("option",{value:"",children:"Select Category"}),s.map(l=>b.jsx("option",{value:l,children:l},l))]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Condition"}),b.jsxs("select",{required:!0,value:e.condition,onChange:l=>n({...e,condition:l.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2",children:[b.jsx("option",{value:"",children:"Select Condition"}),r.map(l=>b.jsx("option",{value:l,children:l},l))]})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Features"}),b.jsxs("div",{className:"mt-1 flex",children:[b.jsx("input",{id:"feature-input",type:"text",className:"block w-full rounded-l-md border border-gray-300 px-3 py-2",placeholder:"Add a feature"}),b.jsx("button",{type:"button",onClick:o,className:"bg-primary text-white px-4 rounded-r-md hover:bg-secondary",children:"Add"})]}),e.features.length>0&&b.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:e.features.map((l,c)=>b.jsxs("span",{className:"bg-gray-100 px-2 py-1 rounded text-sm flex items-center",children:[l,b.jsx("button",{type:"button",onClick:()=>n({...e,features:e.features.filter((u,d)=>d!==c)}),className:"ml-2 text-gray-500 hover:text-red-500",children:"×"})]},c))})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estimated Value (ZAR)"}),b.jsx("input",{type:"number",required:!0,value:e.estimatedValue,onChange:l=>n({...e,estimatedValue:l.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2",min:"0",step:"1"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Preferred Swap Items"}),b.jsxs("div",{className:"mt-1 flex",children:[b.jsx("input",{id:"preferred-item-input",type:"text",className:"block w-full rounded-l-md border border-gray-300 px-3 py-2",placeholder:"Add preferred item"}),b.jsx("button",{type:"button",onClick:a,className:"bg-primary text-white px-4 rounded-r-md hover:bg-secondary",children:"Add"})]}),e.preferredSwapItems.length>0&&b.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:e.preferredSwapItems.map((l,c)=>b.jsxs("span",{className:"bg-gray-100 px-2 py-1 rounded text-sm flex items-center",children:[l,b.jsx("button",{type:"button",onClick:()=>n({...e,preferredSwapItems:e.preferredSwapItems.filter((u,d)=>d!==c)}),className:"ml-2 text-gray-500 hover:text-red-500",children:"×"})]},c))})]}),b.jsx("div",{className:"pt-4",children:b.jsx("button",{type:"submit",className:"w-full bg-primary text-white py-2 rounded-lg hover:bg-secondary transition-colors",children:"Continue"})})]})}function fV({onChange:t}){return b.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:b.jsxs("div",{className:"flex items-start space-x-4",children:[b.jsx(Dm,{className:"h-8 w-8 text-primary flex-shrink-0"}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-lg font-semibold",children:"VeriLINC Certificate"}),b.jsx("p",{className:"text-gray-600 mt-1",children:"Get your item verified and valued by our AI-powered system for more trusted swaps."}),b.jsxs("ul",{className:"mt-4 space-y-2 text-sm text-gray-600",children:[b.jsxs("li",{className:"flex items-center",children:[b.jsx("span",{className:"mr-2",children:"✓"}),"AI-powered item analysis"]}),b.jsxs("li",{className:"flex items-center",children:[b.jsx("span",{className:"mr-2",children:"✓"}),"Professional valuation"]}),b.jsxs("li",{className:"flex items-center",children:[b.jsx("span",{className:"mr-2",children:"✓"}),"Trust badge on your listing"]})]}),b.jsx("div",{className:"mt-6",children:b.jsxs("label",{className:"flex items-center",children:[b.jsx("input",{type:"checkbox",onChange:e=>t(e.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary"}),b.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Yes, I want a VeriLINC certificate (R50)"})]})})]})]})})}let dx;const Ese=new Uint8Array(16);function Cse(){if(!dx&&(dx=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!dx))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return dx(Ese)}const Zn=[];for(let t=0;t<256;++t)Zn.push((t+256).toString(16).slice(1));function $se(t,e=0){return Zn[t[e+0]]+Zn[t[e+1]]+Zn[t[e+2]]+Zn[t[e+3]]+"-"+Zn[t[e+4]]+Zn[t[e+5]]+"-"+Zn[t[e+6]]+Zn[t[e+7]]+"-"+Zn[t[e+8]]+Zn[t[e+9]]+"-"+Zn[t[e+10]]+Zn[t[e+11]]+Zn[t[e+12]]+Zn[t[e+13]]+Zn[t[e+14]]+Zn[t[e+15]]}const Ase=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),CD={randomUUID:Ase};function j_(t,e,n){if(CD.randomUUID&&!e&&!t)return CD.randomUUID();t=t||{};const s=t.random||(t.rng||Cse)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,$se(s)}class mV{async createItem(e){try{const n=await this.uploadImages(e.images),s={...e,images:n,status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return{id:(await __(Uv(sc,"items"),s)).id,...s}}catch(n){throw console.error("Error creating item:",n),n}}async uploadImages(e){const n=e.map(async s=>{const r=SM(TM,`items/${j_()}`);return await IM(r,s),kM(r)});return Promise.all(n)}async getUserItems(e){const n=gJ(Uv(sc,"items"),yJ("userId","==",e));return(await kJ(n)).docs.map(r=>({id:r.id,...r.data()}))}async updateItem(e,n){const s=Wv(sc,"items",e);await rM(s,{...n,updatedAt:new Date().toISOString()})}async deleteItem(e){await SJ(Wv(sc,"items",e))}}function Rse(){const t=Es(),[e,n]=M.useState(1),[s,r]=M.useState({images:[],title:"",description:"",category:"",condition:"",features:[],estimatedValue:"",preferredSwapItems:[],requestVeriLINC:!1}),[i,o]=M.useState(!1),a=new mV,l=h=>{r({...s,images:h}),n(2)},c=h=>{r({...s,...h}),n(3)},u=h=>{r({...s,requestVeriLINC:h})},d=async()=>{try{o(!0),await a.createItem(s),t("/dashboard")}catch(h){console.error("Error publishing item:",h)}finally{o(!1)}};return b.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:b.jsx("div",{className:"max-w-3xl mx-auto px-4",children:b.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[b.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Post New Item"}),b.jsx("div",{className:"flex justify-between mb-8",children:[1,2,3].map(h=>b.jsxs("div",{className:`flex items-center ${h<e?"text-primary":h===e?"text-gray-900":"text-gray-400"}`,children:[b.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${h<=e?"bg-primary text-white":"bg-gray-200"}`,children:h}),b.jsx("span",{className:"ml-2",children:h===1?"Photos":h===2?"Details":"Review"})]},h))}),e===1&&b.jsx(Yu,{onUpload:l}),e===2&&b.jsx(_se,{onSubmit:c}),e===3&&b.jsxs("div",{className:"space-y-6",children:[b.jsx(fV,{onChange:u}),b.jsx("div",{className:"border-t pt-6",children:b.jsx("button",{onClick:d,disabled:i,className:"w-full bg-primary text-white py-3 rounded-lg hover:bg-secondary transition-colors disabled:opacity-50",children:i?"Publishing...":"Publish Item"})})]})]})})})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dse=1e-7,Pse=1e-4;class B_{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class yb{refCount(e){return Ks("refCount")}incRef(e){return Ks("incRef")}timerAvailable(){return!0}time(e){return Ks("time")}read(e){return Ks("read")}readSync(e){return Ks("readSync")}readToGPU(e,n){return Ks("readToGPU")}numDataIds(){return Ks("numDataIds")}disposeData(e,n){return Ks("disposeData")}write(e,n,s){return Ks("write")}move(e,n,s,r,i){return Ks("move")}createTensorFromGPUData(e,n,s){return Ks("createTensorFromGPUData")}memory(){return Ks("memory")}floatPrecision(){return Ks("floatPrecision")}epsilon(){return this.floatPrecision()===32?Dse:Pse}dispose(){return Ks("dispose")}}function Ks(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,To(t,e,n)}function Ose(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,To(t,n,s),To(e,n,s)}function rl(t,e,n){return Math.max(t,Math.min(e,n))}function xb(t){return t%2===0?t:t+1}function To(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function gV(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function Fse(t,e){const n=Math.random();return e*n+(1-n)*t}function Lse(t,e){let n=0;for(let s=0;s<t.length;s++){const r=Number(t[s])-Number(e[s]);n+=r*r}return n}function D(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Gn(t,e,n=""){D(Ze(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Jc(t){D(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function J(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Mse(t){return t.length===0}function yV(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Ze(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function $c(t){return t%1===0}function Vse(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function Qv(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function zse(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return U_(e),e}function pc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function LS(t,e=r=>0,n,s){return new Promise((r,i)=>{let o=0;const a=()=>{if(t()){r();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function W_(t,e){let n=1,s=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${i}`);s=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function Qe(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),D(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),D(t.every(s=>$c(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function na(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||r?null:Qe(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(i!=null){if(i[o]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(i[o]==null||i[o]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),i[o]<=a&&o++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function Dn(t,e){return Yt(t,e)}function Yt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function xV(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function vV(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function G_(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Kf(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function bV(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function ji(t){return typeof t=="string"||t instanceof String}function wV(t){return typeof t=="boolean"}function Jv(t){return typeof t=="number"}function Zc(t){return Array.isArray(t)?Zc(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Jv(t)?"float32":ji(t)?"string":wV(t)?"bool":"float32"}function il(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Zv(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Re(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function IV(t,e,n,s=!1){const r=new Array;if(e.length===1){const i=e[0]*(s?2:1);for(let o=0;o<i;o++)r[o]=n[t+o]}else{const i=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<i;l++)r[l]=IV(t+l*a,o,n,s)}return r}function Tr(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,i)=>r*i)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return IV(0,t,e,n)}function kV(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function vb(t,e){const n=Wn(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Wn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function H_(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return Tr(t,new Float32Array(n));if(e==="int32")return Tr(t,new Int32Array(n));if(e==="bool")return Tr(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function ur(t){t.forEach(e=>{D(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function vi(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function eu(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function ol(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $D="tfjsflags";class SV{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=jse,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(X().getBool("IS_TEST")||X().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];X().getBool("IS_TEST")||X().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(ol(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);$D in e&&e[$D].split(",").forEach(s=>{const[r,i]=s.split(":");this.urlFlags[r]=Use(r,i)})}}function jse(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(Bse(e,s[0],s[1]),s.join("="))),e}function Bse(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Use(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function X(){return q_}let q_=null;function Wse(t){q_=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let MI;function TV(){if(MI==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");MI=t}return MI}function Gse(){const t=TV();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function K_(t,e){const n=Gse();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const Fm="Abs",Gd="Acos",Hd="Acosh",tu="Add",Lm="AddN",bb="All",wb="Any",Mm="ArgMax",Vm="ArgMin",qd="Asin",Kd="Asinh",Xd="Atan",Yd="Atanh",Qd="Atan2",zm="AvgPool",Ib="AvgPoolGrad",jm="AvgPool3D",kb="AvgPool3DGrad",Bm="BatchMatMul",Um="BatchToSpaceND",Sb="Bincount",Wm="BitwiseAnd",NV="BroadcastTo",Tb="BroadcastArgs",Jd="Cast",Zd="Ceil",eh="ClipByValue",Nb="Complex",Gm="ComplexAbs",Hm="Concat",qm="Conv2D",_b="Conv2DBackpropFilter",Km="Conv2DBackpropInput",Xm="Conv3D",Eb="Conv3DBackpropFilterV2",Cb="Conv3DBackpropInputV2",th="Cos",nh="Cosh",$b="Cumprod",Ym="Cumsum",Ab="CropAndResize",Rb="DenseBincount",Db="DepthToSpace",Qm="DepthwiseConv2dNative",Pb="DepthwiseConv2dNativeBackpropFilter",Ob="DepthwiseConv2dNativeBackpropInput",Fb="Diag",Jm="Dilation2D",e0="Dilation2DBackpropInput",t0="Dilation2DBackpropFilter",Lb="Draw",sh="RealDiv",Mb="Einsum",rh="Elu",Vb="EluGrad",ih="Erf",Zm="Equal",oh="Exp",eg="ExpandDims",ah="Expm1",zb="FFT",jb="Fill",Bb="FlipLeftRight",lh="Floor",ch="FloorDiv",tg="FusedBatchNorm",ng="GatherV2",Ub="GatherNd",sg="Greater",uh="GreaterEqual",dh="Identity",Wb="IFFT",Gb="Imag",hh="IsFinite",ph="IsInf",fh="IsNan",rg="LeakyRelu",ig="Less",og="LessEqual",Hb="LinSpace",mh="Log",gh="Log1p",ag="LogicalAnd",lg="LogicalNot",cg="LogicalOr",Hse="LogicalXor",_V="LogSoftmax",qse="LowerBound",ug="LRN",qb="LRNGrad",Kse="MatrixBandPart",dg="Max",yh="Maximum",hg="MaxPool",Kb="MaxPoolGrad",pg="MaxPool3D",Xb="MaxPool3DGrad",Yb="MaxPoolWithArgmax",fg="Mean",mg="Min",xh="Minimum",gg="MirrorPad",vh="Mod",Qb="Multinomial",bh="Multiply",yg="Neg",xg="NotEqual",Jb="NonMaxSuppressionV3",Zb="NonMaxSuppressionV4",ew="NonMaxSuppressionV5",vg="OnesLike",bg="OneHot",wg="Pack",Ig="PadV2",Xse="Pool",wh="Pow",kg="Prelu",Sg="Prod",tw="RaggedGather",nw="RaggedRange",sw="RaggedTensorToTensor",rw="Range",iw="Real",Ih="Reciprocal",kh="Relu",Tg="Reshape",Ng="ResizeNearestNeighbor",ow="ResizeNearestNeighborGrad",_g="ResizeBilinear",aw="ResizeBilinearGrad",Sh="Relu6",Eg="Reverse",Th="Round",Nh="Rsqrt",lw="ScatterNd",cw="TensorScatterUpdate",uw="SearchSorted",Cg="Select",_h="Selu",$g="Slice",Eh="Sin",Ch="Sinh",$h="Sign",Ah="Sigmoid",Rh="Softplus",Dh="Sqrt",Ag="Sum",Rg="SpaceToBatchND",Dg="SplitV",Pg="Softmax",dw="SparseFillEmptyRows",hw="SparseReshape",pw="SparseSegmentMean",fw="SparseSegmentSum",mw="SparseToDense",Ph="SquaredDifference",gw="Square",Og="StaticRegexReplace",yw="StridedSlice",xw="StringNGrams",vw="StringSplit",bw="StringToHashBucketFast",Oh="Sub",Fh="Tan",Lh="Tanh",Mh="Tile",ww="TopK",Iw="Transform",fc="Transpose",kw="Unique",Fg="Unpack",Lg="UnsortedSegmentSum",Yse="UpperBound",Mg="ZerosLike",Vh="Step",n0="FromPixels",Sw="RotateWithOffset",Xf="_FusedMatMul",Yf="FusedConv2D",Qf="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yr(...t){X().getBool("IS_TEST")||X().getBool("PROD")||console.warn(...t)}function Qse(...t){X().getBool("IS_TEST")||X().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xd=K_("kernelRegistry",()=>new Map),Jf=K_("gradRegistry",()=>new Map);function Zf(t,e){const n=X_(t,e);return xd.get(n)}function MS(t){return Jf.get(t)}function s0(t){const e=xd.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[i,o]=r,[a]=i.split("_");a===t&&n.push(o)}return n}function Tw(t){const{kernelName:e,backendName:n}=t,s=X_(e,n);xd.has(s)&&yr(`The kernel '${e}' for backend '${n}' is already registered`),xd.set(s,t)}function EV(t){const{kernelName:e}=t;Jf.has(e)&&X().getBool("DEBUG")&&yr(`Overriding the gradient for '${e}'`),Jf.set(e,t)}function Jse(t,e){const n=X_(t,e);if(!xd.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);xd.delete(n)}function Zse(t){if(!Jf.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);Jf.delete(t)}function ere(t,e){s0(t).forEach(s=>{const r=Object.assign({},s,{backendName:e});Tw(r)})}function X_(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var $V=Pt,jr=null;try{jr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Pt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Pt.prototype.__isLong__;Object.defineProperty(Pt.prototype,"__isLong__",{value:!0});function dr(t){return(t&&t.__isLong__)===!0}Pt.isLong=dr;var AD={},RD={};function nu(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=RD[t],s)?s:(n=Ot(t,(t|0)<0?-1:0,!0),r&&(RD[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=AD[t],s)?s:(n=Ot(t,t<0?-1:0,!1),r&&(AD[t]=n),n))}Pt.fromInt=nu;function Br(t,e){if(isNaN(t))return e?ic:Ur;if(e){if(t<0)return ic;if(t>=AV)return PV}else{if(t<=-PD)return tr;if(t+1>=PD)return DV}return t<0?Br(-t,e).neg():Ot(t%vd|0,t/vd|0,e)}Pt.fromNumber=Br;function Ot(t,e,n){return new Pt(t,e,n)}Pt.fromBits=Ot;var r0=Math.pow;function Y_(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ur;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return Y_(t.substring(1),e,n).neg();for(var r=Br(r0(n,8)),i=Ur,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+a),n);if(a<8){var c=Br(r0(n,a));i=i.mul(c).add(Br(l))}else i=i.mul(r),i=i.add(Br(l))}return i.unsigned=e,i}Pt.fromString=Y_;function Ci(t,e){return typeof t=="number"?Br(t,e):typeof t=="string"?Y_(t,e):Ot(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Pt.fromValue=Ci;var DD=65536,tre=1<<24,vd=DD*DD,AV=vd*vd,PD=AV/2,OD=nu(tre),Ur=nu(0);Pt.ZERO=Ur;var ic=nu(0,!0);Pt.UZERO=ic;var Vu=nu(1);Pt.ONE=Vu;var RV=nu(1,!0);Pt.UONE=RV;var VS=nu(-1);Pt.NEG_ONE=VS;var DV=Ot(-1,2147483647,!1);Pt.MAX_VALUE=DV;var PV=Ot(-1,-1,!0);Pt.MAX_UNSIGNED_VALUE=PV;var tr=Ot(0,-2147483648,!1);Pt.MIN_VALUE=tr;var xe=Pt.prototype;xe.toInt=function(){return this.unsigned?this.low>>>0:this.low};xe.toNumber=function(){return this.unsigned?(this.high>>>0)*vd+(this.low>>>0):this.high*vd+(this.low>>>0)};xe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(tr)){var n=Br(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=Br(r0(e,6),this.unsigned),o=this,a="";;){var l=o.div(i),c=o.sub(l.mul(i)).toInt()>>>0,u=c.toString(e);if(o=l,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};xe.getHighBits=function(){return this.high};xe.getHighBitsUnsigned=function(){return this.high>>>0};xe.getLowBits=function(){return this.low};xe.getLowBitsUnsigned=function(){return this.low>>>0};xe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(tr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};xe.isZero=function(){return this.high===0&&this.low===0};xe.eqz=xe.isZero;xe.isNegative=function(){return!this.unsigned&&this.high<0};xe.isPositive=function(){return this.unsigned||this.high>=0};xe.isOdd=function(){return(this.low&1)===1};xe.isEven=function(){return(this.low&1)===0};xe.equals=function(e){return dr(e)||(e=Ci(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};xe.eq=xe.equals;xe.notEquals=function(e){return!this.eq(e)};xe.neq=xe.notEquals;xe.ne=xe.notEquals;xe.lessThan=function(e){return this.comp(e)<0};xe.lt=xe.lessThan;xe.lessThanOrEqual=function(e){return this.comp(e)<=0};xe.lte=xe.lessThanOrEqual;xe.le=xe.lessThanOrEqual;xe.greaterThan=function(e){return this.comp(e)>0};xe.gt=xe.greaterThan;xe.greaterThanOrEqual=function(e){return this.comp(e)>=0};xe.gte=xe.greaterThanOrEqual;xe.ge=xe.greaterThanOrEqual;xe.compare=function(e){if(dr(e)||(e=Ci(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};xe.comp=xe.compare;xe.negate=function(){return!this.unsigned&&this.eq(tr)?tr:this.not().add(Vu)};xe.neg=xe.negate;xe.add=function(e){dr(e)||(e=Ci(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,p=0;return p+=i+c,h+=p>>>16,p&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,u+=d>>>16,d&=65535,u+=n+o,u&=65535,Ot(h<<16|p,u<<16|d,this.unsigned)};xe.subtract=function(e){return dr(e)||(e=Ci(e)),this.add(e.neg())};xe.sub=xe.subtract;xe.multiply=function(e){if(this.isZero())return Ur;if(dr(e)||(e=Ci(e)),jr){var n=jr.mul(this.low,this.high,e.low,e.high);return Ot(n,jr.get_high(),this.unsigned)}if(e.isZero())return Ur;if(this.eq(tr))return e.isOdd()?tr:Ur;if(e.eq(tr))return this.isOdd()?tr:Ur;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(OD)&&e.lt(OD))return Br(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,p=0,f=0;return f+=o*u,p+=f>>>16,f&=65535,p+=i*u,h+=p>>>16,p&=65535,p+=o*c,h+=p>>>16,p&=65535,h+=r*u,d+=h>>>16,h&=65535,h+=i*c,d+=h>>>16,h&=65535,h+=o*l,d+=h>>>16,h&=65535,d+=s*u+r*c+i*l+o*a,d&=65535,Ot(p<<16|f,d<<16|h,this.unsigned)};xe.mul=xe.multiply;xe.divide=function(e){if(dr(e)||(e=Ci(e)),e.isZero())throw Error("division by zero");if(jr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?jr.div_u:jr.div_s)(this.low,this.high,e.low,e.high);return Ot(n,jr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?ic:Ur;var s,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ic;if(e.gt(this.shru(1)))return RV;i=ic}else{if(this.eq(tr)){if(e.eq(Vu)||e.eq(VS))return tr;if(e.eq(tr))return Vu;var o=this.shr(1);return s=o.div(e).shl(1),s.eq(Ur)?e.isNegative()?Vu:VS:(r=this.sub(e.mul(s)),i=s.add(r.div(e)),i)}else if(e.eq(tr))return this.unsigned?ic:Ur;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=Ur}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:r0(2,a-48),c=Br(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=Br(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=Vu),i=i.add(c),r=r.sub(u)}return i};xe.div=xe.divide;xe.modulo=function(e){if(dr(e)||(e=Ci(e)),jr){var n=(this.unsigned?jr.rem_u:jr.rem_s)(this.low,this.high,e.low,e.high);return Ot(n,jr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};xe.mod=xe.modulo;xe.rem=xe.modulo;xe.not=function(){return Ot(~this.low,~this.high,this.unsigned)};xe.and=function(e){return dr(e)||(e=Ci(e)),Ot(this.low&e.low,this.high&e.high,this.unsigned)};xe.or=function(e){return dr(e)||(e=Ci(e)),Ot(this.low|e.low,this.high|e.high,this.unsigned)};xe.xor=function(e){return dr(e)||(e=Ci(e)),Ot(this.low^e.low,this.high^e.high,this.unsigned)};xe.shiftLeft=function(e){return dr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ot(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Ot(0,this.low<<e-32,this.unsigned)};xe.shl=xe.shiftLeft;xe.shiftRight=function(e){return dr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Ot(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Ot(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};xe.shr=xe.shiftRight;xe.shiftRightUnsigned=function(e){if(dr(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return Ot(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Ot(n,0,this.unsigned):Ot(n>>>e-32,0,this.unsigned)};xe.shru=xe.shiftRightUnsigned;xe.shr_u=xe.shiftRightUnsigned;xe.toSigned=function(){return this.unsigned?Ot(this.low,this.high,!1):this};xe.toUnsigned=function(){return this.unsigned?this:Ot(this.low,this.high,!0)};xe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};xe.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};xe.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Pt.fromBytes=function(e,n,s){return s?Pt.fromBytesLE(e,n):Pt.fromBytesBE(e,n)};Pt.fromBytesLE=function(e,n){return new Pt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Pt.fromBytesBE=function(e,n){return new Pt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const OV=DT($V),nre=yO({__proto__:null,default:OV},[$V]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ql=OV||nre;function Vg(t){return ql.fromString(t,!0,16)}const FV=Vg("c3a5c85c97cb3127"),Ul=Vg("b492b66fbe98f273"),ws=Vg("9ae16a3b2f90404f");function zS(t){return t.xor(t.shru(47))}function LV(t,e,n){const s=t.slice(e,e+n);return ql.fromBytes(Array.from(s),!0,!0)}function $t(t,e){return LV(t,e,8)}function FD(t,e){return LV(t,e,4)}function En(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function qa(t,e,n=Vg("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function sre(t,e,n,s,r,i){r=r.add(t),i=En(i.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),i=i.add(En(r,44)),[r.add(s),i.add(o)]}function hx(t,e,n,s){return sre($t(t,e),$t(t,e+8),$t(t,e+16),$t(t,e+24),n,s)}function rre(t,e=t.length){if(e>=8){const n=ws.add(e*2),s=$t(t,0).add(ws),r=$t(t,e-8),i=En(r,37).mul(n).add(s),o=En(s,25).add(r).mul(n);return qa(i,o,n)}if(e>=4){const n=ws.add(e*2),s=FD(t,0);return qa(s.shl(3).add(e),FD(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],i=n+(s<<8),o=e+(r<<2);return zS(ws.mul(i).xor(FV.mul(o))).mul(ws)}return ws}function ire(t,e=t.length){const n=ws.add(e*2),s=$t(t,0).mul(Ul),r=$t(t,8),i=$t(t,e-8).mul(n),o=$t(t,e-16).mul(ws);return qa(En(s.add(r),43).add(En(i,30)).add(o),s.add(En(r.add(ws),18)).add(i),n)}function ore(t,e=t.length){const n=ws.add(e*2),s=$t(t,0).mul(ws),r=$t(t,8),i=$t(t,e-8).mul(n),o=$t(t,e-16).mul(ws),a=En(s.add(r),43).add(En(i,30)).add(o),l=qa(a,s.add(En(r.add(ws),18)).add(i),n),c=$t(t,16).mul(n),u=$t(t,24),d=a.add($t(t,e-32)).mul(n),h=l.add($t(t,e-24)).mul(n);return qa(En(c.add(u),43).add(En(d,30)).add(h),c.add(En(u.add(s),18)).add(d),n)}function MV(t,e=t.length){const n=ql.fromNumber(81,!0);if(e<=32)return e<=16?rre(t,e):ire(t,e);if(e<=64)return ore(t,e);let s=n,r=n.mul(Ul).add(113),i=zS(r.mul(ws).add(113)).mul(ws),o=[ql.UZERO,ql.UZERO],a=[ql.UZERO,ql.UZERO];s=s.mul(ws).add($t(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=En(s.add(r).add(o[0]).add($t(t,l+8)),37).mul(Ul),r=En(r.add(o[1]).add($t(t,l+48)),42).mul(Ul),s=s.xor(a[1]),r=r.add(o[0]).add($t(t,l+40)),i=En(i.add(a[0]),33).mul(Ul),o=hx(t,l,o[1].mul(Ul),s.add(a[0])),a=hx(t,l+32,i.add(a[1]),r.add($t(t,l+16))),[i,s]=[s,i],l+=64;while(l!==c);const d=Ul.add(i.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=En(s.add(r).add(o[0]).add($t(t,l+8)),37).mul(d),r=En(r.add(o[1]).add($t(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(o[0].mul(9).add($t(t,l+40))),i=En(i.add(a[0]),33).mul(d),o=hx(t,l,o[1].mul(d),s.add(a[0])),a=hx(t,l+32,i.add(a[1]),r.add($t(t,l+16))),[i,s]=[s,i],qa(qa(o[0],a[0],d).add(zS(r).mul(FV)).add(i),qa(o[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sa(t,e){return e==="string"?Yi(t):Il([t],e)}function are(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Il(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=no(t)),X().getBool("DEBUG")&&xV(t,e),are(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function ys(){return X().platform.now()}function lre(t,e){return X().platform.fetch(t,e)}function Yi(t,e="utf-8"){return e=e||"utf-8",X().platform.encode(t,e)}function Ho(t,e="utf-8"){return e=e||"utf-8",X().platform.decode(t,e)}function Cn(t){return X().platform.isTypedArray!=null?X().platform.isTypedArray(t):CV(t)}function no(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||ol(t)||t==null||Cn(t)&&n)e.push(t);else if(Array.isArray(t)||Cn(t))for(let s=0;s<t.length;++s)no(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)no(t[r],e,n)}return e}const cre=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Ze,arraysEqualWithNull:yV,assert:D,assertNonNegativeIntegerDimensions:ur,assertNonNull:Jc,assertShapesMatch:Gn,bytesFromStringArray:bV,bytesPerElement:Kf,checkConversionForErrors:xV,clamp:rl,computeStrides:Re,convertBackendValuesAndArrayBuffer:kV,createScalarValue:sa,createShuffledIndices:zse,decodeString:Ho,distSquared:Lse,encodeString:Yi,fetch:lre,fingerPrint64:MV,flatten:no,getArrayFromDType:Yt,getTypedArrayFromDType:Dn,hasEncodingLoss:G_,hexToLong:Vg,indexToLoc:eu,inferDtype:Zc,inferFromImplicitShape:W_,isBoolean:wV,isFunction:il,isInt:$c,isNumber:Jv,isPromise:ol,isScalarShape:Mse,isString:ji,isTypedArray:Cn,isValidDtype:vV,locToIndex:vi,makeOnesTypedArray:vb,makeZerosNestedTypedArray:H_,makeZerosTypedArray:Wn,nearestDivisor:Zv,nearestLargerEven:xb,now:ys,parseAxisParam:Qe,randUniform:Fse,repeatedTry:LS,rightPad:pc,shuffle:U_,shuffleCombo:Ose,sizeFromShape:J,sizeToSquarishShape:Qv,squeezeShape:na,sum:gV,swap:To,tanh:Vse,toNestedArray:Tr,toTypedArray:Il},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ure{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new hre)}profileKernel(e,n,s){let r;const i=()=>{r=s()};let o;const a=ys();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const c of r)c.dataSync();o=Promise.resolve({kernelMs:ys()-a})}if(X().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(d=>{dre(d,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:i,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),r,o]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],i,l[2])})})}}function dre(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class hre{logKernelProfile(e,n,s,r,i,o){const a=typeof r=="number"?pc(`${r}ms`,9):r.error,l=pc(e,25),c=n.rank,u=n.size,d=pc(n.shape.toString(),14);let h="";for(const p in i){const f=i[p];if(f!=null){const g=f.shape||n.shape,y=g.length;h+=`${p}: ${y}D ${y>0?g:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let p=!1;for(let f=0;f<e.length;f++)if(s[h.id]){c.outputs.forEach(g=>s[g.id]=!0),p=!0,r[c.id]=!0;break}if(p)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(i[c.outputs[d].id]){for(const h in u)i[u[h].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&o[c.id]){const u={};for(const h in c.inputs){const p=c.inputs[h];s[p.id]&&(u[h]=p)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function fre(t,e,n,s){for(let r=e.length-1;r>=0;r--){const i=e[r],o=[];if(i.outputs.forEach(l=>{const c=t[l.id];c!=null?o.push(c):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const a=i.gradient(o);for(const l in i.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=i.inputs[l];if(!Ze(c.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LD=20,$p=3,VI=7;function mre(t,e,n,s){const r=Re(e),i=gre(t,e,n,r),o=e.length,a=Qx(t,e,n,r,i),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function gre(t,e,n,s){const r=J(e),i=s[s.length-1],o=new Array(i).fill(0),a=e.length,l=n==="complex64"?Xp(t):t;if(a>1)for(let c=0;c<r/i;c++){const u=c*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],Kp(l[u+d],0,n).length)}return o}function Kp(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(VI))} + ${parseFloat(t[1].toFixed(VI))}j`:ji(t)?s=`'${t}'`:n==="bool"?s=VV(t):s=parseFloat(t.toFixed(VI)).toString(),pc(s,e)}function VV(t){return t===0?"false":"true"}function Qx(t,e,n,s,r,i=!0){const o=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=Xp(t);return[Kp(g[0],0,n)]}return n==="bool"?[VV(t[0])]:[t[0].toString()]}if(l===1){if(a>LD){const y=$p*o;let x=Array.from(t.slice(0,y)),v=Array.from(t.slice((a-$p)*o,a*o));return n==="complex64"&&(x=Xp(x),v=Xp(v)),["["+x.map((w,I)=>Kp(w,r[I],n)).join(", ")+", ..., "+v.map((w,I)=>Kp(w,r[a-$p+I],n)).join(", ")+"]"]}return["["+(n==="complex64"?Xp(t):Array.from(t)).map((y,x)=>Kp(y,r[x],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),d=s[0]*o,h=[];if(a>LD){for(let g=0;g<$p;g++){const y=g*d,x=y+d;h.push(...Qx(t.slice(y,x),c,n,u,r,!1))}h.push("...");for(let g=a-$p;g<a;g++){const y=g*d,x=y+d;h.push(...Qx(t.slice(y,x),c,n,u,r,g===a-1))}}else for(let g=0;g<a;g++){const y=g*d,x=y+d;h.push(...Qx(t.slice(y,x),c,n,u,r,g===a-1))}const p=l===2?",":"";h[0]="["+(a>0?h[0]+p:"");for(let g=1;g<h.length-1;g++)h[g]=" "+h[g]+p;let f=`,
`;for(let g=2;g<l;g++)f+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":f),h}function Xp(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=J(e),s!=null){const r=s.length;D(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Yt(n,this.size),this.strides=Re(e)}set(e,...n){n.length===0&&(n=[0]),D(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return pi().makeTensor(this.values,this.shape,this.dtype)}}let pi=null,Su=null;function yre(t){pi=t}function xre(t){Su=t}class gt{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=J(e),this.strides=Re(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Su.buffer(this.shape,this.dtype,e)}bufferSync(){return Su.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Tr(this.shape,e,this.dtype==="complex64")}arraySync(){return Tr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=pi().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Ho(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),pi().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=pi().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Ho(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await pi().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),pi().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Su.print(this,e)}clone(){return this.throwIfDisposed(),Su.clone(this)}toString(e=!1){const n=this.dataSync();return mre(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Su.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),pi().makeVariable(this,e,n,s)}}Object.defineProperty(gt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function ee(){return K_("Tensor",()=>gt)}ee();class em extends gt{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Ze(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);pi().disposeTensor(this),this.dataId=e.dataId,pi().incRef(this,null)}dispose(){pi().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(em,Symbol.hasInstance,{value:t=>t instanceof gt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var jS;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(jS||(jS={}));var BS;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(BS||(BS={}));var US;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(US||(US={}));var WS;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(WS||(WS={}));var GS;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(GS||(GS={}));const vre={float32:WS,int32:BS,bool:US,complex64:GS};function Ms(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return vre[t][e]}function Nw(t){return Ms(t,"int32")}function zV(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function jV(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t,e){if(t.dtype===e.dtype)return[t,e];const n=Ms(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function BV(t,e){D(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function bre(t,e){return e.some(n=>n.id===t.id)}function Q_(t){const e=[];return UV(t,e,new Set),e}function UV(t,e,n){if(t==null)return;if(t instanceof gt){e.push(t);return}if(!wre(t))return;const s=t;for(const r in s){const i=s[r];n.has(i)||(n.add(i),UV(i,e,n))}}function wre(t){return Array.isArray(t)||typeof t=="object"}const Ire=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:BV,getTensorsInContainer:Q_,isTensorInList:bre,makeTypesMatch:Ht},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zI(t){return t.kernelName!=null}class MD{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class bd{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new MD}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(yr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new ure(this.backendInstance),!0}setupRegisteredKernels(){s0(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){s0(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof yb)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,i=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,yr(`Initialization of backend ${e} failed`),yr(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return yr(`Initialization of backend ${e} failed`),yr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:i}=this.initializeBackend(s);if(i||r)return{name:s,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,i=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,i,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return bd.nextTensorId++}nextVariableId(){return bd.nextVariableId++}clone(e){const n=V.runKernel(dh,{x:e}),s={x:e},r=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return V.runKernel(Jd,l,c)}}),i=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,i,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(Zf(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let i=0;s.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-i-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=zI(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(zI(e)){const{kernelName:f,inputs:g,attrs:y}=e;this.backendName==null&&this.backend;const x=Zf(f,this.backendName);D(x!=null,()=>`Cannot find registered kernel '${f}' for backend '${this.backendName}'`),a=()=>{const v=this.backend.numDataIds();l=x.kernelFunc({inputs:g,attrs:y,backend:this.backend});const w=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(f,v,w);const I=w.map(N=>N.rank!=null?N:this.makeTensorFromTensorInfo(N));if(r){const N=this.getTensorsForGradient(f,g,I);s=this.saveTensorsForBackwardMode(N)}return I}}else{const{forwardFunc:f}=e,g=y=>{r&&(s=y.map(x=>this.keep(this.clone(x))))};a=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>f(this.backend,g));const x=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,y,x),x}}const{inputs:u,attrs:d}=e,h=zI(e)?null:e.backwardsFunc;let p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(p=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),n=p.outputs)}),r&&this.addTapeNode(c,u,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(f=>u[f]!=null?u[f].shape:null),outputShapes:n.map(f=>f.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=MS(e);if(r!=null){const i=r.inputsToSave||[],o=r.outputsToSave||[];let a;r.saveAllInputs?(D(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=i.map(c=>n[c]);const l=s.filter((c,u)=>o[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let i=e;s==="string"&&ji(e[0])&&(i=e.map(l=>Yi(l)));const o=r.write(i,n,s),a=new gt(n,s,o,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(o),c=bV(i);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const i={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:i}=e,o=new gt(r,i,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const i=new em(e,n,s,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Kf(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof em||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Kf(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,i,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:i},l=MS(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=s[d],p=Wn(h.size,h.dtype);return this.makeTensor(p,h.shape,h.dtype)}return u}),r(c.length>1?c:c[0],i,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=Q_(e),s=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===r.id&&this.track(i)})}gradients(e,n,s,r=!1){if(D(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));D(i instanceof gt,()=>"The result y returned by f() must be a tensor.");const o=pre(this.state.activeTape,n,i);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[i.id]=s??kre(i.shape),fre(a,o,c=>this.tidy(c),Sre);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return D(il(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{D(n.every(a=>a instanceof gt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const i=(a,l)=>(s=e(...n,l),D(s.value instanceof gt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),D(il(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];D(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),D(u.every(h=>h instanceof gt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,p)=>{d[p]=()=>h}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=ys(),s=await this.backend.time(e);return s.wallMs=ys()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new MD;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}bd.nextTensorId=0;bd.nextVariableId=0;function kre(t){const e=vb(J(t),"float32");return V.makeTensor(e,t,"float32")}function WV(){const t=TV();if(t._tfengine==null){const e=new SV(t);t._tfengine=new bd(e)}return Wse(t._tfengine.ENV),yre(()=>t._tfengine),t._tfengine}const V=WV();function Sre(t,e){const n={a:t,b:e};return V.runKernel(tu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tre(){return typeof navigator<"u"&&navigator!=null}let HS;function Nre(t){HS=t}function J_(t){if(HS!==void 0)return HS;if(t||Tre()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Z_(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const _re=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:Z_,isMobile:J_,mockIsMobile:Nre},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vs=X();Vs.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Vs.registerFlag("IS_BROWSER",()=>Z_());Vs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Vs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Vs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Vs.registerFlag("PROD",()=>!1);Vs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Vs.getBool("DEBUG"));Vs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Vs.registerFlag("IS_TEST",()=>!1);Vs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Vs.getBool("DEBUG"));Vs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Vs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Vs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function so(t,e){let n=t;if(Cn(t))return e==="string"?[]:[t.length];if(zV(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(jV(t))return[t.buffer.size/(e==null?4:Kf(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||Cn(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&X().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&GV(t,s,[]),s}function GV(t,e,n){if(n=n||[],!Array.isArray(t)&&!Cn(t)){D(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}D(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),D(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)GV(t[r],s,n.concat(r))}function VD(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function O(t,e,n,s="numeric"){if(t instanceof ee())return VD(s,t.dtype,e,n),t;let r=Zc(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),VD(s,r,e,n),t==null||!Cn(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const i=so(t,r);!Cn(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Il(t,r):no(t,[],!0);return V.makeTensor(a,i,r)}function tm(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((i,o)=>O(i,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eE="__op";function z(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+eE;const r=(...i)=>{V.startScope(n);try{const o=s(...i);return ol(o)&&console.error("Cannot return a Promise inside of tidy."),V.endScope(o),o}catch(o){throw V.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ere(t,e){const n=O(t,"real","complex"),s=O(e,"imag","complex");Gn(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return V.runKernel(Nb,r)}const qo=z({complex_:Ere});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kl(t,e,n,s){if(s==null)s=Zc(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(jV(t)||zV(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return V.backend.createTensorFromGPUData(t,e||n,s)}if(!Cn(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ur(e);const r=J(e),i=J(n);D(r===i,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${i}`);for(let o=0;o<n.length;++o){const a=n[o],l=o===n.length-1?a!==J(e.slice(o)):!0;D(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Cn(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Il(t,s):no(t,[],!0),V.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kr(t,e,n){const s=so(t,n);return kl(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ac={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class $i{static join(e){return new $i(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>Cn(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=n+r.byteLength;this.shards.push({buffer:r,start:n,end:i}),n=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=e+a-c.start,h=a,f=Math.min(n,c.end)-c.start,g=new Uint8Array(c.buffer,d,f-d);if(o.set(g,h),a+=g.length,n<c.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=Cre(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function Cre(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,i=e(t[r]);if(i===0)return r;i<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(){X().set("PROD",!0)}function Are(){X().set("DEBUG",!0)}function Rre(){X().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Dre(t){X().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Pre(){V.disposeVariables()}function ui(){return V}function qS(){return V.memory()}function Ore(t){return V.profile(t)}function K(t,e){return V.tidy(t,e)}function Ye(t){Q_(t).forEach(n=>n.dispose())}function wn(t){return V.keep(t)}function Fre(t){return V.time(t)}function Lre(t){return V.setBackend(t)}function Mre(){return V.ready()}function HV(){return V.backendName}function Vre(t){V.removeBackend(t)}function zre(t){return V.findBackend(t)}function jre(t){return V.findBackendFactory(t)}function tE(t,e,n=1){return V.registerBackend(t,e,n)}function nE(){return V.backend}function Bre(t,e){X().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const al=4;async function KS(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const a=r[o],l=Array.isArray(t)?t[o].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),p=h.reduce((y,x)=>y+x.length,0)+al*h.length,f=new Uint8Array(p);let g=0;for(let y=0;y<h.length;y++){const x=h[y],v=new Uint8Array(new Uint32Array([x.length]).buffer);f.set(v,g),g+=al,f.set(x,g),g+=x.length}d(f)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const i=await Promise.all(s);return{data:Gre(i),specs:n}}function qV(t,e){const n=new $i(t),s={};let r=0;for(const i of e){const o=Ure(i,(a,l)=>n.slice(r+a,r+l));s[i.name]=KV(i,n.slice(r,r+o)),r+=o}return s}function Ure(t,e){const n=J(t.shape);let s;if("quantization"in t){const r=t.quantization;s=Ac[r.dtype]}else if(t.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=al+new Uint32Array(e(r,r+al))[0];return r}else s=Ac[t.dtype];return n*s}async function Wre(t,e){const n=J(t.shape);let s;if("quantization"in t){const r=t.quantization;s=Ac[r.dtype]}else if(t.dtype==="string"){let r=0;for(let i=0;i<n;i++)r+=al+new Uint32Array(await e(r,r+al))[0];return r}else s=Ac[t.dtype];return n*s}function KV(t,e){const n=t.name,s=t.dtype,r=t.shape,i=J(r);let o,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=Ac[l.dtype],u=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];o[d]=h*l.scale+l.min}}else if(l.dtype==="float16")o=Qre()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];o[d]=Math.round(h*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*c}else if(s==="string"){const l=J(t.shape);o=[];for(let c=0;c<l;c++){const u=new Uint32Array(e.slice(a,a+al))[0];a+=al;const d=new Uint8Array(e.slice(a,a+u));o.push(d),a+=u}}else{const l=Ac[s];if(s==="float32")o=new Float32Array(e);else if(s==="int32")o=new Int32Array(e);else if(s==="bool")o=new Uint8Array(e);else if(s==="complex64"){o=new Float32Array(e);const c=new Float32Array(o.length/2),u=new Float32Array(o.length/2);for(let f=0;f<c.length;f++)c[f]=o[f*2],u[f]=o[f*2+1];const d=Kr(c,r,"float32"),h=Kr(u,r,"float32"),p=qo(d,h);return d.dispose(),h.dispose(),p}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=i*l}return Kr(o,r,s)}async function zD(t,e,n){let s=new Uint8Array(e);for(;s.byteLength<n;){const{done:r,value:i}=await t.read();if(r&&i==null){const a=n-s.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(s.length+i.byteLength);o.set(s,0),o.set(new Uint8Array(i),s.length),s=o}return s.buffer}async function XV(t,e){const n={},s=t.getReader();let r=new ArrayBuffer(0);for(const i of e){const o=await Wre(i,async(c,u)=>(r=await zD(s,r,u),r.slice(c,u)));r=await zD(s,r,o);const a=r.slice(0,o);r=r.slice(o);const l=KV(i,a);if(n[i.name]=l,HV()==="webgpu"){const c=nE();"uploadToGPU"in c&&J(l.shape)>=X().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return n}function Gre(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(i=>{s.set(new Uint8Array(i.buffer),r),r+=i.byteLength}),s.buffer}const sE=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function jD(t){return sE?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function Hre(t){if(sE)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function qre(t){if(sE){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function YV(t){return $i.join(t)}function BD(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function QV(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function JV(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function rE(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),JV(t,n,s)}function zg(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:jD(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:jD(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new $i(t.weightData).byteLength}}function XS(t){const e=[];for(const n of t)e.push(...n.weights);return e}function Kre(){const t=n=>{let s=n<<13,r=0;for(;!(s&8388608);)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function Xre(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function Yre(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function Qre(){const t=Kre(),e=Xre(),n=Yre();return s=>{const r=new ArrayBuffer(4*s.length),i=new Uint32Array(r);for(let o=0;o<s.length;o++){const a=s[o],l=t[n[a>>10]+(a&1023)]+e[a>>10];i[o]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Bt.instance==null&&(Bt.instance=new Bt),Bt.instance}static registerSaveRouter(e){Bt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Bt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Bt.getHandlers(e,"save")}static getLoadHandlers(e,n){return Bt.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Bt.getInstance().loadRouters:Bt.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&r.push(a)}),r}}const Jre=t=>Bt.registerSaveRouter(t),Zre=t=>Bt.registerLoadRouter(t),ZV=t=>Bt.getSaveHandlers(t),eie=(t,e)=>Bt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YS="tensorflowjs",QS=1,oc="models_store",Ra="model_info_store";function ez(){if(!X().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function JS(t){const e=t.result;e.createObjectStore(oc,{keyPath:"modelPath"}),e.createObjectStore(Ra,{keyPath:"modelPath"})}class Rc{constructor(e){if(this.indexedDB=ez(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const i=this.indexedDB.open(YS,QS);i.onupgradeneeded=()=>JS(i),i.onsuccess=()=>{const o=i.result;if(n==null){const a=o.transaction(oc,"readonly"),c=a.objectStore(oc).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(o.close(),r(c.error)),a.oncomplete=()=>o.close()}else{n.weightData=$i.join(n.weightData);const a=zg(n),l=o.transaction(Ra,"readwrite");let c=l.objectStore(Ra),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return r(h)}let d;u.onsuccess=()=>{d=o.transaction(oc,"readwrite");const h=d.objectStore(oc);let p;try{p=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(f){return r(f)}p.onsuccess=()=>s({modelArtifactsInfo:a}),p.onerror=f=>{c=l.objectStore(Ra);const g=c.delete(this.modelPath);g.onsuccess=()=>(o.close(),r(p.error)),g.onerror=y=>(o.close(),r(p.error))}},u.onerror=h=>(o.close(),r(u.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>r(i.error)})}}Rc.URL_SCHEME="indexeddb://";const tz=t=>X().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Rc.URL_SCHEME)?tie(t.slice(Rc.URL_SCHEME.length)):null;Bt.registerSaveRouter(tz);Bt.registerLoadRouter(tz);function tie(t){return new Rc(t)}function nie(t){return t.startsWith(Rc.URL_SCHEME)?t.slice(Rc.URL_SCHEME.length):t}class sie{constructor(){this.indexedDB=ez()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(YS,QS);s.onupgradeneeded=()=>JS(s),s.onsuccess=()=>{const r=s.result,i=r.transaction(Ra,"readonly"),a=i.objectStore(Ra).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),i.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=nie(e),new Promise((n,s)=>{const r=this.indexedDB.open(YS,QS);r.onupgradeneeded=()=>JS(r),r.onsuccess=()=>{const i=r.result,o=i.transaction(Ra,"readwrite"),a=o.objectStore(Ra),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return i.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=i.transaction(oc,"readwrite");const p=c.objectStore(oc).delete(e);p.onsuccess=()=>n(l.result.modelArtifactsInfo),p.onerror=f=>s(l.error)};u.onsuccess=d,u.onerror=h=>(d(),i.close(),s(l.error))}},l.onerror=u=>(i.close(),s(l.error)),o.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=i=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const No="/",Tu="tensorflowjs_models",nz="info",rie="model_topology",iie="weight_specs",oie="weight_data",aie="model_metadata";function sz(t){return{info:[Tu,t,nz].join(No),topology:[Tu,t,rie].join(No),weightSpecs:[Tu,t,iie].join(No),weightData:[Tu,t,oie].join(No),modelMetadata:[Tu,t,aie].join(No)}}function rz(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function lie(t){const e=t.split(No);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(No)}function cie(t){return t.startsWith(Dc.URL_SCHEME)?t.slice(Dc.URL_SCHEME.length):t}class Dc{constructor(e){if(!X().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=sz(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=zg(e),i=$i.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,Hre(i));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw rz(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const a=JSON.parse(i);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=qre(o),n}}Dc.URL_SCHEME="localstorage://";const iz=t=>X().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Dc.URL_SCHEME)?uie(t.slice(Dc.URL_SCHEME.length)):null;Bt.registerSaveRouter(iz);Bt.registerLoadRouter(iz);function uie(t){return new Dc(t)}class die{constructor(){D(X().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),D(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Tu+No,s=No+nz;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);if(i.startsWith(n)&&i.endsWith(s)){const o=lie(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=cie(e);const n=sz(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return rz(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qu="://";class xs{constructor(){this.managers={}}static getInstance(){return xs.instance==null&&(xs.instance=new xs),xs.instance}static registerManager(e,n){D(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Qu)&&(e=e.slice(0,e.indexOf(Qu))),D(e.length>0,()=>"scheme must not be an empty string.");const s=xs.getInstance();D(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=xs.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(xs.getInstance().managers)}}function Jx(t){if(t.indexOf(Qu)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${xs.getSchemes().join(",")}`);return{scheme:t.split(Qu)[0],path:t.split(Qu)[1]}}async function oz(t,e,n=!1){D(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=Bt.getLoadHandlers(t);D(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),D(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const r=s[0],i=Bt.getSaveHandlers(e);D(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),D(i.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const o=i[0],a=Jx(t).scheme,l=Jx(t).path,c=a===Jx(t).scheme,u=await r.load();n&&c&&await xs.getManager(a).removeModel(l);const d=await o.save(u);return n&&!c&&await xs.getManager(a).removeModel(l),d.modelArtifactsInfo}async function hie(){const t=xs.getSchemes(),e={};for(const n of t){const s=await xs.getManager(n).listModels();for(const r in s){const i=n+Qu+r;e[i]=s[r]}}return e}async function pie(t){const e=Jx(t);return xs.getManager(e.scheme).removeModel(e.path)}async function fie(t,e){return oz(t,e,!1)}async function mie(t,e){return oz(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gie{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!X().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return CV(e)}}if(X().get("IS_BROWSER")){X().setPlatform("browser",new gie);try{xs.registerManager(Dc.URL_SCHEME,new die)}catch{}try{xs.registerManager(Rc.URL_SCHEME,new sie)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yie={importFetch:()=>require("node-fetch")};let jI;class xie{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return X().global.fetch!=null?X().global.fetch(e,n):(jI==null&&(jI=yie.importFetch()),jI(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}X().get("IS_NODE")&&!X().get("IS_BROWSER")&&X().setPlatform("node",new xie);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(t,e="float32",n){return e=e||"float32",ur(t),new gn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(t,e){const n=O(t,"x","cast");if(!vV(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return V.runKernel(Jd,s,r)}const me=z({cast_:vie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(t){const n={x:O(t,"x","clone","string_or_numeric")};return V.runKernel(dh,n)}const Qi=z({clone_:bie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iE(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */WV();const wie={buffer:qe,cast:me,clone:Qi,print:iE};xre(wie);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iie(t,e){let n=O(t,"a","add"),s=O(e,"b","add");[n,s]=Ht(n,s);const r={a:n,b:s};return V.runKernel(tu,r)}const oe=z({add_:Iie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kie(t,e){let n=O(t,"a","floorDiv"),s=O(e,"b","floorDiv");[n,s]=Ht(n,s);const r={a:n,b:s};return V.runKernel(ch,r)}const _w=z({floorDiv_:kie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(t,e){let n=O(t,"a","div"),s=O(e,"b","div");if([n,s]=Ht(n,s),n.dtype==="int32"&&s.dtype==="int32")return _w(n,s);const r={a:n,b:s},i={};return V.runKernel(sh,r,i)}const Ee=z({div_:Sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tie(t,e){let n=O(t,"a","mul"),s=O(e,"b","mul");[n,s]=Ht(n,s);const r={a:n,b:s};return V.runKernel(bh,r)}const j=z({mul_:Tie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(t){const e=O(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return V.runKernel(Gm,n)}else{const n={x:e};return V.runKernel(Fm,n)}}const pn=z({abs_:Nie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ie(t){const n={x:O(t,"x","acos")};return V.runKernel(Gd,n)}const oE=z({acos_:_ie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(t){const n={x:O(t,"x","acosh")};return V.runKernel(Hd,n)}const aE=z({acosh_:Eie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cie(t){D(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),D(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((r,i)=>O(r,`tensors${i}`,"addN")),n=e[0];e.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!Ze(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return V.runKernel(Lm,s)}const az=z({addN_:Cie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t,e=null,n=!1){const r={x:O(t,"x","all","bool")},i={axis:e,keepDims:n};return V.runKernel(bb,r,i)}const Ew=z({all_:$ie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(t,e=null,n=!1){const r={x:O(t,"x","any","bool")},i={axis:e,keepDims:n};return V.runKernel(wb,r,i)}const nm=z({any_:Aie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(t,e=0){const s={x:O(t,"x","argMax")},r={axis:e};return V.runKernel(Mm,s,r)}const Pc=z({argMax_:Rie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(t,e=0){const s={x:O(t,"x","argMin")},r={axis:e};return V.runKernel(Vm,s,r)}const lE=z({argMin_:Die});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(t){const n={x:O(t,"x","asin")};return V.runKernel(qd,n)}const cE=z({asin_:Pie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oie(t){const n={x:O(t,"x","asinh")};return V.runKernel(Kd,n)}const uE=z({asinh_:Oie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fie(t){const n={x:O(t,"x","atan")};return V.runKernel(Xd,n)}const dE=z({atan_:Fie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lie(t,e){let n=O(t,"a","atan2"),s=O(e,"b","atan2");[n,s]=Ht(n,s);const r={a:n,b:s};return V.runKernel(Qd,r)}const hE=z({atan2_:Lie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mie(t){const n={x:O(t,"x","atanh")};return V.runKernel(Yd,n)}const pE=z({atanh_:Mie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jg(t,e,n,s,r="NHWC",i){const o=t[3],a=[...e,o],l=ia(r);return On(t,a,n,i,s,null,null,l)}function Zr(t,e,n,s,r,i,o="channelsLast"){const[a,l]=sm(e);let c;if(o==="channelsLast")c=[a,l,t[3],t[3]];else if(o==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return On(t,c,n,s,r,i,!1,o)}function ra(t,e,n,s,r,i,o="NDHWC"){const[a,l,c]=ZS(e);let u,d;if(o==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Sl(t,u,n,s,r,!1,d,i)}function On(t,e,n,s,r,i,o=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,p,,f]=e,[g,y]=sm(n),[x,v]=sm(s),w=Ju(h,x),I=Ju(p,v),{padInfo:N,outHeight:A,outWidth:T}=jie(r,c,u,g,y,w,I,i,a),S=o?f*d:f;let E;return a==="channelsFirst"?E=[l,S,A,T]:a==="channelsLast"&&(E=[l,A,T,S]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:A,outWidth:T,outChannels:S,padInfo:N,strideHeight:g,strideWidth:y,filterHeight:h,filterWidth:p,effectiveFilterHeight:w,effectiveFilterWidth:I,dilationHeight:x,dilationWidth:v,inShape:t,outShape:E,filterShape:e}}function Sl(t,e,n,s,r,i=!1,o="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d,h]=t;else if(o==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[p,f,g,,y]=e,[x,v,w]=ZS(n),[I,N,A]=ZS(s),T=Ju(p,I),S=Ju(f,N),E=Ju(g,A),{padInfo:$,outDepth:P,outHeight:F,outWidth:R}=Bie(r,c,u,d,x,v,w,T,S,E,a),G=i?y*h:y;let q;return o==="channelsFirst"?q=[l,G,P,F,R]:o==="channelsLast"&&(q=[l,P,F,R,G]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:P,outHeight:F,outWidth:R,outChannels:G,padInfo:$,strideDepth:x,strideHeight:v,strideWidth:w,filterDepth:p,filterHeight:f,filterWidth:g,effectiveFilterDepth:T,effectiveFilterHeight:S,effectiveFilterWidth:E,dilationDepth:I,dilationHeight:N,dilationWidth:A,inShape:t,outShape:q,filterShape:e}}function Vie(t,e,n,s,r){s==null&&(s=fE(t,e,n));const i=t[0],o=t[1],a=rm((i-e+2*s)/n+1,r),l=rm((o-e+2*s)/n+1,r);return[a,l]}function zie(t,e,n,s,r,i){r==null&&(r=fE(t,e[0],s[0]));const o=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(o[a]=rm((t[a]-e[a]+2*r)/s[a]+1,i));return o}function fE(t,e,n,s=1){const r=Ju(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function sm(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function ZS(t){return typeof t=="number"?[t,t,t]:t}function Ju(t,e){return e<=1?t:t+(t-1)*(e-1)}function jie(t,e,n,s,r,i,o,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const p=Vie([e,n],i,s,t,a);u=p[0],d=p[1]}else if(t==="same"){u=Math.ceil(e/s),d=Math.ceil(n/r);const h=Math.max(0,(u-1)*s+i-e),p=Math.max(0,(d-1)*r+o-n),f=Math.floor(h/2),g=h-f,y=Math.floor(p/2),x=p-y;c={top:f,bottom:g,left:y,right:x,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/s),d=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],p=l==="channelsLast"?t[1][1]:t[2][1],f=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:p,left:f,right:g,type:h===0&&p===0&&f===0&&g===0?"VALID":"EXPLICIT"},u=rm((e-i+h+p)/s+1,a),d=rm((n-o+f+g)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function Bie(t,e,n,s,r,i,o,a,l,c,u){let d,h,p,f;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=zie([e,n,s,1],[a,l,c],1,[r,i,o],t,u);h=y[0],p=y[1],f=y[2]}else if(t==="same"){h=Math.ceil(e/r),p=Math.ceil(n/i),f=Math.ceil(s/o);const g=(h-1)*r+a-e,y=(p-1)*i+l-n,x=(f-1)*o+c-s,v=Math.floor(g/2),w=g-v,I=Math.floor(y/2),N=y-I,A=Math.floor(x/2),T=x-A;d={top:I,bottom:N,left:A,right:T,front:v,back:w,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}function rm(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function ll(t){const[e,n,s]=sm(t);return e===1&&n===1&&s===1}function Hn(t,e){return ll(t)||ll(e)}function Oc(t){return sm(t).every(e=>e>0)}function ia(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Cs(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")D($c(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{D($c(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uie(t,e){const s={x:O(t,"x","reshape","string_or_numeric")},r={shape:e};return V.runKernel(Tg,s,r)}const U=z({reshape_:Uie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wie(t,e,n,s,r){const i=O(t,"x","avgPool","float32"),o=1;D(Hn(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let a=i,l=!1;i.rank===3&&(l=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),D(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Cs("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=V.runKernel(zm,c,u);return d=me(d,i.dtype),l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Bg=z({avgPool_:Wie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(t,e,n,s,r,i="NDHWC"){const o=O(t,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),D(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),D(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),D(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Cs("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i};let d=V.runKernel(jm,c,u);return d=me(d,a.dtype),l?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const mE=z({avgPool3d_:Gie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hie(t,e=0){D(t.length>=1,()=>"Pass at least one tensor to concat");const n=tm(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Qi(n[0]);const s=n,r={axis:e};return V.runKernel(Hm,s,r)}const rn=z({concat_:Hie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qie(t,e,n=!1,s=!1){let r=O(t,"a","matMul"),i=O(e,"b","matMul");[r,i]=Ht(r,i);const o={a:r,b:i},a={transposeA:n,transposeB:s};return V.runKernel(Bm,o,a)}const Xe=z({matMul_:qie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(t){const n={x:O(t,"x","sigmoid","float32")};return V.runKernel(Ah,n)}const bi=z({sigmoid_:Kie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xie(t,e,n){const s=O(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},i={begin:e,size:n};return V.runKernel($g,r,i)}const et=z({slice_:Xie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yie(t){const n={x:O(t,"x","tanh","float32")};return V.runKernel(Lh,n)}const cl=z({tanh_:Yie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qie(t,e,n,s,r,i){const o=O(t,"forgetBias","basicLSTMCell"),a=O(e,"lstmKernel","basicLSTMCell"),l=O(n,"lstmBias","basicLSTMCell"),c=O(s,"data","basicLSTMCell"),u=O(r,"c","basicLSTMCell"),d=O(i,"h","basicLSTMCell"),h=rn([c,d],1),p=Xe(h,a),f=oe(p,l),g=f.shape[0],y=f.shape[1]/4,x=[g,y],v=et(f,[0,0],x),w=et(f,[0,y],x),I=et(f,[0,y*2],x),N=et(f,[0,y*3],x),A=oe(j(bi(v),cl(w)),j(u,bi(oe(o,I)))),T=j(cl(A),bi(N));return[A,T]}const lz=z({basicLSTMCell_:Qie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jie(t,e,n){const s=O(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);D(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),D(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),D(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const i={x:s},o={blockShape:e,crops:n};return V.runKernel(Um,i,o)}const Ug=z({batchToSpaceND_:Jie});function Zie(t){let e;return t.rank===0||t.rank===1?e=U(t,[1,1,1,t.size]):t.rank===2?e=U(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eoe(t,e,n,s,r,i){i==null&&(i=.001);const o=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let c;r!=null&&(c=O(r,"scale","batchNorm"));let u;s!=null&&(u=O(s,"offset","batchNorm")),D(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:Zie(o),scale:c,offset:u,mean:a,variance:l},p={varianceEpsilon:i},f=V.runKernel(tg,h,p);return U(f,o.shape)}const zh=z({batchNorm_:eoe});function toe(t,e,n,s,r,i){const o=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let c;r!=null&&(c=O(r,"scale","batchNorm"));let u;return s!=null&&(u=O(s,"offset","batchNorm")),D(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),D(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),D(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),zh(o,a,l,u,c,i)}const gE=z({batchNorm2d_:toe});function noe(t,e,n,s,r,i){const o=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let c;r!=null&&(c=O(r,"scale","batchNorm"));let u;return s!=null&&(u=O(s,"offset","batchNorm")),D(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),D(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),D(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),zh(o,a,l,u,c,i)}const yE=z({batchNorm3d_:noe});function soe(t,e,n,s,r,i){const o=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let c;r!=null&&(c=O(r,"scale","batchNorm"));let u;return s!=null&&(u=O(s,"offset","batchNorm")),D(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),D(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),D(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&D(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&D(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),zh(o,a,l,u,c,i)}const xE=z({batchNorm4d_:soe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(t,e,n){const s=O(t,"x","bincount"),r=O(e,"weights","bincount");D(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const i={x:s,weights:r},o={size:n};return V.runKernel(Sb,i,o)}const vE=z({bincount_:roe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(t,e){const n=O(t,"x","bitwiseAnd"),s=O(e,"y","bitwiseAnd");if(!Ze(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return V.runKernel(Wm,r)}const cz=z({bitwiseAnd_:ioe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ooe(t,e){const n=O(t,"s0","broadcastArgs","int32"),s=O(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return V.runKernel(Tb,r)}const uz=z({broadcastArgs_:ooe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(t,e){let n=O(t,"broadcastTo","x");const s=n.shape;if(ur(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=U(n,c)}const r=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])i[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(i.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Qi(n);const a={x:n},l={reps:i};return V.runKernel(Mh,a,l)}const mc=z({broadcastTo_:aoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t){const n={x:O(t,"x","ceil","float32")};return V.runKernel(Zd,n)}const bE=z({ceil_:loe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function su(t,e,n){ur(t),n=n||Zc(e);const s={shape:t,value:e,dtype:n};return V.runKernel(jb,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(t,e,n){const s=O(t,"x","clipByValue");if(D(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return su(s.shape,e,s.dtype);const r={x:s},i={clipValueMin:e,clipValueMax:n};return V.runKernel(eh,r,i)}const zs=z({clipByValue_:coe});function uoe(t){return rn(t,0)}const wE=z({concat1d_:uoe});function doe(t,e){return rn(t,e)}const IE=z({concat2d_:doe});function hoe(t,e){return rn(t,e)}const kE=z({concat3d_:hoe});function poe(t,e){return rn(t,e)}const SE=z({concat4d_:poe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe(t,e,n,s,r="NHWC",i=[1,1],o){const a=O(t,"x","conv2d","float32"),l=O(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Cs("conv2d",s,o);const d=r==="NHWC"?c.shape[3]:c.shape[1];D(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),D(Hn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),D(Oc(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),D(Oc(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},p={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},f=V.runKernel(qm,h,p);return u?U(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Ko=z({conv2d_:foe});function moe(t,e,n,s,r="NWC",i=1,o){const a=O(t,"x","conv1d"),l=O(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1]])),D(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),D(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Cs("conv1d",s,o),D(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),D(Hn(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),D(Oc(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),D(Oc(n),()=>"Error in conv1D: Stride should be larger than 0."),D(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=U(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=U(c,[c.shape[0],1,c.shape[1],c.shape[2]]),y=Ko(h,d,[1,n],s,"NHWC",[1,i],o);return u?U(y,[y.shape[2],y.shape[3]]):U(y,[y.shape[0],y.shape[2],y.shape[3]])}const Cw=z({conv1d_:moe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function goe(t,e,n,s,r,i="NHWC",o){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),D(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),D(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),D(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=i==="NHWC"?a[3]:a[1],d=i==="NHWC"?l.shape[3]:l.shape[1];D(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),D(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Cs("conv2dDerInput",r,o);const h={dy:l,filter:n},p={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,inputShape:a},f=V.runKernel(Km,h,p);return c?U(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const TE=z({conv2DBackpropInput_:goe});function yoe(t,e,n,s,r,i){const o=O(t,"x","conv2dTranspose"),a=O(e,"filter","conv2dTranspose");return TE(n,o,a,s,r,"NHWC",i)}const $w=z({conv2dTranspose_:yoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(t,e,n,s,r="NDHWC",i=[1,1,1]){const o=O(t,"x","conv3d"),a=O(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),D(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),D(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),D(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),D(Hn(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),D(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),D(Oc(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),D(Oc(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:i},h=V.runKernel(Xm,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const NE=z({conv3d_:xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function voe(t,e,n,s,r){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,a=!1;e.rank===4&&(a=!0,o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],c=o.shape[4];D(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),D(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),D(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),D(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),D(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:o,filter:n},d={pad:r,strides:s,inputShape:i},h=V.runKernel(Cb,u,d);return a?U(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const dz=z({conv3DBackpropInput_:voe});function boe(t,e,n,s,r){const i=O(t,"x","conv3dTranspose"),o=O(e,"filter","conv3dTranspose");return dz(n,i,o,s,r)}const _E=z({conv3dTranspose_:boe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(t){const n={x:O(t,"x","cos","float32")};return V.runKernel(th,n)}const Wg=z({cos_:woe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ioe(t){const n={x:O(t,"x","cosh","float32")};return V.runKernel(nh,n)}const Aw=z({cosh_:Ioe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(t,e=0,n=!1,s=!1){const i={x:O(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return V.runKernel($b,i,o)}const im=z({cumprod_:koe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(t,e=0,n=!1,s=!1){const i={x:O(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return V.runKernel(Ym,i,o)}const Rw=z({cumsum_:Soe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t,e,n,s=!1){const r=O(t,"x","denseBincount"),i=O(e,"weights","denseBincount");D(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),D(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(i.size===r.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${i.shape}.`);const o={x:r,weights:i},a={size:n,binaryOutput:s};return V.runKernel(Rb,o,a)}const i0=z({denseBincount_:Toe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Noe(t,e,n="NHWC"){const s=O(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],i=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];D(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),D(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),D(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${s.shape}`),D(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return V.runKernel(Db,a,l)}const EE=z({depthToSpace_:Noe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _oe(t,e,n,s,r="NHWC",i=[1,1],o){const a=O(t,"x","depthwiseConv2d","float32"),l=O(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];D(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Cs("depthwiseConv2d",s,o);const h={x:c,filter:l},p={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o},f=V.runKernel(Qm,h,p);return u?U(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const jh=z({depthwiseConv2d_:_oe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t){const n={x:O(t,"x","diag")};return V.runKernel(Fb,n)}const hz=z({diag_:Eoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Coe(t,e,n,s,r=[1,1],i="NHWC"){const o=O(t,"x","dilation2d"),a=O(e,"filter","dilation2d");D(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),D(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),D(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,c=!1;o.rank===3&&(l=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),D(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=V.runKernel(Jm,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const CE=z({dilation2d_:Coe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fc(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const i=n-1-r,o=t[i]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(i)}return s}function yn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],i=e.length-s-1,o=e[i];(r==null||r===1&&o>1)&&n.unshift(i)}return n}function Ue(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let i=t[t.length-r-1];i==null&&(i=1);let o=e[e.length-r-1];if(o==null&&(o=1),i===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=i;else if(i!==o){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=i}return s}const $oe=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Ue,getBroadcastDims:Fc,getReductionAxes:yn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aoe(t,e){let n=O(t,"a","equal","string_or_numeric"),s=O(e,"b","equal","string_or_numeric");[n,s]=Ht(n,s),Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(Zm,r)}const Jr=z({equal_:Aoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Roe(t,e,n){const s=O(e,"a","where"),r=O(n,"b","where"),i=O(t,"condition","where","bool"),o=Ue(Ue(i.shape,s.shape),r.shape),a=mc(i,o),l=mc(s,o),c=mc(r,o),u={condition:a,t:l,e:c};return V.runKernel(Cg,u)}const Un=z({where_:Roe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(t){const n={x:O(t,"x","zerosLike")};return V.runKernel(Mg,n)}const nt=z({zerosLike_:Doe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(t,e){let n=O(t,"a","div"),s=O(e,"b","div");[n,s]=Ht(n,s);const r=Ee(n,s),i=nt(r),o=Jr(s,i);return Un(o,i,r)}const $E=z({divNoNan_:Poe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ooe(t,e){const n=O(t,"t1","dot"),s=O(e,"t2","dot");D((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],i=s.rank===1?s.size:s.shape[0];if(D(r===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${i}.`),n.rank===1&&s.rank===1){const o=U(n,[1,-1]),a=U(s,[-1,1]),l=Xe(o,a);return U(l,[])}else if(n.rank===1&&s.rank===2){const o=U(n,[1,-1]),a=U(s,[s.shape[0],s.shape[1]]),l=Xe(o,a);return U(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=U(s,[-1,1]),a=Xe(n,o);return U(a,[a.size])}else{const o=U(s,[s.shape[0],s.shape[1]]);return Xe(n,o)}}const AE=z({dot_:Ooe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Foe(t,...e){const n=e.map((r,i)=>O(r,`tensors${i}`,"einsum")),s={equation:t};return V.runKernel(Mb,n,s)}const Kl=z({einsum_:Foe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Loe(t){const n={x:O(t,"x","elu","float32")};return V.runKernel(rh,n)}const Bh=z({elu_:Loe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Moe(t,e){const n=O(t,"x","ensureShape","string_or_numeric");if(!yV(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const pz=z({ensureShape_:Moe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Voe(t){let e=O(t,"x","erf");D(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=me(e,"float32"));const n={x:e};return V.runKernel(ih,n)}const Dw=z({erf_:Voe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RE(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function fz(t,e,n){const s=t.length+e.length,r=[];let i=0,o=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[i++]):r.push(e[o++]);return r}function Fn(t,e){const n=[],s=t.length;for(let i=0;i<s;i++)e.indexOf(i)===-1&&n.push(t[i]);const r=e.map(i=>t[i]);return[n,r]}function an(t,e){const n=e.map(s=>1);return fz(t,n,e)}function qn(t,e,n){D(RE(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function qt(t,e){if(RE(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function Tl(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function cn(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zoe(t,e=null,n=!1){const r={x:O(t,"x","max")},i={reductionIndices:e,keepDims:n};return V.runKernel(dg,r,i)}const Nr=z({max_:zoe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function joe(t,e=null,n=!1){const r={x:O(t,"x","min")},i={axis:e,keepDims:n};return V.runKernel(mg,r,i)}const wd=z({min_:joe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(t,e){let n=O(t,"base","pow"),s=O(e,"exp","pow");[n,s]=Ht(n,s);const r={a:n,b:s};return V.runKernel(wh,r)}const ro=z({pow_:Boe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pe(t,e){if((Cn(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Cn(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return kl(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t){const n={x:O(t,"x","sqrt","float32")};return V.runKernel(Dh,n)}const Pn=z({sqrt_:Uoe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Woe(t){const e=O(t,"x","square"),n={};return V.runKernel("Square",{x:e},n)}const wt=z({square_:Woe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(t,e=null,n=!1){let s=O(t,"x","sum");s.dtype==="bool"&&(s=me(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return V.runKernel(Ag,r,i)}const Te=z({sum_:Goe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hoe(t,e="euclidean",n=null,s=!1){t=O(t,"x","norm");const r=mz(t,e,n);let i=r.shape;if(s){const o=Qe(n,t.shape);i=an(r.shape,o)}return U(r,i)}function mz(t,e,n=null){if(t.rank===0)return pn(t);if(t.rank!==1&&n===null)return mz(U(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Te(pn(t),n);if(e===1/0)return Nr(pn(t),n);if(e===-1/0)return wd(pn(t),n);if(e==="euclidean"||e===2)return Pn(Te(ro(pn(t),Pe(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Nr(Te(pn(t),n[0]),n[1]-1);if(e===1/0)return Nr(Te(pn(t),n[1]),n[0]);if(e===-1/0)return wd(Te(pn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Pn(Te(wt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Uh=z({norm_:Hoe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qoe(t,e=null,n=!1){return Uh(t,"euclidean",e,n)}const DE=z({euclideanNorm_:qoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Koe(t){const n={x:O(t,"x","exp")};return V.runKernel(oh,n)}const js=z({exp_:Koe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(t,e=0){const n=O(t,"x","expandDims","string_or_numeric");D(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return V.runKernel(eg,s,r)}const ns=z({expandDims_:Xoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yoe(t){const n={x:O(t,"x","expm1")};return V.runKernel(ah,n)}const PE=z({expm1_:Yoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(t,e){const n=O(t,"x","tile","string_or_numeric");D(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return V.runKernel(Mh,s,r)}const Ir=z({tile_:Qoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Joe(t,e,n,s="float32"){e==null&&(e=t);const r=qe([t,e],s),i=t<=e?t:e;for(let a=0;a<i;++a)r.set(1,a,a);const o=U(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Ir(ns(o,0),[n[0],1,1]);if(n.length===2)return Ir(ns(ns(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ir(ns(ns(ns(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Pw=z({eye_:Joe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(t){const n={x:O(t,"x","floor","float32")};return V.runKernel(lh,n)}const Wh=z({floor_:Zoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eae(t,e,n=0,s=0){const r=O(t,"x","gather"),i=O(e,"indices","gather","int32"),o={x:r,indices:i},a={axis:n,batchDims:s};return V.runKernel(ng,o,a)}const Gh=z({gather_:eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tae(t,e){let n=O(t,"a","greater","string_or_numeric"),s=O(e,"b","greater","string_or_numeric");[n,s]=Ht(n,s),Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(sg,r)}const Hs=z({greater_:tae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nae(t,e){let n=O(t,"a","greaterEqual","string_or_numeric"),s=O(e,"b","greaterEqual","string_or_numeric");[n,s]=Ht(n,s),Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(uh,r)}const oa=z({greaterEqual_:nae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sae(t){const n={input:O(t,"input","imag")};return V.runKernel(Gb,n)}const Gg=z({imag_:sae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rae(t){const n={x:O(t,"x","isFinite")};return V.runKernel(hh,n)}const OE=z({isFinite_:rae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iae(t){const n={x:O(t,"x","isInf")};return V.runKernel(ph,n)}const FE=z({isInf_:iae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oae(t){const n={x:O(t,"x","isNaN")};return V.runKernel(fh,n)}const LE=z({isNaN_:oae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aae(t,e=.2){const s={x:O(t,"x","leakyRelu")},r={alpha:e};return V.runKernel(rg,s,r)}const Hg=z({leakyRelu_:aae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lae(t,e){let n=O(t,"a","less","string_or_numeric"),s=O(e,"b","less","string_or_numeric");[n,s]=Ht(n,s),Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(ig,r)}const Id=z({less_:lae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cae(t,e){let n=O(t,"a","lessEqual","string_or_numeric"),s=O(e,"b","lessEqual","string_or_numeric");[n,s]=Ht(n,s),Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(og,r)}const Nl=z({lessEqual_:cae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return V.runKernel(Hb,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uae(t,e=5,n=1,s=1,r=.5){const i=O(t,"x","localResponseNormalization");D(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),D($c(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,a=!1;i.rank===3&&(a=!0,o=U(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},c={depthRadius:e,bias:n,alpha:s,beta:r},u=V.runKernel(ug,l,c);return a?U(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const ME=z({localResponseNormalization_:uae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dae(t){const n={x:O(t,"x","log","float32")};return V.runKernel(mh,n)}const or=z({log_:dae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hae(t){const n={x:O(t,"x","log1p")};return V.runKernel(gh,n)}const qg=z({log1p_:hae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pae(t){return D(il(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const s=O(e,"x","tf.grad","string_or_numeric"),r=n!=null?O(n,"dy","tf.grad"):null;return V.tidy(()=>{const{value:i,grads:o}=V.gradients(()=>t(s),[s],r);return r!=null&&Gn(i.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Ow(o),o[0]})}}function fae(t){return D(il(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{D(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=tm(e,"args","tf.grads","string_or_numeric"),r=n!=null?O(n,"dy","tf.grads"):null;return V.tidy(()=>{const{value:i,grads:o}=V.gradients(()=>t(...s),s,r);return r!=null&&Gn(i.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Ow(o),o})}}function mae(t){return D(il(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{D(e instanceof gt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),D(n==null||n instanceof gt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=V.gradients(()=>t(e),[e],n);return Ow(s),{grad:s[0],value:r}}}function gae(t){return D(il(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{D(Array.isArray(e)&&e.every(r=>r instanceof gt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),D(n==null||n instanceof gt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=V.gradients(()=>t(...e),e,n);return n!=null&&Gn(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Ow(s.grads),s}}function yz(t,e){D(il(t),()=>"The f passed in variableGrads(f) must be a function"),D(e==null||Array.isArray(e)&&e.every(c=>c instanceof em),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in V.registeredVariables)e.push(V.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),D(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const i=!0,{value:o,grads:a}=V.gradients(t,e,null,i);D(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),D(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function io(t){return V.customGrad(t)}function Ow(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yae(t){const n={x:O(t,"x","neg")};return V.runKernel(yg,n)}const At=z({neg_:yae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xae(t){const n={x:O(t,"x","softplus")};return V.runKernel(Rh,n)}const ru=z({softplus_:xae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vae(t){const e=O(t,"x","logSigmoid");return io(s=>({value:At(ru(At(s))),gradFunc:o=>j(o,bi(At(s)))}))(e)}const VE=z({logSigmoid_:vae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bae(t,e){let n=O(t,"a","sub"),s=O(e,"b","sub");[n,s]=Ht(n,s);const r={a:n,b:s};return V.runKernel(Oh,r)}const Ie=z({sub_:bae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wae(t,e=-1){const n=O(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return io((r,i)=>{const a=Nr(r,e,!0),l=Ie(r,a),c=Ie(me(l,"float32"),or(Te(js(l),e,!0)));return i([c]),{value:c,gradFunc:(d,h)=>{const[p]=h,f=!0,g=js(p);return Ie(d,j(Te(d,e,f),g))}}})(n)}const Fw=z({logSoftmax_:wae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iae(t,e=null,n=!1){const s=O(t,"x","logSumExp"),r=Qe(e,s.shape),i=Nr(s,r,!0),o=Ie(s,i),a=js(o),l=Te(a,r),c=or(l),u=oe(U(i,c.shape),c);if(n){const d=an(u.shape,r);return U(u,d)}return u}const Kg=z({logSumExp_:Iae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kae(t,e){const n=O(t,"a","logicalAnd","bool"),s=O(e,"b","logicalAnd","bool");Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(ag,r)}const Si=z({logicalAnd_:kae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(t){const n={x:O(t,"x","logicalNot","bool")};return V.runKernel(lg,n)}const Xg=z({logicalNot_:Sae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tae(t,e){const n=O(t,"a","logicalOr","bool"),s=O(e,"b","logicalOr","bool");Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(cg,r)}const Lw=z({logicalOr_:Tae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nae(t,e){const n=O(t,"a","logicalXor","bool"),s=O(e,"b","logicalXor","bool");return Ue(n.shape,s.shape),Si(Lw(t,e),Xg(Si(t,e)))}const zE=z({logicalXor_:Nae});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const px=2147483648;function _ae(t,e,n="left"){const s=O(t,"sortedSequence","searchSorted"),r=O(e,"values","searchSorted"),i=s.shape[s.shape.length-1],o=r.shape[r.shape.length-1],a=U(s,[-1,i]),l=U(r,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(J(l.shape)>=px)throw new Error(`values tensor size must less than ${px}`);if(a.shape[1]>=px)throw new Error(`trailing dim_size must less than ${px} for int32 output type, was ${a.shape[1]}`);const c={sortedSequence:a,values:l},u={side:n};return V.runKernel(uw,c,u)}const Mw=z({searchSorted_:_ae});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(t,e){return Mw(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eae(t,e,n,s,r){const i=O(t,"x","maxPool"),o=1;let a=i,l=!1;i.rank===3&&(l=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),D(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),D(Hn(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Cs("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=V.runKernel(hg,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Yg=z({maxPool_:Eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cae(t,e=[1,1,1],n,s,r,i="NDHWC"){const o=O(t,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),D(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),D(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Cs("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:i},d=V.runKernel(pg,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const jE=z({maxPool3d_:Cae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae(t,e,n,s,r=!1){const o={x:O(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:s,includeBatchInIndex:r},l=V.runKernel(Yb,o,a);return{result:l[0],indexes:l[1]}}const vz=z({maxPoolWithArgmax_:$ae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aae(t,e){let n=O(t,"a","maximum"),s=O(e,"b","maximum");[n,s]=Ht(n,s),n.dtype==="bool"&&(n=me(n,"int32"),s=me(s,"int32")),Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(yh,r)}const ho=z({maximum_:Aae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rae(t,e=null,n=!1){const r={x:O(t,"x","mean")},i={axis:e,keepDims:n};return V.runKernel(fg,r,i)}const Wt=z({mean_:Rae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sn(t,e="float32"){if(ur(t),e==="complex64"){const s=sn(t,"float32"),r=sn(t,"float32");return qo(s,r)}const n=Wn(J(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Os(t,e="float32"){if(ur(t),e==="complex64"){const s=Os(t,"float32"),r=sn(t,"float32");return qo(s,r)}const n=vb(J(t),e);return V.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=O(t,"x","meshgrid",t instanceof gt?t.dtype:"float32");if(e===void 0)return[s];let r=O(e,"y","meshgrid",e instanceof gt?e.dtype:"float32");const i=J(s.shape),o=J(r.shape);return n==="xy"?(s=U(s,[1,-1]),r=U(r,[-1,1]),[Xe(Os([o,1],s.dtype),s),Xe(r,Os([1,i],r.dtype))]):(s=U(s,[-1,1]),r=U(r,[1,-1]),[Xe(s,Os([1,o],s.dtype)),Xe(Os([i,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(t,e){let n=O(t,"a","minimum"),s=O(e,"b","minimum");[n,s]=Ht(n,s),n.dtype==="bool"&&(n=me(n,"int32"),s=me(s,"int32")),Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(xh,r)}const ul=z({minimum_:Dae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pae(t,e,n){D(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=O(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");D(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)D(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),D(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const i={paddings:e,mode:n},o={x:s};return V.runKernel(gg,o,i)}const BE=z({mirrorPad_:Pae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oae(t,e){let n=O(t,"a","mod"),s=O(e,"b","mod");[n,s]=Ht(n,s);const r={a:n,b:s};return V.runKernel(vh,r)}const UE=z({mod_:Oae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fae(t,e=null,n=!1){t=O(t,"x","moments");const s=Qe(e,t.shape),r=Wt(t,s,n);let i=r.shape;n||(i=an(r.shape,s));const o=wt(Ie(me(t,"float32"),U(r,i))),a=Wt(o,s,n);return{mean:r,variance:a}}const Qg=z({moments_:Fae});function Lae(t,e,n,s){const r=O(e,"data","multiRNNCell"),i=tm(n,"c","multiRNNCell"),o=tm(s,"h","multiRNNCell");let a=r;const l=[];for(let d=0;d<t.length;d++){const h=t[d](a,i[d],o[d]);l.push(h[0]),l.push(h[1]),a=h[1]}const c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}const wz=z({multiRNNCell_:Lae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(t,e,n,s=!1){const r=O(t,"logits","multinomial"),i=r.size,o=r.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?U(r,[1,-1]):r},c={numSamples:e,seed:n,normalized:s},u=V.runKernel(Qb,l,c);return o===1?U(u,[u.size]):u}const Iz=z({multinomial_:Mae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vae(t,e){let n=O(t,"a","notEqual","string_or_numeric"),s=O(e,"b","notEqual","string_or_numeric");[n,s]=Ht(n,s),Ue(n.shape,s.shape);const r={a:n,b:s};return V.runKernel(xg,r)}const Lc=z({notEqual_:Vae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zae(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:O(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return V.runKernel(bg,o,a)}const kd=z({oneHot_:zae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(t){const n={x:O(t,"x","onesLike")};return V.runKernel(vg,n)}const ar=z({onesLike_:jae});function Bae(t,e){const n=O(t,"v1","outerProduct"),s=O(e,"v2","outerProduct");D(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=U(n,[-1,1]),i=U(s,[1,-1]);return Xe(r,i)}const kz=z({outerProduct_:Bae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uae(t,e,n=0){const s=O(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},i={x:s};return V.runKernel(Ig,i,r)}const aa=z({pad_:Uae});function Wae(t,e,n=0){return D(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),aa(t,[e],n)}const Sz=z({pad1d_:Wae});function Gae(t,e,n=0){return D(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),aa(t,e,n)}const Tz=z({pad2d_:Gae});function Hae(t,e,n=0){return D(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),aa(t,e,n)}const Nz=z({pad3d_:Hae});function qae(t,e,n=0){return D(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),aa(t,e,n)}const _z=z({pad4d_:qae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kae(t,e,n){const s=O(t,"x","spaceToBatchND");D(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),D(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),D(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},i={blockShape:e,paddings:n};return V.runKernel(Rg,r,i)}const Jg=z({spaceToBatchND_:Kae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xae(t,e,n,s,r,i,o){r==null&&(r=[1,1]),i==null&&(i=1),s===0&&(s="valid");const a=O(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(Hn(i,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`);const u=Zr(l.shape,e,i,r,s),d=[u.dilationHeight,u.dilationWidth];let h;s==="same"?h=Qae([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const p=d[0]===1&&d[1]===1,[f,g]=Yae([u.inHeight,u.inWidth],d,h),y=p?s:"valid",x=p?l:Jg(l,d,f),w=(n==="avg"?()=>Bg(x,e,i,y,o):()=>Yg(x,e,i,y,o))(),I=p?w:Ug(w,d,g);return c?U(I,[I.shape[1],I.shape[2],I.shape[3]]):I}function Yae(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),i=t.concat(s,r),o=e.map((u,d)=>(u-i[d]%u)%u),a=r.map((u,d)=>u+o[d]),l=e.map((u,d)=>[s[d],a[d]]),c=e.map((u,d)=>[0,o[d]]);return[l,c]}function Qae(t,e){const s=t.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),i=s.map((o,a)=>o-r[a]);return s.map((o,a)=>[r[a],i[a]])}const WE=z({pool_:Xae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jae(t,e){const n=O(t,"x","prelu"),s=O(e,"alpha","prelu"),r={x:n,alpha:s};return V.runKernel(kg,r)}const Zg=z({prelu_:Jae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zae(t,e=null,n=!1){let s=O(t,"x","prod");s.dtype==="bool"&&(s=me(s,"int32"));const r={x:s},i={axis:e,keepDims:n};return V.runKernel(Sg,r,i)}const GE=z({prod_:Zae});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ele(t,e,n,s){const r=t.map((u,d)=>O(u,`tensors${d}`,"raggedGather","int32")),i=O(e,"paramsDenseValues","raggedGather"),o=O(n,"indices","raggedGather","int32"),a={paramsNestedSplits:r,paramsDenseValues:i,indices:o},l={outputRaggedRank:s},c=V.runKernel(tw,a,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const Ez=z({raggedGather_:ele});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tle(t,e,n){const s=O(t,"starts","raggedRange"),r=O(e,"limits","raggedRange",s.dtype),i=O(n,"deltas","raggedRange",s.dtype),o={starts:s,limits:r,deltas:i},a=V.runKernel(nw,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const Cz=z({raggedRange_:tle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nle(t,e,n,s,r){const i=O(t,"shape","raggedTensorToTensor","int32"),o=O(e,"values","raggedTensorToTensor"),a=O(n,"defaultValue","raggedTensorToTensor",o.dtype),l=s.map((d,h)=>O(d,`tensors${h}`,"raggedTensorToTensor","int32")),c={shape:i,values:o,defaultValue:a,rowPartitionTensors:l},u={rowPartitionTypes:r};return V.runKernel(sw,c,u)}const $z=z({raggedTensorToTensor_:nle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sle(t,e,n){ur(t);const s=J(t);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<s;i++)r[i]=e();return V.makeTensor(r,t,n)}const Az=z({rand_:sle});var HE={exports:{}};HE.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function i(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var u=new r(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&i(d,u),h.state=function(){return i(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(Gc,t)})(HE);var rle=HE.exports,qE={exports:{}};qE.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,p=(c.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(Gc,t)})(qE);var ile=qE.exports,KE={exports:{}};KE.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,p=(c.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(Gc,t)})(KE);var ole=KE.exports,XE={exports:{}};XE.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,p;return h=u[d],h^=h>>>7,p=h^h<<24,h=u[d+1&7],p^=h^h>>>10,h=u[d+3&7],p^=h^h>>>3,h=u[d+4&7],p^=h^h<<7,h=u[d+7&7],h=h^h<<13,p^=h^h<<9,u[d]=p,l.i=d+1&7,p};function c(u,d){var h,p=[];if(d===(d|0))p[0]=d;else for(d=""+d,h=0;h<d.length;++h)p[h&7]=p[h&7]<<15^d.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],u.x=p,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function i(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,p=(c.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=c.next,d.quick=d,u&&(u.x&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(Gc,t)})(XE);var ale=XE.exports,YE={exports:{}};YE.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,p,f;return l.w=u=u+1640531527|0,f=d[h+34&127],p=d[h=h+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,f=d[h]=f^p,l.i=h,f+(u^u>>>16)|0};function c(u,d){var h,p,f,g,y,x=[],v=128;for(d===(d|0)?(p=d,d=null):(d=d+"\0",p=0,v=Math.max(v,d.length)),f=0,g=-32;g<v;++g)d&&(p^=d.charCodeAt((g+32)%d.length)),g===0&&(y=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,g>=0&&(y=y+1640531527|0,h=x[g&127]^=p+y,f=h==0?f+1:0);for(f>=128&&(x[(d&&d.length||0)&127]=-1),f=127,g=4*128;g>0;--g)p=x[f+34&127],h=x[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,x[f]=p^h;u.w=y,u.X=x,u.i=f}c(l,a)}function i(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,p=(c.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=c.next,d.quick=d,u&&(u.X&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(Gc,t)})(YE);var lle=YE.exports,QE={exports:{}};QE.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,p=l.d,f=l.a;return d=d<<25^d>>>7^h,h=h-p|0,p=p<<24^p>>>8^f,f=f-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-p|0,l.d=p<<16^h>>>16^f,l.a=f-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function i(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,p=(c.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&i(u,c),d.state=function(){return i(c,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(Gc,t)})(QE);var cle=QE.exports,Rz={exports:{}};const ule={},dle=Object.freeze(Object.defineProperty({__proto__:null,default:ule},Symbol.toStringTag,{value:"Module"})),hle=X5(dle);(function(t){(function(e,n,s){var r=256,i=6,o=52,a="random",l=s.pow(r,i),c=s.pow(2,o),u=c*2,d=r-1,h;function p(I,N,A){var T=[];N=N==!0?{entropy:!0}:N||{};var S=x(y(N.entropy?[I,w(n)]:I??v(),3),T),E=new f(T),$=function(){for(var P=E.g(i),F=l,R=0;P<c;)P=(P+R)*r,F*=r,R=E.g(1);for(;P>=u;)P/=2,F/=2,R>>>=1;return(P+R)/F};return $.int32=function(){return E.g(4)|0},$.quick=function(){return E.g(4)/4294967296},$.double=$,x(w(E.S),n),(N.pass||A||function(P,F,R,G){return G&&(G.S&&g(G,E),P.state=function(){return g(E,{})}),R?(s[a]=P,F):P})($,S,"global"in N?N.global:this==s,N.state)}function f(I){var N,A=I.length,T=this,S=0,E=T.i=T.j=0,$=T.S=[];for(A||(I=[A++]);S<r;)$[S]=S++;for(S=0;S<r;S++)$[S]=$[E=d&E+I[S%A]+(N=$[S])],$[E]=N;(T.g=function(P){for(var F,R=0,G=T.i,q=T.j,Q=T.S;P--;)F=Q[G=d&G+1],R=R*r+Q[d&(Q[G]=Q[q=d&q+F])+(Q[q]=F)];return T.i=G,T.j=q,R})(r)}function g(I,N){return N.i=I.i,N.j=I.j,N.S=I.S.slice(),N}function y(I,N){var A=[],T=typeof I,S;if(N&&T=="object")for(S in I)try{A.push(y(I[S],N-1))}catch{}return A.length?A:T=="string"?I:I+"\0"}function x(I,N){for(var A=I+"",T,S=0;S<A.length;)N[d&S]=d&(T^=N[d&S]*19)+A.charCodeAt(S++);return w(N)}function v(){try{var I;return h&&(I=h.randomBytes)?I=I(r):(I=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(I)),w(I)}catch{var N=e.navigator,A=N&&N.plugins;return[+new Date,e,A,e.screen,w(n)]}}function w(I){return String.fromCharCode.apply(0,I)}if(x(s.random(),n),t.exports){t.exports=p;try{h=hle}catch{}}else s["seed"+a]=p})(typeof self<"u"?self:Gc,[],Math)})(Rz);var ple=Rz.exports,fle=rle,mle=ile,gle=ole,yle=ale,xle=lle,vle=cle,iu=ple;iu.alea=fle;iu.xor128=mle;iu.xorwow=gle;iu.xorshift7=yle;iu.xor4096=xle;iu.tychei=vle;var Vw=iu;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ble=.001,Dz=.1;function wle(t,e,n){return n==null&&(n=JE()),eT(t,e,(s,r)=>ZE(s,r,n))}function JE(){return V.backend.floatPrecision()===32?ble:Dz}function eT(t,e,n){let s=!0;if((Cn(t)||Cn(e))&&(s=!1),Cn(t)&&Cn(e)&&(s=!0),s){const o=t.constructor.name,a=e.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(t)&&Array.isArray(e)){const o=so(t),a=so(e);if(!Ze(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const r=Cn(t)?t:no(t),i=Cn(e)?e:no(e);if(r.length!==i.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${i.length}.
Actual:   ${r}.
Expected: ${i}.`);for(let o=0;o<i.length;++o){const a=r[o],l=i[o];if(!n(a,l))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${l}.
Actual:   ${r}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function Ile(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function kle(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return ji(t)||ji(t[0])||ji(e)||ji(e[0])?eT(t,n,(s,r)=>s==r):eT(t,e,(s,r)=>ZE(s,r,0))}function Sle(t,e,n){if(n==null&&(n=JE()),!ZE(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function ZE(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Tle(t,e,n){for(let s=0;s<t.length;s++)if(t[s]<e||t[s]>n)throw new Error(`Value out of range:${t[s]} low: ${e}, high: ${n}`)}function Nle(t,e){const n=new Float32Array(t),s=new Float32Array(e);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let r=0;r<s.length;r++)if(n[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${n[r]} instead`)}function Pz(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?Pz(n):t[e]=Yi(n)}return t}function _le(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",s=>n(e)),e.load()})}async function Ele(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const Cle=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:Dz,createVideoElement:_le,encodeStrings:Pz,expectArrayBuffersEqual:Nle,expectArraysClose:wle,expectArraysEqual:kle,expectNumbersClose:Sle,expectPromiseToFail:Ile,expectValuesInRange:Tle,play:Ele,testEpsilon:JE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eC{constructor(e,n,s,r,i){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=Vw.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,i,o;do r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*i*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class $le{constructor(e,n,s,r){this.alpha=e,this.beta=1/n,this.dtype=s;const i=r||Math.random();this.randu=Vw.alea(i.toString()),this.randn=new eC(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,r,i,o;for(;;){do r=this.randn.nextValue(),o=1+this.c*r;while(o<=0);if(o*=o*o,e=r*r,n=1-.331*e*e,s=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<s)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Ale{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=Vw.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(t,e,n=1,s="float32",r){if(ur(t),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const i=new $le(e,n,s,r),o=qe(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Oz=z({randomGamma_:Rle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(t,e=0,n=1,s,r){if(ur(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const i=new eC(e,n,s,!1,r),o=qe(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const zw=z({randomNormal_:Dle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ple(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return zw(t,0,1,e,n)}const Fz=z({randomStandardNormal_:Ple});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ole(t,e=0,n=1,s="float32",r){ur(t);const i=qe(t,s),o=new Ale(e,n,null,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const _l=z({randomUniform_:Ole});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(t,e,n,s){return _l(t,e,n,"int32",s)}const Lz=z({randomUniformInt_:Fle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mc(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return V.runKernel(rw,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lle(t){const n={input:O(t,"input","real")};return V.runKernel(iw,n)}const Sd=z({real_:Lle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(t){const n={x:O(t,"x","reciprocal")};return V.runKernel(Ih,n)}const tC=z({reciprocal_:Mle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(t){const n={x:O(t,"x","relu")};return V.runKernel(kh,n)}const Ai=z({relu_:Vle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zle(t){const n={x:O(t,"x","relu6")};return V.runKernel(Sh,n)}const jw=z({relu6_:zle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(t,e){const s={x:O(t,"x","reverse")},r={dims:e};return V.runKernel(Eg,s,r)}const Er=z({reverse_:jle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(t){const e=O(t,"x","reverse");return D(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Er(e,0)}const Mz=z({reverse1d_:Ble});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ule(t,e){const n=O(t,"x","reverse");return D(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Er(n,e)}const Vz=z({reverse2d_:Ule});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wle(t,e){const n=O(t,"x","reverse");return D(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Er(n,e)}const zz=z({reverse3d_:Wle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(t,e){const n=O(t,"x","reverse");return D(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Er(n,e)}const jz=z({reverse4d_:Gle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(t){const n={x:O(t,"x","round")};return V.runKernel(Th,n)}const Bw=z({round_:Hle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qle(t){const n={x:O(t,"x","rsqrt","float32")};return V.runKernel(Nh,n)}const Uw=z({rsqrt_:qle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(t){const n={x:O(t,"x","selu")};return V.runKernel(_h,n)}const Ww=z({selu_:Kle});function Xle(t,e,n,s,r,i=[1,1],o="NHWC"){const a=O(t,"x","separableConv2d"),l=O(e,"depthwiseFilter","separableConv2d"),c=O(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");D(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),D(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),D(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],p=l.shape[3];D(c.shape[2]===h*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*p}, but got ${c.shape[2]}.`);const f=jh(u,l,s,r,o,i),y=Ko(f,c,1,"valid",o);return d?U(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Gw=z({separableConv2d_:Xle});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Yle(t,e){const n=O(t,"x","setdiff1d"),s=O(e,"y","setdiff1d");D(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),D(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),D(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),i=await s.data(),o=new Set(i);let a=0;for(let u=0;u<r.length;u++)o.has(r[u])||a++;const l=new gn([a],n.dtype),c=new gn([a],"int32");for(let u=0,d=0;u<r.length;u++)o.has(r[u])||(l.values[d]=r[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]}const Bz=Yle;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qle(t){const n={x:O(t,"x","sign")};return V.runKernel($h,n)}const nC=z({sign_:Qle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jle(t){const n={x:O(t,"x","sin","float32")};return V.runKernel(Eh,n)}const Hw=z({sin_:Jle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(t){const n={x:O(t,"x","sinh")};return V.runKernel(Ch,n)}const qw=z({sinh_:Zle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(t,e,n){const s=O(t,"x","slice1d");return D(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),et(s,[e],[n])}const ey=z({slice1d_:ece});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tce(t,e,n){const s=O(t,"x","slice2d");return D(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),et(s,e,n)}const Kw=z({slice2d_:tce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nce(t,e,n){const s=O(t,"x","slice3d");return D(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),et(s,e,n)}const ty=z({slice3d_:nce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sce(t,e,n){const s=O(t,"x","slice4d");return D(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),et(s,e,n)}const Td=z({slice4d_:sce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(t,e=-1){const n=O(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return V.runKernel(Pg,s,r)}const Hh=z({softmax_:rce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ice(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(zb,e)}const ny=z({fft_:ice});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oce(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return V.runKernel(Wb,e)}const Nd=z({ifft_:oce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ace(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=U(t,[n,e]);s=Nd(r)}else{const r=[n,2*(e-1)],i=U(Sd(t),[n,e]),o=U(Gg(t),[n,e]),a=Er(et(i,[0,1],[n,e-2]),1),l=j(Er(et(o,[0,1],[n,e-2]),1),Pe(-1)),c=rn([i,a],1),u=rn([o,l],1),d=U(qo(c,u),[r[0],r[1]]);s=Nd(d)}if(s=Sd(s),t.rank===3&&t.shape[0]!==0){const r=s,i=t.shape[0];s=U(s,[i,s.shape[0]/i,s.shape[1]]),r.dispose()}return s}const Xw=z({irfft_:ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t,e,n=0){const r={x:O(t,"x","split")},i={numOrSizeSplits:e,axis:n};return V.runKernel(Dg,r,i)}const Ls=z({split_:lce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cce(t,e){D(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const f=t.shape.map(y=>0),g=t.shape.map(y=>y);g[t.shape.length-1]=e,r=et(t,f,g),n=e}else if(e!=null&&e>n){const f=t.shape.map(g=>g);f[t.shape.length-1]=e-n,r=rn([t,sn(f)],t.shape.length-1),n=e}else r=t;const i=nt(r),o=U(qo(r,i),[s,n]),a=ny(o),l=Math.floor(n/2)+1,c=Sd(a),u=Gg(a),d=Ls(c,[l,n-l],c.shape.length-1),h=Ls(u,[l,n-l],u.shape.length-1),p=r.shape.slice();return p[r.shape.length-1]=l,U(qo(d[0],h[0]),p)}const sy=z({rfft_:cce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t,e){let n=O(t,"a","squaredDifference"),s=O(e,"b","squaredDifference");[n,s]=Ht(n,s),Ue(n.shape,s.shape);const r={a:n,b:s},i={};return V.runKernel(Ph,r,i)}const Yw=z({squaredDifference_:uce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(t,e){const n=O(t,"x","squeeze","string_or_numeric");return U(n,na(n.shape,e).newShape)}const la=z({squeeze_:dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(t,e=0){const n=tm(t,"tensors","stack","string_or_numeric");D(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&D(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return V.runKernel(wg,s,r)}const Bs=z({stack_:hce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(t,e=0){const s={x:O(t,"x","step")},r={alpha:e};return V.runKernel(Vh,s,r)}const ou=z({step_:pce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(t,e,n,s,r=0,i=0,o=0,a=0,l=0){const u={x:O(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return V.runKernel(yw,u,d)}const sC=z({stridedSlice_:fce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t){const n={x:O(t,"x","tan","float32")};return V.runKernel(Fh,n)}const rC=z({tan_:mce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rs(t,e){Jc(t);const n=so(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return kl(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zu(t,e,n){if(Jc(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=so(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return kl(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iC(t,e,n){if(Jc(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=so(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return kl(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(t,e,n){if(Jc(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=so(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return kl(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wz(t,e,n){if(Jc(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=so(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return kl(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gz(t,e,n){if(Jc(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=so(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,kl(t,e,s,n)}function oC(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(i+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(i+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(i+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(i+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function Qw(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}oC(n,e,t)}function El(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,i=n.length;let o=1;for(let d=r;d<i;++d)o*=n[d];const a=r<1?1:r,l=J(e.shape)/a,c=[...Re(n.slice(0,r)),1],u=J(n);return{sliceRank:r,numUpdates:l,sliceSize:o,strides:c,outputSize:u}}const gce=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:El,validateInput:Qw,validateUpdateShape:oC},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(t,e,n){const s=O(t,"tensor","tensorScatterupdate"),r=O(e,"indices","tensorScatterupdate","int32"),i=O(n,"updates","tensorScatterupdate");if(Qw(i,r,s.shape),s.dtype!==i.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${i.dtype}.`);const o={tensor:s,indices:r,updates:i},a={};return V.runKernel(cw,o,a)}const Hz=z({tensorScatterUpdate_:yce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(t,e=1,n=!0){const s=O(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const i={x:s},o={k:e,sorted:n},[a,l]=V.runKernel(ww,i,o);return{values:a,indices:l}}const aC=z({topk_:xce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(t,e=0,n=1,s,r){if(ur(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new eC(e,n,s,!0,r),o=qe(t,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Jw=z({truncatedNormal_:vce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(t,e=0){const n=O(t,"x","unique","string_or_numeric");D(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[i,o]=V.runKernel(kw,s,r);return{values:i,indices:o}}const lC=z({unique_:bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(t,e,n){const s=O(t,"x","unsortedSegmentSum"),r=O(e,"segmentIds","unsortedSegmentSum","int32");D($c(n),()=>"numSegments must be of dtype int");const i={x:s,segmentIds:r},o={numSegments:n};return V.runKernel(Lg,i,o)}const Zw=z({unsortedSegmentSum_:wce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(t,e=0){const n=O(t,"x","unstack","string_or_numeric");D(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return V.runKernel(Fg,s,r)}const Cr=z({unstack_:Ice});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qz(t,e){return Mw(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cC(t,e=!0,n,s){return V.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const s=qe(t,"int32"),r=qe([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=s.indexToLoc(n[i]),a=i*t.length;r.values.set(o,a)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function kce(t){const e=O(t,"condition","whereAsync","bool"),n=await e.data(),s=e1(e.shape,n);return t!==e&&e.dispose(),s}const uC=kce;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Sce(t,e,n){const s=O(t,"tensor","boolMask"),r=O(e,"mask","boolMask","bool"),i=n??0,o=r.rank,a=s.shape;D(o>0,()=>"mask cannot be scalar"),Gn(a.slice(i,i+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=i;g<i+o;g++)l*=a[g];const c=a.slice(0,i).concat([l],a.slice(i+o)),u=U(s,c),d=U(r,[-1]),h=await uC(d),p=la(h,[1]),f=Gh(u,p,i);return t!==s&&s.dispose(),e!==r&&r.dispose(),p.dispose(),u.dispose(),d.dispose(),h.dispose(),f}const Kz=Sce;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(t,e,n){const s=O(t,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),D(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{D(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},i={perm:e};return s.dtype==="complex64"?K(()=>{let o=Sd(s),a=Gg(s);return o=V.runKernel(fc,{x:o},i),a=V.runKernel(fc,{x:a},i),n&&(a=At(a)),qo(o,a)}):V.runKernel(fc,r,i)}const tt=z({transpose_:Tce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(t,e,n,s,r=!0){const i=O(t,"v","movingAverage"),o=O(e,"x","movingAverage"),a=O(n,"decay","movingAverage");BV(i,o),D(Ze(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=Pe(1),c=Ie(l,a);let u=j(Ie(o,i),c);if(r){D(s!=null,()=>"When using zeroDebias: true, step is required.");const d=O(s,"step","movingAverage");u=Ee(u,Ie(l,ro(a,d)))}return oe(i,u)}const Xz=z({movingAverage_:Nce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t,e,n){ur(n);const s=O(t,"indices","scatterND","int32"),r=O(e,"updates","scatterND");Qw(r,s,n);const i={indices:s,updates:r},o={shape:n};return V.runKernel(lw,i,o)}const Yz=z({scatterND_:_ce});function Ece(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const r=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(t,e,n,s=0){ur(n);const r=O(t,"sparseIndices","sparseToDense","int32"),i=O(e,"sparseValues","sparseToDense","string_or_numeric"),o=O(s,"defaultValue","sparseToDense",i.dtype);Ece(r,i,n,o);const a={sparseIndices:r,sparseValues:i,defaultValue:o},l={outputShape:n};return V.runKernel(mw,a,l)}const Qz=z({sparseToDense_:Cce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(t,e){const n=O(e,"indices","gatherND","int32"),r={params:O(t,"x","gatherND","string_or_numeric"),indices:n};return V.runKernel(Ub,r)}const Jz=z({gatherND_:$ce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ace(t,e){if(e==null)return t.shape.slice();if(Ze(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(t,e,n,s){const r=O(t,"x","dropout");if(D(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),D(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof gt?r.clone():r;const i=Ace(r,n),o=1-e,a=Ee(Wh(oe(_l(i,0,1,"float32",s),o)),o);return j(r,a)}const dC=z({dropout_:Rce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hC(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function t1(t,e,n){const s=1-t%2,r=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+s-1);r[i]=e-n*Math.cos(o)}return rs(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Dce(t,e,n=1){const s=O(t,"predictions","inTopK"),r=O(e,"targets","inTopK");D(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),D(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Gn(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=s.shape[s.shape.length-1];D(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await s.data(),a=await r.data(),[l,c]=[o.length/i,i],u=Dn("bool",l);for(let d=0;d<l;d++){const h=d*c,p=o.subarray(h,h+c),f=[];for(let g=0;g<p.length;g++)f.push({value:p[g],index:g});f.sort((g,y)=>y.value-g.value),u[d]=0;for(let g=0;g<n;g++)if(f[g].index===a[d]){u[d]=1;break}}return t!==s&&s.dispose(),e!==r&&r.dispose(),Kr(u,r.shape,"bool")}const Zz=Dce;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pce(t,e,n,s,r,i="NHWC",o){let a=t;t.rank===3&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]])),D(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),D(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),D(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=i==="NHWC"?a.shape[3]:a.shape[1],u=i==="NHWC"?l.shape[3]:l.shape[1];D(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),D(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),Cs("conv2dDerFilter",r,o);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:i,dimRoundingMode:o,filterShape:n};return V.runKernel(_b,d,h)}const pC=z({conv2DBackpropFilter_:Pce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n1(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return j(t,ou(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function s1(t,e){let n=e;const s=yn(t.shape,e.shape);return s.length>0&&(n=Te(n,s)),U(n,t.shape)}function r1(t,e,n,s){if(e==="linear")return t;if(e==="relu")return Ai(t);if(e==="elu")return Bh(t);if(e==="relu6")return jw(t);if(e==="prelu")return Zg(t,n);if(e==="leakyrelu")return Hg(t,s);if(e==="sigmoid")return bi(t);throw new Error(`Unknown fused activation ${e}.`)}const i1=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oce({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",i1(V.state.gradientDepth,l)===!1){D(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let A=Ko(t,e,n,s,r,i,o);return a!=null&&(A=oe(A,a)),r1(A,l,c,u)}const d=O(t,"x","conv2d","float32"),h=O(e,"filter","conv2d","float32");let p=d,f=!1;d.rank===3&&(f=!0,p=U(d,[1,d.shape[0],d.shape[1],d.shape[2]])),D(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),D(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Cs("fused conv2d",s,o);const g=r==="NHWC"?p.shape[3]:p.shape[1];D(h.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${h.shape[2]}.`),D(Hn(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const y=On(p.shape,h.shape,n,i,s,o);let x;a!=null&&(x=O(a,"bias","fused conv2d"),[x]=Ht(x,d),r==="NHWC"?Ue(y.outShape,x.shape):(D(x.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${x.shape.length}.`),D(x.shape.length===0||x.shape[0]===y.outChannels||x.shape[0]===1,()=>`Error in fused conv2d: bias shape (${x.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let v;if(c!=null){const A=c.shape;if(D(A.length<=1||A.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${A.length}.`),A.length===1)D(A[0]===1||A[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${A}) is not compatible with the number of output channels (${y.outChannels}).`);else if(A.length===3)try{Ue(A,y.outShape)}catch{const S=`Error in fused conv2d: PReLU activation weights (${A}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(S)}v=O(c,"prelu weights","fused conv2d")}const w=(A,T)=>{D(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[S,E,$,P]=T,F=n1(A,$,l);D(ll(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const R=TE(E.shape,F,S,n,s),G=pC(E,F,S.shape,n,s),q=[R,G];if(P!=null){const Q=s1(P,F);q.push(Q)}return q},I={x:p,filter:h,bias:x,preluActivationWeights:v},N={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?io((T,S,E)=>{let $=V.runKernel(Yf,I,N);return E([S,T,$]),f&&($=U($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:w}})(p,h):io((T,S,E,$)=>{let P=V.runKernel(Yf,I,N);return $([S,T,P,E]),f&&(P=U(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:w}})(p,h,x)}const ej=z({fusedConv2d_:Oce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fce(t,e,n,s,r,i=[1,1],o){let a=t;t.rank===3&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,filterShape:n};return V.runKernel(Pb,c,u)}const tj=z({depthwiseConv2dNativeBackpropFilter_:Fce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(t,e,n,s,r,i=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:o,dilations:i,inputShape:t},d=V.runKernel(Ob,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const nj=z({depthwiseConv2dNativeBackpropInput_:Lce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(i1(V.state.gradientDepth,l)===!1){let N=jh(t,e,n,s,r,i,o);return a!=null&&(N=oe(N,a)),r1(N,l,c,u)}const d=O(t,"x","depthwiseConv2d","float32"),h=O(e,"filter","depthwiseConv2d","float32");let p=d,f=!1;d.rank===3&&(f=!0,p=U(d,[1,d.shape[0],d.shape[1],d.shape[2]])),D(p.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),D(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),D(p.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),i==null&&(i=[1,1]),D(Hn(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Cs("fused depthwiseConv2d",s,o);const g=On(p.shape,h.shape,n,i,s,o,!0);let y;a!=null&&(y=O(a,"bias","fused conv2d"),[y]=Ht(y,d),Ue(g.outShape,y.shape));let x;c!=null&&(x=O(c,"prelu weights","fused depthwiseConv2d"));const v=(N,A)=>{D(ll(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[T,S,E,$]=A,P=n1(N,E,l),F=nj(S.shape,P,T,n,s,i,o),R=tj(S,P,T.shape,n,s,i,o);if($!=null){const G=s1(y,P);return[F,R,G]}return[F,R]},w={x:p,filter:h,bias:y,preluActivationWeights:x},I={strides:n,pad:s,dataFormat:r,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:u};return a==null?io((A,T,S)=>{let E=V.runKernel(Qf,w,I);return S([T,A,E]),f&&(E=U(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:v}})(p,h):io((A,T,S,E)=>{let $=V.runKernel(Qf,w,I);return E([T,A,$,S]),f&&($=U($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:v}})(p,h,y)}const Vce=z({fusedDepthwiseConv2d_:Mce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(i1(V.state.gradientDepth,i)===!1){let P=Xe(t,e,n,s);return r!=null&&(P=oe(P,r)),r1(P,i,o,a)}let l=O(t,"a","fused matMul"),c=O(e,"b","fused matMul");[l,c]=Ht(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],p=s?c.shape[c.rank-2]:c.shape[c.rank-1],f=l.shape.slice(0,-2),g=c.shape.slice(0,-2),y=J(f),x=J(g);D(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=Ue(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,p]),I=n?U(l,[y,u,h]):U(l,[y,h,u]),N=s?U(c,[x,p,d]):U(c,[x,d,p]);let A;r!=null&&(A=O(r,"bias","fused matMul"),[A]=Ht(A,l),Ue(w,A.shape));let T;o!=null&&(T=O(o,"prelu weights","fused matMul"));const S=(P,F)=>{const[R,G,q,Q]=F,te=n1(U(P,q.shape),q,i);let B,H;if(!n&&!s?(B=Xe(te,G,!1,!0),H=Xe(R,te,!0,!1)):!n&&s?(B=Xe(te,G,!1,!1),H=Xe(te,R,!0,!1)):n&&!s?(B=Xe(G,te,!1,!0),H=Xe(R,te,!1,!1)):(B=Xe(G,te,!0,!0),H=Xe(te,R,!0,!0)),r!=null){const Z=s1(Q,te);return[B,H,Z]}else return[B,H]},E={a:I,b:N,bias:A,preluActivationWeights:T},$={transposeA:n,transposeB:s,activation:i,leakyreluAlpha:a};return r==null?io((F,R,G)=>{const q=V.runKernel(Xf,E,$);return G([F,R,q]),{value:U(q,w),gradFunc:S}})(I,N):io((F,R,G,q)=>{const Q=V.runKernel(Xf,E,$);return q([F,R,Q,G]),{value:U(Q,w),gradFunc:S}})(I,N,A)}const tT=z({fusedMatMul_:zce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sj=Object.freeze(Object.defineProperty({__proto__:null,conv2d:ej,depthwiseConv2d:Vce,matMul:tT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jce(t){return t1(t,.54,.46)}const Bce=z({hammingWindow_:jce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uce(t){return t1(t,.5,.5)}const rj=z({hannWindow_:Uce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(t,e,n,s=!1,r=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(et(t,i,e)),i+=n;if(s)for(;i<t.size;){const a=i+e-t.size,l=rn([et(t,i,e-a),su([a],r)]);o.push(l),i+=n}return o.length===0?Zu([],[0,e]):U(rn(o),[o.length,e])}const ij=z({frame_:Wce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gce(t,e,n,s,r=rj){s==null&&(s=hC(e));const i=ij(t,e,n),o=j(i,r(e));return sy(o,s)}const Hce=z({stft_:Gce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qce(t,e,n,s,r="bilinear",i=0){const o=O(t,"image","cropAndResize"),a=O(e,"boxes","cropAndResize","float32"),l=O(n,"boxInd","cropAndResize","int32"),c=a.shape[0];D(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),D(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),D(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),D(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),D(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),D(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:o,boxes:a,boxInd:l},d={method:r,extrapolationValue:i,cropSize:s};return V.runKernel(Ab,u,d)}const Kce=z({cropAndResize_:qce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(t){const e=O(t,"image","flipLeftRight","float32");D(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return V.runKernel(Bb,n,{})}const Yce=z({flipLeftRight_:Xce});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(t){const e=O(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];D(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),D(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,Ir(e,r)}const Jce=z({grayscaleToRGB_:Qce});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(t){const e=O(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];D(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),D(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,i=me(e,"float32"),o=rs([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Kl("ij,j->i",i,o);break;case 3:a=Kl("ijk,k->ij",i,o);break;case 4:a=Kl("ijkl,l->ijk",i,o);break;case 5:a=Kl("ijklm,m->ijkl",i,o);break;case 6:a=Kl("ijklmn,n->ijklm",i,o);break;default:throw new Error("Not a valid tensor rank.")}return a=ns(a,-1),me(a,r)}const eue=z({rgbToGrayscale_:Zce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tue(t,e,n=0,s=.5){const r=O(t,"image","rotateWithOffset","float32");D(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const i={image:r},o={radians:e,fillValue:n,center:s};return V.runKernel(Sw,i,o)}const nue=z({rotateWithOffset_:tue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qh(t,e,n,s,r,i){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),D(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),D(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),D(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),D(e.rank===1,()=>"scores must be a 1D tensor"),D(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),D(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sue(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=O(t,"boxes","nonMaxSuppression","float32"),o=O(e,"scores","nonMaxSuppression","float32"),a=qh(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return V.runKernel(Jb,{boxes:i,scores:o},l)}const rue=z({nonMaxSuppression_:sue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iue(t,e,n){const s=oue(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function oue(t,e,n){return lue(t,e,n||aue)}function aue(t,e){return t>e?1:t<e?-1:0}function lue(t,e,n){let s=0,r=t.length,i=0,o=!1;for(;s<r;){i=s+(r-s>>>1);const a=n(e,t[i]);a>0?s=i+1:(r=i,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1(t,e,n,s,r){return fC(t,e,n,s,r,0)}function a1(t,e,n,s,r,i){return fC(t,e,n,s,r,0,!1,i,!0)}function l1(t,e,n,s,r,i){return fC(t,e,n,s,r,i,!0)}function fC(t,e,n,s,r,i,o=!1,a=!1,l=!1){const c=[];for(let y=0;y<e.length;y++)e[y]>r&&c.push({score:e[y],boxIndex:y,suppressBeginIndex:0});c.sort(UD);const u=i>0?-.5/i:0,d=[],h=[];for(;d.length<n&&c.length>0;){const y=c.pop(),{score:x,boxIndex:v,suppressBeginIndex:w}=y;if(x<r)break;let I=!1;for(let N=d.length-1;N>=w;--N){const A=cue(t,v,d[N]);if(A>=s){I=!0;break}if(y.score=y.score*uue(s,u,A),y.score<=r)break}y.suppressBeginIndex=d.length,I||(y.score===x?(d.push(v),h.push(y.score)):y.score>r&&iue(c,y,UD))}const p=d.length,f=n-p;a&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const g={selectedIndices:d};return o&&(g.selectedScores=h),l&&(g.validOutputs=p),g}function cue(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),i=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),p=(a-i)*(l-o),f=(d-c)*(h-u);if(p<=0||f<=0)return 0;const g=Math.max(i,c),y=Math.max(o,u),x=Math.min(a,d),v=Math.min(l,h),w=Math.max(x-g,0)*Math.max(v-y,0);return w/(p+f-w)}function uue(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function UD(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function due(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const i=O(t,"boxes","nonMaxSuppressionAsync"),o=O(e,"scores","nonMaxSuppressionAsync"),a=qh(i,o,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),c=l[0],u=l[1],{selectedIndices:d}=o1(c,u,n,s,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),rs(d,"int32")}const hue=due;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=O(t,"boxes","nonMaxSuppression"),a=O(e,"scores","nonMaxSuppression"),l=qh(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c={boxes:o,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:i},d=V.runKernel(ew,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const fue=z({nonMaxSuppressionWithScore_:pue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function mue(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=0){const o=O(t,"boxes","nonMaxSuppressionAsync"),a=O(e,"scores","nonMaxSuppressionAsync"),l=qh(o,a,n,s,r,i);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,i=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:p}=l1(u,d,n,s,r,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:rs(h,"int32"),selectedScores:rs(p)}}const gue=mue;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=O(t,"boxes","nonMaxSuppression"),a=O(e,"scores","nonMaxSuppression"),l=qh(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:o,scores:a},p={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:i},f=V.runKernel(Zb,h,p);return{selectedIndices:f[0],validOutputs:f[1]}}const xue=z({nonMaxSuppressionPadded_:yue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vue(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,i=!1){const o=O(t,"boxes","nonMaxSuppressionAsync"),a=O(e,"scores","nonMaxSuppressionAsync"),l=qh(o,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,p]=await Promise.all([o.data(),a.data()]),{selectedIndices:f,validOutputs:g}=a1(h,p,c,u,d,i);return o!==t&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:rs(f,"int32"),validOutputs:Pe(g,"int32")}}const bue=vue;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(t,e,n=!1,s=!1){const r=O(t,"images","resizeBilinear");D(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),D(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),D(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=U(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=V.runKernel(_g,a,l);return o?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const oj=z({resizeBilinear_:wue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(t,e,n=!1,s=!1){const r=O(t,"images","resizeNearestNeighbor");D(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),D(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),D(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),D(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=r,o=!1;r.rank===3&&(o=!0,i=U(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:i},l={alignCorners:n,halfPixelCenters:s,size:e},c=V.runKernel(Ng,a,l);return o?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const aj=z({resizeNearestNeighbor_:Iue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kue(t,e="binary",n=!1,s=.5){const r=O(t,"image","threshold"),i=.2989,o=.587,a=.114,l=r.shape[0]*r.shape[1];let c=j(rs([s]),255),u,d,h,p;if(D(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),D(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),D(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),D(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,d,h]=Ls(r,[1,1,1],-1);const y=j(u,i),x=j(d,o),v=j(h,a);p=oe(oe(y,x),v)}else p=t;if(e==="otsu"){const y=vE(me(Bw(p),"int32"),Kr([]),256);c=Sue(y,l)}const f=n?Nl(p,c):Hs(p,c);return me(j(f,255),"int32")}function Sue(t,e){let n=rs([-1]),s=rs([0]),r=rs([0]),i,o,a,l,c,u;for(let d=0;d<t.size-1;d++){i=et(t,0,d+1),o=et(t,d+1),c=Ee(Te(i),e),u=Ee(Te(o),e);const h=Te(j(i,Mc(0,i.size)));a=Ee(h,Te(i));const p=su(o.shape,i.size),f=oe(Mc(0,o.size),p),g=j(o,f);l=Ee(Te(g),Te(o));const y=Ie(a,l),x=Ie(a,l),v=j(c,u);r=j(j(v,y),x);const w=Hs(r,s);s=Un(w,r,s),n=Un(w,rs([d]),n)}return n}const Tue=z({threshold_:kue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t,e,n="nearest",s="constant",r=0,i){const o=O(t,"image","transform","float32"),a=O(e,"transforms","transform","float32");D(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),D(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),D(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:i};return V.runKernel(Iw,l,c)}const _ue=z({transform_:Nue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eue(t,e,n){const s=O(t,"a","bandPart");D(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[i,o]=s.shape.slice(-2);let a,l;typeof e=="number"?(D(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),D(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),a=O(e<0?i:e,"numLower","bandPart")):(D(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Un(Id(e,0),i,ul(e,i))),typeof n=="number"?(D(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),D(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=O(n<0?o:n,"numUpper","bandPart")):(D(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Un(Id(n,0),o,ul(n,o)));const c=U(Mc(0,i,1,"int32"),[-1,1]),u=Mc(0,o,1,"int32"),d=Ie(c,u),h=Si(Nl(d,a),oa(d,At(l))),p=sn([i,o],s.dtype);return U(Bs(Cr(U(s,[-1,i,o])).map(f=>Un(h,f,p))),r)}const Cue=z({bandPart_:Eue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t){let e;if(Array.isArray(t)){e=!1,D(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let i=1;i<t.length;++i)D(t[i].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${r})`)}else e=!0,t=Ls(t,t.shape[0],0).map(r=>la(r,[0]));D(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(V.tidy(()=>{let i=s[r];if(r>0)for(let o=0;o<r;++o){const a=j(Te(j(n[o],i)),n[o]);i=Ie(i,a)}return Ee(i,Uh(i,"euclidean"))}));return e?Bs(n,0):n}const Aue=z({gramSchmidt_:$ue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t,e=!1){if(D(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return WD(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=Cr(U(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],i=[];s.forEach(l=>{const[c,u]=WD(l,e);r.push(c),i.push(u)});const o=U(Bs(r,0),t.shape),a=U(Bs(i,0),t.shape);return[o,a]}}function WD(t,e=!1){return V.tidy(()=>{D(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=Pw(n),i=Qi(t);const o=Zu([[1]],[1,1]);let a=Qi(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=i,d=a,h=r;[a,i,r]=V.tidy(()=>{const p=et(i,[c,c],[n-c,1]),f=Uh(p),g=et(i,[c,c],[1,1]),y=Un(Hs(g,0),Zu([[-1]]),Zu([[1]])),x=Ie(g,j(y,f)),v=Ee(p,x);v.shape[0]===1?a=Qi(o):a=rn([o,et(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const w=At(Ee(Xe(y,x),f)),I=et(i,[c,0],[n-c,s]),N=j(w,a),A=tt(a);if(c===0)i=Ie(I,Xe(N,Xe(A,I)));else{const E=Ie(I,Xe(N,Xe(A,I)));i=rn([et(i,[0,0],[c,s]),E],0)}const T=tt(N),S=et(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=Ie(S,Xe(Xe(S,a),T));else{const E=Ie(S,Xe(Xe(S,a),T));r=rn([et(r,[0,0],[n,c]),E],1)}return[a,i,r]}),Ye([u,d,h])}return!e&&n>s&&(r=et(r,[0,0],[n,s]),i=et(i,[0,0],[s,s])),[r,i]})}const Due=z({qr_:Rue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Is;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Is||(Is={}));function Pue(t,e,n=Is.SUM_BY_NONZERO_WEIGHTS){const s=O(t,"losses","computeWeightedLoss");let r=null;e!=null&&(r=O(e,"weights","computeWeightedLoss"));const i=r==null?s:j(s,r);if(n===Is.NONE)return i;if(n===Is.SUM)return Te(i);if(n===Is.MEAN){if(r==null)return Wt(i);{const o=s.size/r.size,a=Ee(Te(i),Te(r));return o>1?Ee(a,Pe(o)):a}}if(n===Is.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Ee(Te(i),Pe(s.size));{const o=j(r,Os(s.shape)),a=me(Te(Lc(o,Pe(0))),"float32");return Ee(Te(i),a)}}throw Error(`Unknown reduction: ${n}`)}const ca=z({computeWeightedLoss_:Pue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oue(t,e,n,s=Is.SUM_BY_NONZERO_WEIGHTS){const r=O(t,"labels","absoluteDifference"),i=O(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=O(n,"weights","absoluteDifference")),Gn(r.shape,i.shape,"Error in absoluteDifference: ");const a=pn(Ie(r,i));return ca(a,o,s)}const Fue=z({absoluteDifference_:Oue});function Lue(t,e,n,s,r=Is.SUM_BY_NONZERO_WEIGHTS){const i=O(t,"labels","cosineDistance"),o=O(e,"predictions","cosineDistance");let a=null;s!=null&&(a=O(s,"weights","cosineDistance")),Gn(i.shape,o.shape,"Error in cosineDistance: ");const l=Pe(1),c=Ie(l,Te(j(i,o),n,!0));return ca(c,a,r)}const Mue=z({cosineDistance_:Lue});function Vue(t,e,n,s=Is.SUM_BY_NONZERO_WEIGHTS){let r=O(t,"labels","hingeLoss");const i=O(e,"predictions","hingeLoss");let o=null;n!=null&&(o=O(n,"weights","hingeLoss")),Gn(r.shape,i.shape,"Error in hingeLoss: ");const a=Pe(1);r=Ie(j(Pe(2),r),a);const l=Ai(Ie(a,j(r,i)));return ca(l,o,s)}const zue=z({hingeLoss_:Vue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jue(t,e,n,s=1,r=Is.SUM_BY_NONZERO_WEIGHTS){const i=O(t,"labels","huberLoss"),o=O(e,"predictions","huberLoss");let a=null;n!=null&&(a=O(n,"weights","huberLoss")),Gn(i.shape,o.shape,"Error in huberLoss: ");const l=Pe(s),c=pn(Ie(o,i)),u=ul(c,l),d=Ie(c,u),h=oe(j(Pe(.5),wt(u)),j(l,d));return ca(h,a,r)}const Bue=z({huberLoss_:jue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(t,e,n,s=1e-7,r=Is.SUM_BY_NONZERO_WEIGHTS){const i=O(t,"labels","logLoss"),o=O(e,"predictions","logLoss");let a=null;n!=null&&(a=O(n,"weights","logLoss")),Gn(i.shape,o.shape,"Error in logLoss: ");const l=Pe(1),c=Pe(s),u=At(j(i,or(oe(o,c)))),d=j(Ie(l,i),or(oe(Ie(l,o),c))),h=Ie(u,d);return ca(h,a,r)}const Wue=z({logLoss_:Uue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(t,e,n,s=Is.SUM_BY_NONZERO_WEIGHTS){const r=O(t,"labels","meanSquaredError"),i=O(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=O(n,"weights","meanSquaredError")),Gn(r.shape,i.shape,"Error in meanSquaredError: ");const a=Yw(r,i);return ca(a,o,s)}const Hue=z({meanSquaredError_:Gue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function que(t,e){const n=O(t,"labels","sigmoidCrossEntropyWithLogits"),s=O(e,"logits","sigmoidCrossEntropyWithLogits");Gn(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Ai(s),i=j(s,n),o=qg(js(At(pn(s))));return oe(Ie(r,i),o)}function Kue(t,e,n,s=0,r=Is.SUM_BY_NONZERO_WEIGHTS){let i=O(t,"multiClassLabels","sigmoidCrossEntropy");const o=O(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=O(n,"weights","sigmoidCrossEntropy")),Gn(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Pe(s),u=Pe(1),d=Pe(.5);i=oe(j(i,Ie(u,c)),j(d,c))}const l=que(i,o);return ca(l,a,r)}const Xue=z({sigmoidCrossEntropy_:Kue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yue(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return io((r,i,o)=>{const l=Kg(i,[n],!0),c=Ie(me(i,"float32"),l);o([r,c]);const u=At(j(c,r));return{value:Te(u,[n]),gradFunc:(p,f)=>{const[g,y]=f,x=an(p.shape,[n]);return[j(U(p,x),Ie(me(g,"float32"),js(y))),j(U(p,x),Ie(js(y),me(g,"float32")))]}}})(t,e)}function Que(t,e,n,s=0,r=Is.SUM_BY_NONZERO_WEIGHTS){let i=O(t,"onehotLabels","softmaxCrossEntropy");const o=O(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=O(n,"weights","softmaxCrossEntropy")),Gn(i.shape,o.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Pe(s),u=Pe(1),d=Pe(i.shape[1]);i=oe(j(i,Ie(u,c)),Ee(c,d))}const l=Yue(i,o);return ca(l,a,r)}const Jue=z({softmaxCrossEntropy_:Que});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(t,e,n,s){const r=O(t,"indices","sparseFillEmptyRows","int32"),i=O(e,"values","sparseFillEmptyRows"),o=O(n,"denseShape","sparseFillEmptyRows","int32"),a=O(s,"defaultValue","sparseFillEmptyRows",i.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:r,values:i,denseShape:o,defaultValue:a},c=V.runKernel(dw,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const ede=z({sparseFillEmptyRows_:Zue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(t,e,n){const s=O(t,"inputIndices","sparseReshape","int32"),r=O(e,"inputShape","sparseReshape","int32"),i=O(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:s,inputShape:r,newShape:i},a=V.runKernel(hw,o);return{outputIndices:a[0],outputShape:a[1]}}const nde=z({sparseReshape_:tde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sde(t,e,n){const s=O(t,"data","sparseSegmentMean"),r=O(e,"indices","sparseSegmentMean","int32"),i=O(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return V.runKernel(pw,o)}const rde=z({sparseSegmentMean_:sde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(t,e,n){const s=O(t,"data","sparseSegmentSum"),r=O(e,"indices","sparseSegmentSum","int32"),i=O(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:s,indices:r,segmentIds:i};return V.runKernel(fw,o)}const ode=z({sparseSegmentSum_:ide});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade(t,e,n,s,r,i,o,a){const l=O(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=O(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:s,leftPad:r,rightPad:i,padWidth:o,preserveShortSequences:a},d={data:l,dataSplits:c},h=V.runKernel(xw,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}const lde=z({stringNGrams_:ade});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cde(t,e,n=!0){const s=O(t,"input","stringSplit","string"),r=O(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const i={skipEmpty:n},o={input:s,delimiter:r},a=V.runKernel(vw,o,i);return{indices:a[0],values:a[1],shape:a[2]}}const ude=z({stringSplit_:cde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(t,e){const n=O(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return V.runKernel(bw,r,s)}const hde=z({stringToHashBucketFast_:dde});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pde(t,e,n,s=!0){const r=O(t,"input","staticRegexReplace","string"),i={pattern:e,rewrite:n,replaceGlobal:s};return V.runKernel(Og,{x:r},i)}const fde=z({staticRegexReplace_:pde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lj={fft:ny,ifft:Nd,rfft:sy,irfft:Xw},cj={hammingWindow:Bce,hannWindow:rj,frame:ij,stft:Hce},Wr={flipLeftRight:Yce,grayscaleToRGB:Jce,resizeNearestNeighbor:aj,resizeBilinear:oj,rgbToGrayscale:eue,rotateWithOffset:nue,cropAndResize:Kce,nonMaxSuppression:rue,nonMaxSuppressionAsync:hue,nonMaxSuppressionWithScore:fue,nonMaxSuppressionWithScoreAsync:gue,nonMaxSuppressionPadded:xue,nonMaxSuppressionPaddedAsync:bue,threshold:Tue,transform:_ue},mC={bandPart:Cue,gramSchmidt:Aue,qr:Due},uj={absoluteDifference:Fue,computeWeightedLoss:ca,cosineDistance:Mue,hingeLoss:zue,huberLoss:Bue,logLoss:Wue,meanSquaredError:Hue,sigmoidCrossEntropy:Xue,softmaxCrossEntropy:Jue},dj={sparseFillEmptyRows:ede,sparseReshape:nde,sparseSegmentMean:rde,sparseSegmentSum:ode},hj={stringNGrams:lde,stringSplit:ude,stringToHashBucketFast:hde,staticRegexReplace:fde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mde=new Map,nT=new Map;class au{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class xr{constructor(){this.classNameMap={}}static getMap(){return xr.instance==null&&(xr.instance=new xr),xr.instance}static register(e){xr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function le(t,e,n){D(t.className!=null,()=>"Class being registered does not have the static className property defined."),D(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),D(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return xr.register(t),mde.set(r,t),nT.set(t,r),t}function gde(t){return nT.has(t)?nT.get(t):t.className}const yde=Object.freeze(Object.defineProperty({__proto__:null,Serializable:au,SerializationMap:xr,getRegisteredName:gde,registerClass:le},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ua extends au{minimize(e,n=!1,s){const{value:r,grads:i}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:i[a.name]}));this.applyGradients(o)}else this.applyGradients(i);return Ye(i),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return yz(e,n)}dispose(){this.iterations_!=null&&Ye(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Pe(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ua,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gC extends ua{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:K(()=>nt(i).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:K(()=>nt(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;K(()=>{const u=oe(j(l,this.rho),j(wt(a),1-this.rho)),d=j(Ee(Pn(oe(c,this.epsilon)),Pn(oe(l,this.epsilon))),a),h=oe(j(c,this.rho),j(wt(d),1-this.rho));l.assign(u),c.assign(h);const p=oe(j(d,-this.learningRate),i);i.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Ye(this.accumulatedGrads.map(e=>e.variable)),Ye(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yC extends ua{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:K(()=>su(i.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[r].variable;K(()=>{const l=oe(a,wt(o));a.assign(l);const c=oe(j(Ee(o,Pn(oe(l,V.backend.epsilon()))),-this.learningRate),i);i.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Ye(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xC extends ua{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],K(()=>{this.accBeta1=Pe(n).variable(),this.accBeta2=Pe(s).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);K(()=>{const s=Ie(1,this.accBeta1),r=Ie(1,this.accBeta2);n.forEach((i,o)=>{const a=V.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:K(()=>nt(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:K(()=>nt(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,h=oe(j(u,this.beta1),j(c,1-this.beta1)),p=oe(j(d,this.beta2),j(wt(c),1-this.beta2)),f=Ee(h,s),g=Ee(p,r);u.assign(h),d.assign(p);const y=oe(j(Ee(f,oe(Pn(g),this.epsilon)),-this.learningRate),a);a.assign(y)}),this.accBeta1.assign(j(this.accBeta1,this.beta1)),this.accBeta2.assign(j(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ye(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Ye(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),K(()=>{this.accBeta1.assign(ro(this.beta1,this.iterations_+1)),this.accBeta2.assign(ro(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vC extends ua{static get className(){return"Adamax"}constructor(e,n,s,r=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],K(()=>{this.iteration=Pe(0).variable(),this.accBeta1=Pe(n).variable()}),r==null&&(this.epsilon=V.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);K(()=>{const s=Ie(1,this.accBeta1),r=Ee(-this.learningRate,oe(j(this.iteration,this.decay),1));n.forEach((i,o)=>{const a=V.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:nt(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:nt(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[i];if(c==null)return;const u=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,h=oe(j(u,this.beta1),j(c,1-this.beta1)),p=j(d,this.beta2),f=pn(c),g=ho(p,f);u.assign(h),d.assign(g);const y=oe(j(Ee(r,s),Ee(h,oe(g,this.epsilon))),a);a.assign(y)}),this.iteration.assign(oe(this.iteration,1)),this.accBeta1.assign(j(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ye(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Ye(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c1 extends ua{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const o=V.registeredVariables[s];K(()=>{const a=oe(j(this.c,i),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=wn(Pe(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bC extends c1{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Pe(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:K(()=>nt(i).variable(!1))});const o=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&K(()=>{let l;const c=oe(j(this.m,o),a);this.useNesterov?l=oe(j(this.c,oe(a,j(c,this.m))),i):l=oe(j(this.c,c),i),o.assign(c),i.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Ye(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wC extends ua{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r==null&&(this.epsilon=V.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const i=V.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:K(()=>nt(i).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:K(()=>nt(i).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:K(()=>nt(i).variable(o))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;K(()=>{const u=oe(j(l,this.decay),j(wt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=oe(j(d,this.decay),j(a,1-this.decay)),p=Ee(j(a,this.learningRate),Pn(Ie(u,oe(wt(h),this.epsilon)))),f=oe(j(c,this.momentum),p);l.assign(u),d.assign(h),c.assign(f);const g=Ie(i,f);i.assign(g)}else{const d=oe(j(l,this.decay),j(wt(a),1-this.decay)),h=oe(j(c,this.momentum),Ee(j(a,this.learningRate),Pn(oe(d,this.epsilon))));l.assign(d),c.assign(h);const p=Ie(i,h);i.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Ye(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Ye(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Ye(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xde=[gC,yC,xC,vC,bC,wC,c1];function vde(){for(const t of xde)le(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bde="model",wde=".json",Ide=".weights.bin";function GD(t){return new Promise(e=>setTimeout(e)).then(t)}class Vc{constructor(e){if(!X().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Vc.URL_SCHEME)&&(e=e.slice(Vc.URL_SCHEME.length)),(e==null||e.length===0)&&(e=bde),this.modelJsonFileName=e+wde,this.weightDataFileName=e+Ide}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=$i.join(e.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=QV(e,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await GD(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await GD(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:zg(e)}}}}Vc.URL_SCHEME="downloads://";class kde{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=r=>{const i=JSON.parse(r.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=rE(i,c=>this.loadWeights(c));e(l)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const o of e)n.push(...o.weights),s.push(...o.paths);const r=this.checkManifestAndWeightFiles(e),i=s.map(o=>this.loadWeightsFile(o,r[o]));return Promise.all(i).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((s,r)=>{const i=new FileReader;i.onload=o=>{const a=o.target.result;s(a)},i.onerror=o=>r(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(i=>BD(i.name)),r={};for(const i of e)i.paths.forEach(o=>{const a=BD(o);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);r[o]=this.weightsFiles[s.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const Sde=t=>X().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Vc.URL_SCHEME)?Tde(t.slice(Vc.URL_SCHEME.length)):null;Bt.registerSaveRouter(Sde);function Tde(t="model"){return new Vc(t)}function Nde(t){return new kde(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HD(t,e,n,s){o(t),n=n??0,s=s??1,a(n,s);let r=0;const i=l=>(l.then(c=>{const u=n+ ++r/t.length*(s-n);return e(u),c}),l);function o(l){D(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){D(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),D(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),D(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(i))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function pj(t,e){e==null&&(e={});const n=e.fetchFunc==null?X().platform.fetch:e.fetchFunc,s=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(s):await HD(s,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await HD(a,e.onProgress,.5,1)}function _de(t,e){var n;const s=e.fetchFunc==null?X().platform.fetch:e.fetchFunc;let r=0,i;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var a;r<t.length;){i||(i=(await s(t[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await i.read();if(l){r++,i=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,r/t.length);continue}o.enqueue(c);return}o.close()}})}async function Ede(t,e="",n,s){return fj(o=>pj(o,{requestInit:s}))(t,e,n)}function fj(t){return async(e,n="",s)=>{const r=e.map(()=>!1),i={},o=s!=null?s.map(()=>!1):[],a=[];if(e.forEach((p,f)=>{let g=0;p.weights.forEach(y=>{const x="quantization"in y?y.quantization.dtype:y.dtype,v=Ac[x]*J(y.shape),w=()=>{r[f]=!0,i[f]==null&&(i[f]=[]),i[f].push({manifestEntry:y,groupOffset:g,sizeBytes:v})};s!=null?s.forEach((I,N)=>{I===y.name&&(w(),o[N]=!0)}):w(),a.push(y.name),g+=v})}),!o.every(p=>p)){const p=s.filter((f,g)=>!o[g]);throw new Error(`Could not find weights in manifest with names: ${p.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=r.reduce((p,f,g)=>(f&&p.push(g),p),[]),c=[];l.forEach(p=>{e[p].paths.forEach(f=>{const g=n+(n.endsWith("/")?"":"/")+f;c.push(g)})});const u=await t(c),d={};let h=0;return l.forEach(p=>{const f=e[p].paths.length,g=new $i(u.slice(h,h+f));i[p].forEach(x=>{const v=g.slice(x.groupOffset,x.groupOffset+x.sizeBytes),w=qV(v,[x.manifestEntry]);for(const I in w)d[I]=w[I]}),h+=f}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde="application/octet-stream",$de="application/json";class IC{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(D(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=X().platform.fetch,D(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&D(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=QV(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:$de}),"model.json"),e.weightData!=null){const o=$i.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:Cde}),"model.weights.bin")}const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:zg(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return rE(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=XS(e.weightsManifest),r=()=>_de(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=Ade(n),i=this.weightPathPrefix||s,o=[],a=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(c)):o.push(i+c+r);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const n=await this.getWeightUrls(e),s=XS(e),r=await pj(n,this.loadOptions);return[s,r]}}IC.URL_SCHEME_REGEX=/^https?:\/\//;function Ade(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function sT(t){return t.match(IC.URL_SCHEME_REGEX)!=null}const mj=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>sT(s)):n=sT(t),n)return kC(t,e)}return null};Bt.registerSaveRouter(mj);Bt.registerLoadRouter(mj);function kC(t,e){return new IC(t,e)}function Rde(t,e){return kC(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BI{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class gj{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Dde{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Pde(t,e,n,s){const r=arguments;return new Dde(yj(...r))}function yj(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new BI(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new BI({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new BI({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function Ode(t){return new gj(t)}function Fde(t){return new gj(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SC=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:$i,browserFiles:Nde,browserHTTPRequest:Rde,concatenateArrayBuffers:YV,copyModel:fie,decodeWeights:qV,decodeWeightsStream:XV,encodeWeights:KS,fromMemory:Pde,fromMemorySync:yj,getLoadHandlers:eie,getModelArtifactsForJSON:rE,getModelArtifactsForJSONSync:JV,getModelArtifactsInfoForJSON:zg,getSaveHandlers:ZV,getWeightSpecs:XS,http:kC,isHTTPScheme:sT,listModels:hie,loadWeights:Ede,moveModel:mie,registerLoadRouter:Zre,registerSaveRouter:Jre,removeModel:pie,weightsLoaderFactory:fj,withSaveHandler:Ode,withSaveHandlerSync:Fde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lde(t,e,n){const s=O(t,"labels","confusionMatrix"),r=O(e,"predictions","confusionMatrix");D(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),D(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),D(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),D(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),D(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const i=kd(me(s,"int32"),n),o=kd(me(r,"int32"),n),a=tt(i),l=Xe(a,o);return me(l,"int32")}const Mde=z({confusionMatrix_:Lde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vde=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:Mde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ll,qD=!1;function xj(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Zf(n0,V.backendName)!=null){const f={pixels:t},g={numChannels:e};return V.runKernel(n0,f,g)}const[c,u]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,c,u).data;else if(s||n)d=t.data;else if(i||r||a){if(Ll==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Ll=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Ll=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Ll.canvas.width=c,Ll.canvas.height=u,Ll.drawImage(t,0,0,c,u),d=Ll.getImageData(0,0,c,u).data}let h;if(e===4)h=new Int32Array(d);else{const f=c*u;h=new Int32Array(f*e);for(let g=0;g<f;g++)for(let y=0;y<e;++y)h[g*e+y]=d[g*4+y]}return iC(h,[u,c,e],"int32")}function zde(t){return t!=null&&t.data instanceof Uint8Array}function jde(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function Bde(t){return t!=null&&t.width!==0&&t.height!==0}function Ude(t){return jde()&&!(t instanceof ImageBitmap)&&Bde(t)&&!zde(t)}async function Wde(t,e=3){let n=null;if(X().getBool("WRAP_TO_IMAGEBITMAP")&&Ude(t)){let s;try{s=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===t.width&&s.height===t.height?n=s:n=t}else n=t;return xj(n,e)}function vj(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function Gde(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function Hde(t,e){let n=O(t,"img","toPixels");if(!(t instanceof gt)){const c=n;n=me(c,"int32"),c.dispose()}vj(n);const[s,r]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2],o=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let c=0;c<s*r;++c){const u=[0,0,0,255];for(let h=0;h<i;h++){const p=o[c*i+h];if(n.dtype==="float32"){if(p<0||p>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${p}.`)}else if(n.dtype==="int32"&&(p<0||p>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${p}.`);i===1?(u[0]=p*a,u[1]=p*a,u[2]=p*a):u[h]=p*a}const d=c*4;l[d+0]=Math.round(u[0]),l[d+1]=Math.round(u[1]),l[d+2]=Math.round(u[2]),l[d+3]=Math.round(u[3])}if(e!=null){qD||Zf(Lb,V.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),qD=!0),e.width=r,e.height=s;const c=e.getContext("2d"),u=new ImageData(l,r,s);c.putImageData(u,0,0)}return n!==t&&n.dispose(),l}function qde(t,e,n){let s=O(t,"img","draw");if(!(t instanceof gt)){const o=s;s=me(o,"int32"),o.dispose()}vj(s),Gde(n==null?void 0:n.imageOptions);const r={image:s},i={canvas:e,options:n};V.runKernel(Lb,r,i)}const bj=z({fromPixels_:xj}),Kde=Object.freeze(Object.defineProperty({__proto__:null,draw:qde,fromPixels:bj,fromPixelsAsync:Wde,toPixels:Hde},Symbol.toStringTag,{value:"Module"}));function u1(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(J(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,i=r[r.length-1];let o=1;for(let d=0;d<r.length-1;++d)o*=r[d];const a=t.shape,l=r.slice();l.pop();let c=1;for(let d=i;d<n;++d)c*=a[d],l.push(a[d]);const u=[...Re(t.shape).map(d=>d/c),1].slice(0,i);return[l,o,c,u]}const Xde=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:u1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rT=-2,Yde=-1;function TC(t,e,n){const s=t.shape.length;D(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),D(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)D(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function Qde(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function NC(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function wj(t,e,n,s){const r=[...t];for(let i=r.length;i<s.length;i++)r.push(1);for(let i=0;i<n;i++)i===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function Ij(t,e,n){return n<=t?n:n-(e-1)}function kj(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function Jde(t,e,n,s,r,i,o,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const p=e[0],f=n+1;u=Sj(o,p,f,s,t),d=Tj(a,p,f,r,t),h=wj(i,p,f,t)}else for(let p=0;p<c;p++)u[p]=_j(o,s,i,t,p,l),d[p]=Ej(a,r,i,t,p,l),h[p]=Nj(i,p,l);return{begin:u,end:d,strides:h}}function Sj(t,e,n,s,r){const i=[...r],o=kj(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=0;else{const l=Ij(e,n,a);let c=s[l];t&1<<l&&(c=0),i[a]=c}return i}function Tj(t,e,n,s,r){const i=[...r],o=kj(n,e);for(let a=0;a<i.length;a++)if(o.indexOf(a)>-1)i[a]=Number.MAX_SAFE_INTEGER;else{const l=Ij(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),i[a]=c}for(let a=0;a<i.length;a++){const l=r[a];i[a]<0&&(i[a]+=l),i[a]=rl(0,i[a],r[a])}return i}function Nj(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function _j(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),o=rl(0,o,l-1),o}function Ej(t,e,n,s,r,i){let o=e[r];const a=n[r]||1;(t&1<<r||i&1<<r||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[r];return o<0&&(o+=l),a>0?o=rl(0,o,l):o=rl(-1,o,l-1),o}function _C(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function EC(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function d1(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{D(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(r).fill(-1):typeof n=="number"?i=[n,...new Array(r-1).fill(-1)]:n.length<r?i=n.concat(new Array(r-n.length).fill(-1)):i=n,i=i.map((o,a)=>o>=0?o:(D(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,i]}function CC(t,e,n,s,r,i,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:i,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let w=0;w<d.dims;w++)u&&1<<w&a&&d.numAddAxisAfterEllipsis++,1<<w&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Zde(d,h);let p=!0,f=!0,g=!0;const y=[],x=[];for(let w=0;w<t.length;++w){if(h.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const I=!!(h.shrinkAxisMask&1<<w),N=t[w];if(N===-1){y.push(I?1:-1);continue}const A=[h.beginMask&1<<w,h.endMask&1<<w],T=[h.strides[w]>0?0:-1,h.strides[w]>0?N:N-1];if(I&&h.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&h.strides[w]===1;const S=!!(h.beginMask&1<<w&&h.endMask&1<<w);if(h.beginValid&&h.endValid){if(I){const F=h.begin[w]<0?N+h.begin[w]:h.begin[w];if(h.begin[w]=F,h.end[w]=h.begin[w]+1,F<0||F>=N)throw Error(`slice index ${h.begin[w]} of dimension ${w} out of bounds.`)}else h.begin[w]=KD(h.begin[w],0,h.strides[w],N,A,T),h.end[w]=KD(h.end[w],1,h.strides[w],N,A,T);const P=h.strides[w]===1&&h.begin[w]===0&&h.end[w]===N;p=p&&P,f=f&&(w===0&&h.strides[w]===1||P)}else p=p&&h.strides[w]===1&&S,f=f&&(w===0&&h.strides[w]===1||S);let E,$=!1;if(h.beginValid&&h.endValid?(E=h.end[w]-h.begin[w],$=!0):I?(E=1,$=!0):S&&N>=0&&(h.strides[w]<0?E=-N:E=N,$=!0),$){let P;E===0||E<0!=h.strides[w]<0?P=0:P=Math.trunc(E/h.strides[w])+(E%h.strides[w]!==0?1:0),y.push(P)}else y.push(-1)}for(let w=0;w<h.finalShapeGatherIndices.length;++w){const I=h.finalShapeGatherIndices[w];I>=0?x.push(y[I]):I===rT&&x.push(1)}return{finalShapeSparse:x.filter((w,I)=>h.finalShapeGatherIndices[I]!==rT),finalShape:x,isIdentity:p,sliceDim0:f,isSimpleSlice:g,begin:h.begin,end:h.end,strides:h.strides}}function Zde(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(rT),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Yde),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function KD(t,e,n,s,r,i){if(r[e])return n>0?i[e]:i[e+1&1];{const o=t<0?s+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const Cj=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:TC,computeFlatOffset:EC,computeOutShape:NC,getNormalizedAxes:Jde,isSliceContinous:_C,maskToAxes:Qde,parseSliceParams:d1,sliceInfo:CC,startForAxis:_j,startIndicesWithElidedDims:Sj,stopForAxis:Ej,stopIndicesWithElidedDims:Tj,stridesForAxis:Nj,stridesWithElidedDims:wj},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const ehe="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $j{static sgd(e){return new c1(e)}static momentum(e,n,s=!1){return new bC(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,i=!1){return new wC(e,n,s,r,i)}static adam(e=.001,n=.9,s=.999,r=null){return new xC(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new gC(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,i=0){return new vC(e,n,s,r,i)}static adagrad(e,n=.1){return new yC(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wl=$j;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const the=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function $C(){return new Promise(t=>the(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AC(t,e){const n=t[0].length;t.forEach((r,i)=>{D(r.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),D(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,i)=>{for(let o=0;o<n;o++)D(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${i}.`)})}function Ji(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fi;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(fi||(fi={}));function Aj(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const i=n[r],o=s[s.length-n.length+r],a=s[o];if(i>=0)if(a>=0){if(a!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${i} but shape[${r+t}] = ${a}`)}else s[o]=i}return s}function Rj(t){const e={FIRST_DIM_SIZE:fi.FIRST_DIM_SIZE,VALUE_ROWIDS:fi.VALUE_ROWIDS,ROW_LENGTHS:fi.ROW_LENGTHS,ROW_SPLITS:fi.ROW_SPLITS,ROW_LIMITS:fi.ROW_LIMITS,ROW_STARTS:fi.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function Dj(t){return t.length===0?0:t[0]===fi.FIRST_DIM_SIZE?t.length-1:t.length}function Pj(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const i=t[r],o=e[r+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${i} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RC=30;function h1(t){return t<=RC?t:Zv(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DC(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ry(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(i+1))}return r}function iy(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):r.push(o);s.push(...r),s.push(0),s.push(...i)}return s}function oy(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?s?r.push(e[i-1]*t[i]):r.push(t[i]/e[i-1]):r.push(t[i]);return r}function PC(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function OC(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p1=1.7580993408473768,f1=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FC=.3275911,LC=.254829592,MC=-.284496736,VC=1.421413741,zC=-1.453152027,jC=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function Oj(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function Fj(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function Lj(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function BC(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function Mj(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function Vj(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const i=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(i),s[r]=Math.sin(i)}return{real:n,imag:s}}function zj(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),i=Math.sin(s);return{real:r,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UI="->",nhe=/->/g,XD=",",YD="...";function UC(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(nhe,"").length)/UI.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${UI}").`);const[s,r]=t.split(UI);D(s.indexOf(YD)===-1,()=>`The ellipsis notation ("${YD}") is not supported yet.`);const i=s.split(XD),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const p=r[h];if(!i.some(f=>f.indexOf(p)!==-1))throw new Error(`Output subscripts contain the label ${p} not present in the input subscripts.`);a.indexOf(p)===-1&&a.push(p)}for(let h=0;h<s.length;++h){const p=s[h];a.indexOf(p)===-1&&p!==XD&&a.push(p)}const l=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let p=0;p<i[h].length;++p)l[h].push(a.indexOf(i[h][p]))}const c=a.length,u=r.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function WC(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function GC(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const i=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=i[o]:D(s[e[r][o]]===i[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function HC(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const i=[];for(let o=0;o<n.length;++o){const a=n[o],l=she(e,a);for(const c of l)i.indexOf(c)===-1&&(s[o].push(c),i.push(c))}return{path:n,steps:s}}function qC(t){return t.every((e,n)=>e===n)}function she(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function KC(t,e,n=0){let s=[];if(typeof e=="number")D(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);D(r<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[i]=t.shape[n]-o}D(t.shape[n]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jj(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function Bj(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function Uj(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wj(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function Gj(t,e){return`size ${t} must be non-negative, not ${e}`}function Hj(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function qj(t,e){const n=J(t),s=J(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function Kj(t,e){const n=J(t),s=J(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iT(){return"segment ids must be >= 0"}function Xj(){return"segment ids are not increasing"}function Yj(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Qj(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jj(t,e){let n=!1,s;for(t<=RC?(s=t,n=!0):s=Zv(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=Zv(t,s+1);return s}function Zj(t,e,n){const s=[],r=t.length;for(let i=0;i<r;i++)i!==e?s.push(t[i]):s.push(n);return s}function XC(t,e,n,s){const r=e.shape.length,i=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>i)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${i}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<i;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:o,outputShape:a}}const rhe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:XC,computeOutShape:Zj,segOpComputeOptimalWindowSize:Jj},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yo(t){try{return t.map(e=>Ho(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function eB(t){return t.map(e=>Yi(e))}const tB=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:LC,ERF_A2:MC,ERF_A3:VC,ERF_A4:zC,ERF_A5:jC,ERF_P:FC,PARALLELIZE_THRESHOLD:RC,get RowPartitionType(){return fi},SELU_SCALE:f1,SELU_SCALEALPHA:p1,applyActivation:r1,assertAndGetBroadcastShape:Ue,assertAxesAreInnerMostDims:qn,assertParamsConsistent:AC,assignToTypedArray:Mj,axesAreInnerMostDims:RE,calculateShapes:El,checkEinsumDimSizes:GC,checkPadOnDimRoundingMode:Cs,combineLocations:fz,combineRaggedTensorToTensorShapes:Aj,complexWithEvenIndex:Fj,complexWithOddIndex:Lj,computeConv2DInfo:On,computeConv3DInfo:Sl,computeDefaultPad:fE,computeDilation2DInfo:jg,computeOptimalWindowSize:h1,computeOutAndReduceShapes:Fn,computeOutShape:Ji,computePool2DInfo:Zr,computePool3DInfo:ra,convertConv2DDataFormat:ia,decodeEinsumEquation:UC,eitherStridesOrDilationsAreOne:Hn,expandShapeToKeepDim:an,exponent:zj,exponents:Vj,fromStringArrayToUint8:eB,fromUint8ToStringArray:Yo,getAxesPermutation:qt,getBroadcastDims:Fc,getComplexWithIndex:BC,getEinsumComputePath:HC,getEinsumPermutation:WC,getFusedBiasGradient:s1,getFusedDyActivation:n1,getImageCenter:DC,getInnerMostAxes:cn,getPermuted:iy,getRaggedRank:Dj,getReductionAxes:yn,getReshaped:ry,getReshapedPermuted:oy,getRowPartitionTypesHelper:Rj,getSliceBeginCoords:PC,getSliceSize:OC,getSparseFillEmptyRowsIndicesDenseShapeMismatch:jj,getSparseFillEmptyRowsNegativeIndexErrorMessage:Bj,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:Uj,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:Hj,getSparseReshapeInputOutputMismatchErrorMessage:Kj,getSparseReshapeInputOutputMultipleErrorMessage:qj,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:Wj,getSparseReshapeNegativeOutputDimErrorMessage:Gj,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:Qj,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:iT,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:Xj,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:Yj,getUndoAxesPermutation:Tl,isIdentityPermutation:qC,log:Qse,mergeRealAndImagArrays:Xo,prepareAndValidate:u1,prepareSplitSize:KC,segment_util:rhe,shouldFuse:i1,slice_util:Cj,splitRealAndImagArrays:Oj,stridesOrDilationsArePositive:Oc,tupleValuesAreOne:ll,upcastType:Ms,validateDefaultValueShape:Pj,validateInput:Qw,validateUpdateShape:oC,warn:yr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ihe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:o1,nonMaxSuppressionV4Impl:a1,nonMaxSuppressionV5Impl:l1,whereImpl:e1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */vde();const ohe=Object.freeze(Object.defineProperty({__proto__:null,Abs:Fm,Acos:Gd,Acosh:Hd,AdadeltaOptimizer:gC,AdagradOptimizer:yC,AdamOptimizer:xC,AdamaxOptimizer:vC,Add:tu,AddN:Lm,All:bb,Any:wb,ArgMax:Mm,ArgMin:Vm,Asin:qd,Asinh:Kd,Atan:Xd,Atan2:Qd,Atanh:Yd,AvgPool:zm,AvgPool3D:jm,AvgPool3DGrad:kb,AvgPoolGrad:Ib,BatchMatMul:Bm,BatchToSpaceND:Um,Bincount:Sb,BitwiseAnd:Wm,BroadcastArgs:Tb,BroadcastTo:NV,Cast:Jd,Ceil:Zd,ClipByValue:eh,Complex:Nb,ComplexAbs:Gm,Concat:Hm,Conv2D:qm,Conv2DBackpropFilter:_b,Conv2DBackpropInput:Km,Conv3D:Xm,Conv3DBackpropFilterV2:Eb,Conv3DBackpropInputV2:Cb,Cos:th,Cosh:nh,CropAndResize:Ab,Cumprod:$b,Cumsum:Ym,DataStorage:B_,DenseBincount:Rb,DepthToSpace:Db,DepthwiseConv2dNative:Qm,DepthwiseConv2dNativeBackpropFilter:Pb,DepthwiseConv2dNativeBackpropInput:Ob,Diag:Fb,Dilation2D:Jm,Dilation2DBackpropFilter:t0,Dilation2DBackpropInput:e0,Draw:Lb,get ENV(){return q_},Einsum:Mb,Elu:rh,EluGrad:Vb,Environment:SV,Equal:Zm,Erf:ih,Exp:oh,ExpandDims:eg,Expm1:ah,FFT:zb,Fill:jb,FlipLeftRight:Bb,Floor:lh,FloorDiv:ch,FromPixels:n0,FusedBatchNorm:tg,FusedConv2D:Yf,FusedDepthwiseConv2D:Qf,GatherNd:Ub,GatherV2:ng,Greater:sg,GreaterEqual:uh,IFFT:Wb,Identity:dh,Imag:Gb,IsFinite:hh,IsInf:ph,IsNan:fh,KernelBackend:yb,LRN:ug,LRNGrad:qb,LeakyRelu:rg,Less:ig,LessEqual:og,LinSpace:Hb,Log:mh,Log1p:gh,LogSoftmax:_V,LogicalAnd:ag,LogicalNot:lg,LogicalOr:cg,LogicalXor:Hse,LowerBound:qse,MatrixBandPart:Kse,Max:dg,MaxPool:hg,MaxPool3D:pg,MaxPool3DGrad:Xb,MaxPoolGrad:Kb,MaxPoolWithArgmax:Yb,Maximum:yh,Mean:fg,Min:mg,Minimum:xh,MirrorPad:gg,Mod:vh,MomentumOptimizer:bC,Multinomial:Qb,Multiply:bh,Neg:yg,NonMaxSuppressionV3:Jb,NonMaxSuppressionV4:Zb,NonMaxSuppressionV5:ew,NotEqual:xg,OP_SCOPE_SUFFIX:eE,OneHot:bg,OnesLike:vg,Optimizer:ua,OptimizerConstructors:$j,Pack:wg,PadV2:Ig,Pool:Xse,Pow:wh,Prelu:kg,Prod:Sg,RMSPropOptimizer:wC,RaggedGather:tw,RaggedRange:nw,RaggedTensorToTensor:sw,Range:rw,get Rank(){return jS},Real:iw,RealDiv:sh,Reciprocal:Ih,get Reduction(){return Is},Relu:kh,Relu6:Sh,Reshape:Tg,ResizeBilinear:_g,ResizeBilinearGrad:aw,ResizeNearestNeighbor:Ng,ResizeNearestNeighborGrad:ow,Reverse:Eg,RotateWithOffset:Sw,Round:Th,Rsqrt:Nh,SGDOptimizer:c1,ScatterNd:lw,SearchSorted:uw,Select:Cg,Selu:_h,Sigmoid:Ah,Sign:$h,Sin:Eh,Sinh:Ch,Slice:$g,Softmax:Pg,Softplus:Rh,SpaceToBatchND:Rg,SparseFillEmptyRows:dw,SparseReshape:hw,SparseSegmentMean:pw,SparseSegmentSum:fw,SparseToDense:mw,SplitV:Dg,Sqrt:Dh,Square:gw,SquaredDifference:Ph,StaticRegexReplace:Og,Step:Vh,StridedSlice:yw,StringNGrams:xw,StringSplit:vw,StringToHashBucketFast:bw,Sub:Oh,Sum:Ag,Tan:Fh,Tanh:Lh,Tensor:gt,TensorBuffer:gn,TensorScatterUpdate:cw,Tile:Mh,TopK:ww,Transform:Iw,Transpose:fc,Unique:kw,Unpack:Fg,UnsortedSegmentSum:Lg,UpperBound:Yse,Variable:em,ZerosLike:Mg,_FusedMatMul:Xf,abs:pn,acos:oE,acosh:aE,add:oe,addN:az,all:Ew,any:nm,argMax:Pc,argMin:lE,asin:cE,asinh:uE,atan:dE,atan2:hE,atanh:pE,avgPool:Bg,avgPool3d:mE,backend:nE,backend_util:tB,basicLSTMCell:lz,batchNorm:zh,batchNorm2d:gE,batchNorm3d:yE,batchNorm4d:xE,batchToSpaceND:Ug,bincount:vE,bitwiseAnd:cz,booleanMaskAsync:Kz,broadcastArgs:uz,broadcastTo:mc,broadcast_util:$oe,browser:Kde,buffer:qe,cast:me,ceil:bE,clipByValue:zs,clone:Qi,complex:qo,concat:rn,concat1d:wE,concat2d:IE,concat3d:kE,concat4d:SE,conv1d:Cw,conv2d:Ko,conv2dTranspose:$w,conv3d:NE,conv3dTranspose:_E,copyRegisteredKernels:ere,cos:Wg,cosh:Aw,cosineWindow:t1,cumprod:im,cumsum:Rw,customGrad:io,denseBincount:i0,deprecationWarn:Dre,depthToSpace:EE,depthwiseConv2d:jh,device_util:_re,diag:hz,dilation2d:CE,disableDeprecationWarnings:Rre,dispose:Ye,disposeVariables:Pre,div:Ee,divNoNan:$E,dot:AE,dropout:dC,einsum:Kl,elu:Bh,enableDebugMode:Are,enableProdMode:$re,enclosingPowerOfTwo:hC,engine:ui,ensureShape:pz,env:X,equal:Jr,erf:Dw,euclideanNorm:DE,exp:js,expandDims:ns,expm1:PE,eye:Pw,fft:ny,fill:su,findBackend:zre,findBackendFactory:jre,floor:Wh,floorDiv:_w,fused:sj,gather:Gh,gatherND:Jz,gather_util:Xde,getBackend:HV,getGradient:MS,getKernel:Zf,getKernelsForBackend:s0,grad:pae,grads:fae,greater:Hs,greaterEqual:oa,ifft:Nd,imag:Gg,image:Wr,inTopKAsync:Zz,io:SC,irfft:Xw,isFinite:OE,isInf:FE,isNaN:LE,keep:wn,kernel_impls:ihe,leakyRelu:Hg,less:Id,lessEqual:Nl,linalg:mC,linspace:gz,localResponseNormalization:ME,log:or,log1p:qg,logSigmoid:VE,logSoftmax:Fw,logSumExp:Kg,logicalAnd:Si,logicalNot:Xg,logicalOr:Lw,logicalXor:zE,losses:uj,lowerBound:xz,matMul:Xe,math:Vde,max:Nr,maxPool:Yg,maxPool3d:jE,maxPoolWithArgmax:vz,maximum:ho,mean:Wt,memory:qS,meshgrid:bz,min:wd,minimum:ul,mirrorPad:BE,mod:UE,moments:Qg,movingAverage:Xz,mul:j,multiRNNCell:wz,multinomial:Iz,neg:At,nextFrame:$C,norm:Uh,notEqual:Lc,oneHot:kd,ones:Os,onesLike:ar,op:z,outerProduct:kz,pad:aa,pad1d:Sz,pad2d:Tz,pad3d:Nz,pad4d:_z,pool:WE,pow:ro,prelu:Zg,print:iE,prod:GE,profile:Ore,raggedGather:Ez,raggedRange:Cz,raggedTensorToTensor:$z,rand:Az,randomGamma:Oz,randomNormal:zw,randomStandardNormal:Fz,randomUniform:_l,randomUniformInt:Lz,range:Mc,ready:Mre,real:Sd,reciprocal:tC,registerBackend:tE,registerGradient:EV,registerKernel:Tw,relu:Ai,relu6:jw,removeBackend:Vre,reshape:U,reverse:Er,reverse1d:Mz,reverse2d:Vz,reverse3d:zz,reverse4d:jz,rfft:sy,round:Bw,rsqrt:Uw,scalar:Pe,scatterND:Yz,scatter_util:gce,searchSorted:Mw,selu:Ww,separableConv2d:Gw,serialization:yde,setBackend:Lre,setPlatform:Bre,setdiff1dAsync:Bz,sigmoid:bi,sign:nC,signal:cj,sin:Hw,sinh:qw,slice:et,slice1d:ey,slice2d:Kw,slice3d:ty,slice4d:Td,slice_util:Cj,softmax:Hh,softplus:ru,spaceToBatchND:Jg,sparse:dj,sparseToDense:Qz,spectral:lj,split:Ls,sqrt:Pn,square:wt,squaredDifference:Yw,squeeze:la,stack:Bs,step:ou,stridedSlice:sC,string:hj,sub:Ie,sum:Te,sumOutType:Nw,tan:rC,tanh:cl,tensor:Kr,tensor1d:rs,tensor2d:Zu,tensor3d:iC,tensor4d:Uz,tensor5d:Wz,tensor6d:Gz,tensorScatterUpdate:Hz,tensor_util:Ire,test_util:Cle,tidy:K,tile:Ir,time:Fre,topk:aC,train:Wl,transpose:tt,truncatedNormal:Jw,unique:lC,unregisterGradient:Zse,unregisterKernel:Jse,unsortedSegmentSum:Zw,unstack:Cr,upcastType:Ms,upperBound:qz,util:cre,valueAndGrad:mae,valueAndGrads:gae,variable:cC,variableGrads:yz,version_core:ehe,where:Un,whereAsync:uC,zeros:sn,zerosLike:nt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ahe=X();ahe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Xs;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Xs||(Xs={}));var QD;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(QD||(QD={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe={};function nB(t){return lhe[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _(t,e,n,s,r){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const a=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd,c=a<0?e.inputNames.length+a:a;if(i.type==="tensor")return zn(e.inputNames[c],n,s,r);if(i.type==="tensors"){const h=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((f,g)=>{var y;return((y=h[g])===null||y===void 0?void 0:y.op)!=="NoOp"}).map(f=>zn(f,n,s,r))}const u=zn(e.inputNames[c],n,s,r),d=u.dataSync();return i.type==="number"?d[0]:Tr(u.shape,d)}const o=e.attrParams[t];return o&&o.value}function zn(t,e,n,s){const[r,i]=Ys(t,n);if(s!=null){const a=s.getHashTableHandleByName(r);if(a!=null)return a}const o=n.currentContextIds.find(a=>!!e[o0(r,a)]);return o!==void 0?e[o0(r,o)][i]:void 0}function JD(t,e,n){return e[o0(t,n.currentContextId)]}function wo(t,e){const[n,s,r]=Ys(t,e);return[o0(n,e&&e.currentContextId),s,r]}function o0(t,e){return e?`${t}-${e}`:t}function Ys(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const i=e.parseNodeNameCache.get(t);if(i!=null)return i}const s=t.split(":");let r;if(s.length===1)r=[t,0,void 0];else{const i=s[0],o=s.length===3?s[1]:void 0,a=Number(s[s.length-1]);r=[i,a,o]}return n&&e.parseNodeNameCache.set(t,r),r}function Zx(t,e,n){let s=_("pad",t,e,n);if(s==="explicit"){s=_("explicitPaddings",t,e,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)r[i][0]=s[i*2],r[i][1]=s[i*2+1];return r}return s}function Io(t){return t.kept?t:Qi(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const che=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],uhe=Object.freeze(Object.defineProperty({__proto__:null,json:che},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dhe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],hhe=Object.freeze(Object.defineProperty({__proto__:null,json:dhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const phe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],fhe=Object.freeze(Object.defineProperty({__proto__:null,json:phe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mhe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],ghe=Object.freeze(Object.defineProperty({__proto__:null,json:mhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yhe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],xhe=Object.freeze(Object.defineProperty({__proto__:null,json:yhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vhe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],bhe=Object.freeze(Object.defineProperty({__proto__:null,json:vhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const whe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Ihe=Object.freeze(Object.defineProperty({__proto__:null,json:whe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const khe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],She=Object.freeze(Object.defineProperty({__proto__:null,json:khe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Nhe=Object.freeze(Object.defineProperty({__proto__:null,json:The},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _he=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Ehe=Object.freeze(Object.defineProperty({__proto__:null,json:_he},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Che=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],$he=Object.freeze(Object.defineProperty({__proto__:null,json:Che},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ahe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Rhe=Object.freeze(Object.defineProperty({__proto__:null,json:Ahe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dhe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Phe=Object.freeze(Object.defineProperty({__proto__:null,json:Dhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ohe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Fhe=Object.freeze(Object.defineProperty({__proto__:null,json:Ohe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lhe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Mhe=Object.freeze(Object.defineProperty({__proto__:null,json:Lhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vhe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],zhe=Object.freeze(Object.defineProperty({__proto__:null,json:Vhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jhe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Bhe=Object.freeze(Object.defineProperty({__proto__:null,json:jhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uhe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Whe=Object.freeze(Object.defineProperty({__proto__:null,json:Uhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ghe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Hhe=Object.freeze(Object.defineProperty({__proto__:null,json:Ghe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZD{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[uhe,hhe,fhe,ghe,xhe,bhe,Ihe,She,Nhe,Ehe,$he,Rhe,Phe,Fhe,Mhe,zhe,Bhe,Whe,Hhe],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,n={}){const s=e.node,r=[],i=[],o=[],a=s.reduce((g,y)=>(g[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?r.push(g[y.name]):y.op==="Const"?i.push(g[y.name]):(y.input==null||y.input.length===0)&&o.push(g[y.name]),g),{});let l=[];const c=[];let u={},d={};n!=null&&(u=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(a);h.forEach(g=>{const y=a[g];y.inputNames.forEach((x,v)=>{const[w,,I]=wo(x),N=a[w];if(N.outputs!=null){const A=N.outputs.indexOf(I);if(A!==-1){const T=`${w}:${A}`;y.inputNames[v]=T}}y.inputs.push(N),N.children.push(y)})}),Object.keys(d).length===0?h.forEach(g=>{const y=a[g];y.children.length===0&&c.push(y)}):Object.keys(d).forEach(g=>{const[y]=wo(g),x=a[y];x!=null&&(x.signatureKey=d[g],c.push(x))}),Object.keys(u).length>0?Object.keys(u).forEach(g=>{const[y]=wo(g),x=a[y];x&&(x.signatureKey=u[g],l.push(x))}):l=r;let p={};e.library!=null&&e.library.function!=null&&(p=e.library.function.reduce((g,y)=>(g[y.signature.name]=this.mapFunction(y),g),{}));const f={nodes:a,inputs:l,outputs:c,weights:i,placeholders:r,signature:n,functions:p};return o.length>0&&(f.initNodes=o),f}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=nB(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,i)=>(r[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,i)=>{const o=i.type;let a;switch(i.type){case"string":a=oT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=oT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":a=pT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=pT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":a=lT(e.attr,i.tfName,i.defaultValue||0),a===void 0&&i.tfDeprecatedName&&(a=lT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":a=hT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=hT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":a=aT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=aT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":a=mT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=mT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":a=dT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=dT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":a=fT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=fT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":a=cT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=cT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":a=uT(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=uT(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":a=eP(e.attr,i.tfName,i.defaultValue),a===void 0&&i.tfDeprecatedName&&(a=eP(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return r[i.name]={value:a,type:o},r},{})),s}mapFunction(e){const n=e.nodeDef,s=[],r=[];let i={};n!=null&&(i=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&r.push(d[h.name]),d),{}));const o=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=wo(d.name),p={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:YC(d.type),type:"dtype"}},children:[]};p.signatureKey=d.name,o.push(p),i[h]=p}),Object.keys(i).forEach(d=>{const h=i[d];h.inputNames.forEach((p,f)=>{const[g,,y]=wo(p),x=i[g];if(x.outputs!=null){const v=x.outputs.indexOf(y);if(v!==-1){const w=`${g}:${v}`;h.inputNames[f]=w}}h.inputs.push(x),x.children.push(h)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[h,p]=wo(c[d.name]),f=i[h];f!=null&&(f.defaultOutput=p,a.push(f))});const u=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:a,weights:r,placeholders:s,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function qhe(t){const e=X().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function sB(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):qhe(t);return e?n:n.toLowerCase()}function oT(t,e,n,s=!1){const r=t[e];return r!=null?sB(r.s,s):n}function aT(t,e,n){const s=t[e];return s?s.b:n}function lT(t,e,n){const s=t[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function YC(t){switch(typeof t=="string"&&(t=Xs[t]),t){case Xs.DT_FLOAT:case Xs.DT_HALF:return"float32";case Xs.DT_INT32:case Xs.DT_INT64:case Xs.DT_INT8:case Xs.DT_UINT8:return"int32";case Xs.DT_BOOL:return"bool";case Xs.DT_DOUBLE:return"float32";case Xs.DT_STRING:return"string";case Xs.DT_COMPLEX64:case Xs.DT_COMPLEX128:return"complex64";default:return null}}function eP(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function cT(t,e,n){const s=t[e];return s&&s.type?YC(s.type):n}function uT(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(r=>YC(r)):n}function rB(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function dT(t,e,n){const s=t[e];return s&&s.shape?rB(s.shape):n}function hT(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function pT(t,e,n,s=!1){const r=t[e];return r&&r.list&&r.list.s?r.list.s.map(i=>sB(i,s)):n}function fT(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>rB(r)):n}function mT(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Khe{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,i)=>(r[i]=this.getAttr(i),r),{}))}getInput(e){return zn(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return zn(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return lT(this.node.rawAttrs,e,n);if(s.s!=null)return oT(this.node.rawAttrs,e,n);if(s.b!=null)return aT(this.node.rawAttrs,e,n);if(s.shape!=null)return dT(this.node.rawAttrs,e,n);if(s.type!=null)return cT(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return hT(this.node.rawAttrs,e,n);if(s.list.s!=null)return pT(this.node.rawAttrs,e,n);if(s.list.shape!=null)return fT(this.node.rawAttrs,e,n);if(s.list.b!=null)return mT(this.node.rawAttrs,e,n);if(s.list.type!=null)return uT(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:eE,abs:pn,acos:oE,acosh:aE,add:oe,addN:az,all:Ew,any:nm,argMax:Pc,argMin:lE,asin:cE,asinh:uE,atan:dE,atan2:hE,atanh:pE,avgPool:Bg,avgPool3d:mE,basicLSTMCell:lz,batchNorm:zh,batchNorm2d:gE,batchNorm3d:yE,batchNorm4d:xE,batchToSpaceND:Ug,bincount:vE,bitwiseAnd:cz,booleanMaskAsync:Kz,broadcastArgs:uz,broadcastTo:mc,buffer:qe,cast:me,ceil:bE,clipByValue:zs,clone:Qi,complex:qo,concat:rn,concat1d:wE,concat2d:IE,concat3d:kE,concat4d:SE,conv1d:Cw,conv2d:Ko,conv2dTranspose:$w,conv3d:NE,conv3dTranspose:_E,cos:Wg,cosh:Aw,cosineWindow:t1,cumprod:im,cumsum:Rw,denseBincount:i0,depthToSpace:EE,depthwiseConv2d:jh,diag:hz,dilation2d:CE,div:Ee,divNoNan:$E,dot:AE,dropout:dC,einsum:Kl,elu:Bh,enclosingPowerOfTwo:hC,ensureShape:pz,equal:Jr,erf:Dw,euclideanNorm:DE,exp:js,expandDims:ns,expm1:PE,eye:Pw,fft:ny,fill:su,floor:Wh,floorDiv:_w,fused:sj,gather:Gh,gatherND:Jz,greater:Hs,greaterEqual:oa,ifft:Nd,imag:Gg,image:Wr,inTopKAsync:Zz,irfft:Xw,isFinite:OE,isInf:FE,isNaN:LE,leakyRelu:Hg,less:Id,lessEqual:Nl,linalg:mC,linspace:gz,localResponseNormalization:ME,log:or,log1p:qg,logSigmoid:VE,logSoftmax:Fw,logSumExp:Kg,logicalAnd:Si,logicalNot:Xg,logicalOr:Lw,logicalXor:zE,losses:uj,lowerBound:xz,matMul:Xe,max:Nr,maxPool:Yg,maxPool3d:jE,maxPoolWithArgmax:vz,maximum:ho,mean:Wt,meshgrid:bz,min:wd,minimum:ul,mirrorPad:BE,mod:UE,moments:Qg,movingAverage:Xz,mul:j,multiRNNCell:wz,multinomial:Iz,neg:At,norm:Uh,notEqual:Lc,oneHot:kd,ones:Os,onesLike:ar,op:z,outerProduct:kz,pad:aa,pad1d:Sz,pad2d:Tz,pad3d:Nz,pad4d:_z,pool:WE,pow:ro,prelu:Zg,print:iE,prod:GE,raggedGather:Ez,raggedRange:Cz,raggedTensorToTensor:$z,rand:Az,randomGamma:Oz,randomNormal:zw,randomStandardNormal:Fz,randomUniform:_l,randomUniformInt:Lz,range:Mc,real:Sd,reciprocal:tC,relu:Ai,relu6:jw,reshape:U,reverse:Er,reverse1d:Mz,reverse2d:Vz,reverse3d:zz,reverse4d:jz,rfft:sy,round:Bw,rsqrt:Uw,scalar:Pe,scatterND:Yz,searchSorted:Mw,selu:Ww,separableConv2d:Gw,setdiff1dAsync:Bz,sigmoid:bi,sign:nC,signal:cj,sin:Hw,sinh:qw,slice:et,slice1d:ey,slice2d:Kw,slice3d:ty,slice4d:Td,softmax:Hh,softplus:ru,spaceToBatchND:Jg,sparse:dj,sparseToDense:Qz,spectral:lj,split:Ls,sqrt:Pn,square:wt,squaredDifference:Yw,squeeze:la,stack:Bs,step:ou,stridedSlice:sC,string:hj,sub:Ie,sum:Te,tan:rC,tanh:cl,tensor:Kr,tensor1d:rs,tensor2d:Zu,tensor3d:iC,tensor4d:Uz,tensor5d:Wz,tensor6d:Gz,tensorScatterUpdate:Hz,tile:Ir,topk:aC,transpose:tt,truncatedNormal:Jw,unique:lC,unsortedSegmentSum:Zw,unstack:Cr,upperBound:qz,variable:cC,where:Un,whereAsync:uC,zeros:sn,zerosLike:nt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xhe=(t,e,n,s=Kn)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(_("a",t,e,n),_("b",t,e,n))];case"AddN":return[s.addN(_("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(_("a",t,e,n),_("b",t,e,n))];case"Mul":return[s.mul(_("a",t,e,n),_("b",t,e,n))];case"RealDiv":case"Div":return[s.div(_("a",t,e,n),_("b",t,e,n))];case"DivNoNan":return[s.divNoNan(_("a",t,e,n),_("b",t,e,n))];case"FloorDiv":return[s.floorDiv(_("a",t,e,n),_("b",t,e,n))];case"Sub":return[s.sub(_("a",t,e,n),_("b",t,e,n))];case"Minimum":return[s.minimum(_("a",t,e,n),_("b",t,e,n))];case"Maximum":return[s.maximum(_("a",t,e,n),_("b",t,e,n))];case"Pow":return[s.pow(_("a",t,e,n),_("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(_("a",t,e,n),_("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yhe=(t,e,n,s=Kn)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(_("x",t,e,n))];case"Acos":return[s.acos(_("x",t,e,n))];case"Acosh":return[s.acosh(_("x",t,e,n))];case"Asin":return[s.asin(_("x",t,e,n))];case"Asinh":return[s.asinh(_("x",t,e,n))];case"Atan":return[s.atan(_("x",t,e,n))];case"Atan2":return[s.atan2(_("x",t,e,n),_("y",t,e,n))];case"Atanh":return[s.atanh(_("x",t,e,n))];case"Ceil":return[s.ceil(_("x",t,e,n))];case"Complex":return[s.complex(_("real",t,e,n),_("imag",t,e,n))];case"Cos":return[s.cos(_("x",t,e,n))];case"Cosh":return[s.cosh(_("x",t,e,n))];case"Elu":return[s.elu(_("x",t,e,n))];case"Erf":return[s.erf(_("x",t,e,n))];case"Exp":return[s.exp(_("x",t,e,n))];case"Expm1":return[s.expm1(_("x",t,e,n))];case"Floor":return[s.floor(_("x",t,e,n))];case"Log":return[s.log(_("x",t,e,n))];case"Log1p":return[s.log1p(_("x",t,e,n))];case"Imag":return[s.imag(_("x",t,e,n))];case"Neg":return[s.neg(_("x",t,e,n))];case"Reciprocal":return[s.reciprocal(_("x",t,e,n))];case"Real":return[s.real(_("x",t,e,n))];case"Relu":return[s.relu(_("x",t,e,n))];case"Round":return[s.round(_("x",t,e,n))];case"Selu":return[s.selu(_("x",t,e,n))];case"Sigmoid":return[s.sigmoid(_("x",t,e,n))];case"Sin":return[s.sin(_("x",t,e,n))];case"Sign":return[s.sign(_("x",t,e,n))];case"Sinh":return[s.sinh(_("x",t,e,n))];case"Softplus":return[s.softplus(_("x",t,e,n))];case"Sqrt":return[s.sqrt(_("x",t,e,n))];case"Square":return[s.square(_("x",t,e,n))];case"Tanh":return[s.tanh(_("x",t,e,n))];case"Tan":return[s.tan(_("x",t,e,n))];case"ClipByValue":return[s.clipByValue(_("x",t,e,n),_("clipValueMin",t,e,n),_("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(_("x",t,e,n))];case"Rsqrt":return[s.rsqrt(zn(t.inputNames[0],e,n))];case"LeakyRelu":return[s.leakyRelu(_("x",t,e,n),_("alpha",t,e,n))];case"Prelu":return[s.prelu(_("x",t,e,n),_("alpha",t,e,n))];case"IsNan":return[s.isNaN(zn(t.inputNames[0],e,n))];case"IsInf":return[s.isInf(zn(t.inputNames[0],e,n))];case"IsFinite":return[s.isFinite(zn(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){D(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const r=t[s],i=e[s];D(r<0||i<0||r===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function tP(t){return!(typeof t=="number"||t.some(e=>e<0))}function Ap(t,e,n){let s=gT(t,n);const r=!tP(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(i=>{s=gT(i.shape,s)}),!tP(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function gT(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const r=t[s],i=e[s];if(r>=0&&i>=0&&r!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=r>=0?r:i}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qhe{constructor(e,n,s,r,i,o,a){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=Pe(0),wn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Fr(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,wn(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,r)=>this.write(s,n[r]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Kr([],[0].concat(this.elementShape));const s=this.readMany(e);return Fr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Bs(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Kr([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return Fr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),rn(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,Cr(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=s===0?0:n.size/s,o=[];K(()=>{n=U(n,[1,s,i]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:r[l-1],0],d=[1,e[l],i];o[l]=U(et(n,u,d),this.elementShape)}return o});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zc{get id(){return this.idTensor.id}constructor(e,n,s,r=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(i=>{if(s!==i.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${i.dtype}`);Fr(n,i.shape,"TensorList shape mismatch: "),wn(i)}),this.idTensor=Pe(0),this.maxNumElements=r,wn(this.idTensor)}copy(){return new zc([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);Fr(e,this.elementShape,"TensorList shape mismatch: ");const r=Ap(this.elementShape,this.tensors,e);return K(()=>{const i=this.tensors.map(o=>U(o,r));return Bs(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Ap(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Fr(r.shape,e,"TensorList shape mismatch: "),U(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Fr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");wn(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new zc([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Fr(this.tensors[e].shape,n,"TensorList shape mismatch: ");const r=Ap(this.elementShape,this.tensors,n);return U(this.tensors[e],r)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Fr(this.elementShape,n.shape,"TensorList shape mismatch: "),wn(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Fr(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=Ap(this.elementShape,this.tensors,s);return e.length===0?Kr([],[0].concat(r)):K(()=>{const i=e.map(o=>U(this.tensors[o],r));return Bs(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Fr(this.elementShape,n,"TensorList shape mismatch: ");const s=Ap(this.elementShape,this.tensors,n);return this.size()===0?Kr([],[0].concat(s)):K(()=>{const r=this.tensors.map(i=>U(i,s));return rn(r,0)})}}function Jhe(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const r=t.shape.slice(1);Fr(r,e,"TensorList shape mismatch: ");const i=Cr(t);return new zc(i,e,s)}function Zhe(t,e,n,s){return new zc([],t,e,s)}function epe(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const i=new zc([],n,t.dtype,s),o=Cr(t,0);return e.forEach((a,l)=>{i.setItem(a,o[l])}),i}function tpe(t,e,n){let s=0;const r=e.map(u=>(s+=u,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=gT(i,n),a=s===0?0:t.size/s,l=K(()=>{const u=[];t=U(t,[1,s,a]);for(let d=0;d<e.length;++d){const p=[0,d===0?0:r[d-1],0],f=[1,e[d],a];u[d]=U(et(t,p,f),o)}return t.dispose(),u}),c=new zc([],n,t.dtype,e.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const npe=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=_("thenBranch",t,e,n),r=_("elseBranch",t,e,n),i=_("cond",t,e,n),o=_("args",t,e,n);return(await i.data())[0]?n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=_("body",t,e,n),r=_("cond",t,e,n),i=_("args",t,e,n),o=await n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),a=i.map(u=>u.id);let l=await o[0].data();o.forEach(u=>{!u.kept&&a.indexOf(u.id)===-1&&u.dispose()});let c=i;for(;l[0];){const u=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const d=c.map(p=>p.id);u.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()});const h=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await h[0].data(),h.forEach(p=>{!p.kept&&a.indexOf(p.id)===-1&&d.indexOf(p.id)===-1&&p.dispose()})}return c}case"LoopCond":{const s=_("pred",t,e,n);return[Io(s)]}case"Switch":{const s=_("pred",t,e,n);let r=_("data",t,e,n);return r.kept||(r=Io(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=t.inputNames.find(r=>zn(r,e,n)!==void 0);if(s){const r=zn(s,e,n);return[Io(r)]}return}case"Enter":{const s=_("frameName",t,e,n),r=_("tensor",t,e,n);return n.enterFrame(s),[Io(r)]}case"Exit":{const s=_("tensor",t,e,n);return n.exitFrame(),[Io(s)]}case"NextIteration":{const s=_("tensor",t,e,n);return n.nextIteration(),[Io(s)]}case"TensorArrayV3":{const s=_("size",t,e,n),r=_("dtype",t,e,n),i=_("elementShape",t,e,n),o=_("dynamicSize",t,e,n),a=_("clearAfterRead",t,e,n),l=_("identicalElementShapes",t,e,n),c=_("name",t,e,n),u=new Qhe(c,r,s,i,l,o,a);return n.addTensorArray(u),[u.idTensor,Pe(1)]}case"TensorArrayWriteV3":{const s=_("tensorArrayId",t,e,n),r=_("index",t,e,n),i=_("tensor",t,e,n),o=n.getTensorArray(s.id);return o.write(r,i),[o.idTensor]}case"TensorArrayReadV3":{const s=_("tensorArrayId",t,e,n),r=_("index",t,e,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=_("tensorArrayId",t,e,n),r=_("indices",t,e,n),i=_("dtype",t,e,n);return[n.getTensorArray(s.id).gather(r,i)]}case"TensorArrayScatterV3":{const s=_("tensorArrayId",t,e,n),r=_("indices",t,e,n),i=_("tensor",t,e,n),o=n.getTensorArray(s.id);return o.scatter(r,i),[o.idTensor]}case"TensorArrayConcatV3":{const s=_("tensorArrayId",t,e,n),r=n.getTensorArray(s.id),i=_("dtype",t,e,n);return[r.concat(i)]}case"TensorArraySplitV3":{const s=_("tensorArrayId",t,e,n),r=_("tensor",t,e,n),i=_("lengths",t,e,n),o=n.getTensorArray(s.id);return o.split(i,r),[o.idTensor]}case"TensorArraySizeV3":{const s=_("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return[Pe(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=_("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=_("tensorListId",t,e,n),r=_("index",t,e,n),i=_("tensor",t,e,n),o=n.getTensorList(s.id);return o.setItem(r,i),[o.idTensor]}case"TensorListGetItem":{const s=_("tensorListId",t,e,n),r=_("index",t,e,n),i=_("elementShape",t,e,n),o=_("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(r,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=_("indices",t,e,n),r=_("tensor",t,e,n),i=_("elementShape",t,e,n),o=_("numElements",t,e,n),a=epe(r,s,i,o);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=_("elementShape",t,e,n),r=_("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=_(i,t,e,n),a=t.op==="TensorListReserve"?-1:o,l=Zhe(s,r,o,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=_("tensorListId",t,e,n),r=_("indices",t,e,n),i=_("elementShape",t,e,n),o=_("elementDType",t,e,n);return[n.getTensorList(s.id).gather(r,o,i)]}case"TensorListStack":{const s=_("tensorListId",t,e,n),r=_("elementShape",t,e,n),i=_("elementDType",t,e,n),o=_("numElements",t,e,n);return[n.getTensorList(s.id).stack(r,i,o)]}case"TensorListFromTensor":{const s=_("tensor",t,e,n),r=_("elementShape",t,e,n),i=_("elementDType",t,e,n),o=Jhe(s,r,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=_("tensorListId",t,e,n),r=n.getTensorList(s.id),i=_("dtype",t,e,n),o=_("elementShape",t,e,n);return[r.concat(i,o)]}case"TensorListPushBack":{const s=_("tensorListId",t,e,n),r=_("tensor",t,e,n),i=n.getTensorList(s.id);return i.pushBack(r),[i.idTensor]}case"TensorListPopBack":{const s=_("tensorListId",t,e,n),r=_("elementShape",t,e,n),i=_("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(r,i)]}case"TensorListSplit":{const s=_("tensor",t,e,n),r=_("elementShape",t,e,n),i=_("lengths",t,e,n),o=tpe(s,i,r);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const s=_("tensorListId",t,e,n),r=n.getTensorList(s.id);return[Pe(r.size(),"int32")]}case"TensorListResize":{const s=_("tensorListId",t,e,n),r=_("size",t,e,n),o=n.getTensorList(s.id).resize(r);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nP(t,e,n){const[s,r]=_("fusedOps",t,e,n),i=s==="biasadd",o=!i,a=r==="prelu",l=s==="fusedbatchnorm",c=_("numArgs",t,e,n);if(i){if(a&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&i&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=_("strides",t,e,n),d=Zx(t,e,n),h=_("dataFormat",t,e,n).toUpperCase(),p=_("dilations",t,e,n);let[f,g]=_("args",t,e,n);o&&(g=f,f=void 0);const y=_("leakyreluAlpha",t,e,n);return{stride:u,pad:d,dataFormat:h,dilations:p,biasArg:f,preluArg:g,activationFunc:r,leakyreluAlpha:y}}const spe=(t,e,n,s=Kn)=>{switch(t.op){case"Conv1D":{const r=_("stride",t,e,n),i=_("pad",t,e,n),o=_("dataFormat",t,e,n).toUpperCase(),a=_("dilation",t,e,n);return[s.conv1d(_("x",t,e,n),_("filter",t,e,n),r,i,o,a)]}case"Conv2D":{const r=_("strides",t,e,n),i=Zx(t,e,n),o=_("dataFormat",t,e,n).toUpperCase(),a=_("dilations",t,e,n);return[s.conv2d(_("x",t,e,n),_("filter",t,e,n),[r[1],r[2]],i,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=nP(t,e,n);return[s.fused.conv2d({x:_("x",t,e,n),filter:_("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=nP(t,e,n);return[s.fused.depthwiseConv2d({x:_("x",t,e,n),filter:_("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=_("outputShape",t,e,n),i=_("strides",t,e,n),o=Zx(t,e,n);return[s.conv2dTranspose(_("x",t,e,n),_("filter",t,e,n),r,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=_("strides",t,e,n),i=Zx(t,e,n),o=_("dilations",t,e,n),a=_("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(_("input",t,e,n),_("filter",t,e,n),[r[1],r[2]],i,a,[o[1],o[2]])]}case"Conv3D":{const r=_("strides",t,e,n),i=_("pad",t,e,n),o=_("dataFormat",t,e,n).toUpperCase(),a=_("dilations",t,e,n);return[s.conv3d(_("x",t,e,n),_("filter",t,e,n),[r[1],r[2],r[3]],i,o,[a[1],a[2],a[3]])]}case"AvgPool":{const r=_("strides",t,e,n),i=_("pad",t,e,n),o=_("kernelSize",t,e,n);return[s.avgPool(_("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=_("strides",t,e,n),i=_("pad",t,e,n),o=_("kernelSize",t,e,n);return[s.maxPool(_("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=_("strides",t,e,n),i=_("pad",t,e,n),o=_("kernelSize",t,e,n),a=_("includeBatchInIndex",t,e,n),{result:l,indexes:c}=s.maxPoolWithArgmax(_("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i,a);return[l,c]}case"AvgPool3D":{const r=_("strides",t,e,n),i=_("pad",t,e,n),o=_("kernelSize",t,e,n);return[s.avgPool3d(_("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=_("strides",t,e,n),i=_("pad",t,e,n),o=_("kernelSize",t,e,n);return[s.maxPool3d(_("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=_("strides",t,e,n),i=_("pad",t,e,n),o=_("dilations",t,e,n),a=r[1],l=r[2],c=o[1],u=o[2];return[s.dilation2d(_("x",t,e,n),_("filter",t,e,n),[a,l],i,[c,u],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rpe=(t,e,n,s=Kn)=>{switch(t.op){case"Fill":{const r=_("shape",t,e,n),i=_("dtype",t,e,n),o=_("value",t,e,n);return[s.fill(r,o,i)]}case"LinSpace":{const r=_("start",t,e,n),i=_("stop",t,e,n),o=_("num",t,e,n);return[s.linspace(r,i,o)]}case"Multinomial":{const r=_("logits",t,e,n),i=_("numSamples",t,e,n),o=_("seed",t,e,n);return[s.multinomial(r,i,o)]}case"OneHot":{const r=_("indices",t,e,n),i=_("depth",t,e,n),o=_("onValue",t,e,n),a=_("offValue",t,e,n),l=_("dtype",t,e,n);return[s.oneHot(r,i,o,a,l)]}case"Ones":return[s.ones(_("shape",t,e,n),_("dtype",t,e,n))];case"OnesLike":return[s.onesLike(_("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(_("shape",t,e,n),_("dtype",t,e,n),_("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(_("shape",t,e,n),_("minval",t,e,n),_("maxval",t,e,n),_("dtype",t,e,n))];case"RandomUniformInt":return[s.randomUniformInt(_("shape",t,e,n),_("minval",t,e,n),_("maxval",t,e,n),_("seed",t,e,n))];case"Range":{const r=_("start",t,e,n),i=_("stop",t,e,n),o=_("step",t,e,n);return[s.range(r,i,o,_("dtype",t,e,n))]}case"TruncatedNormal":{const r=_("shape",t,e,n),i=_("mean",t,e,n),o=_("stdDev",t,e,n),a=_("seed",t,e,n);return[s.truncatedNormal(r,i,o,_("dtype",t,e,n),a)]}case"Zeros":return[s.zeros(_("shape",t,e,n),_("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(_("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WI(t,e,n){const s=_("boxes",t,e,n),r=_("scores",t,e,n),i=_("maxOutputSize",t,e,n),o=_("iouThreshold",t,e,n),a=_("scoreThreshold",t,e,n),l=_("softNmsSigma",t,e,n);return{boxes:s,scores:r,maxOutputSize:i,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const ipe=async(t,e,n,s,r=Kn)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=WI(t,e,n),d=await r.image.nonMaxSuppressionWithScoreAsync(i,o,a,l,c,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=WI(t,e,n),u=_("padToMaxOutputSize",t,e,n),d=await r.image.nonMaxSuppressionPaddedAsync(i,o,a,l,c,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=WI(t,e,n);return[await r.image.nonMaxSuppressionAsync(i,o,a,l,c)]}case"Where":{const i=r.cast(_("condition",t,e,n),"bool"),o=[await r.whereAsync(i)];return i.dispose(),o}case"ListDiff":return r.setdiff1dAsync(_("x",t,e,n),_("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ope=(t,e,n,s=Kn)=>{switch(t.op){case"LowerBound":{const r=_("sortedSequence",t,e,n),i=_("values",t,e,n);return[s.lowerBound(r,i)]}case"TopKV2":{const r=_("x",t,e,n),i=_("k",t,e,n),o=_("sorted",t,e,n),a=s.topk(r,i,o);return[a.values,a.indices]}case"UpperBound":{const r=_("sortedSequence",t,e,n),i=_("values",t,e,n);return[s.upperBound(r,i)]}case"Unique":{const r=_("x",t,e,n),i=s.unique(r);return[i.values,i.indices]}case"UniqueV2":{const r=_("x",t,e,n),i=_("axis",t,e,n),o=s.unique(r,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape=(t,e,n,s=Kn)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=_("default",t,e,n);return[zn(t.name,e,n)||r];case"Placeholder":return[zn(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=_("x",t,e,n);return[Io(u)]}case"IdentityN":return _("x",t,e,n).map(u=>Io(u));case"Snapshot":const i=_("x",t,e,n);return[Io(i)];case"Shape":return[s.tensor1d(_("x",t,e,n).shape,"int32")];case"ShapeN":return _("x",t,e,n).map(u=>s.tensor1d(u.shape));case"Size":return[s.scalar(_("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(_("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const o=_("x",t,e,n),a=_("data",t,e,n),l=_("message",t,e,n),c=_("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lpe{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Pe(0),this.tensorMap=new Map,wn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Pe(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),K(()=>{const r=Cr(n),i=s.length,o=r.length;D(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let a=0;a<i;a++){const l=s[a],c=r[a];wn(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return K(()=>{const r=[];for(let i=0;i<s.length;i++){const o=s[i],a=this.findWithDefault(o,n);r.push(a)}return Bs(r)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cpe=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(t.name);if(r!=null)return[r];{const i=_("keyDType",t,e,n),o=_("valueDType",t,e,n),a=new lpe(i,o);return s.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=_("tableHandle",t,e,n,s),i=_("keys",t,e,n),o=_("values",t,e,n);return[await s.getHashTableById(r.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const r=_("tableHandle",t,e,n,s),i=_("keys",t,e,n),o=_("defaultValue",t,e,n);return[await s.getHashTableById(r.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=_("tableHandle",t,e,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const upe=(t,e,n,s=Kn)=>{switch(t.op){case"ResizeBilinear":{const r=_("images",t,e,n),i=_("size",t,e,n),o=_("alignCorners",t,e,n),a=_("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(r,[i[0],i[1]],o,a)]}case"ResizeNearestNeighbor":{const r=_("images",t,e,n),i=_("size",t,e,n),o=_("alignCorners",t,e,n),a=_("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(r,[i[0],i[1]],o,a)]}case"CropAndResize":{const r=_("image",t,e,n),i=_("boxes",t,e,n),o=_("boxInd",t,e,n),a=_("cropSize",t,e,n),l=_("method",t,e,n),c=_("extrapolationValue",t,e,n);return[s.image.cropAndResize(r,i,o,a,l,c)]}case"ImageProjectiveTransformV3":{const r=_("images",t,e,n),i=_("transforms",t,e,n),o=_("outputShape",t,e,n),a=_("fillValue",t,e,n),l=_("interpolation",t,e,n),c=_("fillMode",t,e,n);return[s.image.transform(r,i,l.toLowerCase(),c.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dpe=(t,e,n,s=Kn)=>{switch(t.op){case"Equal":return[s.equal(_("a",t,e,n),_("b",t,e,n))];case"NotEqual":return[s.notEqual(_("a",t,e,n),_("b",t,e,n))];case"Greater":return[s.greater(_("a",t,e,n),_("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(_("a",t,e,n),_("b",t,e,n))];case"Less":return[s.less(_("a",t,e,n),_("b",t,e,n))];case"LessEqual":return[s.lessEqual(_("a",t,e,n),_("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(_("a",t,e,n),_("b",t,e,n))];case"LogicalNot":return[s.logicalNot(_("a",t,e,n))];case"LogicalOr":return[s.logicalOr(_("a",t,e,n),_("b",t,e,n))];case"Select":case"SelectV2":return[s.where(_("condition",t,e,n),_("a",t,e,n),_("b",t,e,n))];case"BitwiseAnd":return[s.bitwiseAnd(_("a",t,e,n),_("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hpe=(t,e,n,s=Kn)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(_("a",t,e,n),_("b",t,e,n),_("transposeA",t,e,n),_("transposeB",t,e,n))];case"Einsum":return[s.einsum(_("equation",t,e,n),..._("tensors",t,e,n))];case"Transpose":return[s.transpose(_("x",t,e,n),_("perm",t,e,n))];case"_FusedMatMul":const[r,i]=_("fusedOps",t,e,n),o=r==="biasadd",a=i==="prelu",l=_("numArgs",t,e,n),c=_("leakyreluAlpha",t,e,n);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=_("args",t,e,n);return[s.fused.matMul({a:_("a",t,e,n),b:_("b",t,e,n),transposeA:_("transposeA",t,e,n),transposeB:_("transposeB",t,e,n),bias:u,activation:i,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(_("a",t,e,n),_("numLower",t,e,n),_("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppe=(t,e,n,s=Kn)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(_("x",t,e,n),_("axis",t,e,n),_("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(_("x",t,e,n),_("mean",t,e,n),_("variance",t,e,n),_("offset",t,e,n),_("scale",t,e,n),_("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(_("x",t,e,n),_("mean",t,e,n),_("variance",t,e,n),_("offset",t,e,n),_("scale",t,e,n),_("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(_("x",t,e,n),_("radius",t,e,n),_("bias",t,e,n),_("alpha",t,e,n),_("beta",t,e,n))];case"Softmax":return[s.softmax(_("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(_("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fpe=(t,e,n,s=Kn)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:i}=s.raggedGather(_("paramsNestedSplits",t,e,n),_("paramsDenseValues",t,e,n),_("indices",t,e,n),_("outputRaggedRank",t,e,n));return r.concat(i)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:i}=s.raggedRange(_("starts",t,e,n),_("limits",t,e,n),_("splits",t,e,n));return[r,i]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(_("shape",t,e,n),_("values",t,e,n),_("defaultValue",t,e,n),_("rowPartitionTensors",t,e,n),_("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mpe=(t,e,n,s=Kn)=>{switch(t.op){case"Max":{const a=_("axis",t,e,n),l=_("keepDims",t,e,n);return[s.max(_("x",t,e,n),a,l)]}case"Mean":{const a=_("axis",t,e,n),l=_("keepDims",t,e,n);return[s.mean(_("x",t,e,n),a,l)]}case"Min":{const a=_("axis",t,e,n),l=_("keepDims",t,e,n);return[s.min(_("x",t,e,n),a,l)]}case"Sum":{const a=_("axis",t,e,n),l=_("keepDims",t,e,n);return[s.sum(_("x",t,e,n),a,l)]}case"All":{const a=_("axis",t,e,n),l=_("keepDims",t,e,n);return[s.all(_("x",t,e,n),a,l)]}case"Any":{const a=_("axis",t,e,n),l=_("keepDims",t,e,n);return[s.any(_("x",t,e,n),a,l)]}case"ArgMax":{const a=_("axis",t,e,n);return[s.argMax(_("x",t,e,n),a)]}case"ArgMin":{const a=_("axis",t,e,n);return[s.argMin(_("x",t,e,n),a)]}case"Prod":{const a=_("axis",t,e,n),l=_("keepDims",t,e,n);return[s.prod(_("x",t,e,n),a,l)]}case"Cumprod":{const a=_("axis",t,e,n),l=_("exclusive",t,e,n),c=_("reverse",t,e,n);return[s.cumprod(_("x",t,e,n),a,l,c)]}case"Cumsum":{const a=_("axis",t,e,n),l=_("exclusive",t,e,n),c=_("reverse",t,e,n);return[s.cumsum(_("x",t,e,n),a,l,c)]}case"Bincount":const r=_("x",t,e,n),i=_("weights",t,e,n),o=_("size",t,e,n);return[s.bincount(r,i,o)];case"DenseBincount":{const a=_("x",t,e,n),l=_("weights",t,e,n),c=_("size",t,e,n),u=_("binaryOutput",t,e,n);return[s.denseBincount(a,l,c,u)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpe=(t,e,n,s=Kn)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=_("n",t,e,n),i=_("axis",t,e,n);let o=_("tensors",t,e,n);return o=o.slice(0,r),[s.concat(o,i)]}case"Gather":{const r=_("x",t,e,n),i=_("indices",t,e,n);return[s.gather(r,s.cast(i,"int32"),0)]}case"GatherV2":{const r=_("axis",t,e,n),i=_("batchDims",t,e,n),o=_("x",t,e,n),a=_("indices",t,e,n);return[s.gather(o,s.cast(a,"int32"),r,i)]}case"Reverse":{const r=_("dims",t,e,n),i=[];for(let a=0;a<r.length;a++)r[a]&&i.push(a);const o=_("x",t,e,n);return[s.reverse(o,i)]}case"ReverseV2":{const r=_("axis",t,e,n),i=_("x",t,e,n);return[s.reverse(i,r)]}case"Slice":{const r=_("begin",t,e,n),i=_("size",t,e,n);return[s.slice(_("x",t,e,n),r,i)]}case"StridedSlice":{const r=_("begin",t,e,n),i=_("end",t,e,n),o=_("strides",t,e,n),a=_("beginMask",t,e,n),l=_("endMask",t,e,n),c=_("ellipsisMask",t,e,n),u=_("newAxisMask",t,e,n),d=_("shrinkAxisMask",t,e,n),h=_("x",t,e,n);return[s.stridedSlice(h,r,i,o,a,l,c,u,d)]}case"Pack":return K(()=>{const r=_("axis",t,e,n),i=_("tensors",t,e,n),o=i[0].shape,a=s.squeeze(i[0]).shape,l=i.map(c=>{const u=Ze(c.shape,o);if(!u&&!Ze(s.squeeze(c).shape,a))throw new Error("the input tensors shape does not match");return u?c:s.reshape(c,o)});return[s.stack(l,r)]});case"Unpack":{const r=_("axis",t,e,n),i=_("tensor",t,e,n);return s.unstack(i,r)}case"Tile":{const r=_("reps",t,e,n);return[s.tile(_("x",t,e,n),r)]}case"Split":case"SplitV":{const r=_("axis",t,e,n),i=_("numOrSizeSplits",t,e,n),o=_("x",t,e,n);return s.split(o,i,r)}case"ScatterNd":{const r=_("indices",t,e,n),i=_("values",t,e,n),o=_("shape",t,e,n);return[s.scatterND(r,i,o)]}case"GatherNd":{const r=_("x",t,e,n),i=_("indices",t,e,n);return[s.gatherND(r,i)]}case"SparseToDense":{const r=_("sparseIndices",t,e,n),i=_("outputShape",t,e,n),o=_("sparseValues",t,e,n),a=_("defaultValue",t,e,n);return[s.sparseToDense(r,o,i,o.dtype===a.dtype?a:s.cast(a,o.dtype))]}case"TensorScatterUpdate":{const r=_("indices",t,e,n),i=_("values",t,e,n),o=_("tensor",t,e,n);return[s.tensorScatterUpdate(o,r,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype=(t,e,n,s=Kn)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:o,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows(_("indices",t,e,n),_("values",t,e,n),_("denseShape",t,e,n),_("defaultValue",t,e,n));return[r,i,o,a]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=s.sparse.sparseReshape(_("inputIndices",t,e,n),_("inputShape",t,e,n),_("newShape",t,e,n));return[r,i]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(_("data",t,e,n),_("indices",t,e,n),_("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(_("data",t,e,n),_("indices",t,e,n),_("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpe=(t,e,n,s=Kn)=>{switch(t.op){case"FFT":return[s.fft(_("x",t,e,n))];case"IFFT":return[s.ifft(_("x",t,e,n))];case"RFFT":return[s.rfft(_("x",t,e,n))];case"IRFFT":return[s.irfft(_("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vpe=(t,e,n,s=Kn)=>{switch(t.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(_("input",t,e,n),_("pattern",t,e,n),_("rewrite",t,e,n),_("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=s.string.stringNGrams(_("data",t,e,n),_("dataSplits",t,e,n),_("separator",t,e,n),_("nGramWidths",t,e,n),_("leftPad",t,e,n),_("rightPad",t,e,n),_("padWidth",t,e,n),_("preserveShortSequences",t,e,n));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:o}=s.string.stringSplit(_("input",t,e,n),_("delimiter",t,e,n),_("skipEmpty",t,e,n));return[r,i,o]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(_("input",t,e,n),_("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bpe=(t,e,n,s=Kn)=>{switch(t.op){case"Cast":return[s.cast(_("x",t,e,n),_("dtype",t,e,n))];case"ExpandDims":{const r=_("axis",t,e,n);return[s.expandDims(_("x",t,e,n),r)]}case"Squeeze":{const r=_("axis",t,e,n);return[s.squeeze(_("x",t,e,n),r)]}case"Reshape":return[s.reshape(_("x",t,e,n),_("shape",t,e,n))];case"EnsureShape":return[s.ensureShape(_("x",t,e,n),_("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(_("x",t,e,n),_("padding",t,e,n),_("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(_("x",t,e,n),_("padding",t,e,n),_("constantValue",t,e,n))];case"SpaceToBatchND":{const r=_("blockShape",t,e,n),i=_("paddings",t,e,n);return[s.spaceToBatchND(_("x",t,e,n),r,i)]}case"BatchToSpaceND":{const r=_("blockShape",t,e,n),i=_("crops",t,e,n);return[s.batchToSpaceND(_("x",t,e,n),r,i)]}case"DepthToSpace":{const r=_("blockSize",t,e,n),i=_("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(_("x",t,e,n),r,i)]}case"BroadcastTo":return[s.broadcastTo(_("x",t,e,n),_("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(_("s0",t,e,n),_("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sP(t,e,n,s,r=K){const i=((o,a,l)=>{switch(o.category){case"arithmetic":return r(()=>Xhe(o,a,l));case"basic_math":return r(()=>Yhe(o,a,l));case"control":return npe(o,a,l);case"convolution":return r(()=>spe(o,a,l));case"creation":return r(()=>rpe(o,a,l));case"dynamic":return ipe(o,a,l);case"evaluation":return r(()=>ope(o,a,l));case"image":return r(()=>upe(o,a,l));case"graph":return r(()=>ape(o,a,l));case"logical":return r(()=>dpe(o,a,l));case"matrices":return r(()=>hpe(o,a,l));case"normalization":return r(()=>ppe(o,a,l));case"ragged":return r(()=>fpe(o,a,l));case"reduction":return r(()=>mpe(o,a,l));case"slice_join":return r(()=>gpe(o,a,l));case"sparse":return r(()=>ype(o,a,l));case"spectral":return r(()=>xpe(o,a,l));case"string":return r(()=>vpe(o,a,l));case"transformation":return r(()=>bpe(o,a,l));case"hash_table":return cpe(o,a,l,s);case"custom":const c=nB(o.op);if(c&&c.customExecutor)return c.customExecutor(new Khe(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return ol(i)?i.then(o=>[].concat(o)):[].concat(i)}class rP{constructor(e={},n={},s={},r={},i){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iP(t,e,n,s){const r=new Set,i=[];let o=null,a=null;const l=new Set,c=new Set(Object.keys(t).map(h=>Ys(h)[0]));s=s||[];const u=new Set(s.map(h=>Ys(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((Xl(h)||Epe(h)||Cpe(h))&&o==null&&(o=h,a=o.children.map(p=>p.name).filter(p=>r.has(p))),r.add(h.name),n[h.name]==null&&!c.has(h.name)&&!u.has(h.name)){if(h.inputs.length===0){i.push(h.name);continue}h.inputs.forEach(p=>{l.has(p.name)||(l.add(p.name),d.push(p))})}}return{inputs:t,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:a}}function wpe(t,e){const{usedNodes:n,inputs:s}=e,r=Object.keys(s).map(y=>Ys(y)[0]).map(y=>t.nodes[y]),i=t.initNodes||[],o=y=>n.has(typeof y=="string"?y:y.name);function a(y){return[...new Map(y.map(x=>[x.name,x])).values()]}const l=a([...r,...t.weights,...i]).filter(o),c=a([...l,...Object.values(t.nodes)]).filter(o),u=new Map(c.map(y=>[y.name,y])),d={};for(const y of c){d[y.name]=d[y.name]||0;for(const x of y.children)o(x)||(d[x.name]=Number.POSITIVE_INFINITY),d[x.name]=(d[x.name]||0)+1}const h=Object.entries(d).filter(([,y])=>y===0).map(([y])=>y),p=[...h];for(;h.length>0;){const y=h.pop(),x=u.get(y);for(const v of x.children.filter(o))--d[v.name]===0&&(p.push(v.name),h.push(v.name))}const f=p.map(y=>u.get(y)),g=Ipe(f,l);return kpe(g,l),g}function Ipe(t,e){const n=new Map(t.map(o=>[o.name,o])),s=e.map(o=>o.name),r=new Set(s);for(;s.length>0;){const o=s.pop(),a=n.get(o);for(const l of a.children)!n.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return t.filter(o=>r.has(o.name))}class fx extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function kpe(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),s=new Set(e.map(a=>a.name)),r=a=>s.has(typeof a=="string"?a:a.name),i=new Set(t.map(a=>a.name)),o=a=>i.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(o)){if(!n.has(l.name))throw new fx(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new fx(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!r(a))for(const l of a.inputs){if(!n.has(l.name))throw new fx(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new fx(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function Spe(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,s=t.map((a,l)=>Xl(a)?n:l),r=a=>{const l=s[e.get(a.name)];return l??-1},i=t.map((a,l)=>a.children.map(r).reduce((c,u)=>Math.max(c,u),s[l])),o=new Map;for(let a=0;a<t.length;++a){const l=i[a];if(l===n)continue;const c=t[a],u=t[l];o.has(u.name)||o.set(u.name,[]),o.get(u.name).push(c)}return o}const Tpe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Npe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),_pe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Xl(t){return Tpe.has(t.op)}function Epe(t){return Npe.has(t.op)}function Cpe(t){return _pe.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a0{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new a0(e.functions[s],this)})}getCompilationKey(e,n){const s=e.map(i=>i.name).sort(),r=n.map(i=>i.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,n){const s=iP(e,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:o}=s;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const c=n.map(d=>d.name),u=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${u}]. Missing the following inputs: [${r}]`)}const a=wpe(this.graph,s),l=Spe(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return wn(n),n}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(h=>this.graph.nodes[Ys(h)[0]]),i=n.map(h=>Ys(h)[0]),o=new Set(i);let a=i.map(h=>this.graph.nodes[h]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(r,a);let c=this.compiledMap.get(l);c==null&&(c=this.compile(e,a),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=X().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const u={},d={};return K(()=>{const h=new rP(this.weightMap,u,d,this.functionExecutorMap,this.parseNodeNameCache),p=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(x=>{const[v,w]=Ys(x,h),I=[];I[w]=e[x],p[v]=I,this.keepIntermediateTensors&&(this.clonedTensorsMap[v]=this.cloneTensorList(I))});const f=this.getFrozenTensorIds(p),{orderedNodes:g,nodeLiveUntilMap:y}=c;for(const x of g){if(p[x.name])continue;const v=sP(x,p,h,this._resourceManager);if(ol(v))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);p[x.name]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[x.name]=this.cloneTensorList(v)),this.checkTensorForDisposalWithNodeLiveUntilInfo(x,p,h,f,o,y.get(x.name))}return this.parent==null&&h.dispose(f),n.map(x=>zn(x,p,h))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(e,n,s,r,i,o,a){if(!(Xl(n)||o.has(e))){for(const l of s[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(Xl(l))continue;const c=JD(l.name,s,r);if(c!=null)for(const u of c){if(!u||u.kept||i.has(u.id))continue;const d=a[u.id];d===1?(u.dispose(),delete a[u.id]):d!=null&&a[u.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,s,r,i,o){function a(l){return Xl(l)||i.has(l.name)}if(!(Xl(e)||o==null))for(const l of o){if(a(l))continue;const c=JD(l.name,n,s);for(const u of c)!u||u.kept||r.has(u.id)||u.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,s=!1,r={},i={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=X().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const o=new rP(this.weightMap,r,i,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,n,s),l=n.map(h=>zn(h,a,o)),c=l.map(h=>h.id),u=Object.keys(e).map(h=>e[h].id),d=new Set([...c,...u,...this.weightIds]);return Object.values(a).forEach(h=>{h.forEach(p=>{p&&!p.isDisposed&&!d.has(p.id)&&p.dispose()})}),this.parent==null&&o.dispose(d),l}async executeFunctionAsync(e,n,s){const r=e.reduce((i,o,a)=>(i[this.inputs[a].name]=o,i),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,r){const i=Object.keys(e),o=i.map(I=>this.graph.nodes[Ys(I)[0]]),a=s.map(I=>Ys(I)[0]),l=new Set(a);let c=a.map(I=>this.graph.nodes[I]);c.length===0&&(c=this._outputs);const{usedNodes:u,missingInputs:d,dynamicNode:h,syncInputs:p}=iP(e,c,this.weightMap,this._initNodes),f=[...o,...this.graph.weights,...this._initNodes||[]].map(I=>({node:I,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(e).forEach(I=>{const[N,A]=Ys(I),T=[];T[A]=e[I],g[N]=T});const y={},x=this.getFrozenTensorIds(g),v={};for(;f.length>0;){const I=this.processStack(o,f,n,g,v,x,l,y,u);await Promise.all(I)}h==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const w=c.filter(I=>!Xl(I)&&!zn(I.name,g,n)).map(I=>I.name);if(w.length>0){let I="";throw h!=null&&(I=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${w}] from the provided inputs [${i}]. Consider providing the following inputs: [${d}]. ${I}`)}return g}processStack(e,n,s,r,i,o,a,l,c){const u=[];for(;n.length>0;){const d=n.pop();s.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&_("isConstant",d.node,r,s)&&([h]=wo(d.node.name,s)),r[d.node.name]==null){const p=sP(d.node,r,s,this._resourceManager);h||([h]=wo(d.node.name,s));const f=s.currentContext;ol(p)?u.push(p.then(g=>(r[h]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(g)),s.currentContext=f,this.checkTensorForDisposal(h,d.node,r,s,o,a,l),this.processChildNodes(d.node,n,s,r,i,c),g))):(r[h]=p,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(p)),this.checkTensorForDisposal(h,d.node,r,s,o,a,l),this.processChildNodes(d.node,n,s,r,i,c))}else this.processChildNodes(d.node,n,s,r,i,c)}return u}processChildNodes(e,n,s,r,i,o){e.children.forEach(a=>{const[l]=wo(a.name,s);i[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(c=>!!zn(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})):a.inputNames.every(c=>!!zn(c,r,s))&&(i[l]=!0,n.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[r]=Ys(n),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,a=o.length===s.shape.length&&s.shape.every((l,c)=>o[c]===-1||o[c]===l);D(a,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&D(s.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var n,s;const r={};for(const i in e){const o=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[i];o!=null?r[o.name]=e[i]:r[i]=e[i]}return r}checkInputs(e){const n=Object.keys(e).filter(s=>{const[r]=Ys(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var s,r;const i=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return i!=null?i.name:n},{})}checkOutputs(e){e.forEach(n=>{const[s]=Ys(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class $pe{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ape="?tfjs-format=file",Rpe="model.json";class Dpe{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},s=SC){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new $pe}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return ol(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await XV(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(r=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new a0(ZD.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=ZD.Instance.transformGraph(e.modelInitializer);this.initializer=new a0(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof gt?[e]:e,s={};return n.forEach((r,i)=>s[this.structuredOutputKeys[i]]=r),s}return e}predict(e,n){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,n){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var n;if(!(e instanceof gt)&&!Array.isArray(e)){const i=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(i!=null)for(const o in i){const a=i[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((i,o)=>{var a,l,c;const u=(c=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[o])===null||c===void 0?void 0:c.resourceId;return u!=null?i[o]=this.resourceIdToCapturedInput[u]:i[o]=e[r++],i},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const i=s[r],o=n[i];this.resourceIdToCapturedInput[o.resourceId]=e[r]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Ye(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function oP(t,e={},n=SC){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Ppe(t));const s=new Dpe(t,e,n);return await s.load(),s}function Ppe(t){return t.endsWith("/")||(t=t+"/"),`${t}${Rpe}${Ape}`}/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */function l0(t,e,n,s){return new(n||(n=Promise))(function(r,i){function o(c){try{l(s.next(c))}catch(u){i(u)}}function a(c){try{l(s.throw(c))}catch(u){i(u)}}function l(c){var u;c.done?r(c.value):(u=c.value,u instanceof n?u:new n(function(d){d(u)})).then(o,a)}l((s=s.apply(t,[])).next())})}function c0(t,e){var n,s,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(l){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(r=2&u[0]?s.return:u[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,u[1])).done)return r;switch(s=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,s=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(u[0]===6||u[0]===2)){o=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){o.label=u[1];break}if(u[0]===6&&o.label<r[1]){o.label=r[1],r=u;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(u);break}r[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(t,o)}catch(d){u=[6,d],s=0}finally{n=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,c])}}}var Ope={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},ya=224,Fpe={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},Nu={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}};function Lpe(t){return t===void 0&&(t={version:1,alpha:1}),l0(this,void 0,void 0,function(){var e,n,s,r,i,o,a;return c0(this,function(l){switch(l.label){case 0:if(ohe==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(e=t.version.toFixed(2),n=t.alpha?t.alpha.toFixed(2):"",s=-1,r=1,t.modelUrl==null){if(!(e in Nu))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(Nu));if(!(n in Nu[e]))throw new Error("MobileNet constructed with invalid alpha "+t.alpha+". Valid multipliers for this version are: "+Object.keys(Nu[e])+".");o=Nu[e][n].inputRange,s=o[0],r=o[1]}return t.inputRange!=null&&(a=t.inputRange,s=a[0],r=a[1]),[4,(i=new Mpe(e,n,t.modelUrl,s,r)).load()];case 1:return l.sent(),[2,i]}})})}var Mpe=function(){function t(e,n,s,r,i){r===void 0&&(r=-1),i===void 0&&(i=1),this.version=e,this.alpha=n,this.modelUrl=s,this.inputMin=r,this.inputMax=i,this.normalizationConstant=(i-r)/255}return t.prototype.load=function(){return l0(this,void 0,void 0,function(){var e,n,s,r,i=this;return c0(this,function(o){switch(o.label){case 0:return this.modelUrl?(e=this,[4,oP(this.modelUrl)]):[3,2];case 1:return e.model=o.sent(),[3,4];case 2:return n=Nu[this.version][this.alpha].url,s=this,[4,oP(n,{fromTFHub:!0})];case 3:s.model=o.sent(),o.label=4;case 4:return[4,(r=K(function(){return i.model.predict(sn([1,ya,ya,3]))})).data()];case 5:return o.sent(),r.dispose(),[2]}})})},t.prototype.infer=function(e,n){var s=this;return n===void 0&&(n=!1),K(function(){e instanceof gt||(e=bj(e));var r=oe(j(me(e,"float32"),s.normalizationConstant),s.inputMin),i=r;(e.shape[0]!==ya||e.shape[1]!==ya)&&(i=Wr.resizeBilinear(r,[ya,ya],!0));var o,a=U(i,[-1,ya,ya,3]);if(n){var l=Fpe[s.version],c=s.model.execute(a,l);o=la(c,[1,2])}else{var u=s.model.predict(a);o=et(u,[0,1],[-1,1e3])}return o})},t.prototype.classify=function(e,n){return n===void 0&&(n=3),l0(this,void 0,void 0,function(){var s,r;return c0(this,function(i){switch(i.label){case 0:return[4,Vpe(s=this.infer(e),n)];case 1:return r=i.sent(),s.dispose(),[2,r]}})})},t}();function Vpe(t,e){return l0(this,void 0,void 0,function(){var n,s,r,i,o,a,l;return c0(this,function(c){switch(c.label){case 0:return[4,(n=Hh(t)).data()];case 1:for(s=c.sent(),n.dispose(),r=[],l=0;l<s.length;l++)r.push({value:s[l],index:l});for(r.sort(function(u,d){return d.value-u.value}),i=new Float32Array(e),o=new Int32Array(e),l=0;l<e;l++)i[l]=r[l].value,o[l]=r[l].index;for(a=[],l=0;l<o.length;l++)a.push({className:Ope[o[l]],probability:i[l]});return[2,a]}})})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iB={kernelName:Fm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(t,ou(me(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zpe={kernelName:Gd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=wt(me(n,"float32")),r=Pn(Ie(Pe(1),s));return At(Ee(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jpe={kernelName:Hd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Pn(Ie(wt(me(n,"float32")),1));return Ee(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bpe={kernelName:tu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ue(n.shape,s.shape);return{a:()=>{let a=t;const l=yn(n.shape,r);return l.length>0&&(a=Te(a,l)),U(a,n.shape)},b:()=>{let a=t;const l=yn(s.shape,r);return l.length>0&&(a=Te(a,l)),U(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Upe={kernelName:Lm,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wpe={kernelName:Mm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gpe={kernelName:Vm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hpe={kernelName:qd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ee(t,Pn(Ie(Pe(1),wt(me(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpe={kernelName:Kd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Pn(oe(Pe(1),wt(me(n,"float32"))));return Ee(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kpe={kernelName:Qd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ue(n.shape,s.shape);return{a:()=>{const a=oe(wt(n),wt(s));let l=j(t,Ee(s,a));const c=yn(n.shape,r);return c.length>0&&(l=Te(l,c)),U(l,n.shape)},b:()=>{const a=oe(wt(n),wt(s));let l=At(j(t,Ee(n,a)));const c=yn(s.shape,r);return c.length>0&&(l=Te(l,c)),U(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpe={kernelName:Xd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ee(t,oe(wt(me(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ype={kernelName:Yd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ee(t,Ie(Pe(1),wt(me(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpe(t,e,n,s,r,i){const o=O(t,"dy","avgPool3dGrad"),a=O(e,"input","avgPool3dGrad");let l=o,c=a,u=!1;a.rank===4&&(u=!0,l=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),D(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),D(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Cs("avgPool3dGrad",r,i);const d={dy:l,input:c},h={filterSize:n,strides:s,pad:r,dimRoundingMode:i},p=V.runKernel(kb,d,h);return u?U(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Jpe=z({avgPool3dGrad_:Qpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe={kernelName:jm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:a}=n;return{x:()=>Jpe(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function efe(t,e,n,s,r){const i=O(t,"dy","avgPoolGrad"),o=O(e,"input","avgPoolGrad");D(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let a=o,l=i,c=!1;o.rank===3&&(c=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=U(i,[1,i.shape[0],i.shape[1],i.shape[2]])),D(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),D(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=V.runKernel(Ib,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const tfe=z({avgPoolGrad_:efe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nfe={kernelName:zm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>tfe(t,s,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe={kernelName:Bm,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:i,transposeB:o}=n;return!i&&!o?{a:()=>Xe(t,r,!1,!0),b:()=>Xe(s,t,!0,!1)}:!i&&o?{a:()=>Xe(t,r,!1,!1),b:()=>Xe(t,s,!0,!1)}:i&&!o?{a:()=>Xe(r,t,!1,!0),b:()=>Xe(s,t,!1,!1)}:{a:()=>Xe(r,t,!0,!0),b:()=>Xe(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rfe={kernelName:Um,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>Jg(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ife={kernelName:NV,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,i=s.shape,o=Array.from(i);for(let l=r.length-1;l>=0;l--)if(r[l]===i[l])o[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${i}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>Te(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ofe={kernelName:Jd,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const afe={kernelName:Zd,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lfe={kernelName:eh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:i}=n;return{x:()=>Un(Si(oa(s,r),Nl(s,i)),t,nt(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cfe={kernelName:Gm,inputsToSave:["x"],gradFunc:iB.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ufe={kernelName:Hm,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,i=Qe(r,e[0].shape)[0],o=s.map(l=>l[i]);return Ls(t,o,i).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dfe={kernelName:qm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:i,strides:o,pad:a,dataFormat:l}=n;return D(ll(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>TE(s.shape,t,r,o,a,l),filter:()=>pC(s,t,r.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hfe={kernelName:Km,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:i,pad:o,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>Ko(t,r,i,o,a,1,l),filter:()=>pC(t,s,r.shape,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(t,e,n,s,r){let i=t;t.rank===4&&(i=U(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),D(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),D(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),D(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),D(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),D(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:i,dy:o},l={strides:s,pad:r,filterShape:n};return V.runKernel(Eb,a,l)}const ffe=z({conv3DBackpropFilter_:pfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe={kernelName:Xm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i}=n;D(ll(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>dz(o.shape,t,a,r,i),filter:()=>ffe(o,t,a.shape,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gfe={kernelName:th,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(At(Hw(me(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yfe={kernelName:nh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(qw(me(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xfe={kernelName:Ym,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:i,reverse:o}=n;return{x:()=>{const a=qt([r],s.rank);let l=Rw(t,r,i,!o);return a!=null&&(l=tt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vfe={kernelName:Qm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:i,dimRoundingMode:o}=n,a=s??[1,1];D(ll(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return D(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),D(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),D(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),D(Hn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),Cs("depthwiseConv2d",i,o),{x:()=>nj(l.shape,t,c,r,i,a,o),filter:()=>tj(l,t,c.shape,r,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bfe={kernelName:Jm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,i={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>V.runKernel(e0,i,n),filter:()=>V.runKernel(t0,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wfe={kernelName:rh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>V.runKernel(Vb,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ife={kernelName:ih,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=j(js(At(wt(n))),2/Math.sqrt(Math.PI));return{x:()=>j(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kfe={kernelName:oh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sfe={kernelName:eg,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>U(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tfe={kernelName:ah,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(t,js(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nfe={kernelName:lh,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _fe={kernelName:ch,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ue(n.shape,s.shape);return{a:()=>{const a=Ee(t,me(s,"float32")),l=yn(n.shape,r);return l.length>0?U(Te(a,l),n.shape):a},b:()=>{let a=j(t,me(n,"float32"));const l=yn(s.shape,r);l.length>0&&(a=U(Te(a,l),s.shape));const c=wt(s);return At(Ee(a,me(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Efe={kernelName:tg,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,i,o,a]=e,l=a??Pe(1),c=yn(i.shape,r.shape),u=[];if(i.rank===1){for(let I=0;I<r.shape.length-1;++I)u.push(r.shape[I]);u.push(1)}const d=Ie(r,i),h=j(t,l),p=Uw(oe(o,Pe(s))),f=j(j(j(p,p),p),Pe(-.5));return{x:()=>i.rank===1?U(j(j(t,Ir(U(p,[1,1,1,i.shape[0]]),u)),l),r.shape):U(j(j(t,p),l),r.shape),mean:()=>{let I=j(j(p,Pe(-1)),h);return i.rank===1&&(I=Te(I,c)),U(I,i.shape)},variance:()=>{let I=j(j(f,d),h);return i.rank===1&&(I=Te(I,c)),U(I,i.shape)},scale:()=>{const I=j(d,p);let N=j(t,I);return i.rank===1&&(N=Te(N,c)),U(N,i.shape)},offset:()=>{let I=t;return i.rank===1&&(I=Te(I,c)),U(I,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cfe={kernelName:ng,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:i,batchDims:o}=n,a=Qe(i,s.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,p=u.size,f=h.slice(0,a),g=f.length,y=h.slice(i,h.length).slice(1),x=y.length,v=aP(0,g),w=aP(g+1,g+1+x),I=lP([f,[p],y]),N=U(d,I),A=U(u,[p]),T=lP([[g],v,w]),S=tt(N,T);let E=Zw(S,A,c.shape[a]);const $=Tl(T);return E=tt(E,$),E};if(o===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>Bs(u.map((p,f)=>l(p,r.slice(f,1),t.slice(f,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function aP(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function lP(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $fe={kernelName:uh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>nt(n),b:()=>nt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Afe={kernelName:dh,gradFunc:t=>({x:()=>me(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rfe={kernelName:hh,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe={kernelName:ph,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe={kernelName:fh,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ofe={kernelName:rg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,i=Hs(s,0);return{x:()=>Un(i,t,j(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ffe={kernelName:gh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ee(t,oe(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lfe={kernelName:mh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ee(t,me(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mfe={kernelName:_V,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=js(s);return Ie(t,j(Te(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vfe(t,e,n,s=5,r=1,i=1,o=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:i,beta:o};return V.runKernel(qb,a,l)}const zfe=z({localResponseNormalizationBackprop_:Vfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jfe={kernelName:ug,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:i,bias:o,alpha:a,beta:l}=n;return{x:()=>zfe(s,r,t,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(t,e,n,s){return e.rank<n.rank&&(e=U(e,an(e.shape,s))),t.rank<n.rank&&(t=U(t,an(t.shape,s))),{x:()=>j(t,me(Jr(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cP={kernelName:dg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,i=e[0],o=e[1],a=Qe(r,i.shape),l=oB(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe={kernelName:yh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>j(t,me(oa(n,s),"float32")),b:()=>j(t,me(Id(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ufe(t,e,n,s,r,i,o){const a=O(t,"dy","maxPool3dGrad"),l=O(e,"input","maxPool3dGrad"),c=O(n,"output","maxPool3dGrad");let u=a,d=l,h=c,p=!1;l.rank===4&&(p=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=U(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=U(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),D(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),D(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),D(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),Cs("maxPool3dGrad",i,o);const f={dy:u,input:d,output:h},g={filterSize:s,strides:r,pad:i,dimRoundingMode:o},y=V.runKernel(Xb,f,g);return p?U(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const Wfe=z({maxPool3dGrad_:Ufe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gfe={kernelName:pg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=n;return{x:()=>Wfe(t,s,r,i,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hfe(t,e,n,s,r,i,o){const a=O(t,"dy","maxPoolGrad"),l=O(e,"input","maxPoolGrad"),c=O(n,"output","maxPoolGrad");D(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),D(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),D(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Cs("maxPoolGrad",i,o);const u={dy:a,input:l,output:c},d={filterSize:s,strides:r,pad:i,dimRoundingMode:o};return V.runKernel(Kb,u,d)}const qfe=z({maxPoolGrad_:Hfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe={kernelName:hg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:i,strides:o,pad:a}=n;return{x:()=>qfe(t,s,r,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xfe={kernelName:fg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,i=Qe(r,s.shape),a=Fn(s.shape,i)[1],l=J(a);return{x:()=>{const u=s.shape.slice();i.forEach(p=>{u[p]=1});const d=U(t,u);return Ee(j(d,Os(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yfe={kernelName:mg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[i,o]=e,a=Qe(r,i.shape),l=oB(t,o,i,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qfe={kernelName:xh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>j(t,me(Nl(n,s),"float32")),b:()=>j(t,me(Hs(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jfe={kernelName:gg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>et(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zfe={kernelName:vh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ue(n.shape,s.shape);return{a:()=>{const a=yn(n.shape,r);return a.length>0?U(Te(t,a),n.shape):t},b:()=>{const a=j(t,At(Wh(Ee(n,s)))),l=yn(s.shape,r);return l.length>0?U(Te(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eme={kernelName:bh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ue(n.shape,s.shape);return{a:()=>{const a=j(t,me(s,"float32")),l=yn(n.shape,r);return l.length>0?U(Te(a,l),n.shape):a},b:()=>{const a=j(t,me(n,"float32")),l=yn(s.shape,r);return l.length>0?U(Te(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tme={kernelName:yg,gradFunc:t=>({x:()=>At(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nme={kernelName:bg,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>sn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sme={kernelName:vg,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rme={kernelName:wg,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return Cr(t,s).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uP={kernelName:Ig,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,i=r.map(o=>o[0]);return{x:()=>et(t,i,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime={kernelName:wh,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,i=n,o=s,a=Ue(i.shape,o.shape);return{a:()=>{const u=me(o,"float32");let d=j(t,j(u,ro(i,Ie(u,Pe(1)))));const h=yn(i.shape,a);return h.length>0&&(d=Te(d,h)),U(d,i.shape)},b:()=>{const u=Hs(i,0),d=Un(u,or(i),nt(i));let h=j(t,j(r,d));const p=yn(o.shape,a);return p.length>0&&(h=Te(h,p)),U(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ome={kernelName:kg,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=Hs(n,0);return{x:()=>Un(r,t,j(t,s)),alpha:()=>{let i=Un(r,nt(t),j(t,n));const o=yn(s.shape,t.shape);return o.length>0&&(i=Te(i,o)),U(i,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ame(t,e,n){const s=t.shape.slice();s[n]=1;const r=U(e,s),i=im(t,n,!0,!1),o=im(t,n,!0,!0),a=j(i,o);return j(r,a)}function lme(t,e,n){const s=t.shape.length,r=s-n.length,i=qt(n,s);let o=t;i!=null&&(o=tt(t,i));const a=o.shape.slice(),c=a.splice(s-n.length,n.length).reduce((h,p)=>h*p,1);a.push(c);const u=o.reshape(a);let d=ame(u,e,r);if(d=d.reshape(o.shape),i!=null){const h=Tl(i);d=tt(d,h)}return d}const cme={kernelName:Sg,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let i=[];return r==null?i=s.shape.map((o,a)=>a):typeof r=="number"?i=[r]:i=r,{x:()=>lme(s,t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ume={kernelName:sh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ue(n.shape,s.shape);return{a:()=>{const a=Ee(t,me(s,"float32")),l=yn(n.shape,r);return l.length>0?U(Te(a,l),n.shape):a},b:()=>{let a=j(t,me(n,"float32"));const l=yn(s.shape,r);l.length>0&&(a=U(Te(a,l),s.shape));const c=wt(s);return At(Ee(a,me(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dme={kernelName:Ih,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ee(t,At(wt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hme={kernelName:Sh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=j(Nl(n,6),ou(n));return{x:()=>j(t,me(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pme={kernelName:kh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(t,me(ou(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fme={kernelName:Tg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>U(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mme={kernelName:_g,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>V.runKernel(aw,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gme={kernelName:Ng,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>V.runKernel(ow,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yme={kernelName:Eg,gradFunc:(t,e,n)=>{const{dims:s}=n,r=Qe(s,t.shape);return{x:()=>Er(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xme={kernelName:Th,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vme={kernelName:Nh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>At(Ee(t,j(ro(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bme={kernelName:Cg,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>me(nt(n),"float32"),t:()=>j(t,me(n,t.dtype)),e:()=>j(t,me(Xg(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wme={kernelName:_h,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Hs(n,Pe(0)),r=Pe(p1),i=Pe(f1),o=j(t,i),a=j(j(t,r),js(me(n,"float32")));return Un(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ime={kernelName:Ah,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(t,j(n,Ie(Pe(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kme={kernelName:$h,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sme={kernelName:Eh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(Wg(me(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tme={kernelName:Ch,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(Aw(me(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nme={kernelName:$g,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:i}=n,o=s.shape,[a,l]=d1(s,r,i),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],o[u]-a[u]-l[u]]);return{x:()=>aa(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _me={kernelName:Pg,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,i=!0,o=j(t,s);return{logits:()=>Ie(o,j(Te(o,[r],i),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eme={kernelName:Rh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(t,bi(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dP={kernelName:Rg,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>Ug(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hP={kernelName:Dg,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>rn(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cme={kernelName:Dh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ee(t,j(Pn(me(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $me={kernelName:gw,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(t,j(me(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ame={kernelName:Ph,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Pe(2);return{a:()=>j(t,j(r,Ie(n,s))),b:()=>j(t,j(r,Ie(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rme={kernelName:Vh,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dme={kernelName:Oh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ue(n.shape,s.shape);return{a:()=>{let a=t;const l=yn(n.shape,r);return l.length>0&&(a=Te(a,l)),U(a,n.shape)},b:()=>{let a=t;const l=yn(s.shape,r);return l.length>0&&(a=Te(a,l)),U(At(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pme={kernelName:Ag,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:i}=n;Qe(i,s.shape).forEach(c=>{r[c]=1});const a=U(t,r),l=j(a,Os(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ome={kernelName:Fh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ee(t,wt(Wg(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fme={kernelName:Lh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>j(Ie(Pe(1),wt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lme={kernelName:Mh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=nt(s);if(s.rank===1)for(let a=0;a<r[0];++a)o=oe(o,et(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)o=oe(o,et(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)o=oe(o,et(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)o=oe(o,et(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mme={kernelName:fc,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,i=Tl(r);return{x:()=>tt(t,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vme={kernelName:Fg,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>Bs(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zme={kernelName:Lg,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>jme(t,n)}}};function jme(t,e){const n=ho(e,nt(e)),s=Gh(t,n);let r=oa(e,Pe(0,"int32"));const i=s.rank-r.rank;for(let a=0;a<i;++a)r=ns(r,a+1);r=Si(r,Os(s.shape,"bool"));const o=nt(s);return Un(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bme={kernelName:Mg,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ume=[iB,zpe,jpe,Bpe,Upe,Wpe,Gpe,Hpe,qpe,Kpe,Xpe,Ype,Zpe,nfe,sfe,rfe,ife,ofe,afe,lfe,cfe,ufe,hfe,dfe,mfe,gfe,yfe,xfe,vfe,bfe,ume,wfe,Ife,kfe,Sfe,Tfe,_fe,Nfe,Efe,Cfe,$fe,Afe,Rfe,Dfe,Pfe,Ofe,Ffe,Lfe,Mfe,jfe,cP,cP,Bfe,Gfe,Kfe,Xfe,Yfe,Qfe,Jfe,Zfe,eme,tme,nme,sme,rme,uP,uP,ime,ome,cme,dme,hme,pme,fme,mme,gme,yme,xme,vme,bme,wme,Ime,kme,Sme,Tme,Nme,_me,Eme,dP,dP,hP,hP,Cme,Ame,$me,Rme,Dme,Pme,Ome,Fme,Lme,Mme,Vme,zme,Bme];for(const t of Ume)EV(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.abs=function(){return this.throwIfDisposed(),pn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.acos=function(){return this.throwIfDisposed(),oE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.acosh=function(){return this.throwIfDisposed(),aE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.add=function(t){return this.throwIfDisposed(),oe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.all=function(t,e){return this.throwIfDisposed(),Ew(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.any=function(t,e){return this.throwIfDisposed(),nm(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.argMax=function(t){return this.throwIfDisposed(),Pc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.argMin=function(t){return this.throwIfDisposed(),lE(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.asScalar=function(){return this.throwIfDisposed(),D(this.size===1,()=>"The array must have only 1 element."),U(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.asType=function(t){return this.throwIfDisposed(),me(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as1D=function(){return this.throwIfDisposed(),U(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as2D=function(t,e){return this.throwIfDisposed(),U(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),U(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),U(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),U(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.asin=function(){return this.throwIfDisposed(),cE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.asinh=function(){return this.throwIfDisposed(),uE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.atan=function(){return this.throwIfDisposed(),dE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.atan2=function(t){return this.throwIfDisposed(),hE(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.atanh=function(){return this.throwIfDisposed(),pE(this)};ee().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),Bg(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Ug(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),zh(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.broadcastTo=function(t){return this.throwIfDisposed(),mc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cast=function(t){return this.throwIfDisposed(),me(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.ceil=function(){return this.throwIfDisposed(),bE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),zs(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof gt&&(t=[t]),rn([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.conv1d=function(t,e,n,s,r,i){return this.throwIfDisposed(),Cw(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),$w(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.conv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),Ko(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cos=function(){return this.throwIfDisposed(),Wg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cosh=function(){return this.throwIfDisposed(),Aw(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),im(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Rw(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),EE(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.depthwiseConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),jh(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),CE(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.divNoNan=function(t){return this.throwIfDisposed(),$E(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.div=function(t){return this.throwIfDisposed(),Ee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.dot=function(t){return this.throwIfDisposed(),AE(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.elu=function(){return this.throwIfDisposed(),Bh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.equal=function(t){return this.throwIfDisposed(),Jr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.erf=function(){return this.throwIfDisposed(),Dw(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),DE(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.exp=function(){return this.throwIfDisposed(),js(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.expandDims=function(t){return this.throwIfDisposed(),ns(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.expm1=function(){return this.throwIfDisposed(),PE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.fft=function(){return this.throwIfDisposed(),ny(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.flatten=function(){return this.throwIfDisposed(),U(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.floor=function(){return this.throwIfDisposed(),Wh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.floorDiv=function(t){return this.throwIfDisposed(),_w(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Gh(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.greaterEqual=function(t){return this.throwIfDisposed(),oa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.greater=function(t){return this.throwIfDisposed(),Hs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.ifft=function(){return this.throwIfDisposed(),Nd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.irfft=function(){return this.throwIfDisposed(),Xw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.isFinite=function(){return this.throwIfDisposed(),OE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.isInf=function(){return this.throwIfDisposed(),FE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.isNaN=function(){return this.throwIfDisposed(),LE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Hg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.lessEqual=function(t){return this.throwIfDisposed(),Nl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.less=function(t){return this.throwIfDisposed(),Id(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),ME(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logSigmoid=function(){return this.throwIfDisposed(),VE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Fw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Kg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.log=function(){return this.throwIfDisposed(),or(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.log1p=function(){return this.throwIfDisposed(),qg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Si(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logicalNot=function(){return this.throwIfDisposed(),Xg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logicalOr=function(t){return this.throwIfDisposed(),Lw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.logicalXor=function(t){return this.throwIfDisposed(),zE(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Xe(this,t,e,n)};ee().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),Yg(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.max=function(t,e){return this.throwIfDisposed(),Nr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.maximum=function(t){return this.throwIfDisposed(),ho(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.mean=function(t,e){return this.throwIfDisposed(),Wt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.min=function(t,e){return this.throwIfDisposed(),wd(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.minimum=function(t){return this.throwIfDisposed(),ul(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),BE(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.mod=function(t){return this.throwIfDisposed(),UE(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.mul=function(t){return this.throwIfDisposed(),j(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.neg=function(){return this.throwIfDisposed(),At(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Uh(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.notEqual=function(t){return this.throwIfDisposed(),Lc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),kd(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.onesLike=function(){return this.throwIfDisposed(),ar(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.pad=function(t,e){return this.throwIfDisposed(),aa(this,t,e)};ee().prototype.pool=function(t,e,n,s,r,i){return this.throwIfDisposed(),WE(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.pow=function(t){return this.throwIfDisposed(),ro(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.prelu=function(t){return this.throwIfDisposed(),Zg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.prod=function(t,e){return this.throwIfDisposed(),GE(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.reciprocal=function(){return this.throwIfDisposed(),tC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.relu=function(){return this.throwIfDisposed(),Ai(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.relu6=function(){return this.throwIfDisposed(),jw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.reshapeAs=function(t){return this.throwIfDisposed(),U(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.reshape=function(t){return this.throwIfDisposed(),U(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),oj(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),aj(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.reverse=function(t){return this.throwIfDisposed(),Er(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.rfft=function(){return this.throwIfDisposed(),sy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.round=function(){return this.throwIfDisposed(),Bw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.rsqrt=function(){return this.throwIfDisposed(),Uw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.selu=function(){return this.throwIfDisposed(),Ww(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.separableConv2d=function(t,e,n,s,r,i){return this.throwIfDisposed(),Gw(this,t,e,n,s,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sigmoid=function(){return this.throwIfDisposed(),bi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sign=function(){return this.throwIfDisposed(),nC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sin=function(){return this.throwIfDisposed(),Hw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sinh=function(){return this.throwIfDisposed(),qw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.slice=function(t,e){return this.throwIfDisposed(),et(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.softmax=function(t){return this.throwIfDisposed(),Hh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.softplus=function(){return this.throwIfDisposed(),ru(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Jg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.split=function(t,e){return this.throwIfDisposed(),Ls(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sqrt=function(){return this.throwIfDisposed(),Pn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.square=function(){return this.throwIfDisposed(),wt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Yw(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.squeeze=function(t){return this.throwIfDisposed(),la(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof gt?[this,t]:[this,...t];return Bs(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.step=function(t){return this.throwIfDisposed(),ou(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.stridedSlice=function(t,e,n,s,r,i,o,a){return this.throwIfDisposed(),sC(this,t,e,n,s,r,i,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sub=function(t){return this.throwIfDisposed(),Ie(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.sum=function(t,e){return this.throwIfDisposed(),Te(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.tan=function(){return this.throwIfDisposed(),rC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.tanh=function(){return this.throwIfDisposed(),cl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.tile=function(t){return this.throwIfDisposed(),Ir(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.toBool=function(){return this.throwIfDisposed(),me(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.toFloat=function(){return this.throwIfDisposed(),me(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.toInt=function(){return this.throwIfDisposed(),me(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.topk=function(t,e){return this.throwIfDisposed(),aC(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.transpose=function(t){return this.throwIfDisposed(),tt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.unique=function(t){return this.throwIfDisposed(),lC(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Zw(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.unstack=function(t){return this.throwIfDisposed(),Cr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.where=function(t,e){return this.throwIfDisposed(),Un(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ee().prototype.zerosLike=function(){return this.throwIfDisposed(),nt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fi extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Fi.prototype)}}class Gr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Gr.prototype)}}class W extends Error{constructor(e){super(e),Object.setPrototypeOf(this,W.prototype)}}class Ke extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ke.prototype)}}class QC extends Error{constructor(e){super(e),Object.setPrototypeOf(this,QC.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aB{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jc(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Li(t,e){if(!t)throw new QC(e)}function pP(t,e){let n=0;for(const s of t)s===e&&n++;return n}function Ps(t){return t.length===1?t[0]:t}function xt(t){return Array.isArray(t)?t:[t]}function ko(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Yl(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Dr={};function JC(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function yT(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>yT(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:yT(s))}}}function ay(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const i=t;let o;if(i in n)o=n[i];else if(i in Dr)o=Dr[i];else if(o=e[i],o==null)throw new W(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const i=t;if(i.className==null||i.config==null)throw new W(`${s}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const o=i.className;let a,l;if(o in n?[a,l]=n[o]:o in Dr?[a,l]=Dr.className:o in e&&([a,l]=e[o]),a==null)throw new W(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const p of Object.keys(Dr))c[p]=Dr[p];for(const p of Object.keys(n))c[p]=n[p];const u=i.config;u.customObjects=c;const d=Object.assign({},Dr);for(const p of Object.keys(n))Dr[p]=n[p];yT(i.config);const h=l(a,i.config,n,r);return Dr=Object.assign({},d),h}else{const c=Object.assign({},Dr);for(const d of Object.keys(n))Dr[d]=n[d];const u=new a(i.config);return Dr=Object.assign({},c),u}}}function Wme(t,e){return t<e?-1:t>e?1:0}function mx(t,e){return-1*Wme(t,e)}function Ka(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function Gme(t){if(t==null)throw new W(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function lu(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new W(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function ZC(t,e,n=0,s=1/0){return Li(n>=0),Li(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function An(t,e){Array.isArray(t)?(D(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>An(n,`element ${s+1} of ${e}`))):D(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${lB(t)}.`)}function lB(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>lB(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function Hme(t,e,n){let s=n!=null?n():ys(),r;return(...o)=>{const a=n!=null?n():ys();return a-s<e||(s=a,r=t(...o)),r}}function cB(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let qme=0;function uB(){return qme++}const gx={};function m1(t=""){return t in gx||(gx[t]=0),gx[t]+=1,t+gx[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Kme=["channelsFirst","channelsLast"],Xme=["nearest","bilinear"],Yme=["valid","same","causal"],Qme=["max","avg"],Jme=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vu=new Map;function un(t){lu(Kme,"DataFormat",t)}function Zme(t){lu(Xme,"InterpolationFormat",t)}function Rr(t){lu(Yme,"PaddingMode",t)}function dB(t){lu(Qme,"PoolMode",t)}const yf=[],fP="/";function gc(t,e){yf.push(t);try{const n=e();return yf.pop(),n}catch(n){throw yf.pop(),n}}function ege(){return yf.length===0?"":yf.join(fP)+fP}function hB(t){if(!fB(t))throw new Error("Not a valid tensor name: '"+t+"'");return ege()+t}function pB(t){if(!fB(t))throw new Error("Not a valid tensor name: '"+t+"'");vu.has(t)||vu.set(t,0);const e=vu.get(t);if(vu.set(t,vu.get(t)+1),e>0){const n=`${t}_${e}`;return vu.set(n,1),n}else return t}const tge=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function fB(t){return!!t.match(tge)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nge(t){return t===parseInt(t.toString(),10)}function Xa(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function _d(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function dl(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function Ti(t,e){if(e<t)throw new W(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let GI;function In(){return GI==null&&(GI=nE().epsilon()),GI}function Ni(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zi(t,e){return me(t,e)}function ly(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),U(t,n)}function sge(t,e){return K(()=>{if(t.shape.length!==2)throw new W(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=ly(t,1);return xT(n,[1,e,1])})}function rge(t){const e=[Xa(t.shape)];return U(t,e)}function ige(t){if(t.rank<=1)throw new W(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Xa(t.shape,1)];return U(t,e)}function yc(t,e,n){return K(()=>{switch(t.rank){case 1:return ey(t,e,n);case 2:return Kw(t,[e,0],[n,t.shape[1]]);case 3:return ty(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Td(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return et(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return et(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new W(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function HI(t,e,n){return K(()=>{switch(t.rank){case 1:return ey(t,e,n);case 2:return Kw(t,[0,e],[t.shape[0],n]);case 3:return ty(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Td(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new W(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function yx(t,e,n,s){return K(()=>{switch(t.rank){case 1:return ey(t,e,n);case 2:switch(s){case 1:return yc(t,e,n);case 2:return HI(t,e,n);default:throw new W(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return yc(t,e,n);case 2:return ty(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return HI(t,e,n);default:throw new W(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return yc(t,e,n);case 2:return Td(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Td(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return HI(t,e,n);default:throw new W(`The axis is not within the rank of the tensor ${s}`)}default:throw new W(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function e2(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),rn(t,e)}function mP(t,e){switch(t.rank){case 1:return wE([t,e]);case 2:return IE([t,e],0);case 3:return kE([t,e],0);case 4:return SE([t,e],0);default:throw new W(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function xT(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new W(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Ir(t,e)}function g1(t,e=0,n=1,s,r){return zw(t,e,n,s,r)}function eo(t,e,n,s){if(t.rank<2||e.rank<2)throw new Ke(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(r!==i)throw new Ke(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return tT({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?vT(t.rank,s,Ni()):null,activation:n});{const r=t.shape.slice(),i=r.pop();t=U(t,[-1,i]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],u=Array.from({length:e.rank},(f,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=U(tt(e,u),[l,-1]);const d=[...r,...c];return U(tT({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?vT(t.rank,s,Ni()):null,activation:n}),d)}}function mB(t,e,n){return K(()=>(Array.isArray(e)?e=rs(e,"int32"):e=me(e,"int32"),Gh(t,e,n)))}function cy(t){return j(t,t)}function vT(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new W(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1,1,1]):U(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,1,1,s[0]]):U(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1,1]):U(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,1,s[0]]):U(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1]):U(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,s[0]]):U(e,[1].concat(s))}else if(t<3)return e;throw new W(`Unsupported input rank by biasAdd: ${e.rank}`)}function Ri(t,e,n){return K(()=>(n==null&&(n=Ni()),un(n),oe(t,vT(t.rank,e,n))))}function oge(t,e=1){if(e!==1)throw new Ke(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Bh(t)}function age(t){return K(()=>Ee(t,oe(pn(t),1)))}function gB(t,e,n,s){return K(()=>dC(t,e,n,s))}function lge(t){return K(()=>{const e=oe(.5,j(.2,t));return zs(e,0,1)})}function uy(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cge=["fanIn","fanOut","fanAvg"],uge=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dge(t){lu(cge,"FanMode",t)}function hge(t){lu(uge,"Distribution",t)}class ei extends au{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class yB extends ei{apply(e,n){return sn(e,n)}}yB.className="Zeros";le(yB);class t2 extends ei{apply(e,n){return Os(e,n)}}t2.className="Ones";le(t2);class xB extends ei{constructor(e){if(super(),typeof e!="object")throw new W(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new W(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return K(()=>j(Pe(this.value),Os(e,n)))}getConfig(){return{value:this.value}}}xB.className="Constant";le(xB);class vB extends ei{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return _l(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}vB.className="RandomUniform";le(vB);class bB extends ei{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ke(`randomNormal does not support dType ${n}.`);return g1(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}bB.className="RandomNormal";le(bB);class wB extends ei{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ke(`truncatedNormal does not support dType ${n}.`);return Jw(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}wB.className="TruncatedNormal";le(wB);class IB extends ei{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return K(()=>{if(e.length!==2||e[0]!==e[1])throw new W("Identity matrix initializer can only be used for 2D square matrices.");return j(this.gain,Pw(e[0]))})}getConfig(){return{gain:this.gain}}}IB.className="Identity";le(IB);function pge(t,e="channelsLast"){let n,s;if(un(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Xa(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Xa(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Xa(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class lr extends ei{constructor(e){if(super(),e.scale<0)throw new W(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,dge(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,hge(this.distribution),this.seed=e.seed}apply(e,n){const s=pge(e),r=s[0],i=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,i):o/=Math.max(1,(r+i)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ke(`${this.getClassName()} does not support dType ${n}.`);return Jw(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*o);return _l(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}lr.className="VarianceScaling";le(lr);class n2 extends lr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return lr.className}}n2.className="GlorotUniform";le(n2);class s2 extends lr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return lr.className}}s2.className="GlorotNormal";le(s2);class r2 extends lr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return lr.className}}r2.className="HeNormal";le(r2);class i2 extends lr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return lr.className}}i2.className="HeUniform";le(i2);class o2 extends lr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return lr.className}}o2.className="LeCunNormal";le(o2);class a2 extends lr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return lr.className}}a2.className="LeCunUniform";le(a2);class kB extends ei{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return K(()=>{if(e.length<2)throw new Ke("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=J(e.slice(0,-1)),r=e[e.length-1],i=s*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],a=g1(o,0,1,n,this.seed),l=mC.qr(a,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=j(c,d.sign()),s<r&&(c=c.transpose()),j(Pe(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}kB.className="Orthogonal";le(kB);const gP={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function yP(t,e={}){return ay(t,xr.getMap().classNameMap,e,"initializer")}function Gt(t){return JC(t)}function zt(t){if(typeof t=="string"){const e=t in gP?gP[t]:t;if(e==="GlorotNormal")return new s2;if(e==="GlorotUniform")return new n2;if(e==="HeNormal")return new r2;if(e==="HeUniform")return new i2;if(e==="LeCunNormal")return new o2;if(e==="LeCunUniform")return new a2;{const n={};return n.className=e,n.config={},yP(n)}}else return t instanceof ei?t:yP(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bT(t){return Array.isArray(t)&&Array.isArray(t[0])}function u0(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function Me(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new W(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function dt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new W(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function d0(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const xP="Variable";class fge{constructor(e,n="float32",s=xP,r=!0,i=null){this.dtype=n??"float32",this.shape=e.shape,this.id=uB(),s=s??xP,this.originalName=hB(s),this.name=pB(this.originalName),this.trainable_=r,this.constraint=i,this.val=cC(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),mge(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function mge(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function wT(t){return t.map(e=>e.read())}function l2(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class oo{constructor(e,n,s,r,i,o,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=uB(),o!=null&&(this.originalName=hB(o),this.name=pB(this.originalName)),this.rank=n.length}}let gge=0,y1=class{constructor(e,n){this.callArgs=n,this.id=gge++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},yge=0;class Je extends au{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=yge++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=ko(s)+"_"+m1(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),s=[i].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Gr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new W(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Ps(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Ps(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Fi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Fi(`Layer ${this.name} is not connected, no input to return.`);return Ps(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Fi(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Fi(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ps(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=xt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=xt(this.inputSpec);if(n.length!==s.length)throw new W(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(o==null)continue;const a=i.rank;if(o.ndim!=null&&a!==o.ndim)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&i.dtype!==o.dtype)throw new W(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${i.dtype}.`);if(o.axes){const l=i.shape;for(const c in o.axes){const u=Number(c),d=o.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],u=i.shape[l];if(c!=null&&u!=null&&c!==u)throw new W(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${i.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=xt(e),r=bge(e),i=wge(e);if(r===i)throw new W("Arguments to apply() must be all SymbolicTensors or all Tensors");return gc(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of xt(e))o.push(a.shape);this.build(Ps(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const a=xt(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=Ps(l),this.activityRegularizer!=null)throw new Ke("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=xge(e),a=this.computeOutputShape(o);let l;const c=vge(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new oo(c,u,this,xt(e),n,this.name,d)):l=new oo(c,a,this,xt(e),n,this.name),this.addInboundNode(e,l,null,null,o,a,n),this._refCount++,this.activityRegularizer!=null)throw new Ke("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Fi(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Fi(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Gr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return d0(this.weights)}build(e){this.built=!0}getWeights(e=!1){return wT(e?this.trainableWeights:this.weights)}setWeights(e){K(()=>{const n=this.weights;if(n.length!==e.length)throw new W(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=wT(n);for(let i=0;i<r.length;++i){const o=r[i],a=n[i],l=e[i];if(!Ze(o.shape,l.shape))throw new W(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}l2(s)})}addWeight(e,n,s,r,i,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new W(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():zt("zeros"));const c=r.apply(n,s),u=new fge(c,s,e,o,a);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),o==null&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=xt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),i=xt(n),o=xt(r);if(i.length!==o.length)throw new Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let a=0;a<i.length;a++)i[a].kerasMask=o[a]}addInboundNode(e,n,s,r,i,o,a=null){const l=xt(e);n=xt(n),s=xt(s),r=xt(r),i=u0(i),o=u0(o);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new y1({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:i,outputShapes:o},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function xge(t){t=xt(t);const e=[];for(const n of t)e.push(n.shape);return Ps(e)}function vge(t){return"float32"}function SB(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let i=0;i<s.inboundLayers.length;i++){const o=s.inputTensors[i],a=s.inboundLayers[i],l=s.nodeIndices[i],c=SB(o,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function bge(t){let e=!0;for(const n of xt(t))if(!(n instanceof oo)){e=!1;break}return e}function wge(t){let e=!0;for(const n of xt(t))if(n instanceof oo){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dy extends Je{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:m1("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new W("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new W("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new W("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new oo(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new y1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new W(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}dy.className="InputLayer";le(dy);function Ige(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new W("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new dy({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kge(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return me(e,t.dtype)}catch{throw new W(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Da{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Da)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=kge(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new W(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof oo){if(this.id2Value[e.id]==null)throw new W(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new W(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof oo){if(this.id2Value[e.id]==null)throw new W(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new W(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Ye(this.id2Mask)}}const h0=new aB,p0=new aB;function Sge(t){h0!=null&&h0.setMaxEntries(t),p0!=null&&p0.setMaxEntries(t)}function Yp(t,e,n,s){const r=n==null?!1:n.training,i=Array.isArray(t),o=i?t:[t],a=o.map(f=>f.name),l=[],c=e.names();for(const f of a)c.indexOf(f)!==-1?l.push(e.getValue(f)):l.push(null);const u=a.join(",")+"|"+e.names().sort().join(",");let d=h0.get(u),h;if(d==null){const f=Tge(o,e);d=f.sorted,h=f.recipientCounts,h0.put(u,d),p0.put(u,h)}h={},r||Object.assign(h,p0.get(u));const p=new Da(e);for(let f=0;f<d.length;++f){const g=d[f],y=g.sourceLayer;if(y instanceof dy)continue;const x=[],v=[],w=[];let I=!1;for(const E of g.inputs){const $=p.getValue(E),P=p.getMask(E);x.push($),v.push(P),P!=null&&(I=!0),r||(h[E.name]--,h[E.name]===0&&!e.hasKey(E)&&a.indexOf(E.name)===-1&&!$.isDisposed&&E.sourceLayer.stateful!==!0&&w.push($))}I&&(n=n||{},n.mask=v[0]);const N=xt(y.apply(x,n));let A=null;y.supportsMasking&&(A=y.computeMask(x,v));const T=_ge(g),S=Array.isArray(T)?T:[T];for(let E=0;E<S.length;++E){p.hasKey(S[E])||p.add(S[E],N[E],Array.isArray(A)?A[0]:A);const $=a.indexOf(S[E].name);$!==-1&&(l[$]=N[E])}r||Ye(w)}return p.disposeMasks(),i?l:l[0]}function Tge(t,e){D(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=vP(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const i of t){const{sorted:o,recipientMap:a}=vP(i,e);for(const l of o)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:Nge(s)}}function Nge(t){const e={};for(const n in t)e[n]=t[n].size;return e}function vP(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const i=[],o=[];for(i.push(t);i.length>0;){const a=i[i.length-1];if(n.has(a.name)){i.pop();continue}const l=o[o.length-1]===i.length-1;if(a.inputs.length===0||l)i.pop(),s.push(a),n.add(a.name),l&&o.pop();else{o.push(i.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&i.push(c)}}return{sorted:s,recipientMap:r}}function _ge(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ege=X();Ege.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Sge);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function c2(t,e){return K(()=>Pn(Te(j(t,t),e,!0)))}class hy extends au{getConfig(){return{}}}class TB extends hy{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>{const n=c2(e,this.axis),s=zs(n,0,this.maxValue);return j(e,Ee(s,oe(In(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}TB.className="MaxNorm";le(TB);class NB extends hy{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>Ee(e,oe(In(),c2(e,this.axis))))}getConfig(){return{axis:this.axis}}}NB.className="UnitNorm";le(NB);class _B extends hy{apply(e){return Ai(e)}}_B.className="NonNeg";le(_B);class EB extends hy{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return K(()=>{const n=c2(e,this.axis),s=oe(j(this.rate,zs(n,this.minValue,this.maxValue)),j(1-this.rate,n));return j(e,Ee(s,oe(In(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}EB.className="MinMaxNorm";le(EB);const bP={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Sn(t){return JC(t)}function wP(t,e={}){return ay(t,xr.getMap().classNameMap,e,"constraint")}function Tn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in bP?bP[t]:t,config:{}};return wP(n)}else return t instanceof hy?t:wP(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Ml(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const i=t[r];if(typeof i!="number"){const o=i;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let i=0;i<r.length;++i)t[n[i]]=r[i][0];Ye(s)}}function CB(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var IP;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(IP||(IP={}));const Cge=125;class om{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class $ge{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class Age extends om{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const i=n[r];if(typeof i=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+i*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const a=K(()=>oe(this.totals[r],j(i,s)));this.totals[r]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:K(()=>{const r=j(Ee(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),wn(n[s])}))}}class Rge extends om{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const i in this.history){const o=this.history[i];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),n.push(i),s.push(a)}}const r=await Promise.all(e);for(let i=0;i<r.length;++i)this.history[n[i]][s[i]].dispose(),this.history[n[i]][s[i]]=r[i][0]}}class Dge extends om{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||$C,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Cge),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Jv(this.yieldEvery)&&(this.maybeWait=Hme(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await Ml(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await Ml(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await Ml(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await Ml(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await Ml(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Jv(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Ml(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Ml(e),await this.trainEnd(e))}}function $B(t,e){return t==null&&(t={}),t instanceof om?[t]:Array.isArray(t)&&t[0]instanceof om?t:xt(t).map(s=>new Dge(s,e))}class Or{constructor(){}static registerCallbackConstructor(e,n){D(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Or.checkForDuplicate(n),Or.constructors[e]==null&&(Or.constructors[e]=[]),Or.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Or.constructors)Or.constructors[+n].forEach(r=>{if(r===e)throw new W("Duplicate callback constructor.")})}static clear(){Or.constructors={}}static createCallbacks(e){const n=[];for(const s in Or.constructors){const r=+s;e>=r&&n.push(...Or.constructors[r])}return n.map(s=>new s)}}Or.constructors={};function AB(t,e,n,s,r,i,o,a,l){const c=new Rge,u=[new Age,...Or.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new $ge(u);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:i,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oo(t,e={},n=!1){return ay(t,xr.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function f0(t,e){return K(()=>{t.dtype!=="float32"&&(t=me(t,"float32"));const n=Te(cy(t),e,!0),s=su(n.shape,In()),r=Pn(ho(n,s));return Ee(t,r)})}function x1(t,e){return K(()=>Wt(cy(Ie(e,t)),-1))}function u2(t,e){return K(()=>Wt(pn(Ie(e,t)),-1))}function d2(t,e){return K(()=>{const n=Ie(t,e),s=zs(pn(t),In(),Number.MAX_VALUE),r=pn(Ee(n,s));return j(100,Wt(r,-1))})}function Pge(t,e){return K(()=>{const n=zs(e,In(),Number.MAX_VALUE),s=or(oe(1,n)),r=zs(t,In(),Number.MAX_VALUE),i=or(oe(1,r));return Wt(cy(Ie(s,i)),-1)})}function Oge(t,e){return K(()=>{const n=ho(0,Ie(1,j(t,e)));return Wt(cy(n),-1)})}function Fge(t,e){return K(()=>{const n=ho(0,Ie(1,j(t,e)));return Wt(n,-1)})}function Lge(t,e){return K(()=>{const n=Te(j(t,e),-1),s=Nr(j(Ie(1,t),e),-1);return ho(0,oe(1,Ie(s,n)))})}function Mge(t,e){return K(()=>{const n=Math.log(2),s=Ie(e,t),r=Ie(oe(s,ru(j(-2,s))),n);return Wt(r,-1)})}function am(t,e,n=!1){return K(()=>{if(n)e=Hh(e);else{const s=Te(e,e.shape.length-1,!0);e=Ee(e,s)}return e=zs(e,In(),1-In()),At(Te(j(me(t,"float32"),or(e)),e.shape.length-1))})}function m0(t,e,n=!1){return K(()=>{const s=me(Wh(rge(t)),"int32");e=zs(e,In(),1-In());const r=e.shape,i=U(kd(s,r[r.length-1]),r);return am(i,e,n)})}function Vge(t,e){if(!Ze(t.shape,e.shape))throw new W(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return K(()=>{const n=Ai(e),s=At(pn(e));return oe(Ie(n,j(e,t)),qg(js(s)))})}function v1(t,e){return K(()=>{let n;return n=zs(e,In(),1-In()),n=or(Ee(n,Ie(1,n))),Wt(Vge(t,n),-1)})}function zge(t,e){return K(()=>{const n=zs(t,In(),1),s=zs(e,In(),1);return Te(j(t,or(Ee(n,s))),-1)})}function jge(t,e){return K(()=>{const n=or(oe(In(),e));return Wt(Ie(e,j(t,n)),-1)})}function RB(t,e){return K(()=>{const n=f0(t,-1),s=f0(e,-1),r=j(n,s);return At(Te(r,-1))})}const g0={meanSquaredError:x1,meanAbsoluteError:u2,meanAbsolutePercentageError:d2,meanSquaredLogarithmicError:Pge,squaredHinge:Oge,hinge:Fge,categoricalHinge:Lge,logcosh:Mge,categoricalCrossentropy:am,sparseCategoricalCrossentropy:m0,binaryCrossentropy:v1,kullbackLeiblerDivergence:zge,poisson:jge,cosineProximity:RB};function qI(t){if(typeof t=="string"){if(t in g0)return g0[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new W(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DB(t,e){return K(()=>{const n=j(.5,ar(e)),s=Zi(Hs(e,n),t.dtype);return Wt(Jr(t,s),-1)})}function PB(t,e){return K(()=>Zi(Jr(Pc(t,-1),Pc(e,-1)),"float32"))}function Bge(t,e){return K(()=>me(Te(Si(Jr(t,1),Jr(e,1))),"float32"))}function Uge(t,e){return K(()=>me(Te(Si(Jr(t,0),Jr(e,1))),"float32"))}function Wge(t,e){return K(()=>{const n=Bge(t,e),s=Uge(t,e),r=oe(n,s);return me(Un(Hs(r,0),Ee(n,r),0),"float32")})}function Gge(t,e){return v1(t,e)}function Hge(t,e){return t.rank===e.rank&&(t=la(t,[t.rank-1])),e=Pc(e,-1),e.dtype!==t.dtype&&(e=me(e,t.dtype)),me(Jr(t,e),"float32")}const qge=x1,Kge=x1,Xge=u2,Yge=u2,Qge=d2,Jge=d2,OB=am,Zge=RB,FB=m0,y0={binaryAccuracy:DB,categoricalAccuracy:PB,precision:Wge,categoricalCrossentropy:OB,sparseCategoricalCrossentropy:FB,mse:qge,MSE:Kge,mae:Xge,MAE:Yge,mape:Qge,MAPE:Jge,cosine:Zge};function eye(t){if(typeof t=="string"&&t in y0)return y0[t];if(typeof t!="string"&&t!=null)return t;throw new W(`Unknown metric ${t}`)}function xx(t){if(Li(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(g0))if(g0[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(y0))if(y0[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tye(t){const e={Adagrad:()=>Wl.adagrad(.01),Adadelta:()=>Wl.adadelta(1,.95,In()),Adam:()=>Wl.adam(.001,.9,.999,In()),Adamax:()=>Wl.adamax(.002,.9,.999,In(),0),RMSProp:()=>Wl.rmsprop(.001,.9,0,In()),SGD:()=>Wl.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new W(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const kP=1*1024*1024;function SP(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!IT(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>kP&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${kP}.`)}}function IT(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!IT(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!IT(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nye(t,e,n,s=console.log){const r=rye(t),i=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let o;if(!r){i.push("Receives inputs"),o=[];for(const u in t.nodesByDepth)o.push(...t.nodesByDepth[u])}s("_".repeat(e)),x0(i,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?iye(a[u],n,s):oye(a[u],n,o,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=sye(t),c=d0(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function sye(t){let e;return t.collectedTrainableWeights!=null?e=d0(t.collectedTrainableWeights):e=d0(t.trainableWeights),e}function rye(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let i=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function x0(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function iye(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=t.name,o=t.getClassName(),a=[`${i} (${o})`,r,s,t.countParams().toString()];x0(a,e,n)}function oye(t,e,n,s){let r,i;try{i=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const p=d.inboundLayers[h].name,f=d.nodeIndices[h],g=d.tensorIndices[h];o.push(`${p}[${f}][${g}]`)}const a=t.name,l=t.getClassName(),c=o.length===0?"":o[0],u=[`${a} (${l})`,i,r,t.countParams().toString(),c];x0(u,e,s);for(let d=1;d<o.length;++d)x0(["","","","",o[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function LB(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function kT(t,e){if(t===null)return null;if(typeof t=="string")return Yl(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];LB(e,r,i)?n.push(i):n.push(kT(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const i=Yl(s);n[i]=kT(r,i)}}return n}}function ST(t,e){if(t==null)return null;if(typeof t=="string")return ko(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const i=t[r];LB(e,r,i)?n.push(i):n.push(ST(i,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],i=ko(s);(s==="name"||s==="className")&&typeof r=="string"?n[i]=r:n[i]=ST(r,s)}return n}}/** @license See the LICENSE file. */const MB="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const aye=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class ai extends Je{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const v=this.getClassName().toLowerCase();this.name=m1(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Ka(this.inputs).length!==this.inputs.length)throw new W(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);Ka(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const w=v.sourceLayer,I=v.nodeIndex,N=v.tensorIndex;this.outputLayers.push(w),this.outputLayersNodeIndices.push(I),this.outputLayersTensorIndices.push(N)}for(const v of this.inputs){const w=v.sourceLayer,I=v.nodeIndex,N=v.tensorIndex;Li(I===0,"input layer has >1 nodes"),Li(N===0,"input layer has >1 tensors"),this.inputLayers.push(w),this.inputLayersNodeIndices.push(I),this.inputLayersTensorIndices.push(N)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const w=this.inputLayers[v];if(!(w instanceof dy))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${v} (0-based) originates from layer type ${w.getClassName()}.`);this.inputNames.push(w.name),this.feedInputShapes.push(w.batchInputShape),this.feedInputNames.push(w.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);const n={},s={},r={},i={},o={},a=[],l=(v,w,I,N,A,T)=>{(N==null||A==null||T==null)&&(N=v.sourceLayer,A=v.nodeIndex,T=v.tensorIndex);const S=N.inboundNodes[A];if(I.indexOf(S)!==-1)throw new Gr(`The tensor ${v.name} at layer "${N.name}" is part of a cycle.`);if(w.indexOf(S)!==-1)return;this.containerNodes.add(ai.nodeKey(N,A)),N.id in o||(o[N.id]=Object.keys(o).length),I.indexOf(S)===-1&&I.push(S);const E=S.inboundLayers.length;for(let $=0;$<E;$++){const P=S.inputTensors[$],F=S.inboundLayers[$],R=S.nodeIndices[$],G=S.tensorIndices[$];l(P,w,I,F,R,G)}for(w.push(S);I.indexOf(S)>=0;)I.splice(I.indexOf(S),1);a.push(S)},c=[],u=[];for(const v of this.outputs)l(v,c,u);const d=a.slice().reverse();for(const v of d){s[v.id]=v,v.id in n||(n[v.id]=0);let w=n[v.id];const I=r[v.outboundLayer.id]==null?0:r[v.outboundLayer.id];w=Math.max(w,I),r[v.outboundLayer.id]=w,i[v.outboundLayer.id]=v.outboundLayer,n[v.id]=w;for(let N=0;N<v.inboundLayers.length;N++){const A=v.inboundLayers[N],T=v.nodeIndices[N],S=A.inboundNodes[T],E=n[S.id]==null?0:n[S.id];n[S.id]=Math.max(w+1,E),s[S.id]=S}}const h={};for(const v in n){const w=n[v];w in h||(h[w]=[]),h[w].push(s[v])}const p={};for(const v in r){const w=r[v];w in p||(p[w]=[]),p[w].push(i[v])}let f=Object.keys(p).map(v=>parseInt(v,10)).sort(mx);this.layers=[];for(const v of f){const w=p[v];w.sort((I,N)=>{const A=o[I.id],T=o[N.id];return A<T?-1:A>T?1:0});for(const I of w)I instanceof ai&&this.internalContainerRefs.push(I),this.layers.push(I)}this.layersByDepth=p,f=Object.keys(h).map(v=>parseInt(v,10)).sort(mx);const g=this.inputs.slice(),y=[];for(const v of f)for(const w of h[v]){const I=w.outboundLayer;if(I!=null){for(const N of w.inputTensors)if(g.indexOf(N)===-1)throw new Gr(`Graph disconnected: cannot obtain value for tensor ${N} at layer "${I.name}". The following previous layers were accessed without issue: ${y}`);for(const N of w.outputTensors)g.push(N);y.push(I.name)}}this.nodesByDepth=h;const x=this.layers.map(v=>v.name);for(const v of x){const w=x.filter(I=>I===v).length;if(w!==1)throw new Gr(`The name "${v}" is used ${w} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(x))}this.outboundNodes=[],this.inboundNodes=[],new y1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new W("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const i=aye(e);i&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=i?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new W(`Duplicate weight name: ${u}`);s[u]=c,r++}const o=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],e[a]]);else if(n)throw new W(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new W(`${a.length} of ${r} weights are not set: ${a}`)}l2(o)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],i=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");i!==n&&(e[i]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${MB}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=ST(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return K(()=>{e=xt(e);const s=new Da;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Yp(this.outputs,s,n)})}computeMask(e,n){return K(()=>{e=xt(e);let s;return n==null?s=jc(null,e.length):s=xt(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=u0(e);if(n.length!==this.inputLayers.length)throw new W(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(mx);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(u.id)!==-1)continue;const d=[];for(let g=0;g<c.inboundLayers.length;g++){const y=c.inboundLayers[g],x=c.nodeIndices[g],v=c.tensorIndices[g],w=`${y.name}_${x}_${v}`,I=s[w];d.push(I)}const h=u.computeOutputShape(Ps(d)),p=u0(h),f=u.inboundNodes.indexOf(c);for(let g=0;g<p.length;g++){const y=`${u.name}_${f}_${g}`;s[y]=p[g]}}}const i=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;o.push(d)}for(let a=0;a<o.length;a++){const l=o[a];Li(l in s),i.push(s[l])}return Ps(i)}runInternalGraph(e,n){n==null&&(n=jc(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];s[c.id]=[u,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(mx);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,p=u.outputTensors,f=new Array;for(const g of h)g.id in s&&f.push(s[g.id]);if(f.length===h.length){let g={},y,x,v,w;if(u.callArgs!=null&&(g=u.callArgs),f.length===1){const[I,N]=f[0];g.mask==null&&(g.mask=N),v=xt(d.call(I,g)),w=xt(d.computeMask(I,N)),y=[I],x=[N]}else y=f.map(I=>I[0]),x=f.map(I=>I[1]),g.mask==null&&(g.mask=x),v=xt(d.call(y,g)),w=xt(d.computeMask(y,x));if(d.activityRegularizer)throw new Ke("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let I=0;I<p.length;++I){const N=p[I],A=v[I],T=w[I];s[N.id]=[A,T]}}}}const i=[],o=[],a=[];for(const l of this.outputs){Li(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),i.push(c),o.push(u)}return[i,o,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof ai?1:0;for(let i=0;i<r.inboundNodes.length;i++){const o=ai.nodeKey(r,i);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new W("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new W(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new W(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return K(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=ai.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let d=0;d<o.inboundNodes.length;d++){const h=o.inboundNodes[d],p=ai.nodeKey(o,d);let f={};if(this.containerNodes.has(p)){if(h.callArgs)try{JSON.stringify(h.callArgs),f=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),f={}}if(h.inboundLayers.length>0){const g=[];for(let y=0;y<h.inboundLayers.length;y++){const x=h.inboundLayers[y],v=h.nodeIndices[y],w=h.tensorIndices[y],I=ai.nodeKey(x,v);let N=n[I];N==null&&(N=0),g.push([x.name,N,w,f])}c.push(g)}}}const u={};u.name=o.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=ai.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[o];r.push([a.name,u,d])}e.inputLayers=r;const i=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=ai.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[o];i.push([a.name,u,d])}return e.outputLayers=i,e}static fromConfig(e,n,s={},r=!1){const i={},o={};function a(y,x){y.name in o?o[y.name].push(x):o[y.name]=[x]}function l(y,x){const v=[];let w;for(const I of x){const N=I[0],A=I[1],T=I[2];if(w=I[3]==null?{}:I[3],!(N in i)){a(y,x);return}const S=i[N];if(S.inboundNodes.length<=A){a(y,x);return}const E=S.inboundNodes[A];v.push(E.outputTensors[T])}v.length>0&&y.apply(Ps(v),w)}function c(y){const x=y.name,v=Oo(y,n.customObjects!=null?n.customObjects:{});v.setFastWeightInitDuringBuild(r),i[x]=v,y.inboundNodes.forEach(I=>{if(!(I instanceof Array))throw new W(`Corrupted configuration, expected array for nodeData: ${I}`);a(v,I)})}const u=n.name,d=n.layers;for(const y of d)c(y);for(;!Gme(o);)for(const y of d){const x=i[y.name];if(x.name in o){const v=o[x.name];delete o[x.name];for(const w of v)l(x,w)}}const h=[],p=[],f=n.inputLayers;for(const y of f){const x=y[0],v=y[1],w=y[2];Li(x in i);const N=i[x].inboundNodes[v].outputTensors;h.push(N[w])}const g=n.outputLayers;for(const y of g){const x=y[0],v=y[1],w=y[2];Li(x in i);const N=i[x].inboundNodes[v].outputTensors;p.push(N[w])}return new e({inputs:h,outputs:p,name:u})}get stateful(){if(this._stateful)throw new W("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){K(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lye(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(i=>{i in t?r.push(t[i]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function VB(t,e){return lye(t,e,"classWeight")}async function zB(t,e,n,s){if(n!=null){const r=K(()=>{if(t.shape.length===1)return Qi(t);if(t.shape.length===2){if(t.shape[1]>1)return Pc(t,1);if(t.shape[1]===1)return U(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await r.data());Ye(r);const o=[];return i.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(n[a])}),rs(o,"float32")}else return null}function cye(t,e){return j(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const uye=32;function jB(t,e){let n,s;const r=e;n=r.xs,s=r.ys,D(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=TP("input",t.inputNames,n),o=TP("output",t.outputNames,s),a=i[0].shape[0];D(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),D(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<i.length;l++)D(i[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<o.length;l++)D(o[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function TP(t,e,n){if(n instanceof gt)return[n];if(Array.isArray(n))return D(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new W(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function dye(t){if(t.length===3)throw new Ke("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function hye(t,e,n){const s=n.batchesPerEpoch!=null;if(D(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),D(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),D(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),D(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),D(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let i,o;if(r)if(NP(n.validationData))D(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const y=dye(n.validationData);i=y.xs,o=y.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(y=>"val_"+y)):c=l.slice();const u=$B(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:p}=AB(u,d,n.epochs,null,null,pye(e,n),null,r,c);h.setModel(t),t.history=p,await h.onTrainBegin(),t.stopTraining_=!1;let f=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;f<n.epochs;){const y={};await h.onEpochBegin(f);let x=0,v=0;for(s||(g=await e.iterator());!s||x<n.batchesPerEpoch;){const w=await g.next();if(s&&w.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${x} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(w.value!=null){const{xs:I,ys:N}=jB(t,w.value),A={};A.batch=v,A.size=I[0].shape[0],await h.onBatchBegin(v,A);const T=[];if(n.classWeight!=null){const $=VB(n.classWeight,t.outputNames);for(let P=0;P<$.length;++P)T.push(await zB(N[P],null,$[P]))}const S=I.concat(N).concat(T),E=a(S);Ye(S);for(let $=0;$<l.length;++$){const P=l[$],F=E[$];A[P]=F,wn(F)}await h.onBatchEnd(v,A),CB(A),v++,x++}if(s?x>=n.batchesPerEpoch:w.done){if(r){let I;NP(n.validationData)?I=xt(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):I=xt(t.evaluate(i,o,{batchSize:n.validationBatchSize==null?uye:n.validationBatchSize,verbose:0}));for(let N=0;N<t.metricsNames.length;++N)y[`val_${t.metricsNames[N]}`]=I[N]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(f,y),f++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function pye(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function NP(t){return typeof t.iterator=="function"}function fye(t){return typeof t.next=="function"}async function mye(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let i=[];if(n.verbose>0)throw new Ke("Verbose mode is not implemented yet.");D(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=fye(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(i=K(()=>{if(c.value){const{xs:u,ys:d}=jB(t,c.value),h=u.concat(d),p=K(()=>r(h));if(Ye(h),l===0)for(let g=0;g<p.length;++g)i.push(Pe(0));const f=h[0].shape[0];for(let g=0;g<p.length;++g){const y=p[g],x=i[g];i[g]=K(()=>oe(i[g],j(f,y))),l>0&&Ye(x)}Ye(p),a+=f,++l}return i}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<i.length;++c){const u=i[c];i[c]=Ee(i[c],a),Ye(u)}return Ps(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function KI(t){D(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Rp(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>yc(s,e,n-e)):yc(t,e,n-e)}function TT(t,e){return K(()=>t==null?null:Array.isArray(t)?t.map(n=>TT(n,e)):mB(t,e.dtype==="int32"?e:me(e,"int32")))}function XI(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function BB(t){const e=[];t instanceof gt&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(ly(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function oi(t,e){if(t==null)return;const n=[];if(e instanceof gt)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const i=e[r];n.push(i.id)}const s=[];if(t instanceof gt)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const i=t[r];n.indexOf(i.id)===-1&&s.push(i)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gye(t){return t instanceof gt}function NT(t){return Array.isArray(t)}function _P(t){return!gye(t)&&!NT(t)}function EP(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(NT(t)&&t.length>0)o=!0;else if(_P(t)){for(const a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new W(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let i;if(_P(t)){t=t,i=[];for(const o of e){if(t[o]==null)throw new W(`No data provided for "${o}". Need data for each key in: ${e}`);i.push(t[o])}}else if(NT(t)){if(t=t,t.length!==e.length)throw new W(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);i=t}else{if(t=t,e.length>1)throw new W(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);i=[t]}if(i=BB(i),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new W(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u>=0&&c!==u)throw new W(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return i}function yye(t,e,n){const s=Ka(t.map(i=>i.shape[0]));s.sort();const r=Ka(e.map(i=>i.shape[0]));if(r.sort(),s.length>1)throw new W(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(i=>i.shape))}`);if(r.length>1)throw new W(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(s.length>0&&r.length>0&&!Ze(s,r))throw new W(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function xye(t,e,n){const s=[x1,v1,am];for(let r=0;r<t.length;++r){const i=t[r],o=e[r],a=n[r];if(o!=null){if(o===am&&i.shape[i.shape.length-1]===1)throw new W(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=i.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new W(`A target Tensor with shape ${i.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function CP(t,e,n,s=!0,r=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new W(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new W(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);i=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const a=i[o];if(a.shape.length!==n[o].length)throw new W(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[o][l];if(u!=null&&u!==c)throw new W(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function vye(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let i=n.hasOwnProperty(r)?n[r]:[];Array.isArray(i)||(i=[i]),s.push(i)}return s}}const bye="layers-model";class ed extends ai{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new W("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");nye(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=tye(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ua))throw new W("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new W(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(qI(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new W(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>qI(a))}else{const o=qI(e.loss);this.outputs.forEach(a=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],gc("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=vye(e.metrics,this.outputNames),i=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};gc("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=r[o];(c=>{const u="";let d,h,p;for(const f of c){if(typeof f=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(f)!==-1){const y=this.internalOutputShapes[o];y[y.length-1]===1||this.lossFunctions[o]===v1?["accuracy","acc"].indexOf(f)!==-1?h=DB:["crossentropy","ce"].indexOf(f)!==-1&&(h=Gge):this.lossFunctions[o]===m0?["accuracy","acc"].indexOf(f)!==-1?h=Hge:["crossentropy","ce"].indexOf(f)!==-1&&(h=FB):["accuracy","acc"].indexOf(f)!==-1?h=PB:["crossentropy","ce"].indexOf(f)!==-1&&(h=OB);let x;["accuracy","acc"].indexOf(f)!==-1?x="acc":["crossentropy","ce"].indexOf(f)!==-1&&(x="ce"),p=h,d=u+x}else p=eye(f),d=u+xx(f);let g;gc(d,()=>{g=p}),i(o,d,g)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;KI(r);const o=this.standardizeUserDataXY(e,n,!0,r);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return Ps(c)}finally{oi(o[0],e),oi(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),mye(this,e,n)}checkNumSamples(e,n,s,r="steps"){let i;if(s!=null){if(i=null,n!=null)throw new W(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new W(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new W("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],i=this.retrieveSymbolicTensors(r),o=new Da;if(e instanceof gt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new W(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new W(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=Yp(i,o);return s?a:a[0]}retrieveSymbolicTensors(e){const n=jc(null,e.length);let s=e.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],o=i.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(n[a]=i[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((i,o)=>{i==null&&r.push(e[o])}),new W(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return K(()=>{const r=this.checkNumSamples(e);if(s)throw new Ke("Verbose predictLoop() is not implemented yet.");const i=XI(r,n),o=this.outputs.map(a=>[]);for(let a=0;a<i.length;++a)K(()=>{const c=i[a][0],u=i[a][1],d=Rp(e,c,u),h=[];if(Array.isArray(d))for(let f=0;f<d.length;++f)h.push({key:this.inputs[f],value:d[f]});else h.push({key:this.inputs[0],value:d});const p=new Da(h);return Yp(this.outputs,p)}).forEach((c,u)=>o[u].push(c));return Ps(o.map(a=>rn(a,0)))})}predict(e,n={}){const s=BB(e);CP(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return KI(r),this.predictLoop(s,r)}finally{oi(s,e)}}predictOnBatch(e){CP(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new Gr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===m0?i.push(a.slice(0,a.length-1).concat([1])):i.push(a)}if(e=EP(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=EP(n,this.feedOutputNames,i,!1,"target"),yye(e,n),xye(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new W(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,i=!0,o){const[a,l]=this.standardizeUserDataXY(e,n,i,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=VB(r,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await zB(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,s,r=0,i){return K(()=>{const o=this.checkNumSamples(n,s,i,"steps"),a=[];if(r>0)throw new Ke("Verbose mode is not implemented yet.");if(i!=null)throw new Ke("steps mode in testLoop() is not implemented yet");{const l=XI(o,s),c=rs(Ti(0,o));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],p=yc(c,d,h-d),f=TT(n,p),g=e(f);if(u===0)for(let y=0;y<g.length;++y)a.push(Pe(0));for(let y=0;y<g.length;++y){const x=g[y];a[y]=oe(a[y],j(h-d,x))}}for(let u=0;u<a.length;++u)a[u]=Ee(a[u],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let i=r;if(pP(e,r)>1){const o=pP(e.slice(0,s),r);i+=`_${o}`}n.push(i)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:s[g]});const h=new Da(d),p=Yp(this.outputs,h,{training:!0});let f;for(let g=0;g<this.lossFunctions.length;++g){const y=this.lossFunctions[g];let x=y(r[g],p[g]);i[g]!=null&&(x=cye(x,i[g]));const v=Wt(x);n.push(v),g===0?f=x:f=oe(f,x)}for(let g=0;g<this.metricsTensors.length;++g){let y;if(this.outputs.length>1&&g<this.outputs.length)y=n[g];else{const x=this.metricsTensors[g][0],v=this.metricsTensors[g][1];y=Wt(x(r[v],p[v]))}wn(y),o.push(y)}return f=Wt(f),this.calculateLosses().forEach(g=>{f=oe(f,g)}),f},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>K(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:r[c]});const a=new Da(o),l=Yp(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=Wt(u(i[c],l[c]));c===0?s=d:s=oe(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=Wt(u(i[d],l[d]));n.push(h)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,i,o,a,l,c,u,d,h;try{const p=s.batchSize==null?32:s.batchSize;KI(p);const g=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,p);r=g[0],i=g[1],h=g[2];let y=!1,x;if(s.validationData!=null&&s.validationData.length>0){if(y=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Ke("validationData including sample weights is not supported yet."):new W(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const $=await this.standardizeUserData(l,c,null,null,!0,p);u=$[0],d=$[1],x=u.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){y=!0;const E=Math.floor(r[0].shape[0]*(1-s.validationSplit)),$=r[0].shape[0];u=Rp(r,E,$),o=r,r=Rp(r,0,E),d=Rp(i,E,$),a=i,i=Rp(i,0,E),x=u.concat(d)}else s.validationSteps!=null&&(y=!0);const v=r.concat(i).concat(h);this.checkTrainableWeightsConsistency();const w=this.makeTrainFunction(),I=this.getDedupedMetricsNames();let N,A;y?(this.makeTestFunction(),N=this.testFunction,A=I.slice().concat(I.map(E=>"val_"+E))):(N=null,x=[],A=I.slice());const T=$B(s.callbacks,s.yieldEvery);return await this.fitLoop(w,v,I,p,s.epochs,s.verbose,T,N,x,s.shuffle,A,s.initialEpoch,null,null)}finally{this.isTraining=!1,oi(r,e),oi(i,n),oi(o,e),oi(a,n),oi(u,l),oi(d,c),h!=null&&Ye(h)}}async fitLoop(e,n,s,r,i,o,a,l,c,u,d,h,p,f){r==null&&(r=32),i==null&&(i=1),u==null&&(u=!0),h==null&&(h=0);let g=!1;if(l!=null&&c!=null&&(g=!0),f!=null&&(g=!0,p==null))throw new W("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const y=this.checkNumSamples(n,r,p,"steps_per_epoch");let x;y!=null&&(x=Ti(0,y)),o==null&&(o=1);const{callbackList:v,history:w}=AB(a,o,i,h,y,p,r,g,d);v.setModel(this),this.history=w,await v.onTrainBegin(),this.stopTraining_=!1;for(let I=h;I<i;++I){await v.onEpochBegin(I);const N={};if(p!=null)throw new Ke("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Ke("batch shuffling is not implemneted yet");u&&U_(x);const A=rs(x),T=XI(y,r);for(let S=0;S<T.length;++S){const E={};if(await v.onBatchBegin(S,E),K(()=>{const $=T[S][0],P=T[S][1],F=yc(A,$,P-$);E.batch=S,E.size=P-$;const R=TT(n,F),G=e(R);for(let q=0;q<s.length;++q){const Q=s[q],te=G[q];E[Q]=te,wn(te)}if(S===T.length-1&&g){const q=this.testLoop(l,c,r);for(let Q=0;Q<s.length;++Q){const te=s[Q],B=q[Q];wn(B),N["val_"+te]=B}}}),await v.onBatchEnd(S,E),CB(E),this.stopTraining_)break}A.dispose()}if(await v.onEpochEnd(I,N),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return hye(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],i=s[1],a=this.makeTrainFunction()(r.concat(i)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return Ye(a),oi(s[0],e),oi(s[1],n),Ps(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,i=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:i[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=qS().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-qS().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=ko(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>ko(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=ko(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[ko(xx(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>ko(xx(e)));{const e={};for(const n in this.metrics)e[n]=ko(xx(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=kT(e.optimizer_config),s=Oo(n);let r;if(typeof e.loss=="string")r=Yl(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>Yl(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=Yl(e.loss[o])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(o=>Yl(o));else if(e.metrics!=null){i={};for(const o in e.metrics)i[o]=Yl(e.metrics[o])}this.compile({loss:r,metrics:i,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=ZV(e);if(c.length===0)throw new W(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new W(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new W("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await KS(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:bye,generatedBy:`TensorFlow.js tfjs-layers v${MB}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await KS(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=YV([s.data,u])}return this.userDefinedMetadata!=null&&(SP(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){SP(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}ed.className="Model";le(ed);class UB extends ed{}UB.className="Functional";le(UB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lm extends ed{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:m1("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new W(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof lm||e instanceof ed;let s;if(n){if(s=e,s.outputs.length!==1)throw new W("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new W("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new W("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=Ige({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new W(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new W("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=SB(this.outputs[0])}this.inboundNodes=[],new y1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:jc(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(dt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new ed({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let i,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new W("Legacy serialization format not supported yet.");i=n}else D(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=n.layers,delete n.layers,o=n;const a=new e(o);if(!(a instanceof lm))throw new Ke(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of i){const u=Oo(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new W("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new W("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}lm.className="Sequential";le(lm);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let cs=class extends au{getConfig(){return{}}};class WB extends cs{apply(e,n=1){return oge(e,n)}}WB.className="elu";le(WB);class GB extends cs{apply(e){return Ww(e)}}GB.className="selu";le(GB);class HB extends cs{apply(e){return Ai(e)}}HB.className="relu";le(HB);class qB extends cs{apply(e){return K(()=>ul(6,Ai(e)))}}qB.className="relu6";le(qB);class KB extends cs{apply(e){return e}}KB.className="linear";le(KB);class XB extends cs{apply(e){return bi(e)}}XB.className="sigmoid";le(XB);class YB extends cs{apply(e){return lge(e)}}YB.className="hardSigmoid";le(YB);class QB extends cs{apply(e){return ru(e)}}QB.className="softplus";le(QB);class JB extends cs{apply(e){return age(e)}}JB.className="softsign";le(JB);class ZB extends cs{apply(e){return cl(e)}}ZB.className="tanh";le(ZB);let h2=class extends cs{apply(e,n=-1){return Hh(e,n)}};h2.className="softmax";le(h2);class eU extends cs{apply(e,n=-1){return Fw(e,n)}}eU.className="logSoftmax";le(eU);class tU extends cs{apply(e){return K(()=>K(()=>{const n=Math.sqrt(2),s=j(.5,oe(1,Dw(Ee(e,n))));return j(e,s)}))}}tU.className="gelu";le(tU);class nU extends cs{apply(e){return K(()=>j(.5,j(e,oe(1,cl(j(Pn(Ee(2,Math.PI)),oe(e,j(.044715,ro(e,3)))))))))}}nU.className="gelu_new";le(nU);class sU extends cs{apply(e){return K(()=>j(e,cl(ru(e))))}}sU.className="mish";le(sU);class rU extends cs{apply(e,n=1){return K(()=>j(bi(j(e,n)),e))}}rU.className="swish";le(rU);function hl(t){return t.getClassName()}function YI(t,e={}){return ay(t,xr.getMap().classNameMap,e,"activation")}function pl(t){if(t==null){const e={};return e.className="linear",e.config={},YI(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},YI(e)}else return t instanceof cs?t:YI(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wye(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class iU extends au{}class oU extends iU{constructor(e){super(),wye(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return K(()=>{let n=sn([1]);return this.hasL1&&(n=oe(n,Te(j(this.l1,pn(e))))),this.hasL2&&(n=oe(n,Te(j(this.l2,cy(e))))),U(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}oU.className="L1L2";le(oU);const $P={l1l2:"L1L2"};function Tt(t){return JC(t)}function AP(t,e={}){return ay(t,xr.getMap().classNameMap,e,"regularizer")}function jt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in $P?$P[t]:t,config:{}};return AP(n)}else return t instanceof iU?t:AP(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aU extends Je{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=Me(e);let s=Ai(e);return this.maxValue!=null&&(s=zs(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}aU.className="ReLU";le(aU);class lU extends Je{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Me(e);return Hg(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}lU.className="LeakyReLU";le(lU);class cU extends Je{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=zt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=jt(e.alphaRegularizer),this.alphaConstraint=Tn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new W(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=dt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new kn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=Me(e),Zg(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Gt(this.alphaInitializer),alphaRegularizer:Tt(this.alphaRegularizer),alphaConstraint:Sn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}cU.className="PReLU";le(cU);let uU=class extends Je{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ke(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Me(e);return Bh(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};uU.className="ELU";le(uU);class dU extends Je{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=Me(e);return j(s,me(Hs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}dU.className="ThresholdedReLU";le(dU);class hU extends Je{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new h2().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return K(()=>{let s=Me(e);const r=n.mask;if(r!=null){const i=j(Ie(Os(s.shape),me(r,s.dtype)),Pe(-1e9));s=oe(s,i)}return this.axis instanceof Array?this.axis.length>1?js(Ie(s,Kg(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}hU.className="Softmax";le(hU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function td(t,e,n){if(typeof t=="number")return jc(t,e);if(t.length!==e)throw new W(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!nge(r))throw new W(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function wi(t,e,n,s,r=1){if(t==null)return t;const i=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-i+1,Math.floor((o+s-1)/s)}function Mi(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+dl([n-e,0]);else if(s==="same")t=t*e;else throw new W(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function p2(t,e){return K(()=>(un(e),e==="channelsFirst"?tt(t,[0,2,3,1]):t))}function pU(t,e){return K(()=>(un(e),e==="channelsFirst"?tt(t,[0,2,3,4,1]):t))}function Iye(t,e,n,s=1,r="valid",i,o=1){return K(()=>{if(i==null&&(i=Ni()),un(i),t.shape.length!==3)throw new W(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new W(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new W(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(i==="channelsFirst"&&(t=tt(t,[0,2,1])),r==="causal")throw new Ke("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=Cw(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(a=Ri(a,n)),a})}function RP(t,e,n,s=[1,1],r="valid",i,o,a=null){return K(()=>{if(i==null&&(i=Ni()),un(i),t.rank!==3&&t.rank!==4)throw new W(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new W(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=p2(t,i);if(r==="causal")throw new Ke("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=ej({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),i==="channelsFirst"&&(l=tt(l,[0,3,1,2])),l})}function kye(t,e,n,s=[1,1,1],r="valid",i,o){return K(()=>{if(i==null&&(i=Ni()),un(i),t.rank!==4&&t.rank!==5)throw new W(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new W(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=pU(t,i);if(r==="causal")throw new Ke("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=NE(a,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(a=Ri(a,n)),i==="channelsFirst"&&(a=tt(a,[0,4,1,2,3])),a})}class b1 extends Je{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",b1.verifyArgs(n),this.rank=e,An(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ke(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=td(n.kernelSize,e,"kernelSize"),this.strides=td(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Rr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,un(this.dataFormat),this.activation=pl(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=zt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Tn(n.biasConstraint),this.biasRegularizer=jt(n.biasRegularizer),this.activityRegularizer=jt(n.activityRegularizer),this.dilationRate=td(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new W(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new W(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new W(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Li("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!ZC(e.kernelSize,"number",1,3))throw new W(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:hl(this.activation),useBias:this.useBias,biasInitializer:Gt(this.biasInitializer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),biasConstraint:Sn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Kh extends b1{constructor(e,n){super(e,n),this.kernel=null,Kh.verifyArgs(n),this.filters=n.filters,An(this.filters,"filters"),this.kernelInitializer=zt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Tn(n.kernelConstraint),this.kernelRegularizer=jt(n.kernelRegularizer)}build(e){e=dt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new W(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return K(()=>{e=Me(e);let s;const r=this.bias==null?null:this.bias.read(),i=cB(this.activation.getClassName());if(i!=null&&this.rank===2)s=RP(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)s=Iye(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=RP(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=kye(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ke("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=dt(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<s.length;++i){const o=wi(s[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Gt(this.kernelInitializer),kernelRegularizer:Tt(this.kernelRegularizer),kernelConstraint:Sn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new W(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class py extends Kh{constructor(e){super(2,e),py.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!ZC(e.kernelSize,"number",1,2))throw new W(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}py.className="Conv2D";le(py);class fy extends Kh{constructor(e){super(3,e),fy.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new W(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}fy.className="Conv3D";le(fy);class fU extends py{constructor(e){if(super(e),this.inputSpec=[new kn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new W(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=dt(e),e.length!==4)throw new W("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new W("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new kn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return K(()=>{let s=Me(e);if(s.shape.length!==4)throw new W(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=r[o],c=r[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],p=this.strides[1],f=Mi(l,h,u,this.padding),g=Mi(c,p,d,this.padding),y=[i,f,g,this.filters];this.dataFormat!=="channelsLast"&&(s=tt(s,[0,2,3,1]));let x=$w(s,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(x=tt(x,[0,3,1,2])),this.bias!=null&&(x=Ri(x,this.bias.read(),this.dataFormat)),this.activation!=null&&(x=this.activation.apply(x)),x})}computeOutputShape(e){e=dt(e);const n=e.slice();let s,r,i;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3):(s=3,r=1,i=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=Mi(n[r],l,o,this.padding),n[i]=Mi(n[i],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}fU.className="Conv2DTranspose";le(fU);class mU extends fy{constructor(e){if(super(e),this.inputSpec=[new kn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new W(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=dt(e),e.length!==5)throw new W("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new W("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new kn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return K(()=>{let s=Me(e);if(s.shape.length!==5)throw new W(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,i=r[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=r[l],u=r[o],d=r[a],h=this.kernelSize[0],p=this.kernelSize[1],f=this.kernelSize[2],g=this.strides[0],y=this.strides[1],x=this.strides[2],v=Mi(c,g,h,this.padding),w=Mi(u,y,p,this.padding),I=Mi(d,x,f,this.padding),N=[i,v,w,I,this.filters];this.dataFormat!=="channelsLast"&&(s=tt(s,[0,2,3,4,1]));let A=_E(s,this.kernel.read(),N,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(A=tt(A,[0,4,1,2,3])),this.bias!==null&&(A=Ri(A,this.bias.read(),this.dataFormat)),this.activation!==null&&(A=this.activation.apply(A)),A})}computeOutputShape(e){e=dt(e);const n=e.slice();let s,r,i,o;this.dataFormat==="channelsFirst"?(s=1,r=2,i=3,o=4):(s=4,r=1,i=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=Mi(n[r],u,a,this.padding),n[i]=Mi(n[i],d,l,this.padding),n[o]=Mi(n[o],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}mU.className="Conv3DTranspose";le(mU);class gU extends Kh{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new W("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new W("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new W(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=zt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=jt(n.depthwiseRegularizer),this.depthwiseConstraint=Tn(n.depthwiseConstraint),this.pointwiseInitializer=zt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=jt(n.pointwiseRegularizer),this.pointwiseConstraint=Tn(n.pointwiseConstraint)}build(e){if(e=dt(e),e.length<this.rank+2)throw new W(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new W(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),i=[];for(let a=0;a<this.rank;++a)i.push(1);i.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new kn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return K(()=>{e=Me(e);let s;if(this.rank===1)throw new Ke("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=tt(e,[0,2,3,1])),s=Gw(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Ri(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=tt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Gt(this.depthwiseInitializer),e.pointwiseInitializer=Gt(this.pointwiseInitializer),e.depthwiseRegularizer=Tt(this.depthwiseRegularizer),e.pointwiseRegularizer=Tt(this.pointwiseRegularizer),e.depthwiseConstraint=Sn(this.depthwiseConstraint),e.pointwiseConstraint=Sn(this.pointwiseConstraint),e}}gU.className="SeparableConv";class yU extends gU{constructor(e){super(2,e)}}yU.className="SeparableConv2D";le(yU);class w1 extends Kh{constructor(e){super(1,e),w1.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!ZC(e.kernelSize,"number",1,1))throw new W(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}w1.className="Conv1D";le(w1);class xU extends Je{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return K(()=>{if(e=Me(e),this.dataFormat==="channelsLast"){const s=yx(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return yx(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=yx(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return yx(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}xU.className="Cropping2D";le(xU);class vU extends Je{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,un(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Zme(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return K(()=>{let s=Me(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=tt(s,[0,2,3,1]);const i=this.size[0]*r[2],o=this.size[1]*r[3],a=this.interpolation==="nearest"?Wr.resizeNearestNeighbor(s,[i,o]):Wr.resizeBilinear(s,[i,o]);return tt(a,[0,3,1,2])}else{const i=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?Wr.resizeNearestNeighbor(s,[i,o]):Wr.resizeBilinear(s,[i,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}vU.className="UpSampling2D";le(vU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sye(t,e,n=[1,1],s="valid",r,i){return K(()=>{r==null&&(r=Ni()),un(r);let o=p2(t,r);if(t.rank!==4)throw new W(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new W(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=jh(o,e,n,s==="same"?"same":"valid","NHWC",i),r==="channelsFirst"&&(o=tt(o,[0,3,1,2])),o})}class bU extends b1{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=zt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Tn(e.depthwiseConstraint),this.depthwiseRegularizer=jt(e.depthwiseRegularizer)}build(e){if(e=dt(e),e.length<4)throw new W(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new W(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{e=Me(e);let s=Sye(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Ri(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=dt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=wi(n,this.kernelSize[0],this.padding,this.strides[0]),o=wi(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,i,o]:[e[0],i,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Gt(this.depthwiseInitializer),e.depthwiseRegularizer=Tt(this.depthwiseRegularizer),e.depthwiseConstraint=Sn(this.depthwiseRegularizer),e}}bU.className="DepthwiseConv2D";le(bU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wU(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new W("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(i){return i==null||Array.isArray(i)?i:[i]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function IU(t,e,n,s=!1,r,i,o=!1,a=!1){return K(()=>{const l=e.shape.length;if(l<3)throw new W(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Ti(2,l));e=tt(e,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=me(me(r,"bool"),"float32"),r.rank===l-1&&(r=ns(r,-1)),r=tt(r,c)),s&&(e=Er(e,0),r!=null&&(r=Er(r,0)));const u=[];let d,h=n;const p=e.shape[0],f=Cr(e);let g;r!=null&&(g=Cr(r));for(let x=0;x<p;++x){const v=f[x],w=K(()=>t(v,h));if(r==null)d=w[0],h=w[1];else{const I=K(()=>{const N=g[x],A=Ie(ar(N),N),T=oe(j(w[0],N),j(h[0],A)),S=h.map((E,$)=>oe(j(w[1][$],N),j(E,A)));return{output:T,newStates:S}});d=I.output,h=I.newStates}a&&u.push(d)}let y;return a&&(y=Bs(u,1)),[d,y,h]})}class Cl extends Je{constructor(e){super(e);let n;if(e.cell==null)throw new W("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new g2({cells:e.cell}):n=e.cell,n.stateSize==null)throw new W("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new kn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ti(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){bT(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const i=[];for(const o of n)i.push([e[0],o]);return[r].concat(i)}else return r}computeMask(e,n){return K(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(i=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ke("Constants support is not implemented in RNN yet.");bT(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new kn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!Ze(this.stateSpec.map(o=>o.shape[o.shape.length-1]),i))throw new W(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(o=>new kn({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){K(()=>{if(!this.stateful)throw new Fi("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new W("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>sn([s,r])):this.states_=[sn([s,this.cell.stateSize])];else if(e==null)Ye(this.states_),this.keptStates!=null&&(Ye(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>sn([s,r])):this.states_[0]=sn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new W(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Ye(this.states_);for(let r=0;r<this.states_.length;++r){const i=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,o];if(!Ze(i.shape,a))throw new W(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${i.shape}`);this.states_[r]=i}}this.states_=this.states_.map(r=>wn(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=wU(e,s,r,this.numConstants);e=i.inputs,s=i.initialState,r=i.constants;let o=[],a=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new kn({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof oo){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return K(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let i=n==null?null:n.initialState;e=Me(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==o)throw new W(`RNN Layer has ${o} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=IU((f,g)=>{const y=this.cell.call([f].concat(g),a);return[y[0],y.slice(1)]},e,i,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,r);const p=this.returnSequences?d:u;return this.returnState?[p].concat(h):p})}getInitialState(e){return K(()=>{let n=sn(e.shape);return n=Te(n,[1,2]),n=ly(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?xT(n,[1,s]):n):this.cell.stateSize>1?[xT(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Cl.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,i=Oo(r,s);return new e(Object.assign(n,{cell:i}))}}Cl.className="RNN";le(Cl);class I1 extends Je{}class f2 extends I1{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,An(this.units,"units"),this.activation=pl(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=jt(e.kernelRegularizer),this.recurrentRegularizer=jt(e.recurrentRegularizer),this.biasRegularizer=jt(e.biasRegularizer),this.kernelConstraint=Tn(e.kernelConstraint),this.recurrentConstraint=Tn(e.recurrentConstraint),this.biasConstraint=Tn(e.biasConstraint),this.dropout=_d([1,dl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=_d([1,dl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=dt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{if(e=e,e.length!==2)throw new W(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=fl({ones:()=>ar(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=fl({ones:()=>ar(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?i=eo(j(e,o),this.kernel.read()):i=eo(e,this.kernel.read()),this.bias!=null&&(i=Ri(i,this.bias.read())),a!=null&&(s=j(s,a));let l=oe(i,eo(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:hl(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Tt(this.kernelRegularizer),recurrentRegularizer:Tt(this.recurrentRegularizer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),kernelConstraint:Sn(this.kernelConstraint),recurrentConstraint:Sn(this.recurrentConstraint),biasConstraint:Sn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}f2.className="SimpleRNNCell";le(f2);class kU extends Cl{constructor(e){e.cell=new f2(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(Ye(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ye(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return new e(n)}}kU.className="SimpleRNN";le(kU);class m2 extends I1{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new W("GRUCell does not support reset_after parameter set to true.");this.units=e.units,An(this.units,"units"),this.activation=pl(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=pl(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=jt(e.kernelRegularizer),this.recurrentRegularizer=jt(e.recurrentRegularizer),this.biasRegularizer=jt(e.biasRegularizer),this.kernelConstraint=Tn(e.kernelConstraint),this.recurrentConstraint=Tn(e.recurrentConstraint),this.biasConstraint=Tn(e.biasConstraint),this.dropout=_d([1,dl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=_d([1,dl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=dt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return K(()=>{if(e=e,e.length!==2)throw new W(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=fl({ones:()=>ar(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=fl({ones:()=>ar(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=j(e,i[0]));let u=eo(e,this.kernel.read());this.useBias&&(u=Ri(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=j(r,o[0]));const d=this.recurrentKernel.read(),[h,p]=Ls(d,[2*this.units,this.units],d.rank-1),f=eo(r,h),[g,y,x]=Ls(u,3,u.rank-1),[v,w]=Ls(f,2,f.rank-1);a=this.recurrentActivation.apply(oe(g,v)),l=this.recurrentActivation.apply(oe(y,w));const I=eo(j(l,r),p);c=this.activation.apply(oe(x,I));const N=oe(j(a,r),j(oe(1,At(a)),c));return[N,N]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:hl(this.activation),recurrentActivation:hl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Tt(this.kernelRegularizer),recurrentRegularizer:Tt(this.recurrentRegularizer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),kernelConstraint:Sn(this.kernelConstraint),recurrentConstraint:Sn(this.recurrentConstraint),biasConstraint:Sn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}m2.className="GRUCell";le(m2);class SU extends Cl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new m2(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(Ye(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ye(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}SU.className="GRU";le(SU);class k1 extends I1{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,An(this.units,"units"),this.activation=pl(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=pl(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=jt(e.kernelRegularizer),this.recurrentRegularizer=jt(e.recurrentRegularizer),this.biasRegularizer=jt(e.biasRegularizer),this.kernelConstraint=Tn(e.kernelConstraint),this.recurrentConstraint=Tn(e.recurrentConstraint),this.biasConstraint=Tn(e.biasConstraint),this.dropout=_d([1,dl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=_d([1,dl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=dt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,o=this.units;r=new(n=class extends ei{apply(l,c){const u=i.apply([o]),d=new t2().apply([o]),h=i.apply([o*2]);return mP(mP(u,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return K(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new W(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=fl({ones:()=>ar(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=fl({ones:()=>ar(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=j(e,o[0]));let h=eo(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=j(r,a[0])),h=oe(h,eo(r,this.recurrentKernel.read())),this.useBias&&(h=Ri(h,this.bias.read()));const[p,f,g,y]=Ls(h,4,h.rank-1);l=this.recurrentActivation.apply(p),c=this.recurrentActivation.apply(f),u=oe(j(c,i),j(l,this.activation.apply(g))),d=this.recurrentActivation.apply(y);const x=j(d,this.activation.apply(u));return[x,x,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:hl(this.activation),recurrentActivation:hl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Tt(this.kernelRegularizer),recurrentRegularizer:Tt(this.recurrentRegularizer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),kernelConstraint:Sn(this.kernelConstraint),recurrentConstraint:Sn(this.recurrentConstraint),biasConstraint:Sn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}k1.className="LSTMCell";le(k1);class TU extends Cl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new k1(e),super(e)}call(e,n){return K(()=>{this.cell.dropoutMask!=null&&(Ye(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ye(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}TU.className="LSTM";le(TU);class g2 extends I1{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return K(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const i=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),i.push(o.slice(1))}s=[];for(const a of i.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){bT(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{gc(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=i=>({className:i.getClassName(),config:i.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const i of n.cells)r.push(Oo(i,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return wT(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,i=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],i[o]])}l2(n)}}g2.className="StackedRNNCells";le(g2);function fl(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:i}=t,o=()=>i!=null?i(e(),n):gB(e(),n),a=()=>uy(o,e,s);return!r||r<=1?wn(a().clone()):Array(r).fill(void 0).map(a).map(c=>wn(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Tye=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class NU extends Cl{constructor(e){if(e.unroll)throw new Ke("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ke("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new kn({ndim:5})]}call(e,n){return K(()=>{if(this.cell.dropoutMask!=null&&(Ye(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Ye(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new W("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,i=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:i})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return K(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)],o=sn(i);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){K(()=>{if(!this.stateful)throw new Fi("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),i=[r[0],...r.slice(2)];if(s[0]==null)throw new W("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>sn(i)):this.states_=[sn(i)];else if(e==null)Ye(this.states_),this.keptStates!=null&&(Ye(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>sn(i)):this.states_[0]=sn(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new W(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Ye(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=i;if(!Ze(l.shape,c))throw new W(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>wn(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:i,strides:o,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=wi(c,r[0],i,o[0],a[0]),h=wi(u,r[1],i,o[1],a[1]);return[...e.slice(0,2),...l?[s,d,h]:[d,h,s]]}}NU.className="ConvRNN2D";class y2 extends k1{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:i,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,An(this.filters,"filters"),this.kernelSize=td(s,2,"kernelSize"),this.kernelSize.forEach(l=>An(l,"kernelSize")),this.strides=td(r||1,2,"strides"),this.strides.forEach(l=>An(l,"strides")),this.padding=i||"valid",Rr(this.padding),this.dataFormat=o||"channelsLast",un(this.dataFormat),this.dilationRate=td(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>An(l,"dilationRate"))}build(e){var n;e=dt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new W(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],i=4,o=this.kernelSize.concat([r,this.filters*i]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends ei{apply(h,p){const f=c.apply([u]),g=Os([u]),y=c.apply([u*2]);return e2([f,g,y])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return K(()=>{if(e.length!==3)throw new W(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],i=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=fl({ones:()=>ar(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(Z,se,re)=>!se||!se[re]?Z:j(se[re],Z);let u=c(r,l,0),d=c(r,l,1),h=c(r,l,2),p=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=fl({ones:()=>ar(i),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const f=this.recurrentDropoutMask;let g=c(i,f,0),y=c(i,f,1),x=c(i,f,2),v=c(i,f,3);const w=3,[I,N,A,T]=Ls(this.kernel.read(),a,w),[S,E,$,P]=this.useBias?Ls(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,I,S,this.padding),d=this.inputConv(d,N,E,this.padding),h=this.inputConv(h,A,$,this.padding),p=this.inputConv(p,T,P,this.padding);const[F,R,G,q]=Ls(this.recurrentKernel.read(),a,w);g=this.recurrentConv(g,F),y=this.recurrentConv(y,R),x=this.recurrentConv(x,G),v=this.recurrentConv(v,q);const Q=this.recurrentActivation.apply(oe(u,g)),te=this.recurrentActivation.apply(oe(d,y)),B=oe(j(te,o),j(Q,this.activation.apply(oe(h,x)))),H=j(this.recurrentActivation.apply(oe(p,v)),this.activation.apply(B));return[H,H,B]})}getConfig(){const e=super.getConfig(),n=Tye(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const i=Ko(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Ri(i,s,this.dataFormat):i}recurrentConv(e,n){return Ko(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}y2.className="ConvLSTM2DCell";le(y2);class _U extends NU{constructor(e){const n=new y2(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}_U.className="ConvLSTM2D";le(_U);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class x2 extends Je{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=Me(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,i=this.getNoiseShape(s);return uy(()=>gB(s,this.rate,i,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}x2.className="Dropout";le(x2);class EU extends x2{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}EU.className="SpatialDropout1D";le(EU);class CU extends Je{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,An(this.units,"units"),this.activation=pl(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Tn(e.kernelConstraint),this.biasConstraint=Tn(e.biasConstraint),this.kernelRegularizer=jt(e.kernelRegularizer),this.biasRegularizer=jt(e.biasRegularizer),this.activityRegularizer=jt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=dt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=dt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=Me(e),r=cB(this.activation.getClassName());let i;return r!=null?i=eo(s,this.kernel.read(),r,this.bias?this.bias.read():null):(i=eo(s,this.kernel.read()),this.bias!=null&&(i=Ri(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:hl(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:Tt(this.kernelRegularizer),biasRegularizer:Tt(this.biasRegularizer),activityRegularizer:Tt(this.activityRegularizer),kernelConstraint:Sn(this.kernelConstraint),biasConstraint:Sn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}CU.className="Dense";le(CU);class $U extends Je{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=dt(e);for(const n of e.slice(1))if(n==null)throw new W(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Xa(e,1)]}call(e,n){return K(()=>{this.invokeCallHook(e,n);let s=Me(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let i=2;i<s.rank;++i)r.push(i);r.push(1),s=tt(s,r)}return ige(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}$U.className="Flatten";le($U);class AU extends Je{constructor(e){super(e),this.supportsMasking=!0,this.activation=pl(e.activation)}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=Me(e);return this.activation.apply(s)})}getConfig(){const e={activation:hl(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}AU.className="Activation";le(AU);class RU extends Je{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return K(()=>(e=Me(e),sge(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}RU.className="RepeatVector";le(RU);class DU extends Je{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let i=1,o=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(o===null)o=l;else throw new W("Can only specifiy one unknown dimension.");else i*=c}const a=Xa(e);if(o!==null){if(i===0||a%i!==0)throw new W(s);r[o]=a/i}else if(a!==i)throw new W(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=Me(e),r=s.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return U(s,i)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}DU.className="Reshape";le(DU);class PU extends Je{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Ti(1,e.dims.length+1);if(!Ze(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new kn({ndim:this.dims.length+1})]}computeOutputShape(e){e=dt(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return tt(Me(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}PU.className="Permute";le(PU);class OU extends Je{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=Me(e);return nm(Lc(s,this.maskValue),-1)}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=Me(e),o=nm(Lc(s,this.maskValue),-1,!0);return j(s,me(o,s.dtype))})}}OU.className="Masking";le(OU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FU extends Je{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(xt(e.inputLength))}this.inputDim=e.inputDim,An(this.inputDim,"inputDim"),this.outputDim=e.outputDim,An(this.outputDim,"outputDim"),this.embeddingsInitializer=zt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=jt(e.embeddingsRegularizer),this.activityRegularizer=jt(e.activityRegularizer),this.embeddingsConstraint=Tn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return K(()=>this.maskZero?(e=Me(e),Lc(e,nt(e))):null)}computeOutputShape(e){if(e=dt(e),this.inputLength==null)return[...e,this.outputDim];const n=xt(this.inputLength);if(n.length!==e.length-1)throw new W(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const i=n[r],o=e[r+1];if(i!=null&&o!=null&&i!==o)throw new W(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return K(()=>{this.invokeCallHook(e,n);let s=Me(e);s.dtype!=="int32"&&(s=Zi(s,"int32"));const r=mB(this.embeddings.read(),U(s,[s.size]));return U(r,dt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Gt(this.embeddingsInitializer),embeddingsRegularizer:Tt(this.embeddingsRegularizer),activityRegularizer:Tt(this.activityRegularizer),embeddingsConstraint:Sn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}FU.className="Embedding";le(FU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cu extends Je{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ke}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const i=e[e.length-n.length+r],o=n[r];if(i==null||o==null||i<0||o<0)s.push(null);else if(i===1)s.push(o);else if(o===1)s.push(i);else{if(i!==o)throw new W("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(i)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[dt(e)]),e=e,e.length<2)throw new W(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const i of e)i!=null&&i[0]!==null&&n.push(i[0]);if(n=Ka(n),n.length>1)throw new W(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const o=e[i]==null?null:e[i].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(i=>i.length);e.indexOf(null)===-1&&Ka(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return K(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(i=>i.rank);if(r.indexOf(null)===-1){const i=dl(r);for(let o of e){const a=o.rank;for(let l=0;l<i-a;++l)o=ly(o,1);s.push(o)}return this.mergeFunction(s)}else{let i=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let p=U(l,[d].concat(Xa(u.slice(1))));p=tt(p,[1,0]),p=U(p,h),s.push(p),i=!0}else if(c>1){const u=Ti(1,c).concat([0]);s.push(tt(l,u)),i=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(i){if(a==null){const l=o.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));o=U(tt(U(o,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(Ti(0,a-1));o=tt(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,i)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Ka(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return K(()=>{if(n==null)return null;if(!Array.isArray(n))throw new W("`mask` should be an Array");if(!Array.isArray(e))throw new W("`inputs` should be an Array");if(n.length!==e.length)throw new W(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:ns(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Si(s,n[r]);return s})}}class LU extends cu{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=oe(n,e[s]);return n})}}LU.className="Add";le(LU);class MU extends cu{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=j(n,e[s]);return n})}}MU.className="Multiply";le(MU);class VU extends cu{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=oe(n,e[s]);return j(1/e.length,n)})}}VU.className="Average";le(VU);class zU extends cu{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=ho(n,e[s]);return n})}}zU.className="Maximum";le(zU);class jU extends cu{constructor(e){super(e)}mergeFunction(e){return K(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=ul(n,e[s]);return n})}}jU.className="Minimum";le(jU);class BU extends cu{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new W("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const i=e[r].slice();i.splice(this.axis,1);let o=!1;for(const a of s)if(Ze(a,i)){o=!0;break}o||s.push(i)}if(s.length>1)throw new W("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return K(()=>e2(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new W("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const i of n.slice(1)){if(s[r]==null||i[r]==null){s[r]=null;break}s[r]+=i[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new W("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new W("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new W(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return K(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(me(ar(e[o]),"bool")):n[o].rank<e[o].rank?r.push(ns(n[o],-1)):r.push(n[o]);const i=rn(r,this.axis);return Ew(i,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}BU.className="Concatenate";le(BU);function Dp(t,e){for(;t<0;)t+=e;return t}function Nye(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ke("batchDot is not implemented for tensors of 4D or higher rank yet");if(D(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),D(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ke("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const i=n;return K(()=>{let o;if(s>r){o=s-r;const l=[];for(let c=0;c<o;++c)l.push(1);e=U(e,e.shape.concat(l))}else if(r>s){o=r-s;const l=[];for(let c=0;c<o;++c)l.push(1);t=U(t,t.shape.concat(l))}else o=0;let a;if(t.shape.length===2&&e.shape.length===2)i[0]===i[1]?a=Te(j(t,e),i[0]):a=Te(j(tt(t,[1,0]),e),i[1]);else{const l=i[0]!==t.shape.length-1,c=i[1]===e.shape.length-1;a=Xe(t,e,l,c)}if(o>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+o;++u)c.push(u);a=la(a,c)}return a.shape.length===1&&(a=ns(a,1)),a})}class UU extends cu{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){D(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Ke("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new W(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new W(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((i,o)=>Dp(i,e[o].shape.length)):r=[Dp(this.axes,n.shape.length),Dp(this.axes,s.shape.length)],this.normalize&&(n=f0(n,r[0]),s=f0(s,r[1])),Nye(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Dp(this.axes,e.length),Dp(this.axes,n.length)],s}computeOutputShape(e){D(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Ke("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const i=n.concat(s);return i.length===1&&i.push(1),i}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}UU.className="Dot";le(UU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class WU extends Je{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=Me(e);return uy(()=>oe(g1(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}WU.className="GaussianNoise";le(WU);class GU extends Je{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return K(()=>{this.invokeCallHook(e,n);const s=Me(e);return this.rate>0&&this.rate<1?uy(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return j(s,g1(s.shape,1,i))},()=>s,n.training||!1):s})}}GU.className="GaussianDropout";le(GU);class HU extends Je{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Me(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return K(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return uy(()=>{const i=Me(e),l=-1.6732632423543772*1.0507009873554805;let c=oa(_l(s),this.rate);c=Zi(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-u*l*this.rate,h=oe(j(i,c),j(oe(c,-1),l));return oe(j(h,u),d)},()=>Me(e),n.training||!1)}return e})}}HU.className="AlphaDropout";le(HU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cm(t,e,n,s,r,i=.001){let o;if(t.rank===2)o=gE(t,e,n,s,r,i);else if(t.rank===3)o=yE(t,e,n,s,r,i);else if(t.rank===4)o=xE(t,e,n,s,r,i);else throw new Ke(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function _ye(t,e,n,s,r=.001){return K(()=>{const i=Qg(t,s),o=i.mean,a=i.variance;return[cm(t,o,a,n,e,r),o,a]})}function Eye(t,e,n,s,r=.001){return K(()=>{const i=Qg(t,s),o=i.mean,a=i.variance,l=[];for(const f of Ti(0,t.rank))s.indexOf(f)!==-1?l.push(1):l.push(t.shape[f]);const c=U(o,l),u=U(a,l),d=e==null?null:U(e,l),h=n==null?null:U(n,l);return[cm(t,c,u,h,d,r),o,a]})}function Cye(t,e,n,s,r=.001){return Ze(s.slice().sort(),Ti(0,t.rank-1))?_ye(t,e,n,s,r):Eye(t,e,n,s,r)}class qU extends Je{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=zt(e.betaInitializer||"zeros"),this.gammaInitializer=zt(e.gammaInitializer||"ones"),this.movingMeanInitializer=zt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=zt(e.movingVarianceInitializer||"ones"),this.betaConstraint=Tn(e.betaConstraint),this.gammaConstraint=Tn(e.gammaConstraint),this.betaRegularizer=jt(e.betaRegularizer),this.gammaRegularizer=jt(e.gammaRegularizer)}build(e){e=dt(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new W(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new kn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return K(()=>{const s=n.training==null?!1:n.training,r=Me(e),i=r.shape,o=i.length,a=Ti(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=jc(1,o);c[l]=i[l];const u=a.slice();u.sort();const d=!Ze(u,Ti(0,o).slice(0,o-1)),h=()=>{if(d){const v=U(this.movingMean.read(),c),w=U(this.movingVariance.read(),c),I=this.center?U(this.beta.read(),c):null,N=this.scale?U(this.gamma.read(),c):null;return cm(r,v,w,I,N,this.epsilon)}else return cm(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[p,f,g]=Cye(r,this.gamma.read(),this.beta.read(),a,this.epsilon),y=(v,w,I)=>{K(()=>{const N=1-I,A=v.read(),T=j(Ie(A,w),N);v.write(Ie(A,T))})};return(()=>{y(this.movingMean,f,this.momentum),y(this.movingVariance,g,this.momentum)})(),p})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gt(this.betaInitializer),gammaInitializer:Gt(this.gammaInitializer),movingMeanInitializer:Gt(this.movingMeanInitializer),movingVarianceInitializer:Gt(this.movingVarianceInitializer),betaRegularizer:Tt(this.betaRegularizer),gammaRegularizer:Tt(this.gammaRegularizer),betaConstraint:Sn(this.betaConstraint),gammaConstraint:Sn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}qU.className="BatchNormalization";le(qU);class KU extends Je{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=zt(e.betaInitializer||"zeros"),this.gammaInitializer=zt(e.gammaInitializer||"ones"),this.betaRegularizer=jt(e.betaRegularizer),this.gammaRegularizer=jt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=dt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=n);for(const i of this.axis)if(i<0||i>=n)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==Ka(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(i=>e[i]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=Me(e),r=s.shape,i=r.length;return K(()=>{let{mean:a,variance:l}=Qg(s,this.axis,!0);const c=jc(1,i);for(const g of this.axis)c[g]=r[g];const u=g=>g!=null&&g.shape.length!==i?U(g,c):g;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const p=[],f=[];for(let g=0;g<i;++g)this.axis.indexOf(g)!==-1?(p.push(r[g]),f.push(1)):(p.push(1),f.push(r[g]));return a=Ir(a,p),l=Ir(l,p),d!=null&&(d=Ir(d,f)),h!=null&&(h=Ir(h,f)),cm(s,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gt(this.betaInitializer),gammaInitializer:Gt(this.gammaInitializer),betaRegularizer:Tt(this.betaRegularizer),gammaRegularizer:Tt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}KU.className="LayerNormalization";le(KU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $ye(t,e,n){return K(()=>{if(t.rank!==4)throw new W(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new W("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ni()),n!=="channelsLast"&&n!=="channelsFirst")throw new W(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],aa(t,s)})}class XU extends Je{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ni():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new W(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new W(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new W(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new kn({ndim:4})]}computeOutputShape(e){e=dt(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return K(()=>$ye(Me(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}XU.className="ZeroPadding2D";le(XU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function S1(t,e,n,s,r,i){return K(()=>{un(r),dB(i),Rr(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Ni()),i==null&&(i="max"),t=p2(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=Yg(t,e,n,a):o=Bg(t,e,n,a),r==="channelsFirst"&&(o=tt(o,[0,3,1,2])),o})}function YU(t,e,n,s,r,i){return K(()=>{un(r),dB(i),Rr(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Ni()),i==null&&(i="max"),t=pU(t,r);let o;const a=s==="same"?"same":"valid";return i==="max"?o=jE(t,e,n,a):o=mE(t,e,n,a),r==="channelsFirst"&&(o=tt(o,[0,4,1,2,3])),o})}class QU extends Je{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new W(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(An(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new W(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);An(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Rr(this.padding),this.inputSpec=[new kn({ndim:3})]}computeOutputShape(e){e=dt(e);const n=wi(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return K(()=>{this.invokeCallHook(e,n),e=ly(Me(e),2);const s=this.poolingFunction(Me(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return la(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class JU extends QU{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return un(i),Rr(r),S1(e,n,s,r,i,"max")}}JU.className="MaxPooling1D";le(JU);class ZU extends QU{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return un(i),Rr(r),S1(e,n,s,r,i,"avg")}}ZU.className="AveragePooling1D";le(ZU);class eW extends Je{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new W(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];An(this.poolSize,"poolSize"),An(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,un(this.dataFormat),Rr(this.padding),this.inputSpec=[new kn({ndim:4})]}computeOutputShape(e){e=dt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=wi(n,this.poolSize[0],this.padding,this.strides[0]),s=wi(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return K(()=>(this.invokeCallHook(e,n),this.poolingFunction(Me(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class tW extends eW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return un(i),Rr(r),S1(e,n,s,r,i,"max")}}tW.className="MaxPooling2D";le(tW);class nW extends eW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return un(i),Rr(r),S1(e,n,s,r,i,"avg")}}nW.className="AveragePooling2D";le(nW);class sW extends Je{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new W(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];An(this.poolSize,"poolSize"),An(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,un(this.dataFormat),Rr(this.padding),this.inputSpec=[new kn({ndim:5})]}computeOutputShape(e){e=dt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=wi(n,this.poolSize[0],this.padding,this.strides[0]),s=wi(s,this.poolSize[1],this.padding,this.strides[1]),r=wi(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return K(()=>(this.invokeCallHook(e,n),this.poolingFunction(Me(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class rW extends sW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return un(i),Rr(r),YU(e,n,s,r,i,"max")}}rW.className="MaxPooling3D";le(rW);class iW extends sW{constructor(e){super(e)}poolingFunction(e,n,s,r,i){return un(i),Rr(r),YU(e,n,s,r,i,"avg")}}iW.className="AveragePooling3D";le(iW);class oW extends Je{constructor(e){super(e),this.inputSpec=[new kn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ke}}class aW extends oW{constructor(e){super(e||{})}call(e,n){return K(()=>{const s=Me(e);return Wt(s,1)})}}aW.className="GlobalAveragePooling1D";le(aW);class lW extends oW{constructor(e){super(e||{})}call(e,n){return K(()=>{const s=Me(e);return Nr(s,1)})}}lW.className="GlobalMaxPooling1D";le(lW);class cW extends Je{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,un(this.dataFormat),this.inputSpec=[new kn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ke}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class uW extends cW{call(e,n){return K(()=>{const s=Me(e);return this.dataFormat==="channelsLast"?Wt(s,[1,2]):Wt(s,[2,3])})}}uW.className="GlobalAveragePooling2D";le(uW);class dW extends cW{call(e,n){return K(()=>{const s=Me(e);return this.dataFormat==="channelsLast"?Nr(s,[1,2]):Nr(s,[2,3])})}}dW.className="GlobalMaxPooling2D";le(dW);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hW extends Je{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,i=Oo(r,s);delete n.layer;const o={layer:i};return Object.assign(o,n),new e(o)}}class pW extends hW{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=dt(e),e.length<3)throw new W(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=dt(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return K(()=>(e=Me(e),IU((o,a)=>[Me(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}pW.className="TimeDistributed";le(pW);function Aye(t){lu(Jme,"BidirectionalMergeMode",t)}const Rye="concat";class fW extends hW{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Oo(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=Oo(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Rye:e.mergeMode,Aye(this.mergeMode),e.weights)throw new Ke("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,i;return this.returnState&&(i=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[s].concat(i).concat(i.slice()):Ps(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const i=wU(e,s,r,this.numConstants);if(e=i.inputs,s=i.initialState,r=i.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new W("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const u=s.map(d=>new kn({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new Ke("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof oo;for(const c of o)if(c instanceof oo!==l)throw new W("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return K(()=>{const s=n.initialState;let r,i;if(s==null)r=this.forwardLayer.call(e,n),i=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),i=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=Er(i,1));let a;return this.mergeMode==="concat"?a=e2([r,i]):this.mergeMode==="sum"?a=oe(r,i):this.mergeMode==="ave"?a=j(.5,oe(r,i)):this.mergeMode==="mul"?a=j(r,i):this.mergeMode==null&&(a=[r,i]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){gc(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),gc(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const i=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(i).concat(i):[s].concat(i).concat(i)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Oo(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ke("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}fW.className="Bidirectional";le(fW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mW extends Je{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return K(()=>(e=Me(e),e.dtype!=="float32"&&(e=Zi(e,"float32")),oe(j(e,this.scale),this.offset)))}}mW.className="Rescaling";le(mW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Dye,cropAndResize:Pye}=Wr;class gW extends Je{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,i,o,a,l){return K(()=>{let c,u=!1;const d=n/o,h=s/a,p=(r+n)/o,f=(i+s)/a,g=[d,h,p,f],y=[];e.rank===3?(u=!0,c=Bs([e])):c=e;for(let N=0;N<c.shape[0];N++)y.push(g);const x=Kr(y,[y.length,4]),v=Mc(0,y.length,1,"int32"),I=Pye(c,x,v,[r,i],"nearest");return Zi(u?Me(Cr(I)):I,l)})}upsize(e,n,s,r){return K(()=>{const i=Dye(e,[n,s]);return Zi(i,r)})}call(e,n){return K(()=>{const s=Me(e),r=s.dtype,i=s.shape,o=i[i.length-3],a=i[i.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=dt(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}gW.className="CenterCrop";le(gW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oye(t,e,n,s){let r=Me(t);if(r.dtype!=="int32"&&(r=Zi(r,"int32")),e==="int")return r;const i=r.shape;if(r.rank===0&&(r=ns(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=ns(r,-1)),r.rank>2)throw new W(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=i0(a,s,n,o):l=i0(a,[],n,o),e!=="tfIdf")return l;if(s)return j(l,s);throw new W("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yW extends Je{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=dt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return K(()=>{e=Me(e),e.dtype!=="int32"&&(e=Zi(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new W(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=Me(n.countWeights)}const r=Nr(e),i=wd(e),o=Hs(this.numTokens,r).bufferSync().get(0),a=oa(i,0).bufferSync().get(0);if(!(o&&a))throw new W(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Oye(e,this.outputMode,this.numTokens,s)})}}yW.className="CategoryEncoding";le(yW);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Fye=["bilinear","nearest"],DP=new Set(Fye);class xW extends Je{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(DP.has(e.interpolation))this.interpolation=e.interpolation;else throw new W(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=dt(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return K(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Wr.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Wr.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...DP]} are supported`)})}}xW.className="Resizing";le(xW);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vW{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}vW.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class bW extends Je{constructor(e){super(e),this.randomGenerator=new vW(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}bW.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Lye=["bilinear","nearest"],PP=new Set(Lye);class wW extends bW{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new W(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new W(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new W(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(PP.has(s))this.interpolation=s;else throw new W(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=dt(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return K(()=>{const s=Me(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=_l([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*r;i=Math.round(i);const o=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Wr.resizeBilinear(e,o);case"nearest":return Wr.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...PP]} are supported`)}})}}wW.className="RandomWidth";le(wW);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var OP;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(OP||(OP={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ne(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mye=e1;class T1 extends yb{nextDataId(){return T1.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new B_(this,ui())}write(e,n,s){this.firstUse&&(this.firstUse=!1,X().get("IS_NODE")&&yr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&ji(s[0])){const i=s.map(o=>Yi(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,i){this.data.set(e,{values:n,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),i=this.readSync(s.imag.dataId);return Xo(r,i)}return kV(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Ho(r));return qe(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qe(e.shape,e.dtype,n)}makeOutput(e,n,s){return ui().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=ys();return e(),{kernelMs:ys()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ne([e],"where");const n=this.readSync(e.dataId);return Mye(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}T1.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Vye=t=>{const{x:e}=t.inputs,n=t.backend;Ne(e,"abs");let s=new Float32Array(J(e.shape));const r=n.data.get(e.dataId).values;return s=IW(r),n.makeOutput(s,e.shape,e.dtype)},zye={kernelName:Fm,backendName:"cpu",kernelFunc:Vye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dn(t){return(e,n,s,r,i)=>{const o=Ue(e,n),a=o.length,l=Re(o),c=J(o),u=Dn(i,c),d=e.length,h=n.length,p=Re(e),f=Re(n),g=Fc(e,o),y=Fc(n,o);if(g.length+y.length===0)for(let x=0;x<u.length;++x)u[x]=t(s[x%s.length],r[x%r.length]);else for(let x=0;x<u.length;++x){const v=eu(x,a,l),w=v.slice(-d);g.forEach(T=>w[T]=0);const I=vi(w,d,p),N=v.slice(-h);y.forEach(T=>N[T]=0);const A=vi(N,h,f);u[x]=t(s[I],r[A])}return[u,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zs(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",i),imag:n.makeTensorInfo(r.shape,"float32",o)},a}const jye={kernelName:Nb,backendName:"cpu",kernelFunc:Zs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0(t,e,n="float32"){if(n==="complex64"){const r=v0(t,e,"float32"),i=v0(t,e,"float32");return Zs({inputs:{real:r,imag:i},backend:t})}const s=Wn(J(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ao(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Bye={kernelName:dh,backendName:"cpu",kernelFunc:ao};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bc(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const Uye={kernelName:iw,backendName:"cpu",kernelFunc:Bc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kW(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Il([0],n),[i,o]=dn((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function ml(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return ao({inputs:{x:r},backend:n});const u=v0(n,r.shape,r.dtype),d=ml({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=Zs({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const u=Bc({inputs:{input:r},backend:n}),d=ml({inputs:{x:u},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(u),d}if(!G_(r.dtype,i)){const u=ao({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:i}}const o=n.data.get(r.dataId).values,[a,l,c]=kW(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}const Wye={kernelName:Jd,backendName:"cpu",kernelFunc:ml};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nn(t,e,n,s){return n==null?({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;Ne([o,a],t);const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=o.dtype==="string"?Yo(c):c,h=o.dtype==="string"?Yo(u):u,p=s||o.dtype,[f,g]=e(o.shape,a.shape,d,h,p);return l.makeTensorInfo(g,p,f)}:({inputs:r,backend:i})=>{const{a:o,b:a}=r,l=i;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=ml({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,p=l.data.get(d.dataId).values,f=l.data.get(h.dataId).values,g=ml({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),y=l.data.get(g.dataId),x=y.complexTensorInfos.real,v=y.complexTensorInfos.imag,w=l.data.get(x.dataId).values,I=l.data.get(v.dataId).values,[N,A,T]=n(o.shape,a.shape,p,f,w,I),S=l.makeTensorInfo(T,"float32",N),E=l.makeTensorInfo(T,"float32",A),$=Zs({inputs:{real:S,imag:E},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(S),l.disposeIntermediateTensorInfo(E),$}else{const c=l.data.get(o.dataId).values,u=l.data.get(a.dataId).values,d=s||o.dtype,[h,p]=e(o.shape,a.shape,c,u,d);return l.makeTensorInfo(p,d,h)}}}function v2(t){return(e,n,s,r,i,o)=>{const a=Ue(e,n),l=J(a),c=a.length,u=Re(a),d=Dn("float32",l),h=Dn("float32",l),p=Fc(e,a),f=Fc(n,a),g=Xo(s,r),y=Xo(i,o),x=e.length,v=Re(e),w=n.length,I=Re(n);if(p.length+f.length===0)for(let N=0;N<d.length;N++){const A=N%g.length,T=N%y.length,S=t(g[A*2],g[A*2+1],y[T*2],y[T*2+1]);d[N]=S.real,h[N]=S.imag}else for(let N=0;N<d.length;N++){const A=eu(N,c,u),T=A.slice(-x);p.forEach(F=>T[F]=0);const S=vi(T,x,v),E=A.slice(-w);f.forEach(F=>E[F]=0);const $=vi(E,w,I),P=t(g[S*2],g[S*2+1],y[$*2],y[$*2+1]);d[N]=P.real,h[N]=P.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SW=dn((t,e)=>t+e),Gye=v2((t,e,n,s)=>({real:t+n,imag:e+s})),Ed=Nn(tu,SW,Gye),Hye={kernelName:tu,backendName:"cpu",kernelFunc:Ed};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2(t,e,n,s,r){const i=J(s),o=Wn(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(i>0?o[l]+=e[a]:o[l]+=1)}return o}function TW(t,e,n,s=!1){const r=t.shape[0],i=t.shape[1],o=qe([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<i;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NW=dn((t,e)=>t&e),qye=Nn(Wm,NW),Kye={kernelName:Wm,backendName:"cpu",kernelFunc:qye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(t){return(e,n,s)=>{const r=Yt(n,e.length);for(let i=0;i<e.length;++i)r[i]=t(e[i],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vt(t,e,n){const s=po(e);return $l(t,s,n)}function $l(t,e,n){return({inputs:s,attrs:r,backend:i})=>{const{x:o}=s;Ne(o,t);const a=i,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Yo(l)}else c=l;const u=n||o.dtype,d=e(c,u,r);return a.makeTensorInfo(o.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _W=po(t=>Math.ceil(t)),Xye=$l(Zd,_W),Yye={kernelName:Zd,backendName:"cpu",kernelFunc:Xye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EW(t,e,n,s){const r=Yt(n,J(e));if(s&&n!=="string"){let i=0;t.forEach(o=>{const a=J(o.shape);r.set(o.vals,i),i+=a})}else{let i=0;t.forEach(o=>{const a=n==="string"?Yo(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const u=c*e[1]+i;for(let d=0;d<o.shape[1];++d)r[u+d]=a[l++]}i+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CW=dn((t,e)=>t===e?1:0),$W=Nn(Zm,CW,null,"bool"),Qye={kernelName:Zm,backendName:"cpu",kernelFunc:$W};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AW=po(t=>Math.exp(t)),RW=$l(oh,AW,"float32"),Jye={kernelName:oh,backendName:"cpu",kernelFunc:RW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DW=po(t=>Math.expm1(t)),Zye=$l(ah,DW),exe={kernelName:ah,backendName:"cpu",kernelFunc:Zye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PW=po(t=>Math.floor(t)),txe=$l(lh,PW),nxe={kernelName:lh,backendName:"cpu",kernelFunc:txe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OW=dn((t,e)=>Math.floor(t/e)),sxe=Nn(ch,OW,null,"int32"),rxe={kernelName:ch,backendName:"cpu",kernelFunc:sxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(t,e,n,s,r,i,o,a,l){const c=qe([s,i],n);for(let u=0;u<s;u++){const d=[];let h=0;for(let p=0;p<r;p++){const f=t[u*r+p];h+=f*o[p],d.push(f)}if(h<0||h>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let p=0;p<i;p++)c.values[u*i+p]=e.get(...e.indexToLoc(h*i+p))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t,e,n){const s=qe(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const u=t.locToIndex(o);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MW=dn((t,e)=>t>e?1:0),ixe=Nn(sg,MW,null,"bool"),oxe={kernelName:sg,backendName:"cpu",kernelFunc:ixe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VW=dn((t,e)=>t>=e?1:0),axe=Nn(uh,VW,null,"bool"),lxe={kernelName:uh,backendName:"cpu",kernelFunc:axe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zW=dn((t,e)=>t<e?1:0),cxe=Nn(ig,zW,null,"bool"),uxe={kernelName:ig,backendName:"cpu",kernelFunc:cxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jW=dn((t,e)=>t<=e?1:0),dxe=Nn(og,jW,null,"bool"),hxe={kernelName:og,backendName:"cpu",kernelFunc:dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BW(t,e,n){const s=(e-t)/(n-1),r=Wn(n,"float32");r[0]=t;for(let i=1;i<r.length;i++)r[i]=r[i-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UW=po(t=>Math.log(t)),pxe=$l(mh,UW),fxe={kernelName:mh,backendName:"cpu",kernelFunc:pxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(t,e,n,s){const r=Dn(s,J(n));for(let i=0;i<r.length;++i){const o=i*e;let a=t[o];for(let l=0;l<e;++l){const c=t[o+l];(Number.isNaN(c)||c>a)&&(a=c)}r[i]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GW=dn((t,e)=>Math.max(t,e)),mxe=Nn(yh,GW),gxe={kernelName:yh,backendName:"cpu",kernelFunc:mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HW=dn((t,e)=>Math.min(t,e)),yxe=Nn(xh,HW),xxe={kernelName:xh,backendName:"cpu",kernelFunc:yxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2=dn((t,e)=>t*e),vxe=v2((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),N1=Nn(bh,w2,vxe),bxe={kernelName:bh,backendName:"cpu",kernelFunc:N1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(t,e,n){const s=sa(-1,n);return w2([],e,s,t,n)}function wxe(t){const{inputs:e,backend:n}=t,{x:s}=e;Ne(s,"neg");const r=n.data.get(s.dataId).values,[i,o]=qW(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}const Ixe={kernelName:yg,backendName:"cpu",kernelFunc:wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KW=dn((t,e)=>t!==e?1:0),kxe=Nn(xg,KW,null,"bool"),Sxe={kernelName:xg,backendName:"cpu",kernelFunc:kxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2(t,e,n,s,r){const i=e.length,o=J(e),a=Re(e),l=Re(r),c=Dn(n,J(r));for(let u=0;u<o;++u){const d=eu(u,i,a),h=new Array(d.length);for(let f=0;f<h.length;f++)h[f]=d[s[f]];const p=vi(h,i,l);c[p]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Us(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:i}=n;Ne(r,"transpose");const o=r.shape.length,a=new Array(o);for(let d=0;d<a.length;d++)a[d]=r.shape[i[d]];const l=s.data.get(r.dataId).values,c=I2(l,r.shape,r.dtype,i,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const Txe={kernelName:fc,backendName:"cpu",kernelFunc:Us};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(t,e,n,s){const[r,i]=Fn(t,s),o=Ms(e,"int32"),a=Wn(J(r),o),l=J(i);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:r,outDtype:o}}function Nxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"prod");const a=r.shape.length,l=Qe(i,r.shape),c=qt(l,a);let u=l,d=r;const h=[];c!=null&&(d=Us({inputs:{x:r},backend:n,attrs:{perm:c}}),h.push(d),u=cn(u.length,a));const p=n.data.get(d.dataId).values,{outVals:f,outShape:g,outDtype:y}=XW(d.shape,d.dtype,p,u);let x=g;return o&&(x=an(g,l)),h.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(x,y,f)}const _xe={kernelName:Sg,backendName:"cpu",kernelFunc:Nxe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Exe(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const i=eu(r,e.length,Re(e)).join(",");throw new Error(`indices[${i}] = ${s} is not in [0, ${n})`)}})}function Cxe(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let i=1;i<s.length;++i)if(s[i-1]>s[i])throw new Error("Ragged splits must be sorted in ascending order")}}function $xe(t,e,n,s){const r=[];let i=0;const o=e.length-1+n.length,a=new Array(o).fill(null).map(()=>[0]);Cxe(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const p=n[h],f=h+e.length-1;if(f>=0){const g=a[f],y=g[g.length-1]-p[u];for(let x=u;x<d;++x)a[f].push(p[x+1]+y)}u=p[u],d=p[d]}d!==u&&(r.push([u,d]),i+=d-u)}return{outSplits:a,valueSlices:r,numValues:i}}function Axe(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Yt("int32",s);e.push(r),t[n].forEach((i,o)=>r[o]=i)}return e}function FP(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function Rxe(t,e,n,s,r,i){const o=FP(e,2)[1],a=FP(i,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<s;++d)r[l*a+d]=t[u*o+d];++l}}function Dxe(t,e,n,s,r){const i=e.slice();i[0]=r;const o=Yt(n,J(i)),a=t.length,l=a===0?0:a/e[0];return Rxe(t,e,s,l,o,i),[o,i]}function YW(t,e,n,s,r,i,o,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Exe(i,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:d,numValues:h}=$xe(i,o,t,c),p=Axe(u),f=Dxe(n,s,r,d,h);return[p,f[0],f[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LP=2147483647;function QW(t,e,n,s,r,i,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=o.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(o[0]);for(let y=1;y<u.length;++y)if(u[y]!==u[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=Yt("int32",d+1);h[0]=0;for(let y=0;y<d;++y){const x=a?t[0]:t[y],v=l?s[0]:s[y],w=c?i[0]:i[y];if(w===0)throw new Error("Requires delta != 0");let I;if(w>0&&v<x||w<0&&v>x)I=0;else if(I=Math.ceil(Math.abs((v-x)/w)),I>LP)throw new Error(`Requires ((limit - start) / delta) <= ${LP}`);h[y+1]=h[y]+I}const p=h[d],f=Yt(n,p);let g=0;for(let y=0;y<d;++y){const x=h[y+1]-h[y];let v=a?t[0]:t[y];const w=c?i[0]:i[y];for(let I=0;I<x;++I)f[g++]=v,v+=w}return[h,f]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Pr=fi;class b0{constructor(e,n,s,r,i,o,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=Rj(u),this.raggedRank=Dj(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Pr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Pr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Pr.VALUE_ROWIDS:return b0.getMaxWidthValueRowID(n);case Pr.ROW_SPLITS:return b0.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Pr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const i=e[r+1]-e[r];i>s&&(s=i)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],i=0;for(let o=1;o<n;++o){const a=e[o];a!==r&&(r=a,i=Math.max(o-s,i),s=o)}return Math.max(n-s,i)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return VP(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;Pj(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=Aj(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),i=[];let o=0;for(let a=0;a<r;++a,o+=n)i.push(o);for(let a=r;a<e;++a)i.push(-1);return D(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,s,r){const i=e.length,o=[];for(let a=0;a<i-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)o.push(u),u+=s;for(let d=0;d<l-c;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const i=e.length,o=[];if(i===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let u=1;u<i;++u){const d=e[u];if(d===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Pr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,s,r);case Pr.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,s,r);default:throw new Error(`Unsupported partition type: ${Pr[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Pr.FIRST_DIM_SIZE:return e[0];case Pr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Pr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Pr[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const i=VP(s,!1),o=Yt(this.valuesDType,J(i));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,o,i)}return[i,o]}setOutput(e,n,s,r){if(s.length===0)return;const i=this.values,o=s;let a=r.slice();a=a.slice(e+1);const l=J(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const f=this.defaultValueShape;K(()=>{const g=U(u,f);u=mc(g,a).dataSync()})}let d=0,h=0,p=0;for(let f=0;f<=c;++f){let g=f<c?n[f]:-1;if(g===p){++p;continue}if(h<p){const y=i.subarray(d*l),x=o.subarray(h*l),v=(p-h)*l;MP(x,y,v)}if(f>=c){const y=s.length;g=Math.floor(y/l)}if(g>p)if(this.defaultValue.length===1)o.subarray(p*l,g*l).fill(this.defaultValue[0]),p=g;else for(;g>p;){const y=o.slice(p*l);MP(y,u,l),++p}g<0?(d=f+1,h=p):(d=f,h=p,p=h+1)}}}function MP(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function VP(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function JW(t,e,n,s,r,i,o,a,l,c){return new b0(t,e,n,s,r,i,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,e,n,s){const r=t===e,i=t<e&&n<0,o=e<t&&n>1;if(r||i||o)return Wn(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=Wn(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e6=po(t=>1/Math.sqrt(t)),Pxe=$l(Nh,e6),Oxe={kernelName:Nh,backendName:"cpu",kernelFunc:Pxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ac(t,e,n,s,r,i,o,a,l,c){const u=[s/r,r],d=t.values,h=e.values;if(s===0)return qe(n,e.dtype);const p=l instanceof gn?l:qe(u,e.dtype);typeof l=="string"||typeof l=="number"?p.values.fill(l):typeof l=="boolean"&&p.values.fill(+l);for(let f=0;f<i;f++){const g=[];let y=0;for(let x=0;x<o;x++){const v=d[f*o+x];g.push(v),y+=v*a[x]}if(y<0||y>=s/r)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let x=0;x<r;x++)c?p.values[y*r+x]+=h[f*r+x]:p.values[y*r+x]=e.rank===0?h[0]:h[f*r+x]}return p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fxe=po(t=>1/(1+Math.exp(-t))),t6=vt(Ah,t=>1/(1+Math.exp(-t))),Lxe={kernelName:Ah,backendName:"cpu",kernelFunc:t6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n6(t,e,n,s,r){const i=_C(s,e,n),o=J(n),a=Re(s);if(i){const d=EC(e,a);return r==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=r==="string"?Yo(t):t,c=qe(s,r,l),u=qe(n,r);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),p=h.map((f,g)=>f+e[g]);u.set(c.get(...p),...h)}return r==="string"?eB(u.values):u.values}function Uc(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s;Ne(r,"slice");const[a,l]=d1(r,i,o);TC(r,a,l);const c=n.data.get(r.dataId).values,u=n6(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const Mxe={kernelName:$g,backendName:"cpu",kernelFunc:Uc};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6(t,e,n,s,r,i,o){const a=e[0],l=i[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(jj(a));const y=Yt(n,0),x=Yt(r,0);return[y,[0,d],x,c,u]}let h=!0,p=0;const f=new Array(l).fill(0);for(let y=0;y<a;++y){const x=t[y*d];if(x<0)throw new Error(Bj(y,x));if(x>=l)throw new Error(Uj(y,x,l));++f[x],h=h&&x>=p,p=x}let g=!0;for(let y=0;y<l;++y){const x=f[y]===0;c[y]=x,g=g&&!x,f[y]=Math.max(f[y],1),y>0&&(f[y]+=f[y-1])}if(g&&h){const y=t,x=s;for(let v=0;v<a;++v)u[v]=v;return[y,[a,d],x,c,u]}else{const y=f[l-1],x=Yt(n,y*d),v=Yt(r,y),w=new Array(l).fill(0);for(let I=0;I<a;++I){const N=t[I*d],A=w[N],T=(N===0?0:f[N-1])+A;w[N]++;for(let S=0;S<d;++S)x[T*d+S]=t[I*d+S];v[T]=s[I],u[I]=T}for(let I=0;I<l;++I)if(w[I]===0){const A=I===0?0:f[I-1];x[A*d+0]=I;for(let T=1;T<d;++T)x[A*d+T]=0;v[A]=o}return[x,[y,d],v,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r6(t,e,n,s,r){const i=J(s),o=e[0],a=r.length,l=[];let c=1,u=-1;for(let y=0;y<a;++y){const x=r[y];if(x===-1){if(u!==-1)throw new Error(Wj(u,y));u=y,l.push(1)}else{if(x<0)throw new Error(Gj(y,x));c*=x,l.push(x)}}if(u!==-1){if(c<=0)throw new Error(Hj());const y=Math.trunc(i/c);if(c*y!==i)throw new Error(qj(s,l));l[u]=y}if(J(l)!==i)throw new Error(Kj(s,l));const h=s.length,p=[];if(h>0){p[h-1]=1;for(let y=h-2;y>=0;--y)p[y]=p[y+1]*s[y+1]}const f=[];if(a>0){f[a-1]=1;for(let y=a-2;y>=0;--y)f[y]=f[y+1]*l[y+1]}const g=Yt(n,o*a);for(let y=0;y<o;++y){let x=0;for(let v=0;v<h;++v)x+=t[y*h+v]*p[v];for(let v=0;v<a;++v)g[y*a+v]=Math.trunc(x/f[v]),x%=f[v]}return[g,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2(t,e,n,s,r,i=!1,o=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(iT());const h=e.slice();h[0]=d;const p=h.reduce((w,I)=>w*I,1),f=Yt(n,p);if(a===0)return d>0&&f.fill(o),[f,h];if(d<=0)throw new Error(iT());let g=0,y=1,x=0,v=r[g];for(;;){let w=0;if(y<a){if(w=r[y],v===w){++y;continue}if(v>=w)throw new Error(Xj())}if(v<0||v>=d)throw new Error(Yj(v,d));v>x&&f.fill(o,x*c,v*c);for(let I=g;I<y;++I){const N=s[I];if(N<0||N>=l[0])throw new Error(Qj(I,s[I],l[0]));for(let A=0;A<c;A++)f[v*c+A]+=t[N*c+A]}if(i)for(let I=0;I<c;I++)f[v*c+I]/=y-g;if(g=y,++y,x=v+1,v=w,y>a)break}return x<d&&f.fill(o,x*c,d*c),[f,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vxe=po(t=>Math.sqrt(t)),zxe=vt(Dh,t=>Math.sqrt(t)),jxe={kernelName:Dh,backendName:"cpu",kernelFunc:zxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i6=dn((t,e)=>{const n=t-e;return n*n}),Bxe=Nn(Ph,i6),Uxe={kernelName:Ph,backendName:"cpu",kernelFunc:Bxe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6=po((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),Wxe=$l(Og,o6),Gxe={kernelName:Og,backendName:"cpu",kernelFunc:Wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(t,e,n,s){const r=qe(t,e.dtype);for(let i=0;i<r.size;i++){const o=r.indexToLoc(i),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*n[l]+s[l];r.set(e.get(...a),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hxe{constructor(e,n,s,r,i,o){this.separator=Yi(e),this.nGramWidths=n,this.leftPad=Yi(s),this.rightPad=Yi(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,i,o){for(let a=0;a<i;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),u=Math.max(0,l-(i-(a+1))),d=o-(c+u),h=n+(c>0?0:a-l);let p=0;p+=c*this.leftPad.length;for(let v=0;v<d;++v)p+=e[h+v].length;p+=u*this.rightPad.length;const f=c+u+d-1;p+=f*this.separator.length,s[r+a]=new Uint8Array(p);const g=s[r+a];let y=0;const x=v=>v.forEach(w=>g[y++]=w);for(let v=0;v<c;++v)x(this.leftPad),x(this.separator);for(let v=0;v<d-1;++v)x(e[h+v]),x(this.separator);if(d>0){x(e[h+d-1]);for(let v=0;v<u;++v)x(this.separator),x(this.rightPad)}else{for(let v=0;v<u-1;++v)x(this.rightPad),x(this.separator);x(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const i=r-1,o=Yt("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=i;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),o[l]=o[l-1]+u}const a=new Array(o[i]);for(let l=0;l<i;++l){const c=n[l];let u=o[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],p=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,p,d),u+=p}),this.preserveShort&&u===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,c,a,u,1,h)}}return[a,o]}}function l6(t,e,n,s,r,i,o,a){return new Hxe(n,s,r,i,o,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(t,e,n,s){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)s.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const a=t.subarray(0,o);(!n||a.length!==0)&&s.push(a),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(r,i);(!n||o.length!==0)&&s.push(o),r=i+1}}function c6(t,e,n){const s=t.length,r=[];let i=0,o=0;const a=new Array(s);for(let h=0;h<s;++h){const p=r.length;qxe(t[h],e,n,r);const f=r.length-p;a[h]=f,i+=f,o=Math.max(o,f)}const l=Yt("int32",i*2),c=new Array(i),u=[s,o];let d=0;for(let h=0;h<s;++h)for(let p=0;p<a[h];++p)l[d*2]=h,l[d*2+1]=p,c[d]=r[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u6(t,e){const n=Yt("int32",t.length);for(let s=0;s<t.length;++s)n[s]=MV(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d6=dn((t,e)=>t-e),Kxe=v2((t,e,n,s)=>({real:t-n,imag:e-s})),S2=Nn(Oh,d6,Kxe),Xxe={kernelName:Oh,backendName:"cpu",kernelFunc:S2};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=qe(n,t.dtype);for(let r=0;r<s.values.length;++r){const i=s.indexToLoc(r),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const a=t.locToIndex(o);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qp=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function p6(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),p=Math.min(s,Math.floor(e+(a-l)*u/a+d));p6(t,e,h,p)}const r=t[e];let i=n,o=s;for(To(t,n,e),Qp(t[s],r)>0&&To(t,n,s);i<o;){for(To(t,i,o),i++,o--;Qp(t[i],r)<0;)i=i+1;for(;Qp(t[o],r)>0;)o=o-1}Qp(t[n],r)===0?To(t,n,o):(o=o+1,To(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function f6(t,e,n,s,r){const i=e[e.length-1],[o,a]=[t.length/i,i],l=Dn(n,o*s),c=Dn("int32",o*s);for(let d=0;d<o;d++){const h=d*a,p=t.subarray(h,h+a);let f=new Array(p.length);p.forEach((v,w)=>f[w]={value:v,index:w}),s<f.length&&(p6(f,s),f=f.slice(0,s)),r&&f.sort(Qp);const g=d*s,y=l.subarray(g,g+s),x=c.subarray(g,g+s);for(let v=0;v<s;v++)y[v]=f[v].value,x[v]=f[v].index}const u=e.slice();return u[u.length-1]=s,[qe(u,n,l),qe(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m6(t,e,n,s){const r=Qe(e,n)[0],i=[1,n[0],1];for(let f=0;f<r;f++)i[0]*=n[f];i[1]=n[r];for(let f=r+1;f<n.length;f++)i[2]*=n[f];const o=new Map,a=new Int32Array(n[r]),l=new gn(i,s,t),c=[],u=i[0]===1&&i[2]===1;for(let f=0;f<n[r];f++){let g;if(u)g=t[f].toString();else{const x=[];for(let v=0;v<i[0];v++)for(let w=0;w<i[2];w++)x.push(l.get(v,f,w));g=x.join(",")}const y=o.get(g);if(y!=null)a[f]=y;else{const x=o.size;o.set(g,x),a[f]=x,c.push(f)}}const d=i.slice();d[1]=o.size;const h=new gn(d,s);c.forEach((f,g)=>{for(let y=0;y<i[0];y++)for(let x=0;x<i[2];x++)h.set(l.get(y,f,x),y,g,x)});const p=n.slice();return p[r]=d[1],{outputValues:h.values,outputShape:p,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yxe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:SW,bincountImpl:b2,bincountReduceImpl:TW,bitwiseAndImpl:NW,castImpl:kW,ceilImpl:_W,concatImpl:EW,equalImpl:CW,expImpl:AW,expm1Impl:DW,floorDivImpl:OW,floorImpl:PW,gatherNdImpl:FW,gatherV2Impl:LW,greaterEqualImpl:VW,greaterImpl:MW,lessEqualImpl:jW,lessImpl:zW,linSpaceImpl:BW,logImpl:UW,maxImpl:WW,maximumImpl:GW,minimumImpl:HW,multiplyImpl:w2,negImpl:qW,notEqualImpl:KW,prodImpl:XW,raggedGatherImpl:YW,raggedRangeImpl:QW,raggedTensorToTensorImpl:JW,rangeImpl:ZW,rsqrtImpl:e6,scatterImpl:ac,sigmoidImpl:Fxe,simpleAbsImpl:IW,sliceImpl:n6,sparseFillEmptyRowsImpl:s6,sparseReshapeImpl:r6,sparseSegmentReductionImpl:k2,sqrtImpl:Vxe,squaredDifferenceImpl:i6,staticRegexReplaceImpl:o6,stridedSliceImpl:a6,stringNGramsImpl:l6,stringSplitImpl:c6,stringToHashBucketFastImpl:u6,subImpl:d6,tileImpl:h6,topKImpl:f6,transposeImpl:I2,uniqueImpl:m6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */tE("cpu",()=>new T1,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g6=vt(rh,t=>t>=0?t:Math.exp(t)-1),Qxe={kernelName:rh,backendName:"cpu",kernelFunc:g6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y6(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s;Ne([r],"leakyRelu");const o=J(r.shape),a=n.data.get(r.dataId).values,l=Dn("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?i*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const Jxe={kernelName:rg,backendName:"cpu",kernelFunc:y6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zxe=dn((t,e)=>t<0?e*t:t);function x6(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Ne([s,r],"prelu");const i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[a,l]=Zxe(s.shape,r.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",a)}const eve={kernelName:kg,backendName:"cpu",kernelFunc:x6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v6=vt(kh,t=>Math.max(0,t)),tve={kernelName:kh,backendName:"cpu",kernelFunc:v6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b6=vt(Sh,t=>Math.min(Math.max(0,t),6)),nve={kernelName:Sh,backendName:"cpu",kernelFunc:b6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0(t,e,n,s,r){if(n==="linear")return ao({inputs:{x:e},backend:t});if(n==="relu")return v6({inputs:{x:e},backend:t});if(n==="elu")return g6({inputs:{x:e},backend:t});if(n==="relu6")return b6({inputs:{x:e},backend:t});if(n==="prelu")return x6({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return y6({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return t6({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rt(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=J(r.shape),a=W_(i,o),l=J(a);D(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const sve={kernelName:Tg,backendName:"cpu",kernelFunc:Rt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w6(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;Ne([r,i],"matMul");const l=r.shape.length,c=i.shape.length,u=o?r.shape[l-2]:r.shape[l-1],d=a?i.shape[c-1]:i.shape[c-2],h=o?r.shape[l-1]:r.shape[l-2],p=a?i.shape[c-2]:i.shape[c-1],f=r.shape.slice(0,-2),g=i.shape.slice(0,-2),y=J(f),x=J(g),w=Ue(r.shape.slice(0,-2),i.shape.slice(0,-2)).concat([h,p]);D(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${r.shape} and ${i.shape} and transposeA=${o} and transposeB=${a} must match.`);const I=o?[y,u,h]:[y,h,u],N=a?[x,p,d]:[x,d,p],A=Rt({inputs:{x:r},backend:n,attrs:{shape:I}}),T=Rt({inputs:{x:i},backend:n,attrs:{shape:N}}),S=o?A.shape[1]:A.shape[2],E=o?A.shape[2]:A.shape[1],$=a?T.shape[1]:T.shape[2],P=Math.max(y,x),F=n.data.get(A.dataId).values,R=n.data.get(T.dataId).values,G=Re(A.shape),q=Re(T.shape),[Q,te,B]=o?[G[0],1,G[1]]:[G[0],G[1],1],[H,Z,se]=a?[1,q[1],q[0]]:[q[1],1,q[0]],re=E*$,ie=qe([P,E,$],A.dtype),de=ie.values,ce=n.blockSize;for(let pe=0;pe<P;pe++){const we=pe%y,De=pe%x;for(let $e=0;$e<E;$e+=ce){const Oe=Math.min($e+ce,E);for(let ve=0;ve<$;ve+=ce){const Le=Math.min(ve+ce,$);for(let ze=0;ze<S;ze+=ce){const it=Math.min(ze+ce,S);for(let ct=$e;ct<Oe;ct++)for(let ot=ve;ot<Le;ot++){let ht=0;for(let yt=ze;yt<it;yt++){const Yn=F[we*Q+ct*te+yt*B],Nt=R[yt*H+ot*Z+De*se];ht+=Yn*Nt}de[pe*re+(ct*$+ot)]+=ht}}}}}return n.disposeIntermediateTensorInfo(A),n.disposeIntermediateTensorInfo(T),n.makeTensorInfo(w,ie.dtype,ie.values)}const rve={kernelName:Bm,backendName:"cpu",kernelFunc:w6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ive(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;let h,p,f;const g=[];h=w6({inputs:{a:r,b:i},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(p=Ed({inputs:{a:h,b:o},backend:n}),g.push(h),h=p),u&&(f=w0(n,h,u,a,d),g.push(h),h=f);for(const x of g)n.disposeIntermediateTensorInfo(x);return h}const ove={kernelName:Xf,backendName:"cpu",kernelFunc:ive};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ave=vt(Gd,t=>Math.acos(t)),lve={kernelName:Gd,backendName:"cpu",kernelFunc:ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cve=vt(Hd,t=>Math.acosh(t)),uve={kernelName:Hd,backendName:"cpu",kernelFunc:cve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dve(t){const{inputs:e,backend:n}=t,s=e;Ne(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),i=qe(s[0].shape,s[0].dtype),o=i.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const hve={kernelName:Lm,backendName:"cpu",kernelFunc:dve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"all");const a=Qe(i,r.shape);let l=a;const c=qt(l,r.shape.length);let u=r;c!=null&&(u=Us({inputs:{x:r},backend:n,attrs:{perm:c}}),l=cn(l.length,r.shape.length)),qn("all",l,u.shape.length);const[d,h]=Fn(u.shape,l),p=J(h),f=Wn(J(d),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<f.length;++x){const v=x*p;let w=g[v];for(let I=0;I<p;++I){const N=g[v+I];w=w&&N}f[x]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,f);if(o){const x=an(d,a),v=Rt({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}const fve={kernelName:bb,backendName:"cpu",kernelFunc:pve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"any");const a=Qe(i,r.shape);let l=a;const c=qt(l,r.shape.length);let u=r;c!=null&&(u=Us({inputs:{x:r},backend:n,attrs:{perm:c}}),l=cn(l.length,r.shape.length)),qn("any",l,u.shape.length);const[d,h]=Fn(u.shape,l),p=J(h),f=Wn(J(d),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<f.length;++x){const v=x*p;let w=g[v];for(let I=0;I<p;++I){const N=g[v+I];w=w||N}f[x]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,f);if(o){const x=an(d,a),v=Rt({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}const gve={kernelName:wb,backendName:"cpu",kernelFunc:mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Ne(r,"argMax");let o=Qe(i,r.shape);const a=qt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Us({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=cn(o.length,l.shape.length)),o=[o[0]],qn("argMax",o,l.shape.length);const[u,d]=Fn(l.shape,o),h=J(u),p=Wn(h,"int32"),f=J(d),g=n.data.get(l.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let v=g[x],w=0;for(let I=0;I<f;++I){const N=g[x+I];N>v&&(v=N,w=I)}p[y]=w}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",p)}const xve={kernelName:Mm,backendName:"cpu",kernelFunc:yve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;Ne(r,"argMin");let o=Qe(i,r.shape);const a=qt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=Us({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=cn(o.length,l.shape.length)),o=[o[0]],qn("argMin",o,l.shape.length);const[u,d]=Fn(l.shape,o),h=J(u),p=Wn(h,"int32"),f=J(d),g=n.data.get(l.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let v=g[x],w=0;for(let I=0;I<f;++I){const N=g[x+I];N<v&&(v=N,w=I)}p[y]=w}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",p)}const bve={kernelName:Vm,backendName:"cpu",kernelFunc:vve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wve=vt(qd,t=>Math.asin(t)),Ive={kernelName:qd,backendName:"cpu",kernelFunc:wve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kve=vt(Kd,t=>Math.asinh(t)),Sve={kernelName:Kd,backendName:"cpu",kernelFunc:kve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tve=vt(Xd,t=>Math.atan(t)),Nve={kernelName:Xd,backendName:"cpu",kernelFunc:Tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ve=dn((t,e)=>Math.atan2(t,e)),Eve=Nn(Qd,_ve),Cve={kernelName:Qd,backendName:"cpu",kernelFunc:Eve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ve=vt(Yd,t=>Math.atanh(t)),Ave={kernelName:Yd,backendName:"cpu",kernelFunc:$ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2(t,e,n,s,r,i){const o=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,f=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=qe(r.outShape,n),y=g.values,x=r.outShape[1]*r.outShape[2]*r.outShape[3],v=r.outShape[2]*r.outShape[3],w=r.outShape[3];for(let I=0;I<r.batchSize;++I){const N=I*x,A=I*s[0];for(let T=0;T<r.inChannels;++T)for(let S=0;S<r.outHeight;++S){const E=S*o-h,$=Math.max(0,E),P=Math.min(r.inHeight,u+E),F=N+S*v;for(let R=0;R<r.outWidth;++R){const G=R*a-p,q=Math.max(0,G),Q=Math.min(r.inWidth,d+G);let te=f,B=0,H=0;for(let se=$;se<P;se+=l){const re=A+se*s[1];for(let ie=q;ie<Q;ie+=c){const de=re+ie*s[2],ce=t[de+T];i==="max"&&ce>te?te=ce:i==="avg"&&(B+=ce,H++)}if(isNaN(te))break}const Z=F+R*w+T;y[Z]=i==="avg"?B/H:te}}}return g}function I6(t,e,n,s,r=!1,i=!1){const o=qe(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,p=s.padInfo.top,f=s.padInfo.left,g=qe(e,n,t);for(let y=0;y<s.batchSize;++y)for(let x=0;x<s.inChannels;++x)for(let v=0;v<s.outHeight;++v){const w=v*a-p;let I=w;for(;I<0;)I+=c;const N=Math.min(s.inHeight,d+w);for(let A=0;A<s.outWidth;++A){const T=A*l-f;let S=T;for(;S<0;)S+=u;const E=Math.min(s.inWidth,h+T);let $=Number.NEGATIVE_INFINITY,P=-1;for(let F=I;F<N;F+=c){const R=F-w;for(let G=S;G<E;G+=u){const q=G-T,Q=g.get(y,F,G,x);Q>$&&($=Q,r?P=i?((y*s.inHeight+F)*s.inWidth+G)*s.inChannels+x:(F*s.inWidth+G)*s.inChannels+x:P=R*h+q)}}o.set(P,y,v,A,x)}}return o}function k6(t,e,n,s,r,i){const o=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,g=r.padInfo.front,y=r.padInfo.top,x=r.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=qe(r.outShape,n),I=w.values,N=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],A=r.outShape[2]*r.outShape[3]*r.outShape[4],T=r.outShape[3]*r.outShape[4],S=r.outShape[4];for(let E=0;E<r.batchSize;++E){const $=E*N,P=E*s[0];for(let F=0;F<r.inChannels;++F)for(let R=0;R<r.outDepth;++R){const G=R*o-g;let q=G;for(;q<0;)q+=c;const Q=Math.min(r.inDepth,h+G),te=$+R*A;for(let B=0;B<r.outHeight;++B){const H=B*a-y;let Z=H;for(;Z<0;)Z+=u;const se=Math.min(r.inHeight,p+H),re=te+B*T;for(let ie=0;ie<r.outWidth;++ie){const de=ie*l-x;let ce=de;for(;ce<0;)ce+=d;const pe=Math.min(r.inWidth,f+de),we=re+ie*S;let De=v,$e=0,Oe=0;for(let Le=q;Le<Q;Le+=c){const ze=P+Le*s[1];for(let it=Z;it<se;it+=u){const ct=ze+it*s[2];for(let ot=ce;ot<pe;ot+=d){const ht=ct+ot*s[3],yt=t[ht+F];if(i==="max"&&yt>De?De=yt:i==="avg"&&($e+=yt,Oe++),isNaN(De))break}if(isNaN(De))break}if(isNaN(De))break}const ve=we+F;I[ve]=i==="avg"?$e/Math.max(Oe,1):De}}}}return w}function Rve(t,e){const n=qe(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let y=0;y<e.inChannels;++y)for(let x=0;x<e.outDepth;++x){const v=x*s-h;let w=v;for(;w<0;)w+=o;const I=Math.min(e.inDepth,c+v);for(let N=0;N<e.outHeight;++N){const A=N*r-p;let T=A;for(;T<0;)T+=a;const S=Math.min(e.inHeight,u+A);for(let E=0;E<e.outWidth;++E){const $=E*i-f;let P=$;for(;P<0;)P+=l;const F=Math.min(e.inWidth,d+$);let R=Number.NEGATIVE_INFINITY,G=-1;for(let q=w;q<I;q+=o){const Q=q-v;for(let te=T;te<S;te+=a){const B=te-A;for(let H=P;H<F;H+=l){const Z=H-$,se=t.get(g,q,te,H,y);se>=R&&(R=se,G=Q*u*d+B*u+Z)}}}n.set(G,g,x,N,E,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ne(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;D(Hn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Zr(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Ze(u.inShape,u.outShape))d=ao({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,p=Re(r.shape),f=T2(h,r.shape,r.dtype,p,u,"avg");d=n.makeTensorInfo(u.outShape,r.dtype,f.values)}return d}const Pve={kernelName:zm,backendName:"cpu",kernelFunc:Dve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ove(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Ne(r,"avgPool3d");const u=ra(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=k6(d,r.shape,r.dtype,Re(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const Fve={kernelName:jm,backendName:"cpu",kernelFunc:Ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lve(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Ne([r,i],"avgPool3DGrad");const u=ra(i.shape,o,a,1,l,c),d=u.strideDepth,h=u.strideHeight,p=u.strideWidth,f=u.filterDepth,g=u.filterHeight,y=u.filterWidth,x=u.dilationDepth,v=u.dilationHeight,w=u.dilationWidth,I=u.effectiveFilterDepth,N=u.effectiveFilterHeight,A=u.effectiveFilterWidth,T=I-1-u.padInfo.front,S=A-1-u.padInfo.left,E=N-1-u.padInfo.top,$=qe(i.shape,"float32"),P=1/(f*g*y),F=n.bufferSync(r);for(let R=0;R<u.batchSize;++R)for(let G=0;G<u.inChannels;++G)for(let q=0;q<u.inDepth;++q)for(let Q=0;Q<u.inHeight;++Q)for(let te=0;te<u.inWidth;++te){const B=q-T,H=Q-E,Z=te-S;let se=0;for(let re=0;re<I;re+=x){const ie=(B+re)/d;if(!(ie<0||ie>=u.outDepth||Math.floor(ie)!==ie))for(let de=0;de<N;de+=v){const ce=(H+de)/h;if(!(ce<0||ce>=u.outHeight||Math.floor(ce)!==ce))for(let pe=0;pe<A;pe+=w){const we=(Z+pe)/p;if(we<0||we>=u.outWidth||Math.floor(we)!==we)continue;const De=F.get(R,ie,ce,we,G);se+=De}}}$.set(se*P,R,q,Q,te,G)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const Mve={kernelName:kb,backendName:"cpu",kernelFunc:Lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;Ne([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Zr(o.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,p=u.filterHeight,f=u.filterWidth,g=u.dilationHeight,y=u.dilationWidth,x=u.effectiveFilterHeight,v=u.effectiveFilterWidth,w=v-1-u.padInfo.left,I=x-1-u.padInfo.top,N=qe(o.shape,"float32"),A=1/(p*f),T=n.data.get(r.dataId).values,S=qe(r.shape,"float32",T);for(let E=0;E<u.batchSize;++E)for(let $=0;$<u.inChannels;++$)for(let P=0;P<u.inHeight;++P)for(let F=0;F<u.inWidth;++F){const R=P-I,G=F-w;let q=0;for(let Q=0;Q<x;Q+=g){const te=(R+Q)/d;if(!(te<0||te>=u.outHeight||Math.floor(te)!==te))for(let B=0;B<v;B+=y){const H=(G+B)/h;if(H<0||H>=u.outWidth||Math.floor(H)!==H)continue;const Z=S.get(E,te,H,$);q+=Z}}N.set(q*A,E,P,F,$)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const zve={kernelName:Ib,backendName:"cpu",kernelFunc:Vve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:i,offset:o,mean:a,variance:l}=e;D(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ne([r,a,l,i,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,p=i?n.data.get(i.dataId).values:new Float32Array([1]),f=o?n.data.get(o.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),y=f.length,x=p.length,v=h.length,w=d.length;let I=0,N=0,A=0,T=0;for(let S=0;S<u.length;++S)g[S]=f[I++]+(u[S]-d[N++])*p[A++]/Math.sqrt(h[T++]+c),I>=y&&(I=0),N>=w&&(N=0),A>=x&&(A=0),T>=v&&(T=0);return n.makeTensorInfo(r.shape,r.dtype,g)}const Bve={kernelName:tg,backendName:"cpu",kernelFunc:jve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;Ne([r],"batchToSpaceND");const a=i.reduce((x,v)=>x*v),l=ry(r.shape,i,a),c=iy(l.length,i.length),u=oy(r.shape,i,a),d=PC(o,i.length),h=OC(u,o,i.length),p=Rt({inputs:{x:r},backend:n,attrs:{shape:l}}),f=Us({inputs:{x:p},backend:n,attrs:{perm:c}}),g=Rt({inputs:{x:f},backend:n,attrs:{shape:u}}),y=Uc({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}const Wve={kernelName:Um,backendName:"cpu",kernelFunc:Uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=b2(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Hve={kernelName:Sb,backendName:"cpu",kernelFunc:Gve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qve(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,a=Ue(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Kve={kernelName:Tb,backendName:"cpu",kernelFunc:qve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xve=vt(eh,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Yve={kernelName:eh,backendName:"cpu",kernelFunc:Xve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qve=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(J(e.shape)),r=n.data.get(e.dataId),i=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];s[c]=Math.hypot(u,d)}return n.makeOutput(s,e.shape,"float32")},Jve={kernelName:Gm,backendName:"cpu",kernelFunc:Qve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cd(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,i=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,i)}const Zve={kernelName:Gb,backendName:"cpu",kernelFunc:Cd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $d(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=Qe(r,e[0].shape)[0],o=e.map(g=>g.shape);AC(o,i);let a=Ji(e.map(g=>g.shape),i);if(J(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(g=>J(g.shape)>0);if(l.length===1)return ao({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(I=>Bc({inputs:{input:I},backend:n})),y=l.map(I=>Cd({inputs:{input:I},backend:n})),x=$d({inputs:g,backend:n,attrs:{axis:i}}),v=$d({inputs:y,backend:n,attrs:{axis:i}}),w=Zs({inputs:{real:x,imag:v},backend:n});return g.forEach(I=>n.disposeIntermediateTensorInfo(I)),y.forEach(I=>n.disposeIntermediateTensorInfo(I)),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),w}const c=l.map(g=>{const x=[-1,J(g.shape.slice(i))];return Rt({inputs:{x:g},backend:n,attrs:{shape:x}})}),u=c.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));a=Ji(c.map(g=>g.shape),1);const d=c[0].shape[0]===1,h=EW(u,a,e[0].dtype,d),p=Ji(l.map(g=>g.shape),i),f=n.makeTensorInfo(p,e[0].dtype,h);return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),f}const e0e={kernelName:Hm,backendName:"cpu",kernelFunc:$d};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;Ne([r,i],"conv2d");const d=ia(l),h=On(r.shape,i.shape,o,c,a,u,!1,d),p=h.filterHeight,f=h.filterWidth,g=h.dilationHeight,y=h.dilationWidth,x=h.padInfo.left,v=h.padInfo.top,w=h.dataFormat==="channelsLast",I=new gn(h.outShape,r.dtype),N=Re(r.shape),A=Re(i.shape),T=N[0],S=w?N[1]:N[2],E=w?N[2]:1,$=w?1:N[1],P=I.strides[0],F=w?I.strides[1]:I.strides[2],R=w?I.strides[2]:1,G=w?1:I.strides[1],q=n.data.get(r.dataId).values,Q=n.data.get(i.dataId).values,te=I.values;for(let B=0;B<h.batchSize;++B){const H=B*T,Z=B*P;for(let se=0;se<h.outHeight;++se){const re=Z+se*F,ie=se*h.strideHeight-v;for(let de=0;de<p;++de){const ce=ie+de*g;if(ce<0||ce>=h.inHeight)continue;const pe=de*A[0],we=H+ce*S;for(let De=0;De<h.outWidth;++De){const $e=re+De*R,Oe=De*h.strideWidth-x;for(let ve=0;ve<f;++ve){const Le=Oe+ve*y;if(Le<0||Le>=h.inWidth)continue;const ze=pe+ve*A[1],it=we+Le*E;let ct=ze;for(let ot=0;ot<h.inChannels;++ot){const ht=q[it+ot*$];for(let yt=0;yt<h.outChannels;++yt)te[$e+yt*G]+=ht*Q[ct+yt];ct+=h.outChannels}}}}}}return n.makeTensorInfo(I.shape,I.dtype,te)}const t0e={kernelName:qm,backendName:"cpu",kernelFunc:S6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;Ne([r,i],"conv2dBackpropFilter");const d=ia(l),h=On(r.shape,u,o,1,a,c,!1,d),{strideHeight:p,strideWidth:f,filterHeight:g,filterWidth:y}=h,x=h.dataFormat==="channelsLast",v=new gn(h.filterShape,"float32"),w=h.padInfo.left,I=h.padInfo.top,N=n.data.get(r.dataId).values,A=n.data.get(i.dataId).values,T=new gn(r.shape,r.dtype,N),S=new gn(i.shape,i.dtype,A);for(let E=0;E<g;++E){const $=Math.max(0,Math.ceil((I-E)/p)),P=Math.min(h.outHeight,(h.inHeight+I-E)/p);for(let F=0;F<y;++F){const R=Math.max(0,Math.ceil((w-F)/f)),G=Math.min(h.outWidth,(h.inWidth+w-F)/f);for(let q=0;q<h.inChannels;++q)for(let Q=0;Q<h.outChannels;++Q){let te=0;for(let B=0;B<h.batchSize;++B)for(let H=$;H<P;++H){const Z=E+H*p-I;for(let se=R;se<G;++se){const re=F+se*f-w;x?te+=T.get(B,Z,re,q)*S.get(B,H,se,Q):te+=T.get(B,q,Z,re)*S.get(B,Q,H,se)}}v.set(te,E,F,q,Q)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const s0e={kernelName:_b,backendName:"cpu",kernelFunc:n0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;Ne([r,i],"conv2dBackpropInput");const d=Re(i.shape),h=Re(r.shape);let p=ia(c);const f=On(o,i.shape,a,1,l,u,!1,p),g=new gn(f.inShape,"float32"),y=g.values,x=n.data.get(r.dataId).values,v=n.data.get(i.dataId).values,[w,I,N]=d,{batchSize:A,filterHeight:T,filterWidth:S,inChannels:E,inHeight:$,inWidth:P,outChannels:F,outHeight:R,outWidth:G,strideHeight:q,strideWidth:Q}=f;p=f.dataFormat;const te=T-1-f.padInfo.top,B=S-1-f.padInfo.left,H=p==="channelsLast",Z=g.strides[0],se=H?g.strides[1]:g.strides[2],re=H?g.strides[2]:1,ie=H?1:g.strides[1],de=h[0],ce=H?h[1]:h[2],pe=H?h[2]:1,we=H?1:h[1];for(let De=0;De<A;++De)for(let $e=0;$e<E;++$e)for(let Oe=0;Oe<$;++Oe){const ve=Oe-te,Le=Math.max(0,Math.ceil(ve/q)),ze=Math.min(R,(T+ve)/q);for(let it=0;it<P;++it){const ct=it-B,ot=Math.max(0,Math.ceil(ct/Q)),ht=Math.min(G,(S+ct)/Q);let yt=0;for(let Nt=Le;Nt<ze;++Nt){const hr=Nt*q-ve;for(let Qn=ot;Qn<ht;++Qn){const pr=Qn*Q-ct,fe=de*De+ce*Nt+pe*Qn,Ae=w*(T-1-hr)+I*(S-1-pr)+N*$e;for(let je=0;je<F;++je){const He=x[fe+we*je],_t=v[Ae+je];yt+=He*_t}}}const Yn=Z*De+se*Oe+re*it+ie*$e;y[Yn]=yt}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const i0e={kernelName:Km,backendName:"cpu",kernelFunc:r0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s;Ne([r,i],"conv3d");const c=Sl(r.shape,i.shape,o,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:p,dilationHeight:f,dilationWidth:g,padInfo:y}=c,x=y.front,v=y.left,w=y.top,I=new gn(c.outShape,r.dtype),N=n.data.get(r.dataId).values,A=n.data.get(i.dataId).values,T=I.values,S=Re(r.shape),E=Re(i.shape);for(let $=0;$<c.batchSize;++$){const P=$*S[0],F=$*I.strides[0];for(let R=0;R<c.outDepth;++R){const G=F+R*I.strides[1],q=R*c.strideDepth-x;for(let Q=0;Q<u;++Q){const te=q+Q*p;if(te<0||te>=c.inDepth)continue;const B=Q*E[0],H=P+te*S[1];for(let Z=0;Z<c.outHeight;++Z){const se=G+Z*I.strides[2],re=Z*c.strideHeight-w;for(let ie=0;ie<d;++ie){const de=re+ie*f;if(de<0||de>=c.inHeight)continue;const ce=B+ie*E[1],pe=H+de*S[2];for(let we=0;we<c.outWidth;++we){const De=se+we*c.outChannels,$e=we*c.strideWidth-v;for(let Oe=0;Oe<h;++Oe){const ve=$e+Oe*g;if(ve<0||ve>=c.inWidth)continue;const Le=ce+Oe*E[2],ze=pe+ve*c.inChannels;let it=Le;for(let ct=0;ct<c.inChannels;++ct){const ot=N[ze+ct];for(let ht=0;ht<c.outChannels;++ht)T[De+ht]+=ot*A[it+ht];it+=c.outChannels}}}}}}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const a0e={kernelName:Xm,backendName:"cpu",kernelFunc:o0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s;Ne([r,i],"conv3dBackpropFilterV2");const c=Re(r.shape),u=Re(i.shape),d=Sl(r.shape,l,o,1,a),h=d.strideDepth,p=d.strideHeight,f=d.strideWidth,g=d.filterDepth,y=d.filterHeight,x=d.filterWidth,v=new gn(d.filterShape,"float32"),w=v.values,[I,N,A,T]=v.strides,S=n.data.get(i.dataId).values,[E,$,P,F]=u,R=n.data.get(r.dataId).values,[G,q,Q,te]=c,B=d.padInfo.front,H=d.padInfo.left,Z=d.padInfo.top;for(let se=0;se<g;++se){const re=Math.max(0,Math.ceil((B-se)/h)),ie=Math.min(d.outDepth,(d.inDepth+B-se)/h),de=se*I;for(let ce=0;ce<y;++ce){const pe=Math.max(0,Math.ceil((Z-ce)/p)),we=Math.min(d.outHeight,(d.inHeight+Z-ce)/p),De=ce*N+de;for(let $e=0;$e<x;++$e){const Oe=Math.max(0,Math.ceil((H-$e)/f)),ve=Math.min(d.outWidth,(d.inWidth+H-$e)/f),Le=$e*A+De;for(let ze=0;ze<d.inChannels;++ze){const it=ze*T+Le;for(let ct=0;ct<d.outChannels;++ct){let ot=0;for(let ht=0;ht<d.batchSize;++ht){const yt=ht*G,Yn=ht*E;for(let Nt=re;Nt<ie;++Nt){const Qn=(se+Nt*h-B)*q+yt,pr=Nt*$+Yn;for(let fe=pe;fe<we;++fe){const je=(ce+fe*p-Z)*Q+Qn,He=fe*P+pr;for(let _t=Oe;_t<ve;++_t){const fr=($e+_t*f-H)*te+je,fo=_t*F+He;ot+=R[fr+ze]*S[fo+ct]}}}}w[it+ct]=ot}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const c0e={kernelName:Eb,backendName:"cpu",kernelFunc:l0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s;Ne([r],"conv3dBackpropInputV2");const c=Re(r.shape),u=Re(i.shape),d=Sl(l,i.shape,a,1,o),h=new gn(d.inShape,"float32"),p=h.values,[f,g,y,x]=h.strides,v=n.data.get(r.dataId).values,[w,I,N,A]=c,T=n.data.get(i.dataId).values,[S,E,$,P]=u,{batchSize:F,filterDepth:R,filterHeight:G,filterWidth:q,inChannels:Q,inDepth:te,inHeight:B,inWidth:H,outChannels:Z,outDepth:se,outHeight:re,outWidth:ie,strideDepth:de,strideHeight:ce,strideWidth:pe}=d,we=R-1-d.padInfo.front,De=G-1-d.padInfo.top,$e=q-1-d.padInfo.left;for(let Oe=0;Oe<F;++Oe)for(let ve=0;ve<Q;++ve)for(let Le=0;Le<te;++Le){const ze=Le-we,it=Math.max(0,Math.ceil(ze/de)),ct=Math.min(se,(R+ze)/de);for(let ot=0;ot<B;++ot){const ht=ot-De,yt=Math.max(0,Math.ceil(ht/ce)),Yn=Math.min(re,(G+ht)/ce);for(let Nt=0;Nt<H;++Nt){const hr=Nt-$e,Qn=Math.max(0,Math.ceil(hr/pe)),pr=Math.min(ie,(q+hr)/pe);let fe=0;for(let Ae=it;Ae<ct;++Ae){const je=Ae*de-ze;for(let He=yt;He<Yn;++He){const _t=He*ce-ht;for(let qs=Qn;qs<pr;++qs){const fr=qs*pe-hr,fo=w*Oe+I*Ae+N*He+A*qs,ni=S*(R-1-je)+E*(G-1-_t)+$*(q-1-fr)+P*ve;for(let si=0;si<Z;++si){const mo=v[fo+si],go=T[ni+si];fe+=mo*go}}}}p[f*Oe+g*Le+y*ot+x*Nt+ve]=fe}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const d0e={kernelName:Cb,backendName:"cpu",kernelFunc:u0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h0e=vt(th,t=>Math.cos(t)),p0e={kernelName:th,backendName:"cpu",kernelFunc:h0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f0e=vt(nh,t=>Math.cosh(t)),m0e={kernelName:nh,backendName:"cpu",kernelFunc:f0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,d,h,p]=r.shape,f=i.shape[0],[g,y]=a,x=qe([f,g,y,p],"float32"),v=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,I=n.data.get(r.dataId).values,N=Re(r.shape),A=Re(x.shape);for(let T=0;T<f;T++){const S=T*4,E=v[S],$=v[S+1],P=v[S+2],F=v[S+3],R=w[T];if(R>=u)continue;const G=g>1?(P-E)*(d-1)/(g-1):0,q=y>1?(F-$)*(h-1)/(y-1):0;for(let Q=0;Q<g;Q++){const te=g>1?E*(d-1)+Q*G:.5*(E+P)*(d-1);if(te<0||te>d-1){for(let B=0;B<y;B++)for(let H=0;H<p;H++){const Z=H+B*A[2]+Q*A[1]+T*A[0];x.values[Z]=c}continue}if(l==="bilinear"){const B=Math.floor(te),H=Math.ceil(te),Z=te-B;for(let se=0;se<y;se++){const re=y>1?$*(h-1)+se*q:.5*($+F)*(h-1);if(re<0||re>h-1){for(let pe=0;pe<p;pe++){const we=pe+se*A[2]+Q*A[1]+T*A[0];x.values[we]=c}continue}const ie=Math.floor(re),de=Math.ceil(re),ce=re-ie;for(let pe=0;pe<p;pe++){let we=pe+ie*N[2]+B*N[1]+R*N[0];const De=I[we];we=pe+de*N[2]+B*N[1]+R*N[0];const $e=I[we];we=pe+ie*N[2]+H*N[1]+R*N[0];const Oe=I[we];we=pe+de*N[2]+H*N[1]+R*N[0];const ve=I[we],Le=De+($e-De)*ce,ze=Oe+(ve-Oe)*ce;we=pe+se*A[2]+Q*A[1]+T*A[0],x.values[we]=Le+(ze-Le)*Z}}}else for(let B=0;B<y;++B){const H=y>1?$*(h-1)+B*q:.5*($+F)*(h-1);if(H<0||H>h-1){for(let re=0;re<p;re++){const ie=re+B*A[2]+Q*A[1]+T*A[0];x.values[ie]=c}continue}const Z=Math.round(H),se=Math.round(te);for(let re=0;re<p;re++){const ie=re+Z*N[2]+se*N[1]+R*N[0],de=re+B*A[2]+Q*A[1]+T*A[0];x.values[de]=I[ie]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const y0e={kernelName:Ab,backendName:"cpu",kernelFunc:g0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Ne(r,"cumprod");const l=qt([i],r.shape.length);let c=r;l!=null&&(c=Us({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=cn(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Ms(c.dtype,"int32"),h=vb(J(c.shape),d),p=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],g=a?(x,v)=>x+f-v-1:(x,v)=>x+v;for(let x=0;x<p.length;x+=f)for(let v=0;v<f;v++){const w=g(x,v);if(v===0)h[w]=o?1:p[w];else{const I=g(x,v-1);h[w]=o?p[I]*h[I]:p[w]*h[I]}}const y=n.makeTensorInfo(c.shape,d,h);if(l!=null){const x=Tl(l),v=Us({inputs:{x:y},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),v}return y}const v0e={kernelName:$b,backendName:"cpu",kernelFunc:x0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;Ne(r,"cumsum");const l=qt([i],r.shape.length);let c=r;l!=null&&(c=Us({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=cn(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Ms(c.dtype,"int32"),h=Wn(J(c.shape),d),p=n.data.get(c.dataId).values,f=c.shape[c.shape.length-1],g=a?(x,v)=>x+f-v-1:(x,v)=>x+v;for(let x=0;x<p.length;x+=f)for(let v=0;v<f;v++){const w=g(x,v);if(v===0)h[w]=o?0:p[w];else{const I=g(x,v-1);h[w]=o?p[I]+h[I]:p[w]+h[I]}}const y=n.makeTensorInfo(c.shape,d,h);if(l!=null){const x=Tl(l),v=Us({inputs:{x:y},backend:n,attrs:{perm:x}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),v}return y}const w0e={kernelName:Ym,backendName:"cpu",kernelFunc:b0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=b2(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=TW(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const k0e={kernelName:Rb,backendName:"cpu",kernelFunc:I0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s;D(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*i,h=c*i,p=u/(i*i),f=n.data.get(r.dataId).values,g=new Float32Array(a*d*h*p);let y=0;for(let x=0;x<a;++x)for(let v=0;v<d;++v){const w=Math.floor(v/i),I=v%i;for(let N=0;N<h;++N){const A=Math.floor(N/i),T=N%i,S=(I*i+T)*p;for(let E=0;E<p;++E){const P=E+S+u*(A+c*(w+l*x));g[y++]=f[P]}}}return n.makeTensorInfo([a,d,h,p],r.dtype,g)}const T0e={kernelName:Db,backendName:"cpu",kernelFunc:S0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;Ne([r,i],"depthwiseConv2DNative");const u=Re(r.shape),d=Re(i.shape);let h=l;h==null&&(h=[1,1]),D(Hn(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const p=On(r.shape,i.shape,o,h,a,c,!0),{filterHeight:f,filterWidth:g,dilationHeight:y,dilationWidth:x,padInfo:v}=p,w=v.left,I=v.top,N=p.outChannels/p.inChannels,A=new gn(p.outShape,r.dtype),T=n.data.get(r.dataId).values,S=n.data.get(i.dataId).values,E=A.values;for(let $=0;$<p.batchSize;++$){const P=$*u[0],F=$*A.strides[0];for(let R=0;R<p.outHeight;++R){const G=F+R*A.strides[1],q=R*p.strideHeight-I;for(let Q=0;Q<f;++Q){const te=q+Q*y;if(te<0||te>=p.inHeight)continue;const B=Q*d[0],H=P+te*u[1];for(let Z=0;Z<p.outWidth;++Z){const se=G+Z*A.strides[2],re=Z*p.strideWidth-w;for(let ie=0;ie<g;++ie){const de=re+ie*x;if(de<0||de>=p.inWidth)continue;const ce=B+ie*d[1],pe=H+de*p.inChannels;let we=se,De=ce;for(let $e=0;$e<p.inChannels;++$e){const Oe=T[pe+$e];for(let ve=0;ve<N;++ve)E[we+ve]+=Oe*S[De+ve];we+=N,De+=N}}}}}}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const N0e={kernelName:Qm,backendName:"cpu",kernelFunc:T6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;Ne([r,i],"depthwiseConv2dNativeBackpropFilter");const d=On(r.shape,u,o,a,l,c,!0),{strideHeight:h,strideWidth:p,filterHeight:f,filterWidth:g}=d,y=new gn(d.filterShape,"float32"),x=d.padInfo.left,v=d.padInfo.top,w=d.outChannels/d.inChannels,I=n.data.get(r.dataId).values,N=new gn(r.shape,r.dtype,I),A=n.data.get(i.dataId).values,T=new gn(i.shape,i.dtype,A);for(let S=0;S<f;++S){const E=Math.max(0,Math.ceil((v-S)/h)),$=Math.min(d.outHeight,(d.inHeight+v-S)/h);for(let P=0;P<g;++P){const F=Math.max(0,Math.ceil((x-P)/p)),R=Math.min(d.outWidth,(d.inWidth+x-P)/p);for(let G=0;G<d.outChannels;++G){const q=Math.trunc(G/w),Q=G%w;let te=0;for(let B=0;B<d.batchSize;++B)for(let H=E;H<$;++H){const Z=S+H*h-v;for(let se=F;se<R;++se){const re=P+se*p-x;te+=N.get(B,Z,re,q)*T.get(B,H,se,G)}}y.set(te,S,P,q,Q)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const E0e={kernelName:Pb,backendName:"cpu",kernelFunc:_0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C0e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;Ne([r,i],"depthwiseConv2DNativeBackpropInput");const d=Re(r.shape),h=Re(i.shape),p=On(u,i.shape,o,a,l,c,!0),f=new gn(p.inShape,"float32"),g=f.values,[y,x,v]=f.strides,w=n.data.get(r.dataId).values,[I,N,A]=d,T=n.data.get(i.dataId).values,[S,E,$]=h,{batchSize:P,filterHeight:F,filterWidth:R,inChannels:G,inHeight:q,inWidth:Q,outChannels:te,outHeight:B,outWidth:H,strideHeight:Z,strideWidth:se}=p,re=F-1-p.padInfo.top,ie=R-1-p.padInfo.left,de=te/G;for(let ce=0;ce<P;++ce)for(let pe=0;pe<G;++pe)for(let we=0;we<q;++we){const De=we-re,$e=Math.max(0,Math.ceil(De/Z)),Oe=Math.min(B,(F+De)/Z);for(let ve=0;ve<Q;++ve){const Le=ve-ie,ze=Math.max(0,Math.ceil(Le/se)),it=Math.min(H,(R+Le)/se);let ct=0;for(let ot=$e;ot<Oe;++ot){const ht=ot*Z-De;for(let yt=ze;yt<it;++yt){const Yn=yt*se-Le,Nt=I*ce+N*ot+A*yt,hr=S*(F-1-ht)+E*(R-1-Yn)+$*pe;for(let Qn=0;Qn<de;++Qn){const pr=pe*de+Qn,fe=w[Nt+pr],Ae=T[hr+Qn];ct+=fe*Ae}}}g[y*ce+x*we+v*ve+pe]=ct}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const $0e={kernelName:Ob,backendName:"cpu",kernelFunc:C0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A0e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=J(s.shape),i=n.data.get(s.dataId).values,o=qe([r,r],s.dtype),a=o.values;for(let c=0;c<i.length;c++)a[c*r+c]=i[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const R0e={kernelName:Fb,backendName:"cpu",kernelFunc:A0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D0e={kernelName:Jm,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:i,pad:o,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:p,inHeight:f,inWidth:g,inChannels:y,outHeight:x,outWidth:v,padInfo:w,strideHeight:I,strideWidth:N,filterHeight:A,filterWidth:T,dilationHeight:S,dilationWidth:E,outShape:$}=jg(s.shape,r.shape,i,o,"NHWC",a),P=J($),F=$.length,R=Yt(s.dtype,P);for(let q=0;q<p;++q)for(let Q=0;Q<x;++Q){const te=Q*I-w.top;for(let B=0;B<v;++B){const H=B*N-w.left;for(let Z=0;Z<y;++Z){let se=Number.MIN_SAFE_INTEGER;for(let ie=0;ie<A;++ie){const de=te+ie*S;if(de>=0&&de<f)for(let ce=0;ce<T;++ce){const pe=H+ce*E;if(pe>=0&&pe<g){const we=vi([q,de,pe,Z],u,Re(s.shape)),De=vi([ie,ce,Z],h,Re(r.shape)),$e=c[we]+d[De];$e>se&&(se=$e)}}}const re=vi([q,Q,B,Z],F,Re($));R[re]=se}}}return{dataId:l.write(Il(R,s.dtype),$,s.dtype),shape:$,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P0e={kernelName:t0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=Tr(s.shape,c.data.get(s.dataId).values),d=Tr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:p,inWidth:f,inChannels:g,outHeight:y,outWidth:x,padInfo:v,strideHeight:w,strideWidth:I,filterHeight:N,filterWidth:A,dilationHeight:T,dilationWidth:S,outShape:E}=jg(s.shape,r.shape,o,a,"NHWC",l);D(i.rank===E.length,()=>`Error in ${t0}, dy must have the same rank as output ${E.length}, but got ${i.rank}`);const $=Tr(E,c.data.get(i.dataId).values),P=H_(r.shape,r.dtype);for(let R=0;R<h;++R)for(let G=0;G<y;++G){const q=G*w-v.top;for(let Q=0;Q<x;++Q){const te=Q*I-v.left;for(let B=0;B<g;++B){let H=Number.MIN_SAFE_INTEGER,Z=0,se=0;for(let re=0;re<N;++re){const ie=q+re*T;if(ie>=0&&ie<p)for(let de=0;de<A;++de){const ce=te+de*S;if(ce>=0&&ce<f){const pe=u[R][ie][ce][B]+d[re][de][B];pe>H&&(H=pe,Z=re,se=de)}}}P[Z][se][B]+=$[R][G][Q][B]}}}return{dataId:c.write(Il(P,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O0e={kernelName:e0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:i}=t,{strides:o,pad:a,dilations:l}=n,c=e,u=Tr(s.shape,c.data.get(s.dataId).values),d=Tr(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:p,inWidth:f,inChannels:g,outHeight:y,outWidth:x,padInfo:v,strideHeight:w,strideWidth:I,filterHeight:N,filterWidth:A,dilationHeight:T,dilationWidth:S,outShape:E}=jg(s.shape,r.shape,o,a,"NHWC",l);D(i.rank===E.length,()=>`Error in ${e0}, dy must have the same rank as output ${E.length}, but got ${i.rank}`);const $=Tr(E,c.data.get(i.dataId).values),P=H_(s.shape,s.dtype);for(let R=0;R<h;++R)for(let G=0;G<y;++G){const q=G*w-v.top;for(let Q=0;Q<x;++Q){const te=Q*I-v.left;for(let B=0;B<g;++B){let H=Number.MIN_SAFE_INTEGER,Z=q<0?0:q,se=te<0?0:te;for(let re=0;re<N;++re){const ie=q+re*T;if(ie>=0&&ie<p)for(let de=0;de<A;++de){const ce=te+de*S;if(ce>=0&&ce<f){const pe=u[R][ie][ce][B]+d[re][de][B];pe>H&&(H=pe,Z=ie,se=ce)}}}P[R][Z][se][B]+=$[R][G][Q][B]}}}return{dataId:c.write(Il(P,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:i,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=i.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,p]=r.shape.slice(0,2),f=r.shape.length===2?1:r.shape[2],g=n.data.get(r.dataId).values,y=r.dtype==="float32"?255:1,x=new Uint8ClampedArray(p*h*4);for(let w=0;w<h*p;++w){const I=[0,0,0,255*c];for(let A=0;A<f;A++){const T=g[w*f+A];if(r.dtype==="float32"){if(T<0||T>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${T}.`)}else if(r.dtype==="int32"&&(T<0||T>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${T}.`);f===1?(I[0]=T*y,I[1]=T*y,I[2]=T*y):I[A]=T*y}const N=w*4;x[N+0]=Math.round(I[0]),x[N+1]=Math.round(I[1]),x[N+2]=Math.round(I[2]),x[N+3]=Math.round(I[3])}i.width=p,i.height=h;const v=new ImageData(x,p,h);return d.putImageData(v,0,0),r}const L0e={kernelName:Lb,backendName:"cpu",kernelFunc:F0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function my(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"sum");let a;r.dtype==="bool"?a=ml({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=ao({inputs:{x:r},backend:n});const l=a.shape.length,c=Qe(i,a.shape),u=qt(c,l);let d=c,h=a;u!=null&&(h=Us({inputs:{x:a},backend:n,attrs:{perm:u}}),d=cn(d.length,l)),qn("sum",d,h.shape.length);const[p,f]=Fn(h.shape,d),g=Ms(h.dtype,"int32");let y=v0(n,p,g);const x=J(f),v=n.data.get(y.dataId).values,w=n.data.get(h.dataId).values;for(let I=0;I<v.length;++I){const N=I*x;let A=0;for(let T=0;T<x;++T)A+=w[N+T];v[I]=A}if(o){const I=an(y.shape,c),N=y;y=Rt({inputs:{x:y},backend:n,attrs:{shape:I}}),n.disposeIntermediateTensorInfo(N)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),y}const M0e={kernelName:Ag,backendName:"cpu",kernelFunc:my};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0e(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=UC(r,i.length);GC(o.length,l,i);const{path:c,steps:u}=HC(a,l),d=u.length;let h=null,p=o.length;const f=[];for(let g=0;g<d;++g){for(const y of u[g]){const{permutationIndices:x,expandDims:v}=WC(p,l[y]);let w;qC(x)?w=i[y]:(w=Us({inputs:{x:i[y]},backend:n,attrs:{perm:x}}),f.push(w));const I=w.shape.slice();for(let N=0;N<v.length;++N)I.splice(v[N],0,1);Ze(w.shape,I)||(w=Rt({inputs:{x:w},backend:n,attrs:{shape:I}}),f.push(w)),h===null?h=w:(h=N1({inputs:{a:w,b:h},backend:n}),f.push(h))}g<d-1&&(c[g]>=0&&(h=my({inputs:{x:h},backend:n,attrs:{axis:c[g]-(o.length-p),keepDims:!1}}),f.push(h)),p--)}for(const g of f)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const z0e={kernelName:Mb,backendName:"cpu",kernelFunc:V0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0e(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Ne([s,r],"eluGrad");const i=new Float32Array(J(r.shape)),o=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?i[l]=a[l]:i[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",i)}const B0e={kernelName:Vb,backendName:"cpu",kernelFunc:j0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U0e=FC,W0e=LC,G0e=MC,H0e=VC,q0e=zC,K0e=jC,X0e=vt(ih,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+U0e*n);return e*(1-((((K0e*s+q0e)*s+H0e)*s+G0e)*s+W0e)*s*Math.exp(-n*n))}),Y0e={kernelName:ih,backendName:"cpu",kernelFunc:X0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I0(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:i}=s,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(D(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Rt({inputs:{x:r},backend:n,attrs:{shape:a}})}const Q0e={kernelName:eg,backendName:"cpu",kernelFunc:I0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J0e=dn((t,e)=>t/e),N2=Nn(sh,J0e),_T={kernelName:sh,backendName:"cpu",kernelFunc:N2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6(t,e,n){const s=t.shape,r=s[0],i=s[1],o=n.data.get(t.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[r,i],u=J(c),d=Dn("float32",u),h=Dn("float32",u);for(let y=0;y<r;y++){const x=Uc({inputs:{x:a},backend:n,attrs:{begin:[y,0],size:[1,i]}}),v=Uc({inputs:{x:l},backend:n,attrs:{begin:[y,0],size:[1,i]}}),w=Zs({inputs:{real:x,imag:v},backend:n}),{real:I,imag:N}=Z0e(w,e,n),A=Xo(I,N);for(let T=0;T<i;T++){const S=BC(A,T);d[y*i+T]=S.real,h[y*i+T]=S.imag}n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w)}const p=n.makeTensorInfo(c,"float32",d),f=n.makeTensorInfo(c,"float32",h),g=Zs({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),g}function Z0e(t,e,n){const s=J(t.shape),r=n.data.get(t.dataId),i=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(ebe(s)){const a=ET(i,o,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",sa(s,"float32")),h=ao({inputs:{x:d},backend:n}),p=_T.kernelFunc({inputs:{a:c,b:d},backend:n}),f=_T.kernelFunc({inputs:{a:u,b:h},backend:n}),g=n.data.get(p.dataId).values,y=n.data.get(f.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),{real:g,imag:y}}return a}else{const a=Xo(i,o),l=tbe(a,s,e);return Oj(l)}}function ebe(t){return(t&t-1)===0}function ET(t,e,n,s,r){if(n===1)return{real:t,imag:e};const i=Xo(t,e),o=n/2,a=Fj(i),l=a.real,c=a.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),h=r.makeTensorInfo(u,"float32",c),p=Zs({inputs:{real:d,imag:h},backend:r}),f=Lj(i),g=f.real,y=f.imag,x=[g.length],v=r.makeTensorInfo(x,"float32",g),w=r.makeTensorInfo(x,"float32",y),I=Zs({inputs:{real:v,imag:w},backend:r}),N=ET(l,c,o,s,r),A=N.real,T=N.imag,S=[A.length],E=r.makeTensorInfo(S,"float32",A),$=r.makeTensorInfo(S,"float32",T),P=Zs({inputs:{real:E,imag:$},backend:r}),F=ET(g,y,o,s,r),R=F.real,G=F.imag,q=[R.length],Q=r.makeTensorInfo(q,"float32",R),te=r.makeTensorInfo(q,"float32",G),B=Zs({inputs:{real:Q,imag:te},backend:r}),H=Vj(n,s),Z=[H.real.length],se=r.makeTensorInfo(Z,"float32",H.real),re=r.makeTensorInfo(Z,"float32",H.imag),ie=Zs({inputs:{real:se,imag:re},backend:r}),de=N1({inputs:{a:ie,b:B},backend:r}),ce=Ed({inputs:{a:P,b:de},backend:r}),pe=S2({inputs:{a:P,b:de},backend:r}),we=Bc({inputs:{input:ce},backend:r}),De=Bc({inputs:{input:pe},backend:r}),$e=Cd({inputs:{input:ce},backend:r}),Oe=Cd({inputs:{input:pe},backend:r}),ve=$d({inputs:[we,De],backend:r,attrs:{axis:0}}),Le=$d({inputs:[$e,Oe],backend:r,attrs:{axis:0}}),ze=r.data.get(ve.dataId).values,it=r.data.get(Le.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(Q),r.disposeIntermediateTensorInfo(te),r.disposeIntermediateTensorInfo(B),r.disposeIntermediateTensorInfo(se),r.disposeIntermediateTensorInfo(re),r.disposeIntermediateTensorInfo(ie),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(ce),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(we),r.disposeIntermediateTensorInfo($e),r.disposeIntermediateTensorInfo(De),r.disposeIntermediateTensorInfo(Oe),r.disposeIntermediateTensorInfo(ve),r.disposeIntermediateTensorInfo(Le),{real:ze,imag:it}}function tbe(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let i=0,o=0;for(let a=0;a<e;a++){const l=zj(r*a,e,n),c=BC(t,a);i+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(i/=e,o/=e),Mj(s,i,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nbe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=J(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=Rt({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=N6(a,!1,n),c=Rt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const sbe={kernelName:zb,backendName:"cpu",kernelFunc:nbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:i}=n,o=i||Zc(r),a=Yt(o,J(s));return ibe(a,r,o),e.makeTensorInfo(s,o,a)}const rbe={kernelName:jb,backendName:"cpu",kernelFunc:_2};function ibe(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const obe={kernelName:Bb,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,i=Dn(s.dtype,J(s.shape)),[o,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let h=0;h<o;h++){const p=h*l*a*c;for(let f=0;f<a;f++){const g=f*(l*c);for(let y=0;y<l;y++){const x=y*c;for(let v=0;v<c;v++){const w=Math.round(l-y-1),I=p+g+x+v;let N=u[I];if(w>=0&&w<l){const A=w*c,T=p+g+A+v;N=u[T]}i[I]=N}}}}return{dataId:r.write(i,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function abe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=s;let g=S6({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const y=g;if(u==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const x=Rt({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=Ed({inputs:{a:g,b:x},backend:n}),n.disposeIntermediateTensorInfo(x)}else g=Ed({inputs:{a:g,b:o},backend:n});n.disposeIntermediateTensorInfo(y)}if(p){const y=g;if(u==="NCHW"&&p==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const x=Rt({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=w0(n,g,p,x,f),n.disposeIntermediateTensorInfo(x)}else g=w0(n,g,p,a,f);n.disposeIntermediateTensorInfo(y)}return g}const lbe={kernelName:Yf,backendName:"cpu",kernelFunc:abe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=s;let g=T6({inputs:{x:r,filter:i},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(o){const y=g;g=Ed({inputs:{a:g,b:o},backend:n}),n.disposeIntermediateTensorInfo(y)}if(p){const y=g;g=w0(n,g,p,a,f),n.disposeIntermediateTensorInfo(y)}return g}const ube={kernelName:Qf,backendName:"cpu",kernelFunc:cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dbe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=J(s.shape),o=r.shape,a=o[o.length-1],[l,c,u,d]=u1(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,p=n.bufferSync(s),f=FW(h,p,s.dtype,c,a,u,d,s.shape,i);return n.makeTensorInfo(l,s.dtype,f.values)}const hbe={kernelName:Ub,backendName:"cpu",kernelFunc:dbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s;Ne([r,i],"gatherV2");const l=Qe(o,r.shape)[0],c=n.data.get(i.dataId).values,u=r.shape[l];for(let I=0;I<c.length;++I){const N=c[I];D(N<=u-1&&N>=0,()=>`GatherV2: the index value ${N} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=J(i.shape),p=XC(r,i,l,d),f=Rt({inputs:{x:r},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),g=Rt({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,h/p.batchSize]}}),y=[p.batchSize,p.outerSize,h/p.batchSize,p.sliceSize],x=n.bufferSync(g),v=n.bufferSync(f),w=LW(v,x,y);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(p.outputShape,w.dtype,w.values)}const fbe={kernelName:ng,backendName:"cpu",kernelFunc:pbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=J(s.shape),i=s.shape[s.shape.length-1],o=r/i,a=Rt({inputs:{x:s},backend:n,attrs:{shape:[o,i]}}),l=N6(a,!0,n),c=Rt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const gbe={kernelName:Wb,backendName:"cpu",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ybe=vt(hh,t=>Number.isFinite(t)?1:0,"bool"),xbe={kernelName:hh,backendName:"cpu",kernelFunc:ybe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vbe=vt(ph,t=>Math.abs(t)===1/0?1:0,"bool"),bbe={kernelName:ph,backendName:"cpu",kernelFunc:vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wbe=vt(fh,t=>Number.isNaN(t)?1:0,"bool"),Ibe={kernelName:fh,backendName:"cpu",kernelFunc:wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=BW(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const Sbe={kernelName:Hb,backendName:"cpu",kernelFunc:kbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tbe=vt(gh,t=>Math.log1p(t)),Nbe={kernelName:gh,backendName:"cpu",kernelFunc:Tbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _be=dn((t,e)=>t&&e),Ebe=Nn(ag,_be,null,"bool"),Cbe={kernelName:ag,backendName:"cpu",kernelFunc:Ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $be=vt(lg,t=>t?0:1,"bool"),Abe={kernelName:lg,backendName:"cpu",kernelFunc:$be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rbe=dn((t,e)=>t||e),Dbe=Nn(cg,Rbe,null,"bool"),Pbe={kernelName:cg,backendName:"cpu",kernelFunc:Dbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s;Ne(r,"LRN");const c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,h=J(r.shape),p=new Float32Array(h);function f(g){const y=g%c;let x=g-y+Math.max(0,y-i);const v=g-y+Math.min(y+i,u);let w=0;for(;x<=v;x++){const I=d[x];w+=I*I}return w}for(let g=0;g<h;g++){const y=f(g),x=d[g]*Math.pow(o+a*y,-l);p[g]=x}return n.makeTensorInfo(r.shape,r.dtype,p)}const Fbe={kernelName:ug,backendName:"cpu",kernelFunc:Obe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;Ne(o,"LRNGrad");const d=J(o.shape),h=o.shape[3],p=n.data.get(o.dataId).values,f=n.data.get(r.dataId).values,g=n.data.get(i.dataId).values,y=new Float32Array(d),x=d;for(let v=0;v<x;v++){const w=v%h,I=v-w+Math.max(0,w-a),N=v-w+Math.min(h,w+a+1);let A=0;for(let T=I;T<N;T++)A+=Math.pow(f[T],2);A=c*A+l;for(let T=I;T<N;T++){let S=-2*c*u*f[T]*g[v]/A;v===T&&(S+=Math.pow(A,-u)),S*=p[v],y[T]+=S}}return n.makeTensorInfo(o.shape,r.dtype,y)}const Mbe={kernelName:qb,backendName:"cpu",kernelFunc:Lbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _6(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=n;let l=r.shape;const c=l.length,u=Qe(i,l);let d=u;const h=qt(d,c);let p=a.data.get(r.dataId).values;if(h!=null){const I=new Array(c);for(let N=0;N<I.length;N++)I[N]=l[h[N]];p=I2(p,l,r.dtype,h,I),d=cn(d.length,c),l=I}Ne(r,"max"),qn("max",d,c);const[f,g]=Fn(l,d),y=J(g),x=WW(p,y,f,r.dtype),v=a.write(x,f,r.dtype);let w=f;return o&&(w=an(f,u)),{dataId:v,shape:w,dtype:r.dtype}}const Vbe={kernelName:dg,backendName:"cpu",kernelFunc:_6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ne(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;D(Hn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Zr(r.shape,i,o,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Ze(u.inShape,u.outShape))d=ao({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,p=Re(r.shape),f=T2(h,r.shape,r.dtype,p,u,"max");d=n.makeTensorInfo(u.outShape,r.dtype,f.values)}return d}const jbe={kernelName:hg,backendName:"cpu",kernelFunc:zbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;Ne(r,"maxPool3d");const u=ra(r.shape,i,o,1,a,l,c),d=n.data.get(r.dataId).values,h=k6(d,r.shape,r.dtype,Re(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const Ube={kernelName:pg,backendName:"cpu",kernelFunc:Bbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;Ne([r,i],"maxPool3DGrad");const u=ra(i.shape,o,a,1,l,c),d=n.bufferSync(i),h=Rve(d,u),p=u.strideDepth,f=u.strideHeight,g=u.strideWidth,y=u.dilationDepth,x=u.dilationHeight,v=u.dilationWidth,w=u.effectiveFilterDepth,I=u.effectiveFilterHeight,N=u.effectiveFilterWidth,A=w-1-u.padInfo.front,T=N-1-u.padInfo.left,S=I-1-u.padInfo.top,E=qe(i.shape,"float32"),$=n.bufferSync(r);for(let P=0;P<u.batchSize;++P)for(let F=0;F<u.inChannels;++F)for(let R=0;R<u.inDepth;++R)for(let G=0;G<u.inHeight;++G)for(let q=0;q<u.inWidth;++q){const Q=R-A,te=G-S,B=q-T;let H=0;for(let Z=0;Z<w;Z+=y){const se=(Q+Z)/p;if(!(se<0||se>=u.outDepth||Math.floor(se)!==se))for(let re=0;re<I;re+=x){const ie=(te+re)/f;if(!(ie<0||ie>=u.outHeight||Math.floor(ie)!==ie))for(let de=0;de<N;de+=v){const ce=(B+de)/g;if(ce<0||ce>=u.outWidth||Math.floor(ce)!==ce)continue;const pe=w*I*N-1-h.get(P,se,ie,ce,F),we=Z*I*N+re*N+de,De=pe===we?1:0;if(De===0)continue;const $e=$.get(P,se,ie,ce,F);H+=$e*De}}}E.set(H,P,R,G,q,F)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const Gbe={kernelName:Xb,backendName:"cpu",kernelFunc:Wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hbe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;Ne([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=Zr(a.shape,l,c,1,u,d),p=n.data.get(a.dataId).values,f=qe(h.outShape,a.dtype,I6(p,a.shape,a.dtype,h).values),g=h.strideHeight,y=h.strideWidth,x=h.dilationHeight,v=h.dilationWidth,w=h.effectiveFilterHeight,I=h.effectiveFilterWidth,N=I-1-h.padInfo.left,A=w-1-h.padInfo.top,T=qe(a.shape,"float32"),S=n.data.get(r.dataId).values,E=qe(r.shape,"float32",S);for(let $=0;$<h.batchSize;++$)for(let P=0;P<h.inChannels;++P)for(let F=0;F<h.inHeight;++F)for(let R=0;R<h.inWidth;++R){const G=F-A,q=R-N;let Q=0;for(let te=0;te<w;te+=x){const B=(G+te)/g;if(!(B<0||B>=h.outHeight||Math.floor(B)!==B))for(let H=0;H<I;H+=v){const Z=(q+H)/y;if(Z<0||Z>=h.outWidth||Math.floor(Z)!==Z)continue;const se=w*I-1-f.get($,B,Z,P),re=te*I+H,ie=se===re?1:0;if(ie===0)continue;const de=E.get($,B,Z,P);Q+=de*ie}}T.set(Q,$,F,R,P)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const qbe={kernelName:Kb,backendName:"cpu",kernelFunc:Hbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kbe(t,e,n,s,r){const i=Re(e),o=T2(t,e,n,i,r,"max"),a=I6(t,e,n,r,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xbe={kernelName:Yb,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;Ne(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=Zr(s.shape,r,i,[1,1],o),[d,h]=Kbe(c,s.shape,s.dtype,a,u),p=l.write(d,u.outShape,s.dtype),f=l.write(h,u.outShape,s.dtype);return[{dataId:p,shape:u.outShape,dtype:s.dtype},{dataId:f,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ybe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=Qe(i,r.shape),c=Fn(r.shape,a)[1],u=J(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const p=ml({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(p);const f=N2({inputs:{a:p,b:h},backend:n});d.push(f);const g=my({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:o}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const Qbe={kernelName:fg,backendName:"cpu",kernelFunc:Ybe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;Ne(r,"min");const a=Qe(i,r.shape);let l=a;const c=qt(l,r.shape.length);let u=r;c!=null&&(u=Us({inputs:{x:r},backend:n,attrs:{perm:c}}),l=cn(l.length,r.shape.length)),qn("min",l,u.shape.length);const[d,h]=Fn(u.shape,l),p=J(h),f=Wn(J(d),u.dtype),g=n.data.get(u.dataId).values;for(let x=0;x<f.length;++x){const v=x*p;let w=g[v];for(let I=0;I<p;++I){const N=g[v+I];(Number.isNaN(N)||N<w)&&(w=N)}f[x]=w}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(d,u.dtype,f);if(o){const x=an(d,a),v=Rt({inputs:{x:y},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(y),v}return y}const Zbe={kernelName:mg,backendName:"cpu",kernelFunc:Jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ewe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,mode:o}=s;Ne(r,"mirrorPad");const a=i.map((w,I)=>w[0]+r.shape[I]+w[1]),l=i.map(w=>w[0]),c=i.map((w,I)=>w[0]+r.shape[I]),u=o==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,p=Re(r.shape),f=J(a),g=a.length,y=Re(a),x=Dn(r.dtype,f);for(let w=0;w<f;w++){let I=eu(w,g,y);for(let A=0;A<g;A++)I[A]<l[A]?I[A]=l[A]*2-I[A]-u:I[A]>=c[A]&&(I[A]=(c[A]-1)*2-I[A]+u);I=I.map((A,T)=>A-l[T]);const N=vi(I,h,p);x[w]=d[N]}return{dataId:n.write(x,a,r.dtype),shape:a,dtype:r.dtype}}const twe={kernelName:gg,backendName:"cpu",kernelFunc:ewe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nwe=dn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),swe=Nn(vh,nwe),rwe={kernelName:vh,backendName:"cpu",kernelFunc:swe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=r.shape.length;let a=i;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=Qe([a],r.shape),c=_6({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=an(c.shape,l),d=Rt({inputs:{x:c},backend:n,attrs:{shape:u}}),h=S2({inputs:{a:r,b:d},backend:n}),p=RW({inputs:{x:h},backend:n}),f=my({inputs:{x:p},backend:n,attrs:{axis:l,keepDims:!1}}),g=Rt({inputs:{x:f},backend:n,attrs:{shape:u}}),y=N2({inputs:{a:p,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}const iwe={kernelName:Pg,backendName:"cpu",kernelFunc:E6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function owe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s;Ne(r,"multinomial");const l=a?r:E6({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,i],p=Wn(J(h),"int32");for(let f=0;f<c;++f){const g=f*u,y=new Float32Array(u-1);y[0]=d[g];for(let w=1;w<y.length;++w)y[w]=y[w-1]+d[g+w];const x=Vw.alea(o.toString()),v=f*i;for(let w=0;w<i;++w){const I=x();p[v+w]=y.length;for(let N=0;N<y.length;N++)if(I<y[N]){p[v+w]=N;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",p)}const awe={kernelName:Qb,backendName:"cpu",kernelFunc:owe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lwe=o1;function cwe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;Ne(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:d}=lwe(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const uwe={kernelName:Jb,backendName:"cpu",kernelFunc:cwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dwe=a1;function hwe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;Ne(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:h,validOutputs:p}=dwe(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const pwe={kernelName:Zb,backendName:"cpu",kernelFunc:hwe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fwe=l1;function mwe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;Ne(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,h=o,p=a,f=l,g=c,{selectedIndices:y,selectedScores:x}=fwe(u,d,h,p,f,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const gwe={kernelName:ew,backendName:"cpu",kernelFunc:mwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ywe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s;Ne(r,"oneHot");const c=J(r.shape),u=new Float32Array(c*o);u.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<o&&(u[h*o+d[h]]=a);return n.makeTensorInfo([...r.shape,o],i,u)}const xwe={kernelName:bg,backendName:"cpu",kernelFunc:ywe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k0(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Bc({inputs:{input:s},backend:n}),i=k0({inputs:{x:r},backend:n}),o=Cd({inputs:{input:s},backend:n}),a=k0({inputs:{x:o},backend:n}),l=Zs({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return _2({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const vwe={kernelName:Mg,backendName:"cpu",kernelFunc:k0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C6(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Bc({inputs:{input:s},backend:n}),i=C6({inputs:{x:r},backend:n}),o=Cd({inputs:{input:s},backend:n}),a=k0({inputs:{x:o},backend:n}),l=Zs({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return _2({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const bwe={kernelName:vg,backendName:"cpu",kernelFunc:C6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $6(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return I0({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Gn(i,u.shape,"All tensors passed to stack must have matching shapes"),D(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=I0({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=$d({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const wwe={kernelName:wg,backendName:"cpu",kernelFunc:$6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;Ne(r,"pad");const a=i.map((v,w)=>v[0]+r.shape[w]+v[1]),l=i.map(v=>v[0]),c=n.data.get(r.dataId).values,u=J(r.shape),d=r.shape.length,h=Re(r.shape),p=J(a),f=a.length,g=Re(a),y=Dn(r.dtype,p);o!==0&&y.fill(o);for(let v=0;v<u;v++){const I=eu(v,d,h).map((A,T)=>A+l[T]),N=vi(I,f,g);y[N]=c[v]}return{dataId:n.write(y,a,r.dtype),shape:a,dtype:r.dtype}}const A6={kernelName:Ig,backendName:"cpu",kernelFunc:Iwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kwe=dn((t,e)=>Math.pow(t,e)),Swe=Nn(wh,kwe),Twe={kernelName:wh,backendName:"cpu",kernelFunc:Swe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nwe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,a=r.map(y=>n.data.get(y.dataId).values),l=r.map(y=>y.shape),c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,[d,h,p]=YW(a,l,c,i.shape,i.dtype,u,o.shape),f=d.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(p,i.dtype,h);return f.concat([g])}const _we={kernelName:tw,backendName:"cpu",kernelFunc:Nwe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ewe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=QW(o,s.shape,s.dtype,a,r.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const Cwe={kernelName:nw,backendName:"cpu",kernelFunc:Ewe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=a.map(y=>n.data.get(y.dataId).values),p=a.map(y=>y.shape),[f,g]=JW(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,p,l);return n.makeTensorInfo(f,i.dtype,g)}const Awe={kernelName:sw,backendName:"cpu",kernelFunc:$we};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rwe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:i,step:o}=n,a=ZW(s,r,o,i);return e.makeTensorInfo([a.length],i,a)}const Dwe={kernelName:rw,backendName:"cpu",kernelFunc:Rwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pwe=vt(Ih,t=>1/t),Owe={kernelName:Ih,backendName:"cpu",kernelFunc:Pwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fwe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Ne(r,"resizeBilinear");const l=Re(r.shape),[c,u]=a,[d,h,p,f]=r.shape,g=n.data.get(r.dataId).values,y=new Float32Array(J([d,c,u,f])),x=[i&&c>1?h-1:h,i&&u>1?p-1:p],v=[i&&c>1?c-1:c,i&&u>1?u-1:u];let w=0;const I=x[0]/v[0],N=x[1]/v[1];for(let A=0;A<d;A++)for(let T=0;T<c;T++){let S;o?S=I*(T+.5)-.5:S=I*T;const E=Math.max(0,Math.floor(S)),$=S-E,P=Math.min(h-1,Math.ceil(S)),F=A*l[0]+E*l[1],R=A*l[0]+P*l[1];for(let G=0;G<u;G++){let q;o?q=N*(G+.5)-.5:q=N*G;const Q=Math.max(0,Math.floor(q)),te=q-Q,B=Math.min(p-1,Math.ceil(q)),H=F+Q*l[2],Z=R+Q*l[2],se=F+B*l[2],re=R+B*l[2];for(let ie=0;ie<f;ie++){const de=g[H+ie],ce=g[Z+ie],pe=g[se+ie],we=g[re+ie],De=de+(pe-de)*te,$e=ce+(we-ce)*te,Oe=De+($e-De)*$;y[w++]=Oe}}}return n.makeTensorInfo([d,c,u,f],"float32",y)}const Lwe={kernelName:_g,backendName:"cpu",kernelFunc:Fwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Ne([i,r],"resizeBilinearGrad");const a=Re(r.shape),[l,c,u,d]=r.shape,[,h,p]=i.shape,f=new Float32Array(l*c*u*d),g=[o&&h>1?c-1:c,o&&p>1?u-1:u],y=[o&&h>1?h-1:h,o&&p>1?p-1:p],x=g[0]/y[0],v=g[1]/y[1],w=n.data.get(i.dataId).values;let I=0;for(let N=0;N<l;N++){const A=N*a[0];for(let T=0;T<h;T++){const S=T*x,E=Math.floor(S),$=Math.min(Math.ceil(S),c-1),P=A+E*a[1],F=A+$*a[1],R=S-E,G=1-R;for(let q=0;q<p;q++){const Q=q*v,te=Math.floor(Q),B=Math.min(Math.ceil(Q),u-1),H=Q-te,Z=1-H,se=P+te*a[2],re=P+B*a[2],ie=F+te*a[2],de=F+B*a[2],ce=G*Z,pe=G*H,we=R*Z,De=R*H;for(let $e=0;$e<d;$e++){const Oe=w[I++];f[se+$e]+=Oe*ce,f[re+$e]+=Oe*pe,f[ie+$e]+=Oe*we,f[de+$e]+=Oe*De}}}}return n.makeTensorInfo([l,u,c,d],"float32",f)}const Vwe={kernelName:aw,backendName:"cpu",kernelFunc:Mwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zwe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s;Ne(r,"resizeNearestNeighbor");const l=Re(r.shape),[c,u]=a,[d,h,p,f]=r.shape,g=n.data.get(r.dataId).values,y=new Float32Array(d*c*u*f),x=[i&&c>1?h-1:h,i&&u>1?p-1:p],v=[i&&c>1?c-1:c,i&&u>1?u-1:u],w=x[0]/v[0],I=x[1]/v[1];let N=0;for(let A=0;A<d;A++){const T=A*l[0];for(let S=0;S<c;S++){const E=o?w*(S+.5):w*S;let $=Math.min(h-1,i?Math.round(E):Math.floor(E));o&&($=Math.max(0,$));const P=T+$*l[1];for(let F=0;F<u;F++){const R=o?I*(F+.5):I*F;let G=Math.min(p-1,i?Math.round(R):Math.floor(R));o&&(G=Math.max(0,G));const q=P+G*l[2];for(let Q=0;Q<f;Q++){const te=g[q+Q];y[N++]=te}}}}return n.makeTensorInfo([d,c,u,f],r.dtype,y)}const jwe={kernelName:Ng,backendName:"cpu",kernelFunc:zwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s;Ne([i,r],"resizeNearestNeighborGrad");const a=Re(r.shape),l=Re(i.shape),[c,u,d,h]=r.shape,[,p,f]=i.shape,g=new Float32Array(c*u*d*h),y=n.data.get(i.dataId).values,x=[o&&p>1?u-1:u,o&&f>1?d-1:d],v=[o&&p>1?p-1:p,o&&f>1?f-1:f],w=x[0]/v[0],I=x[1]/v[1],N=1/w,A=1/I,T=Math.ceil(N)*2+2,S=Math.ceil(A)*2+2;for(let E=0;E<c;E++){const $=E*a[0];for(let P=0;P<u;P++){const F=$+P*a[1],R=Math.floor(P*N),G=Math.floor(R-T/2);for(let q=0;q<d;q++){const Q=F+q*a[2],te=Math.floor(q*A),B=Math.floor(te-S/2);for(let H=0;H<h;H++){let Z=0;for(let se=0;se<T;se++){const re=se+G;if(re<0||re>=p)continue;const ie=$+re*l[1],de=re*w,ce=Math.min(u-1,o?Math.round(de):Math.floor(de));if(P===ce)for(let pe=0;pe<S;pe++){const we=pe+B;if(we<0||we>=f)continue;const De=ie+we*l[2],$e=we*I,Oe=Math.min(d-1,o?Math.round($e):Math.floor($e));q===Oe&&(Z+=y[De+H])}}g[Q+H]=Z}}}}return n.makeTensorInfo(r.shape,r.dtype,g)}const Uwe={kernelName:ow,backendName:"cpu",kernelFunc:Bwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wwe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s;Ne(r,"reverse");const o=r.shape.length,a=Qe(i,r.shape);if(o===0)return ao({inputs:{x:r},backend:n});const l=new gn(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(p=>h[p]=r.shape[p]-1-h[p]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Gwe={kernelName:Eg,backendName:"cpu",kernelFunc:Wwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hwe={kernelName:Sw,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=Dn(s.dtype,J(s.shape)),[c,u,d,h]=s.shape,[p,f]=DC(o,u,d),g=255,y=Math.sin(r),x=Math.cos(r),v=a.data.get(s.dataId).values;for(let I=0;I<c;I++){const N=I*d*u*h;for(let A=0;A<u;A++){const T=A*(d*h);for(let S=0;S<d;S++){const E=S*h;for(let $=0;$<h;$++){const P=[c,A,S,$],F=P[2],R=P[1];let G=(F-p)*x-(R-f)*y,q=(F-p)*y+(R-f)*x;G=Math.round(G+p),q=Math.round(q+f);let Q=i;if(typeof i!="number"&&($===3?Q=g:Q=i[$]),G>=0&&G<d&&q>=0&&q<u){const B=q*(d*h),H=G*h,Z=N+B+H+$;Q=v[Z]}const te=N+T+E+$;l[te]=Q}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qwe=vt(Th,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Kwe={kernelName:Th,backendName:"cpu",kernelFunc:qwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xwe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=El(i,r,o),h=!0,p=n.bufferSync(r),f=n.bufferSync(i),g=ac(p,f,o,d,c,l,a,u,0,h);return n.makeTensorInfo(o,g.dtype,g.values)}const Ywe={kernelName:lw,backendName:"cpu",kernelFunc:Xwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qwe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function Jwe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function Zwe(t,e,n,s,r,i){const o=Yt("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)o[c+u]=i==="left"?Qwe(l,e[u+c]):Jwe(l,e[u+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1e(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=Zwe(a,l,r.shape[0],r.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const t1e={kernelName:uw,backendName:"cpu",kernelFunc:e1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n1e(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e;Ne([s,r,i],"select");const o=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=Ms(r.dtype,i.dtype),d=Wn(J(r.shape),u);let h=0;const p=o===0||o>1||r.shape.length===1?1:J(r.shape.slice(1));for(let f=0;f<a.length;f++)for(let g=0;g<p;g++)a[f]===1?d[h++]=l[f]:d[h++]=c[f];return n.makeTensorInfo(r.shape,u,d)}const s1e={kernelName:Cg,backendName:"cpu",kernelFunc:n1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1e=p1,i1e=f1,o1e=vt(_h,t=>t>=0?i1e*t:r1e*(Math.exp(t)-1)),a1e={kernelName:_h,backendName:"cpu",kernelFunc:o1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1e=vt($h,t=>t<0?-1:t>0?1:0),c1e={kernelName:$h,backendName:"cpu",kernelFunc:l1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u1e=vt(Eh,t=>Math.sin(t)),d1e={kernelName:Eh,backendName:"cpu",kernelFunc:u1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h1e=vt(Ch,t=>Math.sinh(t)),p1e={kernelName:Ch,backendName:"cpu",kernelFunc:h1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f1e=11920928955078125e-23,zP=Math.log(f1e)+2,m1e=vt(Rh,t=>{const e=t>-zP,n=t<zP,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),g1e={kernelName:Rh,backendName:"cpu",kernelFunc:m1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;Ne([r],"spaceToBatchND");const a=J(i),l=[[0,0]];l.push(...o);for(let A=1+i.length;A<r.shape.length;++A)l.push([0,0]);const c=A6.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=ry(c.shape,i,a,!1),d=iy(u.length,i.length,!1),h=oy(c.shape,i,a,!1),g=Rt({inputs:{x:c},backend:n,attrs:{shape:u}}),v=Us({inputs:{x:g},backend:n,attrs:{perm:d}}),N=Rt({inputs:{x:v},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),N}const x1e={kernelName:Rg,backendName:"cpu",kernelFunc:y1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1e(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[d,h,p,f,g]=s6(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(y=>Number(y)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const b1e={kernelName:dw,backendName:"cpu",kernelFunc:v1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1e(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(i.dataId).values),[c,u,d]=r6(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const I1e={kernelName:hw,backendName:"cpu",kernelFunc:w1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=k2(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const S1e={kernelName:pw,backendName:"cpu",kernelFunc:k1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1e(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(r.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,[c,u]=k2(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const N1e={kernelName:fw,backendName:"cpu",kernelFunc:T1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1e(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=El(i,r,a),p=!1,f=n.bufferSync(r);let g;switch(i.dtype){case"bool":{const y=n.bufferSync(i),x=!!n.data.get(o.dataId).values[0];g=ac(f,y,a,h,u,c,l,d,x,p);break}case"float32":{const y=n.bufferSync(i),x=n.data.get(o.dataId).values[0];g=ac(f,y,a,h,u,c,l,d,x,p);break}case"int32":{const y=n.bufferSync(i),x=n.data.get(o.dataId).values[0];g=ac(f,y,a,h,u,c,l,d,x,p);break}case"string":{const y=n.bufferSync(i),x=Ho(n.data.get(o.dataId).values[0]);g=ac(f,y,a,h,u,c,l,d,x,p);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(a,g.dtype,g.values)}const E1e={kernelName:mw,backendName:"cpu",kernelFunc:_1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=Qe(o,r.shape)[0],l=KC(r,i,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const p=Uc({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,p})}const $1e={kernelName:Dg,backendName:"cpu",kernelFunc:C1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A1e={kernelName:gw,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Ne(n,"square");const r=s.data.get(n.dataId).values,i=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];i[a]=l*l}return{dataId:s.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R1e=vt(Vh,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),D1e={kernelName:Vh,backendName:"cpu",kernelFunc:R1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s;Ne(r,"stridedSlice");const{finalShapeSparse:p,finalShape:f,isIdentity:g,sliceDim0:y,isSimpleSlice:x,begin:v,end:w,strides:I}=CC(r.shape,i,o,a,l,c,u,d,h);let N;if(g)N=Rt({inputs:{x:r},backend:n,attrs:{shape:f}});else if(y||x){D(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const A=NC(v,w,I),T=Uc({inputs:{x:r},backend:n,attrs:{begin:v,size:A}});N=Rt({inputs:{x:T},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(T)}else{const A=n.bufferSync(r),T=a6(p,A,I,v);N=n.makeTensorInfo(f,T.dtype,T.values)}return N}const O1e={kernelName:yw,backendName:"cpu",kernelFunc:P1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,p=n.data.get(d.dataId).values,[f,g]=l6(h,p,r,i,o,a,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",g)]}const L1e={kernelName:xw,backendName:"cpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[c,u,d]=c6(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const V1e={kernelName:vw,backendName:"cpu",kernelFunc:M1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,a=u6(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const j1e={kernelName:bw,backendName:"cpu",kernelFunc:z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B1e=vt(Fh,t=>Math.tan(t)),U1e={kernelName:Fh,backendName:"cpu",kernelFunc:B1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W1e=vt(Lh,t=>Math.tanh(t)),G1e={kernelName:Lh,backendName:"cpu",kernelFunc:W1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1e(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:i}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=El(i,r,s.shape),d=!1,h=n.bufferSync(r),p=n.bufferSync(i),f=n.bufferSync(s),g=ac(h,p,s.shape,u,l,a,o,c,f,d);return n.makeTensorInfo(s.shape,g.dtype,g.values)}const q1e={kernelName:cw,backendName:"cpu",kernelFunc:H1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;Ne(r,"tile");const o=h6(n.bufferSync(r),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const X1e={kernelName:Mh,backendName:"cpu",kernelFunc:K1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s;Ne(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=f6(a,r.shape,r.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const Q1e={kernelName:ww,backendName:"cpu",kernelFunc:Y1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J1e(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,p]=r.shape,[f,g]=c??[d,h],y=[u,f,g,p],x=Re(r.shape),v=x[0],w=x[1],I=x[2],N=Re(y),A=N[0],T=N[1],S=N[2],E=Dn(r.dtype,J(y));E.fill(l);const $=s.data.get(r.dataId).values,P=s.data.get(i.dataId).values;for(let R=0;R<u;++R){const G=i.shape[0]===1?P:P.subarray(R*8,R*8+8);for(let q=0;q<f;++q)for(let Q=0;Q<g;++Q)for(let te=0;te<p;++te){let B;const H=G[6]*Q+G[7]*q+1;if(H===0)continue;const Z=(G[0]*Q+G[1]*q+G[2])/H,se=(G[3]*Q+G[4]*q+G[5])/H,re=jP(Z,h,a),ie=jP(se,d,a);switch(o){case"nearest":B=rIe($,d,h,v,w,I,R,ie,re,te,l);break;case"bilinear":B=iIe($,d,h,v,w,I,R,ie,re,te,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const de=R*A+q*T+Q*S+te;E[de]=B}return s.makeTensorInfo(y,r.dtype,E)}return{dataId:s.write(E,y,r.dtype),shape:r.shape,dtype:r.dtype}}const Z1e={kernelName:Iw,backendName:"cpu",kernelFunc:J1e};function jP(t,e,n){switch(n){case"reflect":return eIe(t,e);case"wrap":return tIe(t,e);case"nearest":return sIe(t,e);case"constant":default:return nIe(t)}}function eIe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return rl(0,n,e-1)}function tIe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return rl(0,n,e-1)}function nIe(t,e){return t}function sIe(t,e){return rl(0,t,e-1)}function Jp(t,e,n,s,r,i,o,a,l,c,u){const d=o*s+a*r+l*i+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function rIe(t,e,n,s,r,i,o,a,l,c,u){const d=Math.round(a),h=Math.round(l);return Jp(t,e,n,s,r,i,o,d,h,c,u)}function iIe(t,e,n,s,r,i,o,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),p=d+1,f=h+1,g=(f-l)*Jp(t,e,n,s,r,i,o,d,h,c,u)+(l-h)*Jp(t,e,n,s,r,i,o,d,f,c,u),y=(f-l)*Jp(t,e,n,s,r,i,o,p,h,c,u)+(l-h)*Jp(t,e,n,s,r,i,o,p,f,c,u);return(p-a)*g+(a-d)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oIe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;Ne(i,"unique");const o=s.data.get(i.dataId).values,{outputValues:a,outputShape:l,indices:c}=m6(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const aIe={kernelName:kw,backendName:"cpu",kernelFunc:oIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lIe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r.shape.length,a=r.shape[i],l=new Array(o-1);let c=0;for(let p=0;p<o;p++)p!==i&&(l[c++]=r.shape[p]);const u=new Array(o).fill(0),d=r.shape.slice();d[i]=1;const h=new Array(a);for(let p=0;p<h.length;p++){u[i]=p;const f=Uc({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});h[p]=Rt({inputs:{x:f},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(f)}return h}const cIe={kernelName:Fg,backendName:"cpu",kernelFunc:lIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s;Ne(r,"unsortedSegmentSum");const a=r.shape.length,l=i.shape.length,c=[],u=[],d=a-l;let h=i;for(let f=0;f<d;++f){const g=I0({inputs:{input:h},backend:n,attrs:{dim:f+1}});h=g,u.push(g)}for(let f=0;f<o;++f){const g=sa(f,"int32"),y=n.makeTensorInfo([],"int32",g),x=$W({inputs:{a:y,b:h},backend:n}),v=ml({inputs:{x},backend:n,attrs:{dtype:"float32"}}),w=N1({inputs:{a:v,b:r},backend:n}),I=my({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});c.push(I),u.push(y),u.push(x),u.push(v),u.push(w),u.push(I)}const p=$6({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),p}const dIe={kernelName:Lg,backendName:"cpu",kernelFunc:uIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hIe=[ove,zye,lve,uve,Hye,hve,fve,gve,xve,bve,Ive,Sve,Nve,Cve,Ave,Pve,Fve,Mve,zve,rve,Bve,Wve,Hve,Kye,Kve,Wye,Yye,Yve,jye,Jve,e0e,t0e,s0e,i0e,a0e,c0e,d0e,p0e,m0e,y0e,v0e,w0e,k0e,T0e,N0e,E0e,$0e,R0e,D0e,P0e,O0e,L0e,z0e,Qxe,B0e,Qye,Y0e,Jye,Q0e,exe,sbe,rbe,obe,nxe,rxe,lbe,ube,hbe,fbe,oxe,lxe,Bye,gbe,Zve,xbe,bbe,Ibe,Jxe,uxe,hxe,Sbe,fxe,Nbe,Cbe,Abe,Pbe,Fbe,Mbe,Vbe,gxe,jbe,Ube,Gbe,qbe,Xbe,Qbe,Zbe,xxe,twe,rwe,awe,bxe,Ixe,uwe,pwe,gwe,Sxe,xwe,bwe,wwe,A6,Twe,eve,_xe,_we,Cwe,Awe,Dwe,Uye,_T,Owe,tve,nve,sve,Lwe,Vwe,jwe,Uwe,Gwe,Hwe,Kwe,Oxe,Ywe,t1e,s1e,a1e,Lxe,c1e,d1e,p1e,Mxe,iwe,g1e,x1e,b1e,I1e,S1e,N1e,E1e,$1e,jxe,A1e,Uxe,Gxe,D1e,O1e,L1e,V1e,j1e,Xxe,M0e,U1e,G1e,q1e,X1e,Q1e,Z1e,Txe,aIe,cIe,dIe,vwe];for(const t of hIe)Tw(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ql={},vx={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function pIe(t,e){Ql[t]=e}function _i(t,e){if(!(t in Ql)||e!=null){const s=mIe(t,e);if(s!==null)Ql[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Ql[t];return n==null||n.isContextLost()?(delete Ql[t],_i(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ql[t])}function fIe(t){if(!X().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function mIe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??fIe(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Ql[t]},!1),X().getBool("SOFTWARE_WEBGL_ENABLED")&&(vx.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",vx)||n.getContext("experimental-webgl",vx):n.getContext("webgl2",vx)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var um;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(um||(um={}));var kr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(kr||(kr={}));var jn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(jn||(jn={}));function gy(t,e){return[e,t]}function gIe(t,e){return t*e}function bx(t){const e=J(t),n=Math.ceil(e/4);return Qv(n)}function Xh(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function yIe(t,e){const[n,s]=Xh(t,e);return n*s*4}function E2(t,e){const n=t;let s,r,i,o,a,l,c,u,d,h;return X().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,i=n.RGBA16F,o=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,i=t.RGBA,o=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function be(t,e){const n=e();return X().getBool("DEBUG")&&xIe(t),n}function xIe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+IIe(t,e))}const vIe=596e-10,bIe=65504;function wIe(t){return!!(X().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||vIe<Math.abs(t)&&Math.abs(t)<bIe)}function IIe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function wx(t,e){return da(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function kIe(t,e){const n=da(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(be(t,()=>t.shaderSource(n,e)),be(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function SIe(t,e){const n=da(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(be(t,()=>t.shaderSource(n,e)),be(t,()=>t.compileShader(n)),X().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw R6(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const TIe=/ERROR: [0-9]+:([0-9]+):/g;function R6(t,e){const n=TIe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),i=r.length.toString().length+2,o=r.map((d,h)=>pc((h+1).toString(),i)+d);let a=0;for(let d=0;d<o.length;d++)a=Math.max(o[d].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),u=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${pc(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function NIe(t){return da(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function _Ie(t,e){if(be(t,()=>t.linkProgram(e)),!X().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function QI(t,e){if(be(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function EIe(t,e){const n=da(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),be(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function CIe(t,e){const n=da(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return be(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),be(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function $Ie(t){return da(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function AIe(t,e){const n=X().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function RIe(t){return da(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function BP(t,e,n,s,r,i,o){const a=t.getAttribLocation(e,n);return a===-1?!1:(be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),be(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,i,o)),be(t,()=>t.enableVertexAttribArray(a)),!0)}function DIe(t,e,n){MIe(t,n),be(t,()=>t.activeTexture(t.TEXTURE0+n)),be(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function PIe(t,e,n){return da(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function OIe(t,e,n){return t.getUniformLocation(e,n)}function FIe(t,e,n,s){be(t,()=>DIe(t,e,s)),be(t,()=>t.uniform1i(n,s))}function JI(t,e,n){be(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),be(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function UP(t,e){be(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),be(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Ix(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+LIe(t,e))}function LIe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function da(t,e,n){const s=be(t,()=>e());if(s==null)throw new Error(n);return s}function MIe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Ad(t,e=2){return J(t.slice(0,t.length-e))}function Rd(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function kx(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Ad(t),...Rd(t)]),e}function VIe(t,e=!1){let n=X().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=X().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&X().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?xb(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=na(t).newShape);let r=J(t),i=null;t.length<=1&&r<=n?i=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>s&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const a=Ad(t);let l=2,c=2;t.length&&([l,c]=Rd(t)),r=a*(l/2)*(c/2),i=Qv(r).map(u=>u*2)}else i=Qv(r);return i}function Sx(t){return t%2===0}function S0(t,e){if(t=t.slice(-2),e=e.slice(-2),Ze(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||Sx(n)&&Sx(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Sx(t[0])&&Sx(e[0])}let ZI,ek;function zIe(t){if(ZI==null){const e=_i(t);ZI=e.getParameter(e.MAX_TEXTURE_SIZE)}return ZI}function jIe(t){if(ek==null){const e=_i(t);ek=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ek)}function BIe(t){if(t===0)return 0;let e;const n=_i(t);return Hr(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Hr(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Hr(t,e){return t.getExtension(e)!=null}function WP(t){try{if(_i(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function UIe(t){if(t===0)return!1;const e=_i(t);if(t===1){if(!Hr(e,"OES_texture_float"))return!1}else if(!Hr(e,"EXT_color_buffer_float"))return!1;return CT(e)}function WIe(t){if(t===0)return!1;const e=_i(t);if(t===1){if(!Hr(e,"OES_texture_float")||!Hr(e,"WEBGL_color_buffer_float"))return!1}else{if(Hr(e,"EXT_color_buffer_float"))return CT(e);const s="EXT_color_buffer_half_float";if(Hr(e,s)){const r=e.getExtension(s);return GIe(e,r)}return!1}return CT(e)}function CT(t){const e=E2(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function GIe(t,e){const n=E2(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),a}function HIe(t){return t!==2?!1:_i(t).fenceSync!=null}function yy(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _e=X();_e.registerFlag("HAS_WEBGL",()=>_e.getNumber("WEBGL_VERSION")>0);_e.registerFlag("WEBGL_VERSION",()=>WP(2)?2:WP(1)?1:0);_e.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);_e.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>_e.get("WEBGL_VERSION")===2);_e.registerFlag("WEBGL_CPU_FORWARD",()=>!0);_e.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);_e.registerFlag("WEBGL_PACK",()=>_e.getBool("HAS_WEBGL"));_e.registerFlag("WEBGL_PACK_NORMALIZATION",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_PACK_CLIP",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_PACK_REDUCE",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_LAZILY_UNPACK",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_CONV_IM2COL",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>_e.getBool("WEBGL_PACK"));_e.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>zIe(_e.getNumber("WEBGL_VERSION")));_e.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>jIe(_e.getNumber("WEBGL_VERSION")));_e.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=_e.getNumber("WEBGL_VERSION");return t===0?0:BIe(t)});_e.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>_e.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!J_());_e.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>UIe(_e.getNumber("WEBGL_VERSION")));_e.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>_e.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:_e.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));_e.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>WIe(_e.getNumber("WEBGL_VERSION")));_e.registerFlag("WEBGL_FENCE_API_ENABLED",()=>HIe(_e.getNumber("WEBGL_VERSION")));_e.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>_e.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);_e.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});_e.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>J_()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});_e.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);_e.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);_e.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);_e.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);_e.registerFlag("WEBGL_EXP_CONV",()=>!1);_e.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>_e.getBool("IS_TEST"));_e.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);_e.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);_e.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);_e.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $s(){let t,e,n,s,r,i,o,a,l,c;return X().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",i="outputColor",o="out vec4 outputColor;",a=X().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",i="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:i,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uu(t,e,n="index"){const s=Re(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${r}`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r}`:`index -= ${t[i]} * ${r}`;return`${o}; ${a};`}).join("")}function _1(t,e,n="index"){const s=Re(e);return s.map((r,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,a=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${a};`}).join("")}function qIe(t,e){const n=t.length,s=t.map(i=>`${e}[${i}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let i=n-3;i>=0;--i)r[i]=`(${r[i+1]} * ${s[i+1]})`;return r}function KIe(t,e,n="index"){const s=t.map((i,o)=>o),r=qIe(s,e);return r.map((i,o)=>{const a=`int ${t[o]} = ${n} / ${r[o]}`,l=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${a}; ${l};`}).join("")}function C2(t){const e=Re(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function $2(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const D6=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:P6}=tB;function XIe(t,e,n){const s=[];if(t.forEach(p=>{const f=J(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?s.push(`uniform float ${p.name}${f>1?`[${f}]`:""};`):(s.push(`uniform sampler2D ${p.name};`),s.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){const{uniformShape:g}=A2(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(g.length){case 1:s.push(`uniform int ${p.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${p.name}Shape;`);break}s.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{s.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const r=s.join(`
`),i=t.map(p=>YIe(p,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,a=$s(),l=ZIe(a);let c,u,d=nke(a);return e.isPacked?(c=QIe(e.logicalShape,o,n.enableShapeUniforms),u=tke(a)):(c=JIe(e.logicalShape,o,n.enableShapeUniforms),u=eke(a)),n.packedInputs&&(d+=oke),[d,l,u,r,c,i,n.userCode].join(`
`)}function Yh(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return xke(t,e);case 1:return bke(t,e);case 2:return Ike(t,e);case 3:return Ske(t,e);case 4:return Nke(t,e);case 5:return _ke(t);case 6:return Eke(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function O6(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return yke(t);case 1:return vke(t,e);case 2:return wke(t,e);case 3:return kke(t,e);default:return Tke(t,e)}}function YIe(t,e,n=!1,s){let r="";n?r+=O6(t,s):r+=Yh(t,s);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?r+=Cke(t,e):r+=$ke(t,e)),r}function QIe(t,e,n){switch(t.length){case 0:return F6();case 1:return ake(t,e,n);case 2:return mke(t,e,n);case 3:return cke(t,e,n);default:return dke(t,e,n)}}function JIe(t,e,n){switch(t.length){case 0:return F6();case 1:return lke(t,e,n);case 2:return gke(t,e,n);case 3:return uke(t,e,n);case 4:return hke(t,e,n);case 5:return pke(t,e);case 6:return fke(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function ZIe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function eke(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function tke(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function nke(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${ske}
    ${rke}
    ${ike}
  `}const ske=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,rke=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ike=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,oke=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function F6(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function ake(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function lke(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function cke(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),i=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function uke(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${_1(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=uu(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function dke(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2);let o=i,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function hke(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${_1(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=uu(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function pke(t,e){const n=uu(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function fke(t,e){const n=uu(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function mke(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Ze(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function gke(t,e,n){return Ze(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function du(t){return`offset${t}`}function yke(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=$s();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function xke(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,i]=t.shapeInfo.texShape;if(r===1&&i===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=du(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function vke(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,i=$s();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function bke(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Qh(t)}
      }
    `;const r=t.shapeInfo.texShape,i=r[0],o=r[1];if(o===1&&i===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=du(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function wke(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],l=$s();if(i!=null&&Ze(n,i))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function Ike(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape;if(i!=null&&Ze(n,i)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=i[0],p=i[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=na(n),l=o;if(l.length<n.length){const h=Jh(t,l),p=["row","col"];return`
      ${Yh(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${Zh(p,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Qh(t)}
      }
    `;const c=i[0],u=i[1],d=du(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function kke(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const h=n.slice(1),p=[1,2],f=Jh(t,h),g=["b","row","col"];return`
        ${O6(f,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${Zh(g,p)});
        }
      `}const a=$s();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function Ske(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[1]*n[2],o=n[2],{newShape:a,keptDims:l}=na(n),c=a;if(c.length<n.length){const g=Jh(t,c),y=["row","col","depth"];return`
        ${Yh(g,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${Zh(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${Qh(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],p=t.shapeInfo.flatOffset;if(h===i&&p==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===o&&p==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const f=du(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${f};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${f};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function Tke(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=$s();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),p="int b, int row, int col",f=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<o-1;g++)p=`int b${g}, `+p,h*=i[o-g-1],f=`b${g} * ${h} + `+f;return`
    vec4 ${s}(${p}) {
      int index = ${f};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function Nke(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),i=n[3],o=n[2]*i,a=n[1]*o,{newShape:l,keptDims:c}=na(n);if(l.length<n.length){const v=Jh(t,l),w=["row","col","depth","depth2"];return`
      ${Yh(v,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${Zh(w,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${i}, 1)));
        ${Qh(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],p=d[1],f=`int stride2 = ${s}Shape[3];`,g=`int stride1 = ${s}Shape[2] * stride2;`,y=`int stride0 = ${s}Shape[1] * stride1;`;if(p===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${f}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(p===i&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const x=du(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${f}
      ${g}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${x});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${h}, ${p}, index + ${x});
      return sampleTexture(${s}, uv);
    }
  `}function _ke(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],i=e[3]*r,o=e[2]*i,a=e[1]*o,{newShape:l,keptDims:c}=na(e);if(l.length<e.length){const g=Jh(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${Yh(g)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Zh(y,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${i}, ${r})) +
          depth3;
        ${Qh(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],p=d[1];if(p===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const f=du(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${i} +
          depth2 * ${r} + depth3 + ${f};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Eke(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:i}=na(e);if(r.length<e.length){const y=Jh(t,r),x=["row","col","depth","depth2","depth3","depth4"];return`
      ${Yh(y)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Zh(x,i)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Qh(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,p=h[0],f=h[1];if(f===u&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===o&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=du(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${g};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Qh(t){const e=t.name,n=J(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Cke(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=P6(t.shapeInfo.logicalShape,e.logicalShape),l=St(o),c=o-i;let u;const d=["x","y","z","w","u","v"];i===0?u="":o<2&&a.length>=1?u="coords = 0;":u=a.map(v=>`coords.${d[v+c]} = 0;`).join(`
`);let h="";o<2&&i>0?h="coords":h=t.shapeInfo.logicalShape.map((v,w)=>`coords.${d[w+c]}`).join(", ");let p="return outputValue;";const g=J(t.shapeInfo.logicalShape)===1,x=J(e.logicalShape)===1;if(i===1&&!g&&!x)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!x)o===1?p=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:p=`
        return vec4(outputValue.x);
      `;else if(a.length){const v=i-2,w=i-1;a.indexOf(v)>-1&&a.indexOf(w)>-1?p="return vec4(outputValue.x);":a.indexOf(v)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(w)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${h});
      ${p}
    }
  `}function $ke(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Ze(o,i))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=St(l),u=P6(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const p=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(g=>`coords.${p[g+d]} = 0;`).join(`
`);let f="";return l<2&&a>0?f="coords":f=t.shapeInfo.logicalShape.map((g,y)=>`coords.${p[y+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${s}(${f});
    }
  `}function St(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function A2(t,e,n){const{newShape:s,keptDims:r}=na(e),i=e.length,o=t&&i===3&&e[0]===1,a=o?e.slice(1):s,l=!t&&i>1&&!Ze(e,n)&&s.length<i||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function Jh(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Zh(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(t,e,n,s){const r=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),i=r.map(u=>u.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=XIe(r,o,e),l=SIe(t.gl,a),c=t.createProgram(l);return X().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},L6(t,e,c)))}function L6(t,e,n){const s=[],r=[];let i,o,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),X().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),s.push(h)}if(e.enableShapeUniforms&&(i=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),o=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:o}}function GP(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,i=e[s],o=i.shape;if(!Ze(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const a=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!Ze(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Rke(t,e,n,s,r){e.program.enableShapeUniforms||(GP(e.inShapeInfos,n),GP([e.outShapeInfo],[s]));const i=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),X().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:p}=e.variablesLocations[l];if(h){const{uniformShape:f}=A2(e.program.packedInputs,c.shape,c.texData.texShape);switch(f.length){case 1:t.gl.uniform1iv(h,new Int32Array(f));break;case 2:t.gl.uniform2iv(h,new Int32Array(f));break;case 3:t.gl.uniform3iv(h,new Int32Array(f));break;case 4:t.gl.uniform4iv(h,new Int32Array(f));break}}if(p&&t.gl.uniform2i(p,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(J(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let f=c.uniformValues;f instanceof Float32Array||(f=new Float32Array(f)),t.gl.uniform1fv(u,f)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Re(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=r[l];if(c.type==="float")t.gl.uniform1fv(u,d);else if(c.type==="vec2")t.gl.uniform2fv(u,d);else if(c.type==="vec3")t.gl.uniform3fv(u,d);else if(c.type==="vec4")t.gl.uniform4fv(u,d);else if(c.type==="int")t.gl.uniform1iv(u,d);else if(c.type==="ivec2")t.gl.uniform2iv(u,d);else if(c.type==="ivec3")t.gl.uniform3iv(u,d);else if(c.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function Dke(t,e,n){let s="";e.concat(n).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=A2(t.packedInputs,o.shape,l);let h="",p="",f="";if(u.length===1&&t.packedInputs){const N=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${N[0]>1}_${N[1]>1}`}else if(u.length===2&&!t.packedInputs)p=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const N=Re(u);f=`${N[0]===l[1]}_${N[N.length-1]===l[1]}`}const g=o.shape.length,y=u.length===2&&Ze(o.shape,l),x=J(o.shape)===1,v=Fc(o.shape,n.shape),w=!t.packedInputs&&g===n.shape.length&&Ze(l,n.texData.texShape),I=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${g}_${w}_${c?d:""}_${u.length}_${x}_${v}_${y}_${h}_${p}_${f}_${I}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const r=t.userCode;let i=t.constructor.name;return i+="_"+s+"_"+r+`${X().getNumber("WEBGL_VERSION")}`,i}function us(t){return X().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pke{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=um.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=$s();this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?_1(["r","c","d"],e):uu(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oke{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=um.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=$s();this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?_1(["r","c","d"],e):uu(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fke{constructor(e){this.variableNames=["A"],this.outTexUsage=kr.DOWNLOAD;const n=$s();this.outputShape=e,this.userCode=`
      ${D6}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lke{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=kr.DOWNLOAD;const n=$s();this.outputShape=e,this.userCode=`
      ${D6}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mke={R:0,G:1,B:2,A:3};class HP{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=$s();this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${Mke[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?$2():C2(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vke{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=$s();this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length);let r="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?$2():C2(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zke(t){const e=$s(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return kIe(t,n)}function jke(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return EIe(t,e)}function Bke(t){const e=new Uint16Array([0,1,2,2,1,3]);return CIe(t,e)}function xy(t,e,n,s,r,i){AIe(e,n);const o=$Ie(t),a=t.TEXTURE_2D;return be(t,()=>t.bindTexture(a,o)),be(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),be(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),be(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),be(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),X().getNumber("WEBGL_VERSION")===1?be(t,()=>t.texImage2D(a,0,s,e,n,0,r,i,null)):be(t,()=>t.texStorage2D(a,1,s,e,n)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function M6(t){return t.internalFormatFloat}function Uke(t,e,n,s){const[r,i]=gy(e,n);return xy(t,r,i,M6(s),s.textureFormatFloat,t.FLOAT)}function V6(t){return t.internalFormatHalfFloat}function Wke(t,e,n,s){const[r,i]=gy(e,n);return xy(t,r,i,V6(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function z6(t){return t.downloadTextureFormat}function Gke(t,e,n,s){const[r,i]=gy(e,n);return xy(t,r,i,z6(s),t.RGBA,t.UNSIGNED_BYTE)}function j6(t){return t.internalFormatPackedFloat}function Hke(t,e,n,s){const[r,i]=Xh(e,n);return xy(t,r,i,j6(s),t.RGBA,t.FLOAT)}function B6(t){return t.internalFormatPackedHalfFloat}function qke(t,e,n,s){const[r,i]=Xh(e,n);return xy(t,r,i,B6(s),t.RGBA,s.textureTypeHalfFloat)}function Kke(t,e,n){return be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),BP(t,e,"clipSpacePos",n,3,20,0)&&BP(t,e,"uv",n,2,20,12)}function Xke(t,e,n,s,r,i){be(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,a,l;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*s*4),a=t.FLOAT,l=i.internalFormatPackedFloat),o.set(r),X().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,o)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,o)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Yke(t,e,n){be(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?X().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):X().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Qke(t,e,n,s){const r=t.createBuffer();be(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return be(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),be(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),be(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function Jke(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Zke(t,e,n,s){const[r,i]=gy(e,n),o=4,a=new Uint8Array(gIe(e*n,o));return be(t,()=>t.readPixels(0,0,r,i,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function eSe(t,e,n,s,r,i,o,a){const l=t,c=new Float32Array(yIe(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function tSe(t,e,n){const s=new Float32Array(e*n*4);return be(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tk{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=X().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,pIe(n,e)):this.gl=_i(n),e=this.gl,X().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>be(i,()=>i.createVertexArray()),this.bindVertexArray=o=>be(i,()=>i.bindVertexArray(o)),this.deleteVertexArray=o=>be(i,()=>i.deleteVertexArray(o)),this.getVertexArray=()=>be(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>be(e,()=>i.createVertexArrayOES()),this.bindVertexArray=o=>be(e,()=>i.bindVertexArrayOES(o)),this.deleteVertexArray=o=>be(e,()=>i.deleteVertexArrayOES(o)),this.getVertexArray=()=>be(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),X().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=wx(this.gl,i),Hr(this.gl,o))this.textureHalfFloatExtension=wx(this.gl,o);else if(X().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Hr(this.gl,r))this.colorBufferHalfFloatExtension=wx(this.gl,r);else if(X().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Hr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Hr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=jke(this.gl),this.indexBuffer=Bke(this.gl),this.framebuffer=RIe(this.gl),this.textureConfig=E2(this.gl,this.textureHalfFloatExtension)}get debug(){return X().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;be(e,()=>e.finish()),be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),be(e,()=>e.deleteFramebuffer(this.framebuffer)),be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),be(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),be(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Uke(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Wke(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Gke(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Yke(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),Xke(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),qke(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Hke(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(UP(this.gl,this.framebuffer),this.outputTexture=null),be(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Zke(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,i,o){return eSe(this.gl,e,n,s,r,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Jke(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=Qke(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(X().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(i,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=i}else X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>tSe(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=zke(n));const s=NIe(n);be(n,()=>n.attachShader(s,this.vertexShader)),be(n,()=>n.attachShader(s,e)),_Ie(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&QI(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;be(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Kke(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(be(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&QI(this.gl,this.program),be(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?PIe(this.gl,e,n):OIe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),be(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),FIe(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,i]=Xh(n,s);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&QI(this.gl,this.program),Ix(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}be(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),be(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=wx(this.gl,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await LS(()=>this.disposed||this.isQueryAvailable(e,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=nSe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in X().platform&&(s=X().platform.setTimeoutCustom.bind(X().platform)),LS(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),JI(this.gl,e,this.framebuffer),this.debug&&Ix(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(JI(this.gl,this.outputTexture,this.framebuffer),this.debug&&Ix(this.gl)):UP(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;JI(r,e,this.framebuffer),this.debug&&Ix(r),this.outputTexture=e,be(r,()=>r.viewport(0,0,n,s)),be(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),be(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function nSe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:sSe,bincountImpl:U6,bincountReduceImpl:rSe,bitwiseAndImpl:iSe,castImpl:oSe,ceilImpl:aSe,concatImpl:lSe,equalImpl:cSe,expImpl:uSe,expm1Impl:dSe,floorImpl:hSe,gatherNdImpl:pSe,gatherV2Impl:fSe,greaterImpl:mSe,greaterEqualImpl:gSe,lessImpl:ySe,lessEqualImpl:xSe,linSpaceImpl:vSe,logImpl:bSe,maxImpl:wSe,maximumImpl:ISe,minimumImpl:kSe,multiplyImpl:SSe,negImpl:TSe,notEqualImpl:NSe,prodImpl:_Se,raggedGatherImpl:ESe,raggedRangeImpl:CSe,raggedTensorToTensorImpl:$Se,rangeImpl:ASe,rsqrtImpl:RSe,scatterImpl:DSe,sigmoidImpl:PSe,simpleAbsImpl:W6,sliceImpl:OSe,sparseFillEmptyRowsImpl:FSe,sparseReshapeImpl:LSe,sparseSegmentReductionImpl:G6,sqrtImpl:MSe,staticRegexReplaceImpl:VSe,stridedSliceImpl:zSe,stringNGramsImpl:jSe,stringSplitImpl:BSe,stringToHashBucketFastImpl:USe,subImpl:WSe,tileImpl:GSe,topKImpl:HSe,transposeImpl:R2,uniqueImpl:qSe}=Yxe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ks(t,e){return e===1?[t]:H6(t,e)}function KSe(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XSe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=us(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ks("rc",this.rank),s=St(this.rank),r=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let i=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q6{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length);let s="";for(let r=0;r<4;r++){let i="thisRC = rc;";r%2===1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),s+=`
        ${i}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${YSe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?$2():C2(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function YSe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?KIe(["r","c","d"],"inputShape"):uu(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QSe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=KP(n,s),i=XP(e,r,s);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=qP(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].pop();return this.usedTextures[i].push(l),l}let a;return r===jn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===jn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===jn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===jn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===jn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const i=KP(s,r),o=XP(n,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const a=qP(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=X().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function JSe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function qP(t,e,n,s,r){const i=ZSe(e,s);let o;if(r){const[l,c]=Xh(t[0],t[1]);o=l*c}else{const[l,c]=gy(t[0],t[1]);o=l*c}const a=JSe(n,i);return o*a}function ZSe(t,e){switch(t){case jn.PACKED_2X2_FLOAT32:return j6(e);case jn.PACKED_2X2_FLOAT16:return B6(e);case jn.UNPACKED_FLOAT32:return M6(e);case jn.UNPACKED_FLOAT16:return V6(e);case jn.PACKED_4X1_UNSIGNED_BYTE:return z6(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function eTe(t){return X().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?jn.PACKED_2X2_FLOAT32:jn.UNPACKED_FLOAT32:t?jn.PACKED_2X2_FLOAT16:jn.UNPACKED_FLOAT16}function KP(t,e){if(t===kr.UPLOAD)return jn.PACKED_2X2_FLOAT32;if(t===kr.RENDER||t==null)return eTe(e);if(t===kr.DOWNLOAD||t===kr.PIXELS)return jn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function XP(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bi{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const ti="if (isnan(x)) return x;",tTe="return x;",YP="return abs(x);",nTe="return (x >= 0.0) ? x : (exp(x) - 1.0);",sTe=ti+`
  return (x < 0.0) ? 0.0 : x;
`,rTe=ti+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ba="return x;",iTe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oTe="return x;",aTe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,lTe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cTe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,uTe="return 1.0 / (1.0 + exp(-1.0 * x));";class Pa{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dTe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length);const n=e.length,s=ks("rc",n),r=St(n),i=KSe(n,s),o=s.slice(-2),a=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hTe=e1,pTe=1e-7,fTe=1e-4,Tx={};function mTe(t){return t in Tx||(Tx[t]={}),Tx[t]}const gTe=X().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),yTe=600;function xTe(){return X().global.screen==null?1024:X().global.screen.height*X().global.screen.width*window.devicePixelRatio*yTe/1024/1024}class E1 extends yb{nextDataId(){return E1.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!X().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof tk)n=e;else{const s=_i(X().getNumber("WEBGL_VERSION"),e);n=new tk(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=_i(X().getNumber("WEBGL_VERSION"));n=new tk(s),this.binaryCache=mTe(X().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new QSe(this.gpgpu),this.numMBBeforeWarning=xTe(),this.texData=new B_(this,ui())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,i,o){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,i]},l.texShape=[r,i];const c=kx(n),u=new HP(c,!1,o),d=this.runWebGLProgram(u,[a],s,[[r,i]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,s){if((X().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||X().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:kr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,i){if(X().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:kr.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:i,slice:o,shape:a,isPacked:l}=n;if(o!=null){let h;l?h=new Pa(a,ba):h=new Bi(a,ba);const p=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:r}],r),f=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),f}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=ys());let d;if(r==="complex64"){const h=this.readSync(i.real.dataId),p=this.readSync(i.imag.dataId);d=Xo(h,p)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=ys()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const f=this.pendingRead.get(e);return new Promise(g=>f.push(g))}const n=this.texData.get(e),{values:s,shape:r,slice:i,dtype:o,complexTensorInfos:a,isPacked:l}=n;if(i!=null){let f;l?f=new Pa(r,ba):f=new Bi(r,ba);const g=this.runWebGLProgram(f,[{dataId:e,shape:r,dtype:o}],o),y=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(X().getBool("DEBUG")&&!X().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&X().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(o!=="complex64"&&X().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const f=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(f.texture.texture,...bx(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const f=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),g=f[0],y=f[1];d=Xo(g,y)}else if(c==null)d=this.getValuesFromTexture(e);else{const f=J(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,f)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const f=this.gpgpu.gl;be(f,()=>f.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(f=>f(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ui().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:i,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let p;l?p=new Pa(i,ba):p=new Bi(i,ba);const f=this.runWebGLProgram(p,[{dataId:e,shape:i,dtype:a}],a),g=this.readToGPU(f,n);return this.disposeIntermediateTensorInfo(f),g}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=ui().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Ho(r));return qe(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return qe(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!wIe(s))throw X().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),i=J(n);if(X().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),p=this.texData.get(h.dataId),f=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...bx(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(h),f}const o=X().getBool("WEBGL_PACK")&&r===!0,a=o?kx(n):n,l=o?new Lke(a):new Fke(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const i=no(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=no(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);a.kernelMs=gV(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:o[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ys(),endMs:null}}endTimer(e){return X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ys(),e)}async getQueryTime(e){if(X().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:i,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=gTe){return X().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&J(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){yr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return hTe(e.shape,n)}packedUnaryOp(e,n,s){const r=new Pa(e.shape,n),i=this.compileAndRun(r,[e],s);return ui().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=W6(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(X().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,YP,e.dtype);const n=new Bi(e.shape,YP),s=this.compileAndRun(n,[e]);return ui().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&ji(s[0])){const i=s.map(o=>Yi(o));r=this.write(i,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return ui().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new dTe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new XSe(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[Ad(e.shape),...Rd(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},i=[Ad(n),...Rd(n)],o=new q6(i,s),a=!0,l=[s],c=this.runWebGLProgram(o,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=s;if(n!=null){const h=J(i),p=n[0]*n[1]*4;D(h<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=kx(i);let l;r?l=new Oke(a):l=new Pke(a);const c=!0,u=[n??bx(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,u,c,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,s,r,i=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===um.DENSE){const x=o??bx(e.outputShape);l.texShape=x.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),J(a.shape)===0)return l.values=Dn(a.dtype,0),a;const c=[],u=n.map(x=>{if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(x.dataId);if(v.texture==null){if(!e.packedInputs&&J(x.shape)<=X().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=x.shape)}if(this.uploadToGPU(x.dataId),!!v.isPacked!=!!e.packedInputs)x=v.isPacked?this.unpackTensor(x):this.packTensor(x),c.push(x),v=this.texData.get(x.dataId);else if(v.isPacked&&!S0(v.shape,x.shape)){const w=x,I=x.shape;x.shape=v.shape,x=this.packedReshape(x,I),c.push(x),v=this.texData.get(x.dataId),w.shape=I}return{shape:x.shape,texData:v,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=Dke(e,u,d),p=this.getAndSaveBinary(h,()=>Ake(this.gpgpu,e,u,d)),f=this.activeTimers!=null;let g;f&&(g=this.startTimer()),X().get("ENGINE_COMPILE_ONLY")||Rke(this.gpgpu,p,u,d,r),c.forEach(x=>this.disposeIntermediateTensorInfo(x)),f&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const y=X().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const x=ys();x-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=x)}if(!X().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const x=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),x}return a}compileAndRun(e,n,s,r,i=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(X().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=K(()=>{if(!X().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=X().getBool("DEBUG");X().set("DEBUG",!1);const n=this.abs(Pe(1e-8)).dataSync()[0];if(X().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?pTe:fTe}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:i,texture:o,usage:a,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let u;c&&(u=ys());let d=n.texShape;if(d==null&&(d=VIe(s,l),n.texShape=d),i!=null){const h=kx(s);let p,f=d[1],g=d[0];const y=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!y)&&([f,g]=Xh(d[0],d[1])),l?p=new Vke(h,y):p=new HP(h,y);const x=y?[g,f]:d,v=this.makeTensorInfo(x,r),w=this.texData.get(v.dataId);y?w.usage=kr.PIXELS:w.usage=kr.UPLOAD,w.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),f,g,i);const I=[[g,f]],A=this.runWebGLProgram(p,[v],r,I,!0),T=this.texData.get(A.dataId);n.texShape=T.texShape,n.isPacked=T.isPacked,n.usage=T.usage,X().get("ENGINE_COMPILE_ONLY")?this.disposeData(A.dataId):(n.texture=T.texture,n.values=null,this.texData.delete(A.dataId)),this.disposeIntermediateTensorInfo(v),c&&(this.uploadWaitMs+=ys()-u)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=vTe(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*Kf(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(i){throw i}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await $C(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(R6(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:i,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=L6(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:i,width:o,channels:a}=e,l=ui().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,i,o,a);return ui().makeTensorFromDataId(c,n,s,l)}}E1.nextDataId=0;function vTe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Z_()&&tE("webgl",()=>new E1,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D2=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Wc{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Ue(n,s),this.enableShapeUniforms=us(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hu=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class ep{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ue(n,s);const i=this.outputShape.length;this.enableShapeUniforms=us(i);let o="";if(r)if(i===0||J(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${St(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ks("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${l[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cr(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const bTe={kernelName:dh,backendName:"webgl",kernelFunc:cr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Al(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,i=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(i.dataId),a=cr({inputs:{x:s},backend:n}),l=cr({inputs:{x:r},backend:n});return o.complexTensorInfos={real:a,imag:l},i}const wTe={kernelName:Nb,backendName:"webgl",kernelFunc:Al};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K6="return (a < 0.) ? b * a : a;",X6=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function ITe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:i}=s,o=n.makeTensorInfo([],"float32",sa(i,"float32")),a=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ep(X6,r.shape,o.shape):new Wc(K6,r.shape,o.shape),l=n.runWebGLProgram(a,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const kTe={kernelName:rg,backendName:"webgl",kernelFunc:ITe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y6="return (a < 0.) ? b * a : a;",Q6=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function STe(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,i=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ep(Q6,s.shape,r.shape):new Wc(Y6,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],"float32")}const TTe={kernelName:kg,backendName:"webgl",kernelFunc:STe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tp="if (isnan(x)) return x;";function lt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:i})=>{const{x:o}=r,a=i,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&n!=null){const d=a.texData.get(o.dataId),h=n(d.values,l);return a.makeTensorInfo(o.shape,l,h)}const c=X().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Pa(o.shape,e):u=new Bi(o.shape,t),a.runWebGLProgram(u,[o],l)}}function Xn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:i}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,u=a;if(s&&l.dtype==="complex64"){const f=u.texData.get(l.dataId),g=u.texData.get(c.dataId),[y,x]=[[f.complexTensorInfos.real,g.complexTensorInfos.real],[f.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(w=>{const[I,N]=w,A={dataId:I.dataId,dtype:I.dtype,shape:l.shape},T={dataId:N.dataId,dtype:N.dtype,shape:c.shape},S=new Wc(t,l.shape,c.shape);return u.runWebGLProgram(S,[A,T],Ms(I.dtype,N.dtype))}),v=Al({inputs:{real:y,imag:x},backend:u});return u.disposeIntermediateTensorInfo(y),u.disposeIntermediateTensorInfo(x),v}const d=i||Ms(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const f=u.texData.get(l.dataId).values,g=u.texData.get(c.dataId).values,y=l.dtype==="string"?Yo(f):f,x=l.dtype==="string"?Yo(g):g,[v,w]=r(l.shape,c.shape,y,x,d),I=u.makeTensorInfo(w,d),N=u.texData.get(I.dataId);return N.values=v,I}const h=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let p;return h?p=new ep(e,l.shape,c.shape,n):p=new Wc(t,l.shape,c.shape),u.runWebGLProgram(p,[l,c],d)}}function dm(t,e=!1){if(t==="linear")return e?oTe:tTe;if(t==="relu")return e?lTe:sTe;if(t==="elu")return e?aTe:nTe;if(t==="relu6")return e?cTe:rTe;if(t==="prelu")return e?Q6:Y6;if(t==="leakyrelu")return e?X6:K6;if(t==="sigmoid")return e?uTe:iTe;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J6{constructor(e,n,s,r=!1,i=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=us(this.outputShape.length);const u=r?e[1]:e[2],d=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",p=i?"rc.z, i * 2":"i * 2, rc.z",f=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",x="";a&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:y=`vec4 activation(vec4 x) {
          ${a}
        }`,x="result = activation(result);");const v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let w="rc.x",I="rc.x";e[0]<n[0]?w=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(I=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${w};
        int batchB = ${I};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${f[0]} * ${g[0]});
          result += (${f[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${x}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QP={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class JP{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ue(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZP="return a * b;";function P2(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=Ms(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new JP(QP.REAL,s.shape,r.shape),u=new JP(QP.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(c,d,"float32"),p=n.runWebGLProgram(u,d,"float32"),f=Al({inputs:{real:h,imag:p},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=SSe(s.shape,r.shape,a.values,l.values,i),d=n.makeTensorInfo(u,i),h=n.texData.get(d.dataId);return h.values=c,d}let o;return X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new ep(ZP,s.shape,r.shape):o=new Wc(ZP,s.shape,r.shape),n.runWebGLProgram(o,[s,r],i)}const NTe={kernelName:bh,backendName:"webgl",kernelFunc:P2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Te(t,e,n){const s=[Ad(t.shape),...Rd(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},i=[Ad(e),...Rd(e)],o=new q6(i,s),a=!0,l=[s],c=n.runWebGLProgram(o,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:i}=s,o=n,a=J(r.shape),l=W_(i,a),c=J(l);D(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=o.texData.get(r.dataId);return u.isPacked&&!S0(r.shape,l)&&!(u.texture!==null&&S0(u.shape,l))?_Te(r,l,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const ETe={kernelName:Tg,backendName:"webgl",kernelFunc:ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eO{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${$c(d)?d.toPrecision(2):d}, ones);`}let u="";i%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CTe{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Te(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=h1(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function pu(t,e,n,s){const r=$Te(t.shape);let i=t;for(let o=0;o<r.length;o++){const{inSize:a,windowSize:l,outSize:c}=r[o];let u,d;n==="mean"?u=o===0?new eO({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new eO({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new CTe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=i,i=s.runWebGLProgram(u,[i],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ATe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=St(this.rank),i=RTe(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function RTe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DTe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=St(this.rank),i=H6("rc",this.rank),o=new Array(this.rank);for(let u=0;u<n.length;u++)o[n[u]]=i[u];const a=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1(t,e,n){const s=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new DTe(t.shape,e):new ATe(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PTe(t,e,n,s){const r=e,i=t.shape.length,o=Qe(r,t.shape);let a=o;const l=qt(a,i),c=l!=null;let u=t;c&&(u=C1(t,l,s),a=cn(a.length,i)),qn("sum",a,i);const[d,h]=Fn(u.shape,a);let p=d;n&&(p=an(d,o));const f=J(h),y=J(t.shape)/f,x=ye({inputs:{x:u},attrs:{shape:[y,f]},backend:s}),v=Nw(t.dtype),w=pu(x,v,"sum",s),I=ye({inputs:{x:w},attrs:{shape:p},backend:s});return s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(w),c&&s.disposeIntermediateTensorInfo(u),I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s;return PTe(r,i,o,n)}const OTe={kernelName:Ag,backendName:"webgl",kernelFunc:$1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _s(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:i}=s,o=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[i[u]];let c;if(o.shouldExecuteOnCPU([r])){const d=o.texData.get(r.dataId).values,h=R2(d,r.shape,r.dtype,i,l);c=o.makeTensorInfo(l,r.dtype);const p=o.texData.get(c.dataId);p.values=h}else c=C1(r,i,o);return c}const FTe={kernelName:fc,backendName:"webgl",kernelFunc:_s};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z6=1e3;function T0({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=s?e.shape[u-1]:e.shape[u-2],p=n?t.shape[c-1]:t.shape[c-2],f=s?e.shape[u-2]:e.shape[u-1],g=t.shape.slice(0,-2),y=e.shape.slice(0,-2),x=J(g),v=J(y),I=Ue(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,f]);D(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const N=n?[x,d,p]:[x,p,d],A=s?[v,f,h]:[v,h,f],T=ye({inputs:{x:t},backend:r,attrs:{shape:N}}),S=ye({inputs:{x:e},backend:r,attrs:{shape:A}}),E=[T,S],$=Math.max(x,v),P=n?T.shape[1]:T.shape[2],F=i!=null,R=o!=null,G=l==="leakyrelu",q=l!=null?dm(l,!0):null,Q=F||R||G||q!=null;let te;if((p===1||f===1)&&P>Z6&&Q===!1){let H=T,Z=S;n&&(H=_s({inputs:{x:T},backend:r,attrs:{perm:[0,2,1]}}),E.push(H)),s&&(Z=_s({inputs:{x:S},backend:r,attrs:{perm:[0,2,1]}}),E.push(Z));const se=f!==1,re=f===1;let ie=H;se&&(ie=ye({inputs:{x:H},backend:r,attrs:{shape:[$,P,1]}}),E.push(ie));const de=f===1?2:1;let ce=Z;re&&(ce=ye({inputs:{x:Z},backend:r,attrs:{shape:[$,1,P]}}),E.push(ce));const pe=P2({inputs:{a:ie,b:ce},backend:r});te=$1({inputs:{x:pe},backend:r,attrs:{axis:de,keepDims:!0}}),E.push(pe)}else{const H=Ms(t.dtype,e.dtype),Z=new J6(N,A,[$,p,f],n,s,F,q,R,G),se=[T,S];if(i!=null&&se.push(i),R&&se.push(o),G){const re=r.makeTensorInfo([],"float32",sa(a,"float32"));se.push(re),E.push(re)}te=r.runWebGLProgram(Z,se,H)}const B=ye({inputs:{x:te},backend:r,attrs:{shape:I}});E.push(te);for(const H of E)r.disposeIntermediateTensorInfo(H);return B}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LTe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;return T0({a:r,b:i,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const MTe={kernelName:Xf,backendName:"webgl",kernelFunc:LTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tO="return abs(x);";function VTe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const i=n.texData.get(s.dataId),o=W6(i.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return X().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Pa(s.shape,tO):r=new Bi(s.shape,tO),n.runWebGLProgram(r,[s],s.dtype)}const zTe={kernelName:Fm,backendName:"webgl",kernelFunc:VTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jTe=ti+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,BTe=lt({opSnippet:jTe}),UTe={kernelName:Gd,backendName:"webgl",kernelFunc:BTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WTe=ti+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,GTe=lt({opSnippet:WTe}),HTe={kernelName:Hd,backendName:"webgl",kernelFunc:GTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nO="return a + b;",qTe=Xn({opSnippet:nO,packedOpSnippet:nO,supportsComplex:!0,cpuKernelImpl:sSe}),KTe={kernelName:tu,backendName:"webgl",kernelFunc:qTe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XTe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`float v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YTe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const s=[];this.variableNames.forEach(i=>{s.push(`vec4 v${i} = get${i}AtOutCoords();`)});const r=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ev(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return cr({inputs:{x:s[0]},backend:n});if(s.length>X().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=ev({inputs:s.slice(0,l),backend:n}),u=ev({inputs:s.slice(l),backend:n});return ev({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>Ms(l,c)),i=s.map(l=>l.shape),a=X().getBool("WEBGL_PACK")?new YTe(s[0].shape,i):new XTe(s[0].shape,i);return n.runWebGLProgram(a,s,r)}const QTe={kernelName:Lm,backendName:"webgl",kernelFunc:ev};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Qe(i,r.shape);let c=l;const u=qt(c,a);let d=r;u!=null&&(d=_s({inputs:{x:r},backend:n,attrs:{perm:u}}),c=cn(c.length,a)),qn("all",c,a);const[h,p]=Fn(d.shape,c),f=J(p),g=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=pu(g,g.dtype,"all",n);let x;if(o){const v=an(h,l);x=ye({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=ye({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),x}const ZTe={kernelName:bb,backendName:"webgl",kernelFunc:JTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Qe(i,r.shape);let c=l;const u=qt(c,a);let d=r;u!=null&&(d=_s({inputs:{x:r},backend:n,attrs:{perm:u}}),c=cn(c.length,a)),qn("any",c,a);const[h,p]=Fn(d.shape,c),f=J(p),g=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=pu(g,g.dtype,"any",n);let x;if(o){const v=an(h,l);x=ye({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=ye({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),x}const tNe={kernelName:wb,backendName:"webgl",kernelFunc:eNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nNe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sNe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,D(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=St(l),u=ks("coords",l);let d,h;if(o===1){h=l+1;const S=St(h);d=`
        ${S} sourceLocR = ${S}(${u.join()}, 0);
        ++${u[l-1]};
        ${S} sourceLocG = ${S}(${u.join()}, 0);
        ++${u[l-2]};
        ${S} sourceLocA = ${S}(${u.join()}, 0);
        --${u[l-1]};
        ${S} sourceLocB = ${S}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const p=["x","y","z","w","u","v"].slice(0,h),f="."+p[h-1],g=p.map(S=>"int "+S),y=ks("sourceLocR",h-1).concat("inIdx.r"),x=ks("sourceLocG",h-1).concat("inIdx.g"),v=ks("sourceLocB",h-1).concat("inIdx.b"),w=ks("sourceLocA",h-1).concat("inIdx.a"),I=s==="max"?"greaterThan":"lessThan",N=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()})));`,A=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${x.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,T=r?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${T}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${A};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${N}
          vec4 candidate = ${A};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${I}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e5(t,e,n,s=null){let r=e.shape[0],i=e.shape[1];s!=null&&(r=s.shape[0],i=s.shape[1]);const o=h1(i),a={windowSize:o,inSize:i,batchSize:r,outSize:Math.ceil(i/o)},l=new nNe(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=e5(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function t5(t,e,n,s=null){const r=s!=null?s.shape:e.shape,i=r[r.length-1],o=h1(i),a=new sNe(r,o,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=t5(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function n5(t,e,n,s){const r=[n];if(qn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!X().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=t.unpackTensor(e),i.push(l));const[c,u]=Fn(l.shape,r),d=J(u),h=ye({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(h);const p=e5(t,h,s);i.push(p);const f=ye({inputs:{x:p},backend:t,attrs:{shape:c}});return i.forEach(g=>t.disposeIntermediateTensorInfo(g)),f}return t5(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=Qe(i,r.shape);const a=qt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=_s({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=cn(o.length,l.shape.length)),qn("argMax",[o[0]],l.shape.length);const u=n5(n,l,o[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const iNe={kernelName:Mm,backendName:"webgl",kernelFunc:rNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i}=s;let o=Qe(i,r.shape);const a=qt(o,r.shape.length);let l=r;const c=[];a!=null&&(l=_s({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),o=cn(o.length,l.shape.length)),qn("argMin",[o[0]],l.shape.length);const u=n5(n,l,o[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const aNe={kernelName:Vm,backendName:"webgl",kernelFunc:oNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lNe=ti+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,cNe=lt({opSnippet:lNe}),uNe={kernelName:qd,backendName:"webgl",kernelFunc:cNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dNe=ti+"return log(x + sqrt(x * x + 1.0));",hNe=lt({opSnippet:dNe}),pNe={kernelName:Kd,backendName:"webgl",kernelFunc:hNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fNe=ti+`
  return atan(x);
`,mNe=lt({opSnippet:fNe}),gNe={kernelName:Xd,backendName:"webgl",kernelFunc:mNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yNe=D2+`
  return atan(a, b);
`,xNe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+hu+`
  return result;
`,vNe=Xn({opSnippet:yNe,packedOpSnippet:xNe}),bNe={kernelName:Qd,backendName:"webgl",kernelFunc:vNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wNe=ti+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,INe=lt({opSnippet:wNe}),kNe={kernelName:Yd,backendName:"webgl",kernelFunc:INe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hm{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,x=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(g||(v="-1.0 / 1e-20"),s){const S=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${p}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${S} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?y:x:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let I=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(I="avgValue / max(count, 1.0)");const N=Math.floor(o/4)*4,A=o%4,T=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${p}, ${f});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${N}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${T}
          }

          int xC = xCCorner + ${N};
          if (${A===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${A===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${T}
          } else if (${A===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${T}
          }
        }
        setOutput(${I});
      }
    `}}class O2{constructor(e,n,s,r=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=e.padInfo.front,x=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let I="0.0";if(w||(I="-1.0 / 1e-20"),s){const $=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${y}, ${x}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${$} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const N="max";let A=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(A="avgValue / max(count, 1.0)");const T=Math.floor(o/4)*4,S=o%4,E=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${N}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${y}, ${x}, ${v});
      const float initializationValue = ${I};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${I});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${T}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${E}
            }

            int xC = xCCorner + ${T};
            if (${S===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${S===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${S===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${E}
            }
          }
        }
        setOutput(${A});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;yy(r,"avgPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;D(Hn(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Zr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Ze(u.inShape,u.outShape))return cr({inputs:{x:r},backend:n});const d=new hm(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const TNe={kernelName:zm,backendName:"webgl",kernelFunc:SNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],d=ra(r.shape,i,o,u,a,l,c),h=new O2(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const _Ne={kernelName:jm,backendName:"webgl",kernelFunc:NNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ENe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class CNe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=d-1-e.padInfo.front,g=h-1-e.padInfo.top,y=p-1-e.padInfo.left,x=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${f}, ${g}, ${y});
      const float avgMultiplier = float(${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ne(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=ra(o.shape,a,l,d,c,u),p=new CNe(h);return n.runWebGLProgram(p,[r],o.dtype)}const ANe={kernelName:kb,backendName:"webgl",kernelFunc:$Ne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RNe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i;yy([r,i],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Zr(o.shape,a,l,1,c),d=new ENe(u);return n.runWebGLProgram(d,[r],o.dtype)}const DNe={kernelName:Ib,backendName:"webgl",kernelFunc:RNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PNe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:i}=e,{transposeA:o,transposeB:a}=s;return T0({a:r,b:i,transposeA:o,transposeB:a,backend:n})}const ONe={kernelName:Bm,backendName:"webgl",kernelFunc:PNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FNe{constructor(e,n,s,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Ue(e,n),Ue(e,s);let a="0.0";r!=null&&(Ue(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Ue(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LNe{constructor(e,n,s,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ue(e,n),Ue(e,s);let a="vec4(0.0)";r!=null&&(Ue(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Ue(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MNe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:i,offset:o,scale:a}=t;D(r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,i];let u=null;o!=null&&(u=o.shape,c.push(o));let d=null;a!=null&&(d=a.shape,c.push(a));const h=X().getBool("WEBGL_PACK_NORMALIZATION")?new LNe(s.shape,r.shape,i.shape,u,d,l):new FNe(s.shape,r.shape,i.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},VNe={kernelName:tg,backendName:"webgl",kernelFunc:MNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zNe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=St(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=jNe(this.rank);let r;const i=e.map((o,a)=>`sourceLoc.${$T[a]} = start[${a}] + coords.${$T[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const $T=["x","y","z","w","u","v"];function jNe(t){if(t===1)return"sourceLoc";if(t<=6)return $T.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BNe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=St(this.rank),s=ks("coords",this.rank),r=ks("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UNe(t,e,n,s){const r=s.texData.get(t.dataId),i=s.makeTensorInfo(n,t.dtype),o=s.texData.get(i.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let a=EC(e,Re(t.shape));r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),i}function np(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,size:o}=s,[a,l]=d1(r,i,o);if(TC(r,a,l),J(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=OSe(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:c}=n.texData.get(r.dataId),u=_C(r.shape,a,l);if(c||!u){const d=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BNe(l):new zNe(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),UNe(r,a,l,n)}const WNe={kernelName:$g,backendName:"webgl",kernelFunc:np};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GNe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,crops:o}=s;D(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((v,w)=>v*w),l=ry(r.shape,i,a),c=iy(l.length,i.length),u=oy(r.shape,i,a),d=PC(o,i.length),h=OC(u,o,i.length),p=[],f=ye({inputs:{x:r},backend:n,attrs:{shape:l}}),g=_s({inputs:{x:f},backend:n,attrs:{perm:c}}),y=ye({inputs:{x:g},backend:n,attrs:{shape:u}}),x=np({inputs:{x:y},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(g),p.push(y),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),x},HNe={kernelName:Um,backendName:"webgl",kernelFunc:GNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qNe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o}=s,a=n.readSync(r.dataId),l=n.readSync(i.dataId),c=U6(a,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const KNe={kernelName:Sb,backendName:"webgl",kernelFunc:qNe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XNe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,YNe=`
  return float(int(a.r) & int(b.r));
`;function QNe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,i=X().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=X().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,d]=iSe(s.shape,r.shape,l,c,s.dtype),h=n.makeTensorInfo(d,s.dtype),p=n.texData.get(h.dataId);return p.values=u,h}let a;return i?a=new ep(XNe,s.shape,r.shape,!1):a=new Wc(YNe,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const JNe={kernelName:Wm,backendName:"webgl",kernelFunc:QNe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZNe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,i=n.readSync(s.dataId),o=n.readSync(r.dataId),a=Ue(Array.from(i),Array.from(o));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const e_e={kernelName:Tb,backendName:"webgl",kernelFunc:ZNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t_e="return float(a != b);",s5=Xn({opSnippet:t_e,cpuKernelImpl:NSe,dtype:"bool"}),n_e={kernelName:xg,backendName:"webgl",kernelFunc:s5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vy(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return cr({inputs:{x:r.complexTensorInfos.real},backend:n})}const s_e={kernelName:iw,backendName:"webgl",kernelFunc:vy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r_e="return float(int(x));";function i_e(t,e){const n=new Bi(t.shape,r_e),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AT(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:i}=s;if(i==="complex64"){if(r.dtype==="complex64")return cr({inputs:{x:r},backend:n});const o=sn(r.shape),a=AT({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=Al({inputs:{real:a,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const o=vy({inputs:{input:r},backend:n}),a=AT({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),a}if(!G_(r.dtype,i)){const o=cr({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[a,l,c]=oSe(o,r.shape,r.dtype,i);return n.makeTensorInfo(a,l,c)}if(i==="int32")return i_e(r,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",Dn("bool",1)),l=s5({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${i}`)}const o_e={kernelName:Jd,backendName:"webgl",kernelFunc:AT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sO="return ceil(x);",a_e=lt({opSnippet:sO,packedOpSnippet:sO,cpuKernelImpl:aSe}),l_e={kernelName:Zd,backendName:"webgl",kernelFunc:a_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c_e{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u_e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:i,clipValueMax:o}=s;let a;X().getBool("WEBGL_PACK_CLIP")?a=new u_e(r.shape):a=new c_e(r.shape);const l=[[i],[o]];return n.runWebGLProgram(a,[r],r.dtype,l)}const h_e={kernelName:eh,backendName:"webgl",kernelFunc:d_e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p_e{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rO(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function f_e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),i=new p_e(s.shape),o=[rO(s,r.complexTensorInfos.real),rO(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const m_e={kernelName:Gm,backendName:"webgl",kernelFunc:f_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g_e{constructor(e){this.outputShape=[],this.outputShape=Ji(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const a=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const r=n.length,i=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y_e{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ji(e,n);const s=this.outputShape,r=s.length,i=St(r),o=ks("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((g,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let g=1;g<l.length;g++){const y=l[g-1];h+=`
        if (${c} < ${l[g]}  && ${c} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${Nx(a,c,y)}),
            vec2(${Nx(u,c,y)}));
        }`}const p=l.length,f=l[l.length-1];h+=`
        return getChannel(
          getT${p}(${Nx(a,c,f)}),
          vec2(${Nx(u,c,f)}));`,this.userCode=`
      float getValue(${a.map(g=>"int "+g)}) {
        ${h}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Nx(t,e,n){const s=t.indexOf(e);return t.map((i,o)=>o===s?`${i} - ${n}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return cr({inputs:{x:r.complexTensorInfos.imag},backend:n})}const x_e={kernelName:Gb,backendName:"webgl",kernelFunc:A1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zp(t,e,n){const s=t[0].dtype;if(s==="complex64"){const p=t.map(v=>vy({inputs:{input:v},backend:n})),f=t.map(v=>A1({inputs:{input:v},backend:n})),g=Zp(p,e,n),y=Zp(f,e,n),x=Al({inputs:{real:g,imag:y},backend:n});return p.forEach(v=>n.disposeIntermediateTensorInfo(v)),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),x}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const p=t.map(I=>{const A=[-1,J(I.shape.slice(e))];return ye({inputs:{x:I},backend:n,attrs:{shape:A}})}),f=p.map(I=>({vals:n.readSync(I.dataId),shape:I.shape})),g=Ji(p.map(I=>I.shape),1),y=p[0].shape[0]===1,x=lSe(f,g,s,y),v=Ji(t.map(I=>I.shape),e),w=n.makeTensorInfo(v,s,x);return p.forEach(I=>n.disposeIntermediateTensorInfo(I)),w}const i=t.filter(p=>J(p.shape)>0),o=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const p=o?new Bi(t[0].shape,ba):new Pa(t[0].shape,ba);return n.runWebGLProgram(p,t,s)}const a=X().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>a){const p=[];for(let g=0;g<i.length;g+=a){const y=i.slice(g,g+a);p.push(Zp(y,e,n))}const f=Zp(p,e,n);for(const g of p)n.disposeIntermediateTensorInfo(g);return f}if(o){const p=new y_e(i.map(f=>f.shape),e);return n.runWebGLProgram(p,i,s)}const{tensors2D:l,outShape:c}=v_e(i,e,n),u=new g_e(l.map(p=>p.shape)),d=n.runWebGLProgram(u,l,s);l.forEach(p=>n.disposeIntermediateTensorInfo(p));const h=ye({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function v_e(t,e,n){const s=Ji(t.map(i=>i.shape),e);return{tensors2D:t.map(i=>ye({inputs:{x:i},attrs:{shape:[-1,J(i.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r5(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,i=Qe(r,e[0].shape)[0],o=e.map(c=>c.shape);AC(o,i);const a=Ji(e.map(c=>c.shape),i);if(J(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>J(c.shape)>0);return l.length===1?cr({inputs:{x:l[0]},backend:n}):Zp(l,i,n)}const b_e={kernelName:Hm,backendName:"webgl",kernelFunc:r5};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i5{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,y=e.dataFormat==="channelsLast",x=y?1:2,v=y?2:3,w=y?3:1;let I="",N="";s&&(r?I=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?I=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:I=`
          float activation(float x) {
            ${s}
          }
        `,N="result = activation(result);");const A=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${I}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${x}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${A}
        ${N}
        setOutput(result);
      }
    `}}class w_e{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o5{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=us(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<u;y++)h+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<u;y++)h+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const x=y*2;if(h+=`
           xC = xCCorner + ${x*l};
           `,a===1){if(x<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }
               `,l===1&&x>0?h+=`
                 xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                   } else {
                     xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xC${x} = xTexelC${x};
                 `,x+1<u)){const v=o%2===0?xb(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                     xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${x+1}.zw = vec2(0.0);
                     }
                     xTexelC${x+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                     } else {
                      xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                     }
                     `:h+=`
                     xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                     `):v===1?h+=`
                     xC${x+1} = xTexelC${x};
                     `:h+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                       xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${x+1}.zw = vec2(0.0);
                       }
                       xTexelC${x+1}Ready = 1;
                     }

                     xC${x+1} = xTexelC${x+1};
                     `}}else x<u&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.0);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
               `,x+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                   xTexelC${x} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${x}.zw = vec2(0.0);
                   }
                   xTexelC${x}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                   xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${x+1}.zw = vec2(0.);
                   }
                   xTexelC${x+1}Ready = 1;
                 }

                 xC${x} = vec4(
                   xTexelC${x}.xy, xTexelC${x+1}.xy);
               `,x+1<u&&(h+=`
                   xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                 `)));x<u&&(h+=`
             wTexel = getW(r, ${x}, d1, d2);
             dotProd += xC${x}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${x}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,x+1<u&&(h+=`
               wTexel = getW(r, ${x+1}, d1, d2);
               dotProd += xC${x+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${x+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let p="",f="";s&&(r?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:i?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:p=`vec4 activation(vec4 x) {
           ${s}
         }`,f="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${f}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I_e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=us(this.outputShape.length);const{dataFormat:s}=n,r=$s(),i=s==="channelsLast",o=i?1:2,a=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N0(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function a5({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,p=n.dataFormat==="channelsLast",f=!1,g=!1;let y;const x=[];if(i!=null){const I=N0(i.shape,p);I!=null&&(i=ye({inputs:{x:i},backend:s,attrs:{shape:I}}),x.push(i))}if(r!=null){const I=N0(r.shape,p);I!=null&&(r=ye({inputs:{x:r},backend:s,attrs:{shape:I}}),x.push(r))}if(!((d===1||h===1)&&u>Z6)&&c.isPacked&&p&&c.texture!=null&&l[2]%2!==0&&Ze(c.shape.slice(-3),l.slice(-3))){const I=l[0]*l[1]*(l[2]+1),N={dataId:t.dataId,shape:[1,I,n.inChannels],dtype:t.dtype},A=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,D(S0(c.shape,N.shape),()=>`packed reshape ${c.shape} to ${N.shape} isn't free`);const T=ye({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});x.push(T);const S=T0({a:N,b:T,backend:s,transposeA:f,transposeB:g,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o}),E=s.texData.get(S.dataId);D(E.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=A,E.shape=n.outShape,y=cr({inputs:{x:S},backend:s}),y.shape=n.outShape,x.push(S)}else{const I=n.outHeight*n.outWidth,N=ye({inputs:{x:t},backend:s,attrs:{shape:p?[n.batchSize,I,n.inChannels]:[n.batchSize,n.inChannels,I]}}),A=ye({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),T=T0({a:p?N:A,b:p?A:N,transposeA:!p,transposeB:g,backend:s,bias:r,activation:a,preluActivationWeights:i,leakyreluAlpha:o});y=ye({inputs:{x:T},backend:s,attrs:{shape:n.outShape}}),x.push(N),x.push(A),x.push(T)}for(const I of x)s.disposeIntermediateTensorInfo(I);return y}function l5({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:p}=n,f=p==="channelsLast",g=l*c*u,y=h*d,x=[n.batchSize,g,y],v=!0,w=!1,I=[];if(i!=null){const B=N0(i.shape,f);B!=null&&(i=ye({inputs:{x:i},backend:s,attrs:{shape:B}}),I.push(i))}if(r!=null){const B=N0(r.shape,f);B!=null&&(r=ye({inputs:{x:r},backend:s,attrs:{shape:B}}),I.push(r))}const N=ye({inputs:{x:e},backend:s,attrs:{shape:[1,g,J(e.shape)/g]}});I.push(N);const A=new I_e(x,n),T=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],S=s.runWebGLProgram(A,[t],"float32",T),E=ye({inputs:{x:S},backend:s,attrs:{shape:x}});I.push(S),I.push(E);const $=r!=null,P=i!=null,F=a==="leakyrelu",R=a?dm(a,!0):null,G=new J6(f?E.shape:N.shape,f?N.shape:E.shape,f?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],v,w,$,R,P,F),q=f?[E,N]:[N,E];if(r&&q.push(r),P&&q.push(i),F){const B=s.makeTensorInfo([],"float32",sa(o,"float32"));q.push(B),I.push(B)}const Q=s.runWebGLProgram(G,q,"float32"),te=ye({inputs:{x:Q},backend:s,attrs:{shape:n.outShape}});I.push(Q);for(const B of I)s.disposeIntermediateTensorInfo(B);return te}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,d=ia(l),h=On(r.shape,i.shape,o,c,a,u,!1,d);let p;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))p=a5({x:r,filter:i,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&X().getBool("WEBGL_EXP_CONV")){const g=new o5(h),y=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=n.runWebGLProgram(g,[r,i],"float32",y)}else if(X().getBool("WEBGL_CONV_IM2COL"))p=l5({x:r,filter:i,convInfo:h,backend:n});else{const g=new i5(h);p=n.runWebGLProgram(g,[r,i],"float32")}const f=ye({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),f}const S_e={kernelName:qm,backendName:"webgl",kernelFunc:k_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T_e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class N_e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,u=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class __e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class E_e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,i=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,d=ia(l),h=On(r.shape,u,o,1,a,c,!1,d),p=new T_e(h);return n.runWebGLProgram(p,[r,i],"float32")}const $_e={kernelName:_b,backendName:"webgl",kernelFunc:C_e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A_e{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=us(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,i=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=ia(c),h=On(o,i.shape,a,1,l,u,!1,d);if(X().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const p=[[h.strideHeight,h.strideWidth]],f=new A_e(h);return n.runWebGLProgram(f,[r,i],"float32",p)}else{const p=new N_e(h);return n.runWebGLProgram(p,[r,i],"float32")}}const D_e={kernelName:Km,backendName:"webgl",kernelFunc:R_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=Sl(r.shape,i.shape,o,l,a),u=new w_e(c);return n.runWebGLProgram(u,[r,i],"float32")}const O_e={kernelName:Xm,backendName:"webgl",kernelFunc:P_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,pad:a,filterShape:l}=s,c=Sl(r.shape,l,o,1,a),u=new __e(c);return n.runWebGLProgram(u,[r,i],"float32")}const L_e={kernelName:Eb,backendName:"webgl",kernelFunc:F_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M_e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{pad:o,strides:a,inputShape:l}=s,c=Sl(l,i.shape,a,1,o),u=new E_e(c);return n.runWebGLProgram(u,[r,i],"float32")}const V_e={kernelName:Cb,backendName:"webgl",kernelFunc:M_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z_e=tp+`
  return cos(x);
`,j_e=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${hu}
  return result;
`,B_e=lt({opSnippet:z_e,packedOpSnippet:j_e}),U_e={kernelName:th,backendName:"webgl",kernelFunc:B_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W_e=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,G_e=lt({opSnippet:W_e}),H_e={kernelName:nh,backendName:"webgl",kernelFunc:G_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q_e{constructor(e,n,s,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[u]=n,[d,h]=s;this.outputShape=[u,d,h,c];const p=r==="bilinear"?1:0,[f,g]=[`${a-1}.0`,`${l-1}.0`],[y,x,v]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${f}`],[w,I,N]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${x};
        float width_scale = ${I};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${f} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${N};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K_e=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:i,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new q_e(r.shape,i.shape,a,l,c);return n.runWebGLProgram(u,[r,i,o],"float32")},X_e={kernelName:Ab,backendName:"webgl",kernelFunc:K_e};var pm;(function(t){t.Prod="*",t.Sum="+"})(pm||(pm={}));class iO{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===pm.Prod?"1.0":"0.0",a=s?o:`getX(${oO(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${St(i)} coords = getOutputCoords();
        int end = ${aO(i,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${aO(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${oO(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function oO(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function aO(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(t,e,n,s,r,i){const o=e.shape.length,a=qt([s],o);let l=e;a!=null&&(l=_s({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=cn(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let d=cr({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const p=new iO(t,l.shape,!1,i),f=[[h]],g=d;d=n.runWebGLProgram(p,[d],d.dtype,f),n.disposeIntermediateTensorInfo(g)}if(r){const h=new iO(t,l.shape,r,i),p=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(p)}if(a!=null){const h=Tl(a),p=_s({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),p}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return c5(pm.Prod,r,n,i,o,a)}const Q_e={kernelName:$b,backendName:"webgl",kernelFunc:Y_e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,exclusive:o,reverse:a}=s;return c5(pm.Sum,r,n,i,o,a)}const Z_e={kernelName:Ym,backendName:"webgl",kernelFunc:J_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:i}=e,{size:o,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=U6(l,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(i),u=rSe(l,c,o,a);return n.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const tEe={kernelName:Rb,backendName:"webgl",kernelFunc:eEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nEe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:i,dataFormat:o}=s,a=r.shape[0],l=o==="NHWC"?r.shape[1]:r.shape[2],c=o==="NHWC"?r.shape[2]:r.shape[3],u=o==="NHWC"?r.shape[3]:r.shape[1],d=l*i,h=c*i,p=u/(i*i),f=o==="NHWC"?[a,d,h,p]:[a,p,d,h],g=new nEe(f,i,o);return n.runWebGLProgram(g,[r],r.dtype)}const rEe={kernelName:Db,backendName:"webgl",kernelFunc:sEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u5{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=us(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d5{constructor(e,n=!1,s=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=us(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<d;x++)p+=`
          vec4 xTexelC${x*2};
          int xTexelC${x*2}Ready;
          vec4 xTexelC${x*2+1};
          int xTexelC${x*2+1}Ready;
          vec4 xC${x};`;p+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let x=0;x<d;x++)p+=`
          xTexelC${x*2} = vec4(0.0);
          xTexelC${x*2}Ready = 0;
          xTexelC${x*2+1} = vec4(0.0);
          xTexelC${x*2+1}Ready = 0;
          xC${x} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let x=0;x<(h+1)/2;x++){const v=x*2;if(p+=`
          xC = xCCorner + ${v*c};
          `,l===1){if(v<d&&(a%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,c===1&&v>0?p+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const w=a%2===0?xb(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,c>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:p+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):w===1?p+=`
                    xC${v+1} = xTexelC${v};
                    `:p+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(a%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(p+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(p+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(p+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let f="",g="";s&&(r?f=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:i?f=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:f=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),D(Hn(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=On(r.shape,i.shape,o,u,a,c,!0);let h;X().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new d5(d):h=new u5(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,i],"float32",p)}const oEe={kernelName:Qm,backendName:"webgl",kernelFunc:iEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aEe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class lEe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,d=On(r.shape,u,o,a,l,c,!0),h=new aEe(d);return n.runWebGLProgram(h,[r,i],"float32")}const uEe={kernelName:Pb,backendName:"webgl",kernelFunc:cEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dEe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:i}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,d=On(u,i.shape,o,a,l,c,!0),h=new lEe(d);return n.runWebGLProgram(h,[r,i],"float32")}const hEe={kernelName:Ob,backendName:"webgl",kernelFunc:dEe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pEe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fEe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],i=J(s.shape),o=ye({inputs:{x:s},backend:n,attrs:{shape:[i]}}),a=new pEe(i),l=n.runWebGLProgram(a,[o],o.dtype),c=ye({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const mEe={kernelName:Fb,backendName:"webgl",kernelFunc:fEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gEe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:i,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i}=e,{strides:o,pad:a,dilations:l}=s,c=jg(r.shape,i.shape,o,a,"NHWC",l);let u;const d=new gEe(c);u=n.runWebGLProgram(d,[r,i],"float32");const h=ye({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const xEe={kernelName:Jm,backendName:"webgl",kernelFunc:yEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vEe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,i=e,{allDims:o,summedDims:a,idDims:l}=UC(r,i.length);GC(o.length,l,i);const{path:c,steps:u}=HC(a,l),d=u.length;let h=null,p=o.length;const f=[];for(let g=0;g<d;++g){for(const y of u[g]){const{permutationIndices:x,expandDims:v}=WC(p,l[y]);let w;qC(x)?w=i[y]:(w=_s({inputs:{x:i[y]},backend:n,attrs:{perm:x}}),f.push(w));const I=w.shape.slice();for(let N=0;N<v.length;++N)I.splice(v[N],0,1);Ze(w.shape,I)||(w=ye({inputs:{x:w},backend:n,attrs:{shape:I}}),f.push(w)),h===null?h=w:(h=P2({inputs:{a:w,b:h},backend:n}),f.push(h))}g<d-1&&(c[g]>=0&&(h=$1({inputs:{x:h},backend:n,attrs:{axis:c[g]-(o.length-p),keepDims:!1}}),f.push(h)),p--)}for(const g of f)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const bEe={kernelName:Mb,backendName:"webgl",kernelFunc:vEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wEe="return (x >= 0.0) ? x : (exp(x) - 1.0);",IEe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,kEe=lt({opSnippet:wEe,packedOpSnippet:IEe}),SEe={kernelName:rh,backendName:"webgl",kernelFunc:kEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TEe="return (b >= 0.0) ? a : a * (b + 1.0);",NEe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,_Ee=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,i=X().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ep(NEe,s.shape,r.shape):new Wc(TEe,s.shape,r.shape);return n.runWebGLProgram(i,[s,r],s.dtype)},EEe={kernelName:Vb,backendName:"webgl",kernelFunc:_Ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CEe=`
  return vec4(equal(a, b));
`,$Ee="return float(a == b);",AEe=Xn({opSnippet:$Ee,packedOpSnippet:CEe,dtype:"bool",cpuKernelImpl:cSe}),REe={kernelName:Zm,backendName:"webgl",kernelFunc:AEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DEe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${FC};
  float a1 = ${LC};
  float a2 = ${MC};
  float a3 = ${VC};
  float a4 = ${zC};
  float a5 = ${jC};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,PEe=lt({opSnippet:DEe}),OEe={kernelName:ih,backendName:"webgl",kernelFunc:PEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FEe=tp+`
  return exp(x);
`,LEe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,h5=lt({opSnippet:FEe,packedOpSnippet:LEe,cpuKernelImpl:uSe,dtype:"float32"}),MEe={kernelName:oh,backendName:"webgl",kernelFunc:h5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RT(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:i}=e,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(D(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),ye({inputs:{x:i},backend:s,attrs:{shape:a}})}const VEe={kernelName:eg,backendName:"webgl",kernelFunc:RT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lO="return exp(x) - 1.0;",zEe=lt({opSnippet:lO,packedOpSnippet:lO,cpuKernelImpl:dSe}),jEe={kernelName:ah,backendName:"webgl",kernelFunc:zEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cO{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const i=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p5(t,e,n){const s=n.texData.get(t.dataId),r=J(t.shape),i=t.shape[t.shape.length-1],o=r/i,a=ye({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=a.shape,c=new cO("real",l,e),u=new cO("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),p=n.runWebGLProgram(u,d,"float32"),f=Al({inputs:{real:h,imag:p},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p);const g=ye({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(f),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BEe(t){const{inputs:e,backend:n}=t,{input:s}=e;return p5(s,!1,n)}const UEe={kernelName:zb,backendName:"webgl",kernelFunc:BEe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WEe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function by(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:i}=n;if(i=i||Zc(r),i==="string"){const o=Yt(i,J(s));return o.fill(r),e.makeTensorInfo(s,i,o)}else{const o=new WEe(s,r),a=[[r]];return e.runWebGLProgram(o,[],i,a)}}const GEe={kernelName:jb,backendName:"webgl",kernelFunc:by};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HEe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qEe={kernelName:Bb,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new HEe(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uO="return floor(x);",KEe=lt({opSnippet:uO,packedOpSnippet:uO,cpuKernelImpl:hSe}),XEe={kernelName:lh,backendName:"webgl",kernelFunc:KEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YEe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,QEe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,JEe=Xn({opSnippet:YEe,packedOpSnippet:QEe,dtype:"int32"}),ZEe={kernelName:ch,backendName:"webgl",kernelFunc:JEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eCe{constructor(e){this.variableNames=["A"];const n=$s(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tCe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=$s(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nCe={kernelName:n0,backendName:"webgl",kernelFunc:sCe};let bu,nk=X().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function sCe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:i}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,i];if(a||o){const g=X().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(bu==null||g!==nk)&&(nk=g,bu=document.createElement("canvas").getContext("2d",{willReadFrequently:nk})),bu.canvas.width=l,bu.canvas.height=c,bu.drawImage(r,0,0,l,c),r=bu.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=kr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const p=X().getBool("WEBGL_PACK")?new tCe(d):new eCe(d),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=s,g=ia(u),y=On(r.shape,i.shape,l,d,c,h,!1,g);let x;const v=[],w=o!=null,I=a!=null,N=p==="leakyrelu",A=()=>{const S=[r,i],E=($,P)=>{if(P==="NCHW"&&$.shape.length===1&&$.shape[0]!==1){const F=ye({inputs:{x:$},backend:n,attrs:{shape:[$.shape[0],1,1]}});return v.push(F),F}return $};if(w&&S.push(E(o,u)),I&&S.push(E(a,u)),N){const $=n.makeTensorInfo([],"float32",sa(f,"float32"));S.push($),v.push($)}return S};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))x=a5({x:r,filter:i,convInfo:y,backend:n,bias:o,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else if(y.strideWidth<=2&&g==="channelsLast"&&X().getBool("WEBGL_EXP_CONV")){const S=p?dm(p,!0):null,E=new o5(y,w,S,I,N),$=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],P=A();x=n.runWebGLProgram(E,P,"float32",$)}else if(X().getBool("WEBGL_CONV_IM2COL"))x=l5({x:r,filter:i,convInfo:y,backend:n,bias:o,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else{const S=p?dm(p,!1):null,E=new i5(y,w,S,I,N),$=A();x=n.runWebGLProgram(E,$,"float32")}const T=ye({inputs:{x},backend:n,attrs:{shape:y.outShape}});return v.push(x),v.forEach(S=>n.disposeIntermediateTensorInfo(S)),T}const iCe={kernelName:Yf,backendName:"webgl",kernelFunc:rCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:i,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=s,f=[];let g=u;g==null&&(g=[1,1]),D(Hn(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const y=On(r.shape,i.shape,l,g,c,d,!0),x=X().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,v=h?dm(h,x):null,w=[r,i],I=o!=null,N=a!=null,A=h==="leakyrelu";if(I&&w.push(o),N&&w.push(a),A){const $=n.makeTensorInfo([],"float32",sa(p,"float32"));w.push($),f.push($)}let T;x?T=new d5(y,I,v,N,A):T=new u5(y,I,v,N,A);const S=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],E=n.runWebGLProgram(T,w,"float32",S);return f.forEach($=>n.disposeIntermediateTensorInfo($)),E}const aCe={kernelName:Qf,backendName:"webgl",kernelFunc:oCe};class lCe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const i=St(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cCe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,i=r.shape,o=i[i.length-1],a=J(s.shape),[l,c,u,d]=u1(s,r),h=ye({inputs:{x:r},backend:n,attrs:{shape:[c,o]}}),p=ye({inputs:{x:s},backend:n,attrs:{shape:[J(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const x=n.readSync(r.dataId),v=n.bufferSync(s),w=pSe(x,v,s.dtype,c,o,u,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,w.values)}const f=new lCe(o,d,[c,u],s.shape),g=n.runWebGLProgram(f,[p,h],p.dtype),y=ye({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),y}const uCe={kernelName:Ub,backendName:"webgl",kernelFunc:cCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dCe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=St(this.rank),r=hCe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function hCe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:i}=e,{axis:o,batchDims:a}=s,l=Qe(o,r.shape)[0];if(X().get("DEBUG")){const v=n.readSync(i.dataId),w=r.shape[l];for(let I=0;I<v.length;++I){const N=v[I];D(N<=w-1&&N>=0,()=>`GatherV2: the index value ${N} is not in [0, ${w-1}]`)}}const c=XC(r,i,l,a),u=J(i.shape),d=[],h=ye({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),p=ye({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(p);const f=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const v=n.bufferSync(p),w=n.bufferSync(h),I=fSe(w,v,f);return d.forEach(N=>n.disposeIntermediateTensorInfo(N)),n.makeTensorInfo(c.outputShape,I.dtype,I.values)}const g=new dCe(h.shape,f),y=n.runWebGLProgram(g,[h,p],h.dtype);d.push(y);const x=ye({inputs:{x:y},backend:n,attrs:{shape:c.outputShape}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),x}const pCe={kernelName:ng,backendName:"webgl",kernelFunc:f5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fCe="return float(a > b);",mCe=`
  return vec4(greaterThan(a, b));
`,gCe=Xn({opSnippet:fCe,packedOpSnippet:mCe,cpuKernelImpl:mSe,dtype:"bool"}),yCe={kernelName:sg,backendName:"webgl",kernelFunc:gCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xCe="return float(a >= b);",vCe=`
  return vec4(greaterThanEqual(a, b));
`,bCe=Xn({opSnippet:xCe,packedOpSnippet:vCe,dtype:"bool",cpuKernelImpl:gSe}),wCe={kernelName:uh,backendName:"webgl",kernelFunc:bCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ICe(t){const{inputs:e,backend:n}=t,{input:s}=e;return p5(s,!0,n)}const kCe={kernelName:Wb,backendName:"webgl",kernelFunc:ICe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SCe="return float(!isnan(x) && !isinf(x));",TCe=lt({opSnippet:SCe,dtype:"bool"}),NCe={kernelName:hh,backendName:"webgl",kernelFunc:TCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ce="return float(isinf(x));",ECe=lt({opSnippet:_Ce,dtype:"bool"}),CCe={kernelName:ph,backendName:"webgl",kernelFunc:ECe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ce="return float(isnan(x));",ACe=lt({opSnippet:$Ce,dtype:"bool"}),RCe={kernelName:fh,backendName:"webgl",kernelFunc:ACe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DCe="return float(a < b);",PCe=`
  return vec4(lessThan(a, b));
`,OCe=Xn({opSnippet:DCe,packedOpSnippet:PCe,cpuKernelImpl:ySe,dtype:"bool"}),FCe={kernelName:ig,backendName:"webgl",kernelFunc:OCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LCe="return float(a <= b);",MCe=`
  return vec4(lessThanEqual(a, b));
`,VCe=Xn({opSnippet:LCe,packedOpSnippet:MCe,cpuKernelImpl:xSe,dtype:"bool"}),zCe={kernelName:og,backendName:"webgl",kernelFunc:VCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jCe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:i}=n,o=vSe(s,r,i);return e.makeTensorInfo([o.length],"float32",o)}const BCe={kernelName:Hb,backendName:"webgl",kernelFunc:jCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UCe=tp+`
  return x < 0.0 ? 0./0. : log(x);
`,WCe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,GCe=lt({opSnippet:UCe,packedOpSnippet:WCe,cpuKernelImpl:bSe}),HCe={kernelName:mh,backendName:"webgl",kernelFunc:GCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qCe=tp+`
  return log(1.0 + x);
`,KCe=lt({opSnippet:qCe}),XCe={kernelName:gh,backendName:"webgl",kernelFunc:KCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YCe="return float(a >= 1.0 && b >= 1.0);",QCe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,JCe=Xn({opSnippet:YCe,packedOpSnippet:QCe,dtype:"bool"}),ZCe={kernelName:ag,backendName:"webgl",kernelFunc:JCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e2e="return float(!(x >= 1.0));",t2e=lt({opSnippet:e2e}),n2e={kernelName:lg,backendName:"webgl",kernelFunc:t2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s2e="return float(a >= 1.0 || b >= 1.0);",r2e=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,i2e=Xn({opSnippet:s2e,packedOpSnippet:r2e,dtype:"bool"}),o2e={kernelName:cg,backendName:"webgl",kernelFunc:i2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a2e{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[];const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l2e{constructor(e,n,s,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;i===.5?l=`inversesqrt(${c})`:i===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c2e=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:i,bias:o,alpha:a,beta:l}=s,c=X().getBool("WEBGL_PACK_NORMALIZATION")?new l2e(r.shape,i,o,a,l):new a2e(r.shape,i,o,a,l);return n.runWebGLProgram(c,[r],r.dtype)},u2e={kernelName:ug,backendName:"webgl",kernelFunc:c2e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d2e{constructor(e,n,s,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h2e=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:i,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,d=new d2e(r.shape,a,l,c,u);return n.runWebGLProgram(d,[r,i,o],r.dtype)},p2e={kernelName:qb,backendName:"webgl",kernelFunc:h2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2e(t,e,n,s){const r=J(e),o=J(t.shape)/r,a=ye({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=pu(a,t.dtype,"max",s),c=ye({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:i,keepDims:o}=s,a=r.shape.length,l=Qe(i,r.shape);let c=l;const u=qt(c,a),d=u!=null,h=n.shouldExecuteOnCPU([r]);let p=r;if(d){if(h){const w=n.texData.get(p.dataId).values,I=new Array(a);for(let T=0;T<I.length;T++)I[T]=r.shape[u[T]];const N=R2(w,r.shape,r.dtype,u,I);p=n.makeTensorInfo(I,r.dtype);const A=n.texData.get(p.dataId);A.values=N}else p=C1(r,u,n);c=cn(c.length,a)}qn("max",c,a);const[f,g]=Fn(p.shape,c);let y=f;o&&(y=an(f,l));let x;if(h){const w=n.texData.get(p.dataId).values,I=wSe(w,J(g),y,r.dtype);x=n.makeTensorInfo(y,r.dtype);const N=n.texData.get(x.dataId);N.values=I}else x=f2e(p,g,y,n);return d&&n.disposeIntermediateTensorInfo(p),x}const m2e={kernelName:dg,backendName:"webgl",kernelFunc:m5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g2e=D2+`
  return max(a, b);
`,y2e=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+hu+`
  return result;
`,x2e=Xn({opSnippet:g2e,packedOpSnippet:y2e,cpuKernelImpl:ISe}),v2e={kernelName:yh,backendName:"webgl",kernelFunc:x2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;yy(r,"maxPool");const{filterSize:i,strides:o,pad:a,dimRoundingMode:l}=s,c=1;D(Hn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Zr(r.shape,i,o,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Ze(u.inShape,u.outShape))return cr({inputs:{x:r},backend:n});const d=new hm(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const w2e={kernelName:hg,backendName:"webgl",kernelFunc:b2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:i,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],d=ra(r.shape,i,o,u,a,c,l),h=new O2(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const k2e={kernelName:pg,backendName:"webgl",kernelFunc:I2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S2e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=i-1-e.padInfo.top,l=o-1-e.padInfo.left,c=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class T2e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,p=u-1-e.padInfo.left,f=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${f} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i}=e,o=i,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=ra(o.shape,a,l,d,c,u),p=new O2(h,"max",!0),f=n.runWebGLProgram(p,[o],o.dtype),g=new T2e(h),y=n.runWebGLProgram(g,[r,f],o.dtype);return n.disposeIntermediateTensorInfo(f),y}const _2e={kernelName:Xb,backendName:"webgl",kernelFunc:N2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:i,output:o}=e,a=i;yy([i,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=Zr(a.shape,l,c,1,u,d),p=!0,f=new hm(h,"max",p),g=n.runWebGLProgram(f,[a],a.dtype),y=new S2e(h),x=n.runWebGLProgram(y,[r,g],a.dtype);return n.disposeIntermediateTensorInfo(g),x}const C2e={kernelName:Kb,backendName:"webgl",kernelFunc:E2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $2e(t,e,n,s){let r=new hm(n,"max",!1);const i=s.runWebGLProgram(r,[t],"float32");r=new hm(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[i,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A2e={kernelName:Yb,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:i,pad:o,includeBatchInIndex:a}=e,l=n;D(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];D(Hn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Zr(s.shape,r,i,c,o),[d,h]=$2e(s,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2e(t,e,n,s){const r=J(e),o=J(t.shape)/r,a=ye({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),l=pu(a,"float32","mean",s),c=ye({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D2e={kernelName:fg,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:i}=e,o=n,a=s.shape.length,l=Qe(i,s.shape);let c=l;const u=qt(c,a),d=u!=null,h=o.shouldExecuteOnCPU([s]),p=[];let f=s;if(d){if(h){const I=o.texData.get(f.dataId).values,N=new Array(a);for(let S=0;S<N.length;S++)N[S]=s.shape[u[S]];const A=R2(I,s.shape,s.dtype,u,N);f=o.makeTensorInfo(N,s.dtype);const T=o.texData.get(f.dataId);T.values=A}else f=C1(s,u,o);p.push(f),c=cn(c.length,a)}qn("sum",c,a);const[g,y]=Fn(f.shape,c);let x=g;r&&(x=an(g,l));const v=R2e(f,y,x,o);for(const w of p)o.disposeIntermediateTensorInfo(w);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=Qe(i,r.shape);let c=l;const u=qt(c,a);let d=r;u!=null&&(d=_s({inputs:{x:r},backend:n,attrs:{perm:u}}),c=cn(c.length,r.shape.length)),qn("min",c,a);const[h,p]=Fn(d.shape,c),f=J(p),g=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=pu(g,g.dtype,"min",n);let x;if(o){const v=an(h,l);x=ye({inputs:{x:y},backend:n,attrs:{shape:v}})}else x=ye({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(d),x}const O2e={kernelName:mg,backendName:"webgl",kernelFunc:P2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F2e=D2+`
  return min(a, b);
`,L2e=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+hu+`
  return result;
`,M2e=Xn({opSnippet:F2e,packedOpSnippet:L2e,cpuKernelImpl:kSe}),V2e={kernelName:xh,backendName:"webgl",kernelFunc:M2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z2e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,i=St(r),o=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j2e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((f,g)=>f[0]+e[g]+f[1]);const r=e.length,i=St(r),o=n.map(f=>f[0]).join(","),a=n.map((f,g)=>f[0]+e[g]).join(","),l=ks("rc",r),c=ks("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=s==="reflect"?0:1;let p="";if(r===1){const f=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;p=`
        ${i} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${f}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const f=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;p=`
        ${i} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${f}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${f}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${u}) {
            ${f}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B2e=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:i}=n,o=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new j2e(s.shape,r,i):new z2e(s.shape,r,i);return e.runWebGLProgram(o,[s],s.dtype)},U2e={kernelName:gg,backendName:"webgl",kernelFunc:B2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W2e=`if (b == 0.0) return NAN;
  return mod(a, b);`,G2e=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+hu+`
  return result;
`,H2e=Xn({opSnippet:W2e,packedOpSnippet:G2e}),q2e={kernelName:vh,backendName:"webgl",kernelFunc:H2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K2e{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X2e=`
if (a == b) {
  return 1.0;
};
return a / b;`,Y2e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,g5=Xn({opSnippet:X2e,packedOpSnippet:Y2e,checkOutOfBounds:!0}),Q2e={kernelName:sh,backendName:"webgl",kernelFunc:g5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dO="return a - b;",y5=Xn({opSnippet:dO,packedOpSnippet:dO,supportsComplex:!0,cpuKernelImpl:WSe}),J2e={kernelName:Oh,backendName:"webgl",kernelFunc:y5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:i}=s,o=Qe([i],r.shape),a=m5({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=an(a.shape,o),c=ye({inputs:{x:a},backend:n,attrs:{shape:l}}),u=y5({inputs:{a:r,b:c},backend:n}),d=h5({inputs:{x:u},backend:n}),h=$1({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),p=ye({inputs:{x:h},backend:n,attrs:{shape:l}}),f=g5({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}const Z2e={kernelName:Pg,backendName:"webgl",kernelFunc:x5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$e(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:i,seed:o,normalized:a}=s,l=a?r:x5({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new K2e(c,u,i),h=[[o]],p=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),p}const t$e={kernelName:Qb,backendName:"webgl",kernelFunc:e$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n$e=ti+`
  return -x;
`,s$e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function r$e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId),[o,a]=TSe(i.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}let r;return X().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Pa(s.shape,s$e):r=new Bi(s.shape,n$e),n.runWebGLProgram(r,[s],s.dtype)}const i$e={kernelName:yg,backendName:"webgl",kernelFunc:r$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$e=o1;function a$e(t){yr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),{selectedIndices:d}=o$e(c,u,o,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const l$e={kernelName:Jb,backendName:"webgl",kernelFunc:a$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c$e=a1;function u$e(t){yr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),{selectedIndices:h,validOutputs:p}=c$e(u,d,o,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const d$e={kernelName:Zb,backendName:"webgl",kernelFunc:u$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h$e=l1;function p$e(t){yr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:i}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),d=n.readSync(i.dataId),h=o,p=a,f=l,g=c,{selectedIndices:y,selectedScores:x}=h$e(u,d,h,p,f,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([x.length],"float32",new Float32Array(x))]}const f$e={kernelName:ew,backendName:"webgl",kernelFunc:p$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m$e{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g$e=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:i,depth:o,onValue:a,offValue:l}=s,c=J(r.shape),u=new m$e(c,o,a,l),d=ye({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],i);n.disposeIntermediateTensorInfo(d);const p=[...r.shape,o],f=ye({inputs:{x:h},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(h),f},y$e={kernelName:bg,backendName:"webgl",kernelFunc:g$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _0(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=vy({inputs:{input:s},backend:n}),i=_0({inputs:{x:r},backend:n}),o=A1({inputs:{input:s},backend:n}),a=_0({inputs:{x:o},backend:n}),l=Al({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return by({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const x$e={kernelName:Mg,backendName:"webgl",kernelFunc:_0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v5(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=vy({inputs:{input:s},backend:n}),i=v5({inputs:{x:r},backend:n}),o=A1({inputs:{input:s},backend:n}),a=_0({inputs:{x:o},backend:n}),l=Al({inputs:{real:i,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),l}else return by({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const v$e={kernelName:vg,backendName:"webgl",kernelFunc:v5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b$e(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return RT({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const i=e[0].shape,o=e[0].dtype;e.forEach(u=>{Gn(i,u.shape,"All tensors passed to stack must have matching shapes"),D(o===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=RT({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=r5({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const w$e={kernelName:wg,backendName:"webgl",kernelFunc:b$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I$e{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,i=St(r),o=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${a});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k$e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,y)=>g[0]+e[y]+g[1]);const r=e.length,i=St(r),o=n.map(g=>g[0]).join(","),a=n.map((g,y)=>g[0]+e[y]).join(","),l=ks("rc",r),c=ks("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${i} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let g=0,y=r===1?2:4;g<y;g++)f+=`
        ${h[g]}
        if (${p}) {
          result[${g}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${g}] = getChannel(getX(${c.join()}), ${d});
        }
      `;f+=r===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${a});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b5=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:i,constantValue:o}=s;if(J(r.shape)===0){const c=i.map((u,d)=>u[0]+r.shape[d]+u[1]);return by({backend:n,attrs:{shape:c,value:o,dtype:r.dtype}})}const a=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new k$e(r.shape,i,o):new I$e(r.shape,i,o),l=[[o]];return n.runWebGLProgram(a,[r],r.dtype,l)},S$e={kernelName:Ig,backendName:"webgl",kernelFunc:b5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,N$e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+hu+`
  return result;
`,_$e=Xn({opSnippet:T$e,packedOpSnippet:N$e}),E$e={kernelName:wh,backendName:"webgl",kernelFunc:_$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:i,keepDims:o}=s,a=r.shape.length,l=[],c=Qe(i,r.shape);let u=c;const d=qt(u,a);let h=r;d!=null&&(h=_s({inputs:{x:r},backend:n,attrs:{perm:d}}),u=cn(u.length,a),l.push(h)),qn("prod",u,a);let p;if(n.shouldExecuteOnCPU([h])){const f=n.texData.get(h.dataId).values,{outVals:g,outShape:y,outDtype:x}=_Se(h.shape,h.dtype,f,u);p=n.makeTensorInfo(y,x,g)}else{const[f,g]=Fn(h.shape,u),y=J(g),x=ye({inputs:{x:h},backend:n,attrs:{shape:[-1,y]}}),v=Nw(r.dtype),w=pu(x,v,"prod",n);p=ye({inputs:{x:w},backend:n,attrs:{shape:f}}),l.push(x),l.push(w)}if(o){l.push(p);const f=an(p.shape,c);p=ye({inputs:{x:p},backend:n,attrs:{shape:f}})}return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),p}const $$e={kernelName:Sg,backendName:"webgl",kernelFunc:C$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A$e(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:a}=s,l=r.map(x=>n.readSync(x.dataId)),c=r.map(x=>x.shape),u=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,p,f]=ESe(l,c,u,i.shape,i.dtype,d,o.shape,a),g=h.map(x=>n.makeTensorInfo([x.length],"int32",x)),y=n.makeTensorInfo(f,i.dtype,p);return g.concat([y])}const R$e={kernelName:tw,backendName:"webgl",kernelFunc:A$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D$e(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:i}=e,o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=CSe(o,s.shape,s.dtype,a,r.shape,l,i.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const P$e={kernelName:nw,backendName:"webgl",kernelFunc:D$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$e(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:i,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(i.dataId),d=n.readSync(o.dataId),h=a.map(y=>n.readSync(y.dataId)),p=a.map(y=>y.shape),[f,g]=$Se(c,r.shape,u,i.shape,i.dtype,d,o.shape,h,p,l);return n.makeTensorInfo(f,i.dtype,g)}const F$e={kernelName:sw,backendName:"webgl",kernelFunc:O$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:i,dtype:o}=n,a=ASe(s,r,i,o);return e.makeTensorInfo([a.length],o,a)},L$e={kernelName:rw,backendName:"webgl",kernelFunc:w5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M$e="return 1.0 / x;",V$e=lt({opSnippet:M$e}),z$e={kernelName:Ih,backendName:"webgl",kernelFunc:V$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j$e=ti+`
  return (x < 0.0) ? 0.0 : x;
`,B$e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,U$e=lt({opSnippet:j$e,packedOpSnippet:B$e}),W$e={kernelName:kh,backendName:"webgl",kernelFunc:U$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$e=ti+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,H$e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,q$e=lt({opSnippet:G$e,packedOpSnippet:H$e}),K$e={kernelName:Sh,backendName:"webgl",kernelFunc:q$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X$e{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y$e{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;i?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=X().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Y$e(r.shape,l,c,i,o):new X$e(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],"float32")}const J$e={kernelName:_g,backendName:"webgl",kernelFunc:Q$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z$e{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,p=1/d,f=Math.ceil(h)*2+2,g=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eAe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new Z$e(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const tAe={kernelName:aw,backendName:"webgl",kernelFunc:eAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nAe{constructor(e,n,s,r,i){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let p;i?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sAe{constructor(e,n,s,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let p;i?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rAe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:i,halfPixelCenters:o,size:a}=s,[l,c]=a,u=X().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new sAe(r.shape,l,c,i,o):new nAe(r.shape,l,c,i,o);return n.runWebGLProgram(u,[r],r.dtype)}const iAe={kernelName:Ng,backendName:"webgl",kernelFunc:rAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oAe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,i]=n,[,o,a]=e,l=[s&&o>1?r-1:r,s&&a>1?i-1:i],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,p=1/d,f=Math.ceil(h)*2+2,g=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aAe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:i}=e,{alignCorners:o}=s,a=new oAe(i.shape,r.shape,o);return n.runWebGLProgram(a,[i],i.dtype)}const lAe={kernelName:ow,backendName:"webgl",kernelFunc:aAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cAe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,i=e.map((a,l)=>r(l)).join(","),o=St(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uAe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=ks("rc",s),i=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=St(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${o}) {
            result.b = ${u(r.slice())};
            if(${i}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(f){return h(f)}function c(f){return f[s-1]="("+f[s-1]+" + 1)",h(f)}function u(f){return f[s-2]="("+f[s-2]+" + 1)",h(f)}function d(f){return f[s-1]="("+f[s-1]+" + 1)",f[s-2]="("+f[s-2]+" + 1)",h(f)}function h(f){const g=e.map((v,w)=>p(w,f)),y=g.join(","),x=g.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${x}))`}function p(f,g){return n.indexOf(f)!==-1&&e[f]!==1?`${e[f]} - ${g[f]} - 1`:`${g[f]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dAe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:i}=s,o=r.shape.length,a=Qe(i,r.shape);if(o===0)return cr({inputs:{x:r},backend:n});const l=X().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uAe(r.shape,a):new cAe(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const hAe={kernelName:Eg,backendName:"webgl",kernelFunc:dAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pAe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fAe={kernelName:Sw,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:i,center:o}=e,a=n,l=new pAe(s.shape,i),[c,u]=DC(o,s.shape[1],s.shape[2]),d=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mAe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,gAe=lt({opSnippet:mAe}),yAe={kernelName:Th,backendName:"webgl",kernelFunc:gAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xAe="return inversesqrt(x);",vAe=lt({opSnippet:xAe,cpuKernelImpl:RSe}),bAe={kernelName:Nh,backendName:"webgl",kernelFunc:vAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F2{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=St(i.length),u=St(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let p="";r===1?p="i":r===2&&(p="i, coords[1]");const f=`getUpdates(${p})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,x=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${x};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wAe{constructor(e,n,s,r,i,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=St(i.length),u=St(o.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let p="";r===1?p="i":r===2&&(p="i, coords[1]");const f=`getUpdates(${p})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,x=n>1?"strides[j]":"strides",v=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${x};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${v};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IAe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:i}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=El(i,r,o),h=[d/c,c];if(d===0)return n.makeTensorInfo(o,r.dtype);const p=ye({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),f=ye({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;X().getBool("WEBGL_PACK")?y=new wAe(l,a,p.shape.length,f.shape.length,u,h):y=new F2(l,a,p.shape.length,f.shape.length,u,h);const x=n.runWebGLProgram(y,[f,p,g],f.dtype),v=ye({inputs:{x},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(g),v}const kAe={kernelName:lw,backendName:"webgl",kernelFunc:IAe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SAe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=X().getNumber("WEBGL_VERSION")===2?i:o,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TAe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:i}=e,{side:o}=s,a=new SAe(r.shape[0],r.shape[1],i.shape[1],o),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,i],"int32",l)}const NAe={kernelName:uw,backendName:"webgl",kernelFunc:TAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ae{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,i;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)i="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),i=c.join()}const o=St(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EAe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:i}=e,o=new _Ae(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,i],Ms(r.dtype,i.dtype))}const CAe={kernelName:Cg,backendName:"webgl",kernelFunc:EAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ae=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${p1};
  float scale = ${f1};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,AAe=lt({opSnippet:$Ae}),RAe={kernelName:_h,backendName:"webgl",kernelFunc:AAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DAe=tp+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,PAe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,OAe=lt({opSnippet:DAe,packedOpSnippet:PAe,cpuKernelImpl:PSe}),FAe={kernelName:Ah,backendName:"webgl",kernelFunc:OAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LAe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,MAe=lt({opSnippet:LAe}),VAe={kernelName:$h,backendName:"webgl",kernelFunc:MAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zAe=tp+`
  return sin(x);
`,jAe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${hu}
  return result;
`,BAe=lt({opSnippet:zAe,packedOpSnippet:jAe}),UAe={kernelName:Eh,backendName:"webgl",kernelFunc:BAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WAe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,GAe=lt({opSnippet:WAe}),HAe={kernelName:Ch,backendName:"webgl",kernelFunc:GAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qAe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,KAe=lt({opSnippet:qAe}),XAe={kernelName:Rh,backendName:"webgl",kernelFunc:KAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YAe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:i,paddings:o}=s;D(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=i.reduce((x,v)=>x*v),l=[[0,0]];l.push(...o);for(let x=1+i.length;x<r.shape.length;++x)l.push([0,0]);const c=[],u=b5({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=ry(u.shape,i,a,!1),h=iy(d.length,i.length,!1),p=oy(u.shape,i,a,!1),f=ye({inputs:{x:u},backend:n,attrs:{shape:d}}),g=_s({inputs:{x:f},backend:n,attrs:{perm:h}}),y=ye({inputs:{x:g},backend:n,attrs:{shape:p}});return c.push(u),c.push(f),c.push(g),c.forEach(x=>n.disposeIntermediateTensorInfo(x)),y},QAe={kernelName:Rg,backendName:"webgl",kernelFunc:YAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JAe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[d,h,p,f,g]=FSe(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(y=>Number(y)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const ZAe={kernelName:dw,backendName:"webgl",kernelFunc:JAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eRe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:i}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(i.dataId)),[c,u,d]=LSe(a,s.shape,s.dtype,o,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const tRe={kernelName:hw,backendName:"webgl",kernelFunc:eRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nRe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=G6(o,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const sRe={kernelName:pw,backendName:"webgl",kernelFunc:nRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rRe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:i}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(i.dataId),[c,u]=G6(o,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const iRe={kernelName:fw,backendName:"webgl",kernelFunc:rRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:i,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=El(i,r,a),p=!1;if(i.dtype==="string"){const x=n.bufferSync(r),v=n.bufferSync(i),w=Ho(n.readSync(o.dataId)[0]),I=DSe(x,v,a,h,u,c,l,d,w,p);return n.makeTensorInfo(a,I.dtype,I.values)}const f=new F2(c,l,r.shape.length,i.shape.length,d,[h,1],p),g=n.runWebGLProgram(f,[i,r,o],i.dtype),y=ye({inputs:{x:g},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(g),y}const aRe={kernelName:mw,backendName:"webgl",kernelFunc:oRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:i,axis:o}=s,a=Qe(o,r.shape)[0],l=KC(r,i,a),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(h=>{const p=[...d];p[a]=h;const f=np({inputs:{x:r},backend:n,attrs:{begin:u,size:p}});return u[a]+=h,f})}const cRe={kernelName:Dg,backendName:"webgl",kernelFunc:lRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hO="return sqrt(x);",uRe=lt({opSnippet:hO,packedOpSnippet:hO,cpuKernelImpl:MSe}),dRe={kernelName:Dh,backendName:"webgl",kernelFunc:uRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hRe="return x * x;",pRe=lt({opSnippet:hRe}),fRe={kernelName:gw,backendName:"webgl",kernelFunc:pRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pO="return (a - b) * (a - b);",mRe=Xn({opSnippet:pO,packedOpSnippet:pO}),gRe={kernelName:Ph,backendName:"webgl",kernelFunc:mRe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const i=n.readSync(r.dataId),o=Yo(i),a=VSe(o,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const xRe={kernelName:Og,backendName:"webgl",kernelFunc:yRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vRe({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=ti+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new Bi(s.shape,r);return n.runWebGLProgram(i,[s],s.dtype)}const bRe={kernelName:Vh,backendName:"webgl",kernelFunc:vRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wRe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,i=St(s.length),o=St(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:i,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:p,finalShape:f,isIdentity:g,sliceDim0:y,isSimpleSlice:x,begin:v,end:w,strides:I}=CC(r.shape,i,o,a,l,c,u,d,h);let N;if(g)N=ye({inputs:{x:r},backend:n,attrs:{shape:f}});else if(y||x){D(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const T=NC(v,w,I),S=np({inputs:{x:r},backend:n,attrs:{begin:v,size:T}});N=ye({inputs:{x:S},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(S)}else if(n.shouldExecuteOnCPU([r])){const S=n.readSync(r.dataId),E=qe(r.shape,r.dtype,S),$=zSe(p,E,I,v);N=n.makeTensorInfo(f,r.dtype,$.values)}else{const S=new wRe(v,I,p);N=n.runWebGLProgram(S,[r],r.dtype)}const A=ye({inputs:{x:N},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(N),A}const kRe={kernelName:yw,backendName:"webgl",kernelFunc:IRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SRe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:i,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),p=n.readSync(d.dataId),[f,g]=jSe(h,p,r,i,o,a,l,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",g)]}const TRe={kernelName:xw,backendName:"webgl",kernelFunc:SRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NRe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[c,u,d]=BSe(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const _Re={kernelName:vw,backendName:"webgl",kernelFunc:NRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ERe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),a=USe(o,r);return n.makeTensorInfo(i.shape,"int32",a)}const CRe={kernelName:bw,backendName:"webgl",kernelFunc:ERe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Re="return tan(x);",ARe=lt({opSnippet:$Re}),RRe={kernelName:Fh,backendName:"webgl",kernelFunc:ARe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DRe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,PRe=lt({opSnippet:DRe}),ORe={kernelName:Lh,backendName:"webgl",kernelFunc:PRe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FRe(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:i,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=El(o,i,r.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(r.shape,i.dtype);const p=ye({inputs:{x:i},backend:n,attrs:{shape:[l,a]}}),f=ye({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),g=ye({inputs:{x:r},backend:n,attrs:{shape:h}}),y=new F2(l,a,p.shape.length,f.shape.length,u,h,!1,!0),x=n.runWebGLProgram(y,[f,p,g],g.dtype),v=ye({inputs:{x},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),v}const LRe={kernelName:cw,backendName:"webgl",kernelFunc:FRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MRe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=St(this.rank),i=VRe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function VRe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I5(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:i}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(h=>Ho(h)):l,u=qe(r.shape,r.dtype,c),d=GSe(u,i);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new MRe(r.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const zRe={kernelName:Mh,backendName:"webgl",kernelFunc:I5};class jRe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class BRe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vl(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function fO(t){let e=1;for(;e<t;)e*=2;return e}function URe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:i,sorted:o}=s,a=X().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=X().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||i>l){const $=n.readSync(r.dataId),[P,F]=HSe($,c,r.dtype,i,o);return[n.makeTensorInfo(P.shape,P.dtype,P.values),n.makeTensorInfo(F.shape,F.dtype,F.values)]}if(i===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,by({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,p=h?n.unpackTensor(r):r,g=J(c)/u,y=ye({inputs:{x:p},attrs:{shape:[g,u]},backend:n});h&&Vl(n,p);const x=fO(i),v=fO(u);let w=null;const I=()=>w===null?[y,y]:[y,w],N=($,P,F)=>{const R=I(),G=new jRe(F),Q=[[u],[w===null?1:0],[Number.NEGATIVE_INFINITY],[$],[P]],te=w;w=n.runWebGLProgram(G,R,"int32",Q),Vl(n,te)};for(let $=1;$<x;$*=2){const P=$*2;for(let F=$;F>=1;F/=2)N(P,F,[g,v])}for(let $=v;$>x;$/=2){const P=I(),F=new BRe([g,$/2]),G=[[u],[w===null?1:0],[x]],q=w;w=n.runWebGLProgram(F,P,"int32",G),Vl(n,q);const Q=x/2,te=Q*2;for(let B=Q;B>=1;B/=2)N(te,B,w.shape)}let A=w;w=np({inputs:{x:w},backend:n,attrs:{begin:0,size:[g,i]}}),Vl(n,A);let T=f5({inputs:{x:y,indices:w},backend:n,attrs:{axis:1,batchDims:1}});Vl(n,y);const S=c.slice(0,-1);S.push(i),A=w,w=ye({inputs:{x:w},attrs:{shape:S},backend:n}),Vl(n,A);const E=T;return T=ye({inputs:{x:T},attrs:{shape:S},backend:n}),Vl(n,E),[T,w]}const WRe={kernelName:ww,backendName:"webgl",kernelFunc:URe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GRe{constructor(e,n,s,r,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HRe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:i}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[u,d,h,p]=r.shape,[f,g]=c??[d,h],y=[u,f,g,p],x=new GRe(d,h,o,a,l,y);return n.runWebGLProgram(x,[r,i],"float32")}const qRe={kernelName:Iw,backendName:"webgl",kernelFunc:HRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KRe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:i}=e;yy(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(i.dataId),{outputValues:a,outputShape:l,indices:c}=qSe(o,r,i.shape,i.dtype);return[s.makeTensorInfo(l,i.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const XRe={kernelName:kw,backendName:"webgl",kernelFunc:KRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YRe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:i}=s;i<0&&(i+=r.shape.length);const o=r,a=o.shape.length,l=r.shape[i],c=new Array(a-1);let u=0;for(let g=0;g<a;g++)g!==i&&(c[u++]=o.shape[g]);const d=[],h=new Array(a).fill(0),p=o.shape.slice();p[i]=1;const f=new Array(l);for(let g=0;g<f.length;g++){h[i]=g;const y=np({inputs:{x:o},backend:n,attrs:{begin:h,size:p}}),x=ye({inputs:{x:y},backend:n,attrs:{shape:c}});f[g]=x,d.push(y)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),f}const QRe={kernelName:Fg,backendName:"webgl",kernelFunc:YRe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JRe{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,i=e.inSize,o=e.numSegments,a=o*Math.ceil(i/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let p="";i%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let f="";i%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${f}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZRe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:i}=e,{numSegments:o}=s,a=r.shape.length,l=[];let c=0;const u=qt([c],a);let d=r;u!=null&&(d=_s({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=cn(1,a)[0]);const h=Zj(d.shape,c,o),p=J([d.shape[c]]),f=ye({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});l.push(f);const g=Nw(r.dtype),y=(I,N,A,T,S)=>{const E=I.shape[0],$=I.shape[1],P=Jj($,S),F={windowSize:P,inSize:$,batchSize:E,numSegments:S},R=new JRe(F,N),G=n.compileAndRun(R,[I,A],T);if(l.push(G),G.shape[1]===S)return G;const q=w5({backend:n,attrs:{start:0,stop:S,step:1,dtype:"float32"}}),Q=I5({inputs:{x:q},backend:n,attrs:{reps:[$/P]}});return l.push(q),l.push(Q),y(G,N,Q,T,S)},x=y(f,"unsortedSegmentSum",i,g,o),v=ye({inputs:{x},backend:n,attrs:{shape:h}});let w=v;if(u!=null){l.push(v);const I=Tl(u);w=_s({inputs:{x:w},backend:n,attrs:{perm:I}})}return l.forEach(I=>n.disposeIntermediateTensorInfo(I)),w}const eDe={kernelName:Lg,backendName:"webgl",kernelFunc:ZRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tDe=[MTe,zTe,UTe,HTe,KTe,QTe,ZTe,tNe,iNe,aNe,uNe,pNe,gNe,bNe,kNe,TNe,_Ne,ANe,DNe,ONe,VNe,HNe,KNe,JNe,e_e,o_e,l_e,h_e,wTe,m_e,b_e,S_e,$_e,D_e,O_e,L_e,V_e,U_e,H_e,X_e,Q_e,Z_e,tEe,rEe,oEe,uEe,hEe,mEe,xEe,bEe,SEe,EEe,REe,OEe,MEe,VEe,jEe,UEe,GEe,qEe,XEe,ZEe,nCe,iCe,aCe,uCe,pCe,yCe,wCe,bTe,kCe,x_e,NCe,CCe,RCe,kTe,FCe,zCe,BCe,HCe,XCe,ZCe,n2e,o2e,u2e,p2e,m2e,v2e,w2e,k2e,_2e,C2e,A2e,D2e,O2e,V2e,U2e,q2e,t$e,NTe,i$e,l$e,d$e,f$e,n_e,y$e,v$e,w$e,S$e,E$e,TTe,$$e,R$e,P$e,F$e,L$e,s_e,Q2e,z$e,W$e,K$e,ETe,J$e,tAe,iAe,lAe,hAe,fAe,yAe,bAe,kAe,NAe,CAe,RAe,FAe,VAe,UAe,HAe,WNe,Z2e,XAe,QAe,ZAe,tRe,sRe,iRe,aRe,cRe,dRe,fRe,gRe,xRe,bRe,kRe,TRe,_Re,CRe,J2e,OTe,RRe,ORe,LRe,zRe,WRe,qRe,FTe,XRe,QRe,eDe,x$e];for(const t of tDe)Tw(t);class nDe{constructor(){this.model=null}async initialize(){if(!this.model)throw new Error("Initialize method must be implemented by child class")}async predict(){throw new Error("Predict method must be implemented by child class")}}class sDe extends nDe{async initialize(){this.model||(this.model=await Lpe())}async predict(e){return this.model||await this.initialize(),await this.model.classify(e)}}class rDe{constructor(){this.baseValues={Electronics:5e3,Furniture:3e3,Clothing:1e3,Sports:2e3,Other:500}}estimateValue(e,n){var i;const s=this.baseValues[n]||this.baseValues.Other,r=((i=e[0])==null?void 0:i.probability)||.5;return Math.round(s*r)}calculateFee(e){const n=Math.max(e*.02,50);return Math.round(n)}}class iDe{async uploadImage(e){const n=SM(TM,`item-images/${j_()}`);return await IM(n,e),await kM(n)}async loadImage(e){const n=new Image;return n.src=e,await n.decode(),n}}class oDe{async createCertificate(e){const n={...e,itemId:j_(),createdAt:NJ(),status:"pending_review"},s=await __(Uv(sc,"certificates"),n);return{...n,id:s.id}}}class L2{constructor(){this.aiModel=new sDe,this.valueEstimator=new rDe,this.imageStorage=new iDe,this.certificateGenerator=new oDe}async generateCertificate(e,n){try{const s=await this.imageStorage.uploadImage(e),r=await this.imageStorage.loadImage(s),i=await this.aiModel.predict(r),o=this.valueEstimator.estimateValue(i,n.category),a=this.valueEstimator.calculateFee(o);return await this.certificateGenerator.createCertificate({imageUrl:s,predictions:i,estimatedValue:o,fee:a,...n})}catch(s){throw console.error("Error generating certificate:",s),s}}}function aDe(){const[t,e]=M.useState(1),[n,s]=M.useState({images:[],category:"",condition:"",description:""}),[r,i]=M.useState(!1),o=new L2,a=c=>{s({...n,images:c}),e(2)},l=async c=>{c.preventDefault(),i(!0);try{const u=await o.generateCertificate(n);console.log("Certificate generated:",u)}catch(u){console.error("Error generating certificate:",u)}finally{i(!1)}};return b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[b.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Standard Certificate"}),b.jsx("p",{className:"text-blue-600",children:"Get a quick AI-powered valuation of your item based on photos and basic information. Perfect for common items with clear market values."}),b.jsx("p",{className:"text-blue-600 mt-2",children:"Fee: R50"})]}),t===1&&b.jsxs("div",{children:[b.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Upload Item Photos"}),b.jsx(Yu,{onUpload:a,maxImages:5})]}),t===2&&b.jsxs("form",{onSubmit:l,className:"space-y-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),b.jsxs("select",{value:n.category,onChange:c=>s({...n,category:c.target.value}),className:"w-full border border-gray-300 rounded-md p-2",required:!0,children:[b.jsx("option",{value:"",children:"Select a category"}),b.jsx("option",{value:"Electronics",children:"Electronics"}),b.jsx("option",{value:"Furniture",children:"Furniture"}),b.jsx("option",{value:"Fashion",children:"Fashion"}),b.jsx("option",{value:"Sports",children:"Sports"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Condition"}),b.jsxs("select",{value:n.condition,onChange:c=>s({...n,condition:c.target.value}),className:"w-full border border-gray-300 rounded-md p-2",required:!0,children:[b.jsx("option",{value:"",children:"Select condition"}),b.jsx("option",{value:"New",children:"New"}),b.jsx("option",{value:"Like New",children:"Like New"}),b.jsx("option",{value:"Good",children:"Good"}),b.jsx("option",{value:"Fair",children:"Fair"}),b.jsx("option",{value:"Poor",children:"Poor"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),b.jsx("textarea",{value:n.description,onChange:c=>s({...n,description:c.target.value}),className:"w-full border border-gray-300 rounded-md p-2",rows:4,required:!0})]}),b.jsx("button",{type:"submit",disabled:r,className:"w-full bg-primary text-white py-3 rounded-lg hover:bg-secondary transition-colors disabled:opacity-50",children:r?"Processing...":"Request Certificate"})]})]})}function lDe(){const[t,e]=M.useState(1),[n,s]=M.useState({images:[],category:"",condition:"",description:"",receipts:[],proofOfOwnership:[],additionalDetails:"",serialNumber:"",purchaseDate:"",originalPrice:""}),[r,i]=M.useState(!1),o=new L2,a=d=>{s({...n,images:d}),e(2)},l=d=>{s({...n,receipts:d})},c=d=>{s({...n,proofOfOwnership:d})},u=async d=>{d.preventDefault(),i(!0);try{const h=await o.generateAdvancedCertificate(n);console.log("Advanced certificate generated:",h)}catch(h){console.error("Error generating advanced certificate:",h)}finally{i(!1)}};return b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6",children:[b.jsx("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:"Advanced Certificate"}),b.jsx("p",{className:"text-purple-600",children:"Get a comprehensive valuation with human expert review. Includes detailed analysis, authenticity verification, and market comparison."}),b.jsx("p",{className:"text-purple-600 mt-2",children:"Fee: R150"})]}),t===1&&b.jsxs("div",{children:[b.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Upload Item Photos"}),b.jsx(Yu,{onUpload:a,maxImages:10})]}),t===2&&b.jsxs("form",{onSubmit:u,className:"space-y-6",children:[b.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),b.jsxs("select",{value:n.category,onChange:d=>s({...n,category:d.target.value}),className:"w-full border border-gray-300 rounded-md p-2",required:!0,children:[b.jsx("option",{value:"",children:"Select a category"}),b.jsx("option",{value:"Electronics",children:"Electronics"}),b.jsx("option",{value:"Furniture",children:"Furniture"}),b.jsx("option",{value:"Fashion",children:"Fashion"}),b.jsx("option",{value:"Sports",children:"Sports"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Condition"}),b.jsxs("select",{value:n.condition,onChange:d=>s({...n,condition:d.target.value}),className:"w-full border border-gray-300 rounded-md p-2",required:!0,children:[b.jsx("option",{value:"",children:"Select condition"}),b.jsx("option",{value:"New",children:"New"}),b.jsx("option",{value:"Like New",children:"Like New"}),b.jsx("option",{value:"Good",children:"Good"}),b.jsx("option",{value:"Fair",children:"Fair"}),b.jsx("option",{value:"Poor",children:"Poor"})]})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Serial Number (if applicable)"}),b.jsx("input",{type:"text",value:n.serialNumber,onChange:d=>s({...n,serialNumber:d.target.value}),className:"w-full border border-gray-300 rounded-md p-2"})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Date"}),b.jsx("input",{type:"date",value:n.purchaseDate,onChange:d=>s({...n,purchaseDate:d.target.value}),className:"w-full border border-gray-300 rounded-md p-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Original Price (ZAR)"}),b.jsx("input",{type:"number",value:n.originalPrice,onChange:d=>s({...n,originalPrice:d.target.value}),className:"w-full border border-gray-300 rounded-md p-2"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),b.jsx("textarea",{value:n.description,onChange:d=>s({...n,description:d.target.value}),className:"w-full border border-gray-300 rounded-md p-2",rows:4,required:!0})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Details"}),b.jsx("textarea",{value:n.additionalDetails,onChange:d=>s({...n,additionalDetails:d.target.value}),className:"w-full border border-gray-300 rounded-md p-2",rows:4,placeholder:"Include any relevant details about the item's history, modifications, or special features"})]}),b.jsxs("div",{children:[b.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Upload Receipts"}),b.jsx(Yu,{onUpload:l,maxImages:3})]}),b.jsxs("div",{children:[b.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Proof of Ownership"}),b.jsx(Yu,{onUpload:c,maxImages:3})]}),b.jsx("button",{type:"submit",disabled:r,className:"w-full bg-primary text-white py-3 rounded-lg hover:bg-secondary transition-colors disabled:opacity-50",children:r?"Processing...":"Request Advanced Certificate"})]})]})}function cDe(){const[t,e]=M.useState([]),[n,s]=M.useState(!0),[r,i]=M.useState("active"),o=new L2;M.useEffect(()=>{a()},[r]);const a=async()=>{try{const c=await o.getCertificates(r);e(c)}catch(c){console.error("Error loading certificates:",c)}finally{s(!1)}},l=async c=>{try{await o.reissueCertificate(c),await a()}catch(u){console.error("Error reissuing certificate:",u)}};return n?b.jsx("div",{className:"flex justify-center items-center py-12",children:b.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):b.jsxs("div",{children:[b.jsxs("div",{className:"flex justify-between items-center mb-6",children:[b.jsx("h3",{className:"text-lg font-semibold",children:"Your Certificates"}),b.jsxs("div",{className:"flex space-x-2",children:[b.jsx("button",{onClick:()=>i("active"),className:`px-4 py-2 rounded-lg ${r==="active"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Active"}),b.jsx("button",{onClick:()=>i("expired"),className:`px-4 py-2 rounded-lg ${r==="expired"?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Expired"})]})]}),b.jsxs("div",{className:"space-y-4",children:[t.map(c=>b.jsxs("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:[b.jsxs("div",{className:"flex justify-between items-start",children:[b.jsxs("div",{children:[b.jsx("h4",{className:"font-semibold",children:c.itemName}),b.jsxs("p",{className:"text-sm text-gray-600",children:["Certificate #",c.certificateNumber]})]}),b.jsx("div",{className:`px-2 py-1 rounded text-sm ${c.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.status})]}),b.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4 text-sm",children:[b.jsxs("div",{children:[b.jsx("span",{className:"text-gray-600",children:"Issued Date:"}),b.jsx("span",{className:"ml-2",children:new Date(c.issuedDate).toLocaleDateString()})]}),b.jsxs("div",{children:[b.jsx("span",{className:"text-gray-600",children:"Expiry Date:"}),b.jsx("span",{className:"ml-2",children:new Date(c.expiryDate).toLocaleDateString()})]}),b.jsxs("div",{children:[b.jsx("span",{className:"text-gray-600",children:"Estimated Value:"}),b.jsxs("span",{className:"ml-2",children:["R ",c.estimatedValue.toLocaleString()]})]}),b.jsxs("div",{children:[b.jsx("span",{className:"text-gray-600",children:"Certificate Type:"}),b.jsx("span",{className:"ml-2",children:c.type})]})]}),b.jsxs("div",{className:"mt-4 flex justify-end space-x-4",children:[b.jsx("button",{onClick:()=>window.open(c.pdfUrl,"_blank"),className:"text-primary hover:text-secondary",children:"View Certificate"}),c.status==="expired"&&b.jsx("button",{onClick:()=>l(c.id),className:"text-primary hover:text-secondary",children:"Reissue Certificate"})]})]},c.id)),t.length===0&&b.jsx("div",{className:"text-center py-8 text-gray-500",children:"No certificates found."})]})]})}function uDe(){const[t,e]=M.useState("standard");return b.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:b.jsx("div",{className:"max-w-4xl mx-auto px-4",children:b.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[b.jsx("h1",{className:"text-2xl font-bold mb-6",children:"VeriLINC Fair Value Certificate"}),b.jsx("div",{className:"border-b border-gray-200 mb-6",children:b.jsxs("nav",{className:"-mb-px flex space-x-8",children:[b.jsx("button",{onClick:()=>e("standard"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="standard"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Standard Certificate"}),b.jsx("button",{onClick:()=>e("advanced"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="advanced"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Advanced Certificate"}),b.jsx("button",{onClick:()=>e("view"),className:`py-4 px-1 border-b-2 font-medium text-sm ${t==="view"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"View Certificates"})]})}),t==="standard"&&b.jsx(aDe,{}),t==="advanced"&&b.jsx(lDe,{}),t==="view"&&b.jsx(cDe,{})]})})})}function dDe({certificate:t}){return b.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[b.jsxs("div",{className:"flex items-center space-x-3",children:[b.jsx(ZM,{className:"h-6 w-6 text-green-600"}),b.jsxs("div",{children:[b.jsx("h3",{className:"text-sm font-semibold text-green-800",children:"VeriLINC Certified"}),b.jsxs("p",{className:"text-sm text-green-600",children:["Certificate #",t.certificateNumber]})]})]}),b.jsxs("div",{className:"mt-2 text-sm text-green-700",children:[b.jsxs("p",{children:["Market Value: R ",t.estimatedValue.toLocaleString()]}),b.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Last Verified: ",new Date(t.lastUpdated).toLocaleDateString()]})]})]})}function hDe(){const{id:t}=LL(),e=Es(),[n,s]=M.useState(1),[r,i]=M.useState(null),[o,a]=M.useState(!0),l=$M[1];M.useEffect(()=>{(async()=>{try{const d={certificateNumber:"VL"+Math.random().toString().slice(2,8),estimatedValue:19999,lastUpdated:new Date().toISOString(),condition:"Excellent",authenticity:"Verified Original",marketAnalysis:{averagePrice:20500,priceRange:{min:18500,max:22e3}}};i(d)}catch(d){console.error("Error loading certificate:",d)}finally{a(!1)}})()},[]);const c=()=>{e(`/checkout/${t}`,{state:{product:l,quantity:n,total:l.price*n,certificate:r}})};return b.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:b.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[b.jsx("div",{children:b.jsx("img",{src:l.imageUrl,alt:l.title,className:"w-full rounded-lg shadow-sm"})}),b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{children:[b.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:l.title}),b.jsxs("p",{className:"text-2xl font-bold text-primary mt-2",children:["R ",l.price.toLocaleString()]})]}),r&&b.jsx(dDe,{certificate:r}),b.jsxs("div",{className:"flex items-center space-x-4",children:[b.jsx(Dm,{className:"h-5 w-5 text-green-500"}),b.jsx("span",{className:"text-green-600",children:"Verified Seller"})]}),b.jsxs("div",{className:"border-t border-b py-4",children:[b.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Product Details"}),b.jsxs("ul",{className:"space-y-2 text-gray-600",children:[b.jsx("li",{children:"• 256GB Storage"}),b.jsx("li",{children:"• 6.7-inch Super Retina XDR display"}),b.jsx("li",{children:"• Pro camera system"}),b.jsx("li",{children:"• A16 Bionic chip"}),b.jsx("li",{children:"• All-day battery life"})]})]}),r&&b.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[b.jsx("h3",{className:"text-sm font-semibold text-blue-800 mb-2",children:"Market Analysis"}),b.jsxs("div",{className:"space-y-2 text-sm text-blue-700",children:[b.jsxs("p",{children:["Average Market Price: R ",r.marketAnalysis.averagePrice.toLocaleString()]}),b.jsxs("p",{children:["Price Range: R ",r.marketAnalysis.priceRange.min.toLocaleString()," - R ",r.marketAnalysis.priceRange.max.toLocaleString()]}),b.jsxs("p",{children:["Condition: ",r.condition]}),b.jsxs("p",{children:["Authenticity: ",r.authenticity]})]})]}),b.jsxs("div",{className:"flex items-center space-x-4",children:[b.jsx(ree,{className:"h-5 w-5 text-gray-400"}),b.jsxs("div",{children:[b.jsx("p",{className:"font-medium",children:"Free Delivery"}),b.jsx("p",{className:"text-sm text-gray-500",children:"2-3 business days"})]})]}),b.jsxs("div",{className:"space-y-4",children:[b.jsxs("div",{className:"flex items-center space-x-4",children:[b.jsx("label",{className:"text-gray-700",children:"Quantity:"}),b.jsx("select",{value:n,onChange:u=>s(Number(u.target.value)),className:"border rounded-md px-2 py-1",children:[1,2,3,4,5].map(u=>b.jsx("option",{value:u,children:u},u))})]}),b.jsx("button",{onClick:c,className:"w-full bg-primary text-white py-3 rounded-lg hover:bg-secondary transition-colors",children:"Buy Now"}),b.jsx("button",{className:"w-full border border-primary text-primary py-3 rounded-lg hover:bg-primary hover:text-white transition-colors",children:"Add to Cart"})]})]})]})})})}var k5="https://js.stripe.com/v3",pDe=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,mO="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",fDe=function(){for(var e=document.querySelectorAll('script[src^="'.concat(k5,'"]')),n=0;n<e.length;n++){var s=e[n];if(pDe.test(s.src))return s}return null},gO=function(e){var n="",s=document.createElement("script");s.src="".concat(k5).concat(n);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(s),s},mDe=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:n})},Pp=null,_x=null,Ex=null,gDe=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},yDe=function(e,n){return function(){window.Stripe?e(window.Stripe):n(new Error("Stripe.js not available"))}},xDe=function(e){return Pp!==null?Pp:(Pp=new Promise(function(n,s){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&e&&console.warn(mO),window.Stripe){n(window.Stripe);return}try{var r=fDe();if(r&&e)console.warn(mO);else if(!r)r=gO(e);else if(r&&Ex!==null&&_x!==null){var i;r.removeEventListener("load",Ex),r.removeEventListener("error",_x),(i=r.parentNode)===null||i===void 0||i.removeChild(r),r=gO(e)}Ex=yDe(n,s),_x=gDe(s),r.addEventListener("load",Ex),r.addEventListener("error",_x)}catch(o){s(o);return}}),Pp.catch(function(n){return Pp=null,Promise.reject(n)}))},vDe=function(e,n,s){if(e===null)return null;var r=e.apply(void 0,n);return mDe(r,s),r},Op,S5=!1,T5=function(){return Op||(Op=xDe(null).catch(function(e){return Op=null,Promise.reject(e)}),Op)};Promise.resolve().then(function(){return T5()}).catch(function(t){S5||console.warn(t)});var bDe=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];S5=!0;var r=Date.now();return T5().then(function(i){return vDe(i,n,r)})};class wDe{constructor(){this.stripe=null,this.init()}async init(){this.stripe=await bDe("pk_test_your_stripe_public_key")}async createPaymentIntent(e,n="zar",s){try{return(await __(Uv(sc,"payment_intents"),{amount:e,currency:n,description:s,status:"pending",createdAt:new Date().toISOString()})).id}catch(r){throw console.error("Error creating payment intent:",r),r}}async processPayment(e,n){try{const s=Wv(sc,"payment_intents",e),r=await IJ(s);if(!r.exists())throw new Error("Payment intent not found");const{error:i,paymentIntent:o}=await this.stripe.confirmCardPayment(r.data().clientSecret,{payment_method:n});if(i)throw i;return await rM(s,{status:o.status,updatedAt:new Date().toISOString()}),o}catch(s){throw console.error("Error processing payment:",s),s}}getPricing(){return{verilinc:{standard:50,advanced:150},escrow:{percentage:.02,minimum:50},premium:{monthly:99,annual:999},advertising:{sponsored_listing:{daily:100,weekly:600,monthly:2e3},banner_ads:{daily:200,weekly:1200,monthly:4e3}}}}}function IDe(){const t=bl(),e=Es(),{product:n,quantity:s,total:r,certificate:i}=t.state||{},[o,a]=M.useState({fullName:"",email:"",phone:"",address:"",city:"",postalCode:"",cardNumber:"",expiryDate:"",cvv:""}),[l,c]=M.useState(!1),u=new wDe,d=async h=>{h.preventDefault(),c(!0);try{(await u.processPayment({amount:r,currency:"ZAR",paymentMethod:{card:{number:o.cardNumber,exp_month:o.expiryDate.split("/")[0],exp_year:o.expiryDate.split("/")[1],cvc:o.cvv}}})).status==="succeeded"&&e("/order-confirmation",{state:{orderNumber:Math.random().toString(36).substr(2,9).toUpperCase(),product:n,quantity:s,total:r,certificate:i}})}catch(p){console.error("Payment failed:",p)}finally{c(!1)}};return b.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:b.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Checkout"}),b.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[b.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Order Summary"}),b.jsxs("div",{className:"flex items-center justify-between mb-4",children:[b.jsxs("div",{children:[b.jsx("p",{className:"font-medium",children:n==null?void 0:n.title}),b.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",s]}),i&&b.jsxs("div",{className:"flex items-center mt-2 text-sm text-green-600",children:[b.jsx(Dm,{className:"h-4 w-4 mr-1"}),"VeriLINC Certified"]})]}),b.jsxs("p",{className:"font-bold text-primary",children:["R ",r==null?void 0:r.toLocaleString()]})]}),i&&b.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-md",children:b.jsx("p",{className:"text-sm text-green-800",children:"This item has been verified by VeriLINC for authenticity and fair market value."})})]}),b.jsxs("form",{onSubmit:d,className:"bg-white rounded-lg shadow p-6 space-y-6",children:[b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),b.jsx("input",{type:"text",required:!0,value:o.fullName,onChange:h=>a({...o,fullName:h.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),b.jsx("input",{type:"email",required:!0,value:o.email,onChange:h=>a({...o,email:h.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Delivery Address"}),b.jsx("textarea",{required:!0,value:o.address,onChange:h=>a({...o,address:h.target.value}),rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Card Number"}),b.jsx("input",{type:"text",required:!0,value:o.cardNumber,onChange:h=>a({...o,cardNumber:h.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:"4242 4242 4242 4242"})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Expiry Date"}),b.jsx("input",{type:"text",required:!0,value:o.expiryDate,onChange:h=>a({...o,expiryDate:h.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:"MM/YY"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CVV"}),b.jsx("input",{type:"text",required:!0,value:o.cvv,onChange:h=>a({...o,cvv:h.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:"123"})]})]})]}),b.jsx("button",{type:"submit",disabled:l,className:"w-full bg-primary text-white py-3 rounded-lg hover:bg-secondary transition-colors disabled:opacity-50",children:l?"Processing...":`Pay R ${r==null?void 0:r.toLocaleString()}`})]})]})})}function kDe(){const t=bl(),{orderNumber:e,product:n,quantity:s,total:r,certificate:i}=t.state||{};return b.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:b.jsx("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:b.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[b.jsx(KZ,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),b.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Order Confirmed!"}),b.jsxs("p",{className:"text-gray-600 mb-6",children:["Thank you for your purchase. Your order number is: ",e]}),b.jsx("div",{className:"border-t border-b py-4 my-6",children:b.jsxs("div",{className:"flex justify-between items-center mb-2",children:[b.jsxs("div",{children:[b.jsx("span",{className:"font-medium",children:n==null?void 0:n.title}),b.jsxs("span",{className:"ml-2",children:["x",s]}),i&&b.jsxs("div",{className:"flex items-center mt-1 text-sm text-green-600",children:[b.jsx(Dm,{className:"h-4 w-4 mr-1"}),"VeriLINC Certified"]})]}),b.jsxs("div",{className:"text-lg font-bold text-primary",children:["R ",r==null?void 0:r.toLocaleString()]})]})}),i&&b.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6 text-left",children:[b.jsx("h3",{className:"text-sm font-semibold text-green-800 mb-2",children:"VeriLINC Certificate"}),b.jsxs("p",{className:"text-sm text-green-700",children:["This purchase includes a VeriLINC certificate verifying the item's authenticity and value. Certificate #",i.certificateNumber]})]}),b.jsx("p",{className:"text-gray-600 mb-6",children:"We'll send you an email with your order details and tracking information."}),b.jsx(Ja,{to:"/buy-sell",className:"inline-block bg-primary text-white px-6 py-2 rounded-lg hover:bg-secondary transition-colors",children:"Continue Shopping"})]})})})}function SDe(){const t=Es(),{user:e}=O_(),[n,s]=M.useState(1),[r,i]=M.useState({title:"",description:"",category:"",condition:"",price:"",location:"",images:[],requestVeriLINC:!1}),[o,a]=M.useState(!1),l=new mV;M.useEffect(()=>{e||t("/login",{state:{from:"/post-ad"}})},[e,t]);const c=p=>{i({...r,images:p}),s(2)},u=async p=>{p.preventDefault(),a(!0);try{const f=await l.createItem({...r,userId:e.uid,status:"active",createdAt:new Date().toISOString()});r.requestVeriLINC,t("/seller/dashboard")}catch(f){console.error("Error creating listing:",f)}finally{a(!1)}},d=["Vehicles","Property","Electronics","Furniture","Fashion","Sports","Collectibles","Jobs","Services"],h=["New","Like New","Good","Fair","Poor"];return b.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:b.jsx("div",{className:"max-w-3xl mx-auto px-4",children:b.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[b.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Post New Ad"}),b.jsx("div",{className:"flex justify-between mb-8",children:[1,2,3].map(p=>b.jsxs("div",{className:`flex items-center ${p<n?"text-primary":p===n?"text-gray-900":"text-gray-400"}`,children:[b.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${p<=n?"bg-primary text-white":"bg-gray-200"}`,children:p}),b.jsx("span",{className:"ml-2",children:p===1?"Photos":p===2?"Details":"Review"})]},p))}),n===1&&b.jsxs("div",{children:[b.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Upload Photos"}),b.jsx(Yu,{onUpload:c,maxImages:10})]}),n===2&&b.jsxs("form",{onSubmit:p=>{p.preventDefault(),s(3)},className:"space-y-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),b.jsx("input",{type:"text",required:!0,value:r.title,onChange:p=>i({...r,title:p.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),b.jsx("textarea",{required:!0,value:r.description,onChange:p=>i({...r,description:p.target.value}),rows:4,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),b.jsxs("select",{required:!0,value:r.category,onChange:p=>i({...r,category:p.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[b.jsx("option",{value:"",children:"Select Category"}),d.map(p=>b.jsx("option",{value:p,children:p},p))]})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Condition"}),b.jsxs("select",{required:!0,value:r.condition,onChange:p=>i({...r,condition:p.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[b.jsx("option",{value:"",children:"Select Condition"}),h.map(p=>b.jsx("option",{value:p,children:p},p))]})]})]}),b.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Price (ZAR)"}),b.jsx("input",{type:"number",required:!0,value:r.price,onChange:p=>i({...r,price:p.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",min:"0"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),b.jsx("input",{type:"text",required:!0,value:r.location,onChange:p=>i({...r,location:p.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",placeholder:"City, Province"})]})]}),b.jsx("button",{type:"submit",className:"w-full bg-primary text-white py-3 rounded-lg hover:bg-secondary transition-colors",children:"Continue"})]}),n===3&&b.jsxs("div",{className:"space-y-6",children:[b.jsx(fV,{onChange:p=>i({...r,requestVeriLINC:p})}),b.jsx("div",{className:"border-t pt-6",children:b.jsx("button",{onClick:u,disabled:o,className:"w-full bg-primary text-white py-3 rounded-lg hover:bg-secondary transition-colors disabled:opacity-50",children:o?"Publishing...":"Publish Ad"})})]})]})})})}function TDe(){const t=[{id:1,title:"iPhone 14 Pro Max",price:19999,status:"active",views:245,inquiries:12,publishedDate:"2024-01-15"}];return b.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:b.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[b.jsxs("div",{className:"flex justify-between items-center mb-8",children:[b.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Seller Dashboard"}),b.jsxs(Ja,{to:"/post-ad",className:"flex items-center bg-primary text-white px-4 py-2 rounded-lg hover:bg-secondary",children:[b.jsx(EM,{className:"h-5 w-5 mr-2"}),"Post New Ad"]})]}),b.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[b.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:b.jsxs("div",{className:"flex items-center",children:[b.jsx(HZ,{className:"h-8 w-8 text-primary"}),b.jsxs("div",{className:"ml-4",children:[b.jsx("p",{className:"text-sm text-gray-500",children:"Total Views"}),b.jsx("p",{className:"text-2xl font-bold",children:"245"})]})]})}),b.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:b.jsxs("div",{className:"flex items-center",children:[b.jsx(nee,{className:"h-8 w-8 text-primary"}),b.jsxs("div",{className:"ml-4",children:[b.jsx("p",{className:"text-sm text-gray-500",children:"Active Listings"}),b.jsx("p",{className:"text-2xl font-bold",children:"1"})]})]})}),b.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:b.jsxs("div",{className:"flex items-center",children:[b.jsx(F_,{className:"h-8 w-8 text-primary"}),b.jsxs("div",{className:"ml-4",children:[b.jsx("p",{className:"text-sm text-gray-500",children:"New Inquiries"}),b.jsx("p",{className:"text-2xl font-bold",children:"12"})]})]})})]}),b.jsx("div",{className:"bg-white rounded-lg shadow",children:b.jsxs("div",{className:"p-6",children:[b.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Your Listings"}),b.jsxs("table",{className:"w-full",children:[b.jsx("thead",{children:b.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[b.jsx("th",{className:"pb-3",children:"Title"}),b.jsx("th",{className:"pb-3",children:"Price"}),b.jsx("th",{className:"pb-3",children:"Status"}),b.jsx("th",{className:"pb-3",children:"Views"}),b.jsx("th",{className:"pb-3",children:"Inquiries"}),b.jsx("th",{className:"pb-3",children:"Published"}),b.jsx("th",{className:"pb-3",children:"Actions"})]})}),b.jsx("tbody",{children:t.map(e=>b.jsxs("tr",{className:"border-b",children:[b.jsx("td",{className:"py-4",children:e.title}),b.jsxs("td",{children:["R ",e.price.toLocaleString()]}),b.jsx("td",{children:b.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e.status})}),b.jsx("td",{children:e.views}),b.jsx("td",{children:e.inquiries}),b.jsx("td",{children:new Date(e.publishedDate).toLocaleDateString()}),b.jsx("td",{children:b.jsx("button",{className:"text-primary hover:text-secondary",children:"Edit"})})]},e.id))})]})]})})]})})}function NDe(){return b.jsx(zZ,{children:b.jsxs(d8,{children:[b.jsx(Ln,{path:"/",element:b.jsx(c8,{to:"/platform-select",replace:!0})}),b.jsx(Ln,{path:"/platform-select",element:b.jsx(jZ,{})}),b.jsx(Ln,{path:"/buy-sell",element:b.jsx(fee,{})}),b.jsx(Ln,{path:"/product/:id",element:b.jsx(hDe,{})}),b.jsx(Ln,{path:"/checkout/:id",element:b.jsx(IDe,{})}),b.jsx(Ln,{path:"/order-confirmation",element:b.jsx(kDe,{})}),b.jsx(Ln,{path:"/post-ad",element:b.jsx(SDe,{})}),b.jsx(Ln,{path:"/seller/dashboard",element:b.jsx(TDe,{})}),b.jsx(Ln,{path:"/swap",element:b.jsx(mee,{})}),b.jsx(Ln,{path:"/signup",element:b.jsx(gee,{})}),b.jsx(Ln,{path:"/login",element:b.jsx(yee,{})}),b.jsx(Ln,{path:"/forgot-password",element:b.jsx(xee,{})}),b.jsx(Ln,{path:"/dashboard",element:b.jsx(cne,{})}),b.jsx(Ln,{path:"/profile",element:b.jsx(vne,{})}),b.jsx(Ln,{path:"/items/new",element:b.jsx(Rse,{})}),b.jsx(Ln,{path:"/items/:id",element:b.jsx(Ene,{})}),b.jsx(Ln,{path:"/certificate",element:b.jsx(uDe,{})})]})})}sk.createRoot(document.getElementById("root")).render(b.jsx(bt.StrictMode,{children:b.jsx(x8,{children:b.jsx(NDe,{})})}));
